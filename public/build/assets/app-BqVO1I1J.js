var cA=Object.defineProperty;var um=r=>{throw TypeError(r)};var lA=(r,e,t)=>e in r?cA(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var k=(r,e,t)=>lA(r,typeof e!="symbol"?e+"":e,t),l0=(r,e,t)=>e.has(r)||um("Cannot "+t);var b=(r,e,t)=>(l0(r,e,"read from private field"),t?t.call(r):e.get(r)),M=(r,e,t)=>e.has(r)?um("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),S=(r,e,t,n)=>(l0(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t),q=(r,e,t)=>(l0(r,e,"access private method"),t);var ma=(r,e,t,n)=>({set _(s){S(r,e,s,t)},get _(){return b(r,e,n)}});const Sb="6.15.0";function uA(r,e,t){const n=e.split("|").map(i=>i.trim());for(let i=0;i<n.length;i++)switch(e){case"any":return;case"bigint":case"boolean":case"number":case"string":if(typeof r===e)return}const s=new Error(`invalid value for type ${e}`);throw s.code="INVALID_ARGUMENT",s.argument=`value.${t}`,s.value=r,s}async function ct(r){const e=Object.keys(r);return(await Promise.all(e.map(n=>Promise.resolve(r[n])))).reduce((n,s,i)=>(n[e[i]]=s,n),{})}function te(r,e,t){for(let n in e){let s=e[n];const i=t?t[n]:null;i&&uA(s,i,n),Object.defineProperty(r,n,{enumerable:!0,value:s,writable:!1})}}function $a(r,e){if(r==null)return"null";if(e==null&&(e=new Set),typeof r=="object"){if(e.has(r))return"[Circular]";e.add(r)}if(Array.isArray(r))return"[ "+r.map(t=>$a(t,e)).join(", ")+" ]";if(r instanceof Uint8Array){const t="0123456789abcdef";let n="0x";for(let s=0;s<r.length;s++)n+=t[r[s]>>4],n+=t[r[s]&15];return n}if(typeof r=="object"&&typeof r.toJSON=="function")return $a(r.toJSON(),e);switch(typeof r){case"boolean":case"number":case"symbol":return r.toString();case"bigint":return BigInt(r).toString();case"string":return JSON.stringify(r);case"object":{const t=Object.keys(r);return t.sort(),"{ "+t.map(n=>`${$a(n,e)}: ${$a(r[n],e)}`).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function Qe(r,e){return r&&r.code===e}function Pd(r){return Qe(r,"CALL_EXCEPTION")}function Be(r,e,t){let n=r;{const i=[];if(t){if("message"in t||"code"in t||"name"in t)throw new Error(`value will overwrite populated values: ${$a(t)}`);for(const o in t){if(o==="shortMessage")continue;const a=t[o];i.push(o+"="+$a(a))}}i.push(`code=${e}`),i.push(`version=${Sb}`),i.length&&(r+=" ("+i.join(", ")+")")}let s;switch(e){case"INVALID_ARGUMENT":s=new TypeError(r);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":s=new RangeError(r);break;default:s=new Error(r)}return te(s,{code:e}),t&&Object.assign(s,t),s.shortMessage==null&&te(s,{shortMessage:n}),s}function z(r,e,t,n){if(!r)throw Be(e,t,n)}function C(r,e,t,n){z(r,e,"INVALID_ARGUMENT",{argument:t,value:n})}function Ob(r,e,t){t==null&&(t=""),t&&(t=": "+t),z(r>=e,"missing argument"+t,"MISSING_ARGUMENT",{count:r,expectedCount:e}),z(r<=e,"too many arguments"+t,"UNEXPECTED_ARGUMENT",{count:r,expectedCount:e})}const fA=["NFD","NFC","NFKD","NFKC"].reduce((r,e)=>{try{if("test".normalize(e)!=="test")throw new Error("bad");if(e==="NFD"&&"é".normalize("NFD")!=="é")throw new Error("broken");r.push(e)}catch{}return r},[]);function Pb(r){z(fA.indexOf(r)>=0,"platform missing String.prototype.normalize","UNSUPPORTED_OPERATION",{operation:"String.prototype.normalize",info:{form:r}})}function js(r,e,t){if(t==null&&(t=""),r!==e){let n=t,s="new";t&&(n+=".",s+=" "+t),z(!1,`private constructor; use ${n}from* methods`,"UNSUPPORTED_OPERATION",{operation:s})}}function J2(r,e,t){if(r instanceof Uint8Array)return t?new Uint8Array(r):r;if(typeof r=="string"&&r.match(/^0x(?:[0-9a-f][0-9a-f])*$/i)){const n=new Uint8Array((r.length-2)/2);let s=2;for(let i=0;i<n.length;i++)n[i]=parseInt(r.substring(s,s+2),16),s+=2;return n}C(!1,"invalid BytesLike value",e||"value",r)}function Q(r,e){return J2(r,e,!1)}function ut(r,e){return J2(r,e,!0)}function De(r,e){return!(typeof r!="string"||!r.match(/^0x[0-9A-Fa-f]*$/)||typeof e=="number"&&r.length!==2+2*e||e===!0&&r.length%2!==0)}function of(r){return De(r,!0)||r instanceof Uint8Array}const fm="0123456789abcdef";function K(r){const e=Q(r);let t="0x";for(let n=0;n<e.length;n++){const s=e[n];t+=fm[(s&240)>>4]+fm[s&15]}return t}function me(r){return"0x"+r.map(e=>K(e).substring(2)).join("")}function _i(r){return De(r,!0)?(r.length-2)/2:Q(r).length}function ke(r,e,t){const n=Q(r);return t!=null&&t>n.length&&z(!1,"cannot slice beyond data bounds","BUFFER_OVERRUN",{buffer:n,length:n.length,offset:t}),K(n.slice(e??0,t??n.length))}function hA(r){let e=K(r).substring(2);for(;e.startsWith("00");)e=e.substring(2);return"0x"+e}function Y2(r,e,t){const n=Q(r);z(e>=n.length,"padding exceeds data length","BUFFER_OVERRUN",{buffer:new Uint8Array(n),length:e,offset:e+1});const s=new Uint8Array(e);return s.fill(0),t?s.set(n,e-n.length):s.set(n,0),K(s)}function vr(r,e){return Y2(r,e,!0)}function Cd(r,e){return Y2(r,e,!1)}const Td=BigInt(0),hn=BigInt(1),La=9007199254740991;function gu(r,e){const t=af(r,"value"),n=BigInt(ae(e,"width"));if(z(t>>n===Td,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:r}),t>>n-hn){const s=(hn<<n)-hn;return-((~t&s)+hn)}return t}function Nd(r,e){let t=re(r,"value");const n=BigInt(ae(e,"width")),s=hn<<n-hn;if(t<Td){t=-t,z(t<=s,"too low","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:r});const i=(hn<<n)-hn;return(~t&i)+hn}else z(t<s,"too high","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:r});return t}function Di(r,e){const t=af(r,"value"),n=BigInt(ae(e,"bits"));return t&(hn<<n)-hn}function re(r,e){switch(typeof r){case"bigint":return r;case"number":return C(Number.isInteger(r),"underflow",e||"value",r),C(r>=-La&&r<=La,"overflow",e||"value",r),BigInt(r);case"string":try{if(r==="")throw new Error("empty string");return r[0]==="-"&&r[1]!=="-"?-BigInt(r.substring(1)):BigInt(r)}catch(t){C(!1,`invalid BigNumberish string: ${t.message}`,e||"value",r)}}C(!1,"invalid BigNumberish value",e||"value",r)}function af(r,e){const t=re(r,e);return z(t>=Td,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:r}),t}const hm="0123456789abcdef";function pl(r){if(r instanceof Uint8Array){let e="0x0";for(const t of r)e+=hm[t>>4],e+=hm[t&15];return BigInt(e)}return re(r)}function ae(r,e){switch(typeof r){case"bigint":return C(r>=-La&&r<=La,"overflow",e||"value",r),Number(r);case"number":return C(Number.isInteger(r),"underflow",e||"value",r),C(r>=-La&&r<=La,"overflow",e||"value",r),r;case"string":try{if(r==="")throw new Error("empty string");return ae(BigInt(r),e)}catch(t){C(!1,`invalid numeric string: ${t.message}`,e||"value",r)}}C(!1,"invalid numeric value",e||"value",r)}function Z2(r){return ae(pl(r))}function Zn(r,e){let n=af(r,"value").toString(16);if(e==null)n.length%2&&(n="0"+n);else{const s=ae(e,"width");for(z(s*2>=n.length,`value exceeds width (${s} bytes)`,"NUMERIC_FAULT",{operation:"toBeHex",fault:"overflow",value:r});n.length<s*2;)n="0"+n}return"0x"+n}function Fe(r){const e=af(r,"value");if(e===Td)return new Uint8Array([]);let t=e.toString(16);t.length%2&&(t="0"+t);const n=new Uint8Array(t.length/2);for(let s=0;s<n.length;s++){const i=s*2;n[s]=parseInt(t.substring(i,i+2),16)}return n}function xr(r){let e=K(of(r)?r:Fe(r)).substring(2);for(;e.startsWith("0");)e=e.substring(1);return e===""&&(e="0"),"0x"+e}const jh="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";let Df=null;function dA(r){if(Df==null){Df={};for(let t=0;t<jh.length;t++)Df[jh[t]]=BigInt(t)}const e=Df[r];return C(e!=null,"invalid base58 value","letter",r),e}const pA=BigInt(0),Rp=BigInt(58);function Cb(r){const e=Q(r);let t=pl(e),n="";for(;t;)n=jh[Number(t%Rp)]+n,t/=Rp;for(let s=0;s<e.length&&!e[s];s++)n=jh[0]+n;return n}function X2(r){let e=pA;for(let t=0;t<r.length;t++)e*=Rp,e+=dA(r[t]);return e}function e3(r){r=atob(r);const e=new Uint8Array(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return Q(e)}function t3(r){const e=Q(r);let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)}var nc;class Tb{constructor(e,t,n){k(this,"filter");k(this,"emitter");M(this,nc);S(this,nc,t),te(this,{emitter:e,filter:n})}async removeListener(){b(this,nc)!=null&&await this.emitter.off(this.filter,b(this,nc))}}nc=new WeakMap;function gA(r,e,t,n,s){C(!1,`invalid codepoint at offset ${e}; ${r}`,"bytes",t)}function r3(r,e,t,n,s){if(r==="BAD_PREFIX"||r==="UNEXPECTED_CONTINUE"){let i=0;for(let o=e+1;o<t.length&&t[o]>>6===2;o++)i++;return i}return r==="OVERRUN"?t.length-e-1:0}function bA(r,e,t,n,s){return r==="OVERLONG"?(C(typeof s=="number","invalid bad code point for replacement","badCodepoint",s),n.push(s),0):(n.push(65533),r3(r,e,t))}const n3=Object.freeze({error:gA,ignore:r3,replace:bA});function s3(r,e){e==null&&(e=n3.error);const t=Q(r,"bytes"),n=[];let s=0;for(;s<t.length;){const i=t[s++];if(i>>7===0){n.push(i);continue}let o=null,a=null;if((i&224)===192)o=1,a=127;else if((i&240)===224)o=2,a=2047;else if((i&248)===240)o=3,a=65535;else{(i&192)===128?s+=e("UNEXPECTED_CONTINUE",s-1,t,n):s+=e("BAD_PREFIX",s-1,t,n);continue}if(s-1+o>=t.length){s+=e("OVERRUN",s-1,t,n);continue}let c=i&(1<<8-o-1)-1;for(let l=0;l<o;l++){let u=t[s];if((u&192)!=128){s+=e("MISSING_CONTINUE",s,t,n),c=null;break}c=c<<6|u&63,s++}if(c!==null){if(c>1114111){s+=e("OUT_OF_RANGE",s-1-o,t,n,c);continue}if(c>=55296&&c<=57343){s+=e("UTF16_SURROGATE",s-1-o,t,n,c);continue}if(c<=a){s+=e("OVERLONG",s-1-o,t,n,c);continue}n.push(c)}}return n}function st(r,e){C(typeof r=="string","invalid string value","str",r),e!=null&&(Pb(e),r=r.normalize(e));let t=[];for(let n=0;n<r.length;n++){const s=r.charCodeAt(n);if(s<128)t.push(s);else if(s<2048)t.push(s>>6|192),t.push(s&63|128);else if((s&64512)==55296){n++;const i=r.charCodeAt(n);C(n<r.length&&(i&64512)===56320,"invalid surrogate pair","str",r);const o=65536+((s&1023)<<10)+(i&1023);t.push(o>>18|240),t.push(o>>12&63|128),t.push(o>>6&63|128),t.push(o&63|128)}else t.push(s>>12|224),t.push(s>>6&63|128),t.push(s&63|128)}return new Uint8Array(t)}function yA(r){return r.map(e=>e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10&1023)+55296,(e&1023)+56320))).join("")}function $i(r,e){return yA(s3(r,e))}function mA(r,e){return s3(st(r,e))}function i3(r){async function e(t,n){z(n==null||!n.cancelled,"request cancelled before sending","CANCELLED");const s=t.url.split(":")[0].toLowerCase();z(s==="http"||s==="https",`unsupported protocol ${s}`,"UNSUPPORTED_OPERATION",{info:{protocol:s},operation:"request"}),z(s==="https"||!t.credentials||t.allowInsecureAuthentication,"insecure authorized connections unsupported","UNSUPPORTED_OPERATION",{operation:"request"});let i=null;const o=new AbortController,a=setTimeout(()=>{i=Be("request timeout","TIMEOUT"),o.abort()},t.timeout);n&&n.addListener(()=>{i=Be("request cancelled","CANCELLED"),o.abort()});const c=Object.assign({},r,{method:t.method,headers:new Headers(Array.from(t)),body:t.body||void 0,signal:o.signal});let l;try{l=await fetch(t.url,c)}catch(d){throw clearTimeout(a),i||d}clearTimeout(a);const u={};l.headers.forEach((d,p)=>{u[p.toLowerCase()]=d});const f=await l.arrayBuffer(),h=f==null?null:new Uint8Array(f);return{statusCode:l.status,statusMessage:l.statusText,headers:u,body:h}}return e}const xA=12,wA=250;let dm=i3();const EA=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),vA=new RegExp("^ipfs://(ipfs/)?(.*)$","i");let u0=!1;async function o3(r,e){try{const t=r.match(EA);if(!t)throw new Error("invalid data");return new Ds(200,"OK",{"content-type":t[1]||"text/plain"},t[2]?e3(t[3]):AA(t[3]))}catch{return new Ds(599,"BAD REQUEST (invalid data: URI)",{},null,new pt(r))}}function a3(r){async function e(t,n){try{const s=t.match(vA);if(!s)throw new Error("invalid link");return new pt(`${r}${s[2]}`)}catch{return new Ds(599,"BAD REQUEST (invalid IPFS URI)",{},null,new pt(t))}}return e}const Rf={data:o3,ipfs:a3("https://gateway.ipfs.io/ipfs/")},c3=new WeakMap;var So,ui;class l3{constructor(e){M(this,So);M(this,ui);S(this,So,[]),S(this,ui,!1),c3.set(e,()=>{if(!b(this,ui)){S(this,ui,!0);for(const t of b(this,So))setTimeout(()=>{t()},0);S(this,So,[])}})}addListener(e){z(!b(this,ui),"singal already cancelled","UNSUPPORTED_OPERATION",{operation:"fetchCancelSignal.addCancelListener"}),b(this,So).push(e)}get cancelled(){return b(this,ui)}checkSignal(){z(!this.cancelled,"cancelled","CANCELLED",{})}}So=new WeakMap,ui=new WeakMap;function _f(r){if(r==null)throw new Error("missing signal; should not happen");return r.checkSignal(),r}var sc,ic,nn,ys,oc,ac,at,dr,ms,Oo,Po,Co,Rn,sn,fi,To,Gl;const wd=class wd{constructor(e){M(this,To);M(this,sc);M(this,ic);M(this,nn);M(this,ys);M(this,oc);M(this,ac);M(this,at);M(this,dr);M(this,ms);M(this,Oo);M(this,Po);M(this,Co);M(this,Rn);M(this,sn);M(this,fi);S(this,ac,String(e)),S(this,sc,!1),S(this,ic,!0),S(this,nn,{}),S(this,ys,""),S(this,oc,3e5),S(this,sn,{slotInterval:wA,maxAttempts:xA}),S(this,fi,null)}get url(){return b(this,ac)}set url(e){S(this,ac,String(e))}get body(){return b(this,at)==null?null:new Uint8Array(b(this,at))}set body(e){if(e==null)S(this,at,void 0),S(this,dr,void 0);else if(typeof e=="string")S(this,at,st(e)),S(this,dr,"text/plain");else if(e instanceof Uint8Array)S(this,at,e),S(this,dr,"application/octet-stream");else if(typeof e=="object")S(this,at,st(JSON.stringify(e))),S(this,dr,"application/json");else throw new Error("invalid body")}hasBody(){return b(this,at)!=null}get method(){return b(this,ys)?b(this,ys):this.hasBody()?"POST":"GET"}set method(e){e==null&&(e=""),S(this,ys,String(e).toUpperCase())}get headers(){const e=Object.assign({},b(this,nn));return b(this,ms)&&(e.authorization=`Basic ${t3(st(b(this,ms)))}`),this.allowGzip&&(e["accept-encoding"]="gzip"),e["content-type"]==null&&b(this,dr)&&(e["content-type"]=b(this,dr)),this.body&&(e["content-length"]=String(this.body.length)),e}getHeader(e){return this.headers[e.toLowerCase()]}setHeader(e,t){b(this,nn)[String(e).toLowerCase()]=String(t)}clearHeaders(){S(this,nn,{})}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let n=0;return{next:()=>{if(n<t.length){const s=t[n++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}get credentials(){return b(this,ms)||null}setCredentials(e,t){C(!e.match(/:/),"invalid basic authentication username","username","[REDACTED]"),S(this,ms,`${e}:${t}`)}get allowGzip(){return b(this,ic)}set allowGzip(e){S(this,ic,!!e)}get allowInsecureAuthentication(){return!!b(this,sc)}set allowInsecureAuthentication(e){S(this,sc,!!e)}get timeout(){return b(this,oc)}set timeout(e){C(e>=0,"timeout must be non-zero","timeout",e),S(this,oc,e)}get preflightFunc(){return b(this,Oo)||null}set preflightFunc(e){S(this,Oo,e)}get processFunc(){return b(this,Po)||null}set processFunc(e){S(this,Po,e)}get retryFunc(){return b(this,Co)||null}set retryFunc(e){S(this,Co,e)}get getUrlFunc(){return b(this,fi)||dm}set getUrlFunc(e){S(this,fi,e)}toString(){return`<FetchRequest method=${JSON.stringify(this.method)} url=${JSON.stringify(this.url)} headers=${JSON.stringify(this.headers)} body=${b(this,at)?K(b(this,at)):"null"}>`}setThrottleParams(e){e.slotInterval!=null&&(b(this,sn).slotInterval=e.slotInterval),e.maxAttempts!=null&&(b(this,sn).maxAttempts=e.maxAttempts)}send(){return z(b(this,Rn)==null,"request already sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.send"}),S(this,Rn,new l3(this)),q(this,To,Gl).call(this,0,pm()+this.timeout,0,this,new Ds(0,"",{},null,this))}cancel(){z(b(this,Rn)!=null,"request has not been sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.cancel"});const e=c3.get(this);if(!e)throw new Error("missing signal; should not happen");e()}redirect(e){const t=this.url.split(":")[0].toLowerCase(),n=e.split(":")[0].toLowerCase();z(this.method==="GET"&&(t!=="https"||n!=="http")&&e.match(/^https?:/),"unsupported redirect","UNSUPPORTED_OPERATION",{operation:`redirect(${this.method} ${JSON.stringify(this.url)} => ${JSON.stringify(e)})`});const s=new wd(e);return s.method="GET",s.allowGzip=this.allowGzip,s.timeout=this.timeout,S(s,nn,Object.assign({},b(this,nn))),b(this,at)&&S(s,at,new Uint8Array(b(this,at))),S(s,dr,b(this,dr)),s}clone(){const e=new wd(this.url);return S(e,ys,b(this,ys)),b(this,at)&&S(e,at,b(this,at)),S(e,dr,b(this,dr)),S(e,nn,Object.assign({},b(this,nn))),S(e,ms,b(this,ms)),this.allowGzip&&(e.allowGzip=!0),e.timeout=this.timeout,this.allowInsecureAuthentication&&(e.allowInsecureAuthentication=!0),S(e,Oo,b(this,Oo)),S(e,Po,b(this,Po)),S(e,Co,b(this,Co)),S(e,sn,Object.assign({},b(this,sn))),S(e,fi,b(this,fi)),e}static lockConfig(){u0=!0}static getGateway(e){return Rf[e.toLowerCase()]||null}static registerGateway(e,t){if(e=e.toLowerCase(),e==="http"||e==="https")throw new Error(`cannot intercept ${e}; use registerGetUrl`);if(u0)throw new Error("gateways locked");Rf[e]=t}static registerGetUrl(e){if(u0)throw new Error("gateways locked");dm=e}static createGetUrlFunc(e){return i3(e)}static createDataGateway(){return o3}static createIpfsGatewayFunc(e){return a3(e)}};sc=new WeakMap,ic=new WeakMap,nn=new WeakMap,ys=new WeakMap,oc=new WeakMap,ac=new WeakMap,at=new WeakMap,dr=new WeakMap,ms=new WeakMap,Oo=new WeakMap,Po=new WeakMap,Co=new WeakMap,Rn=new WeakMap,sn=new WeakMap,fi=new WeakMap,To=new WeakSet,Gl=async function(e,t,n,s,i){var u,f,h;if(e>=b(this,sn).maxAttempts)return i.makeServerError("exceeded maximum retry limit");z(pm()<=t,"timeout","TIMEOUT",{operation:"request.send",reason:"timeout",request:s}),n>0&&await IA(n);let o=this.clone();const a=(o.url.split(":")[0]||"").toLowerCase();if(a in Rf){const d=await Rf[a](o.url,_f(b(s,Rn)));if(d instanceof Ds){let p=d;if(this.processFunc){_f(b(s,Rn));try{p=await this.processFunc(o,p)}catch(g){(g.throttle==null||typeof g.stall!="number")&&p.makeServerError("error in post-processing function",g).assertOk()}}return p}o=d}this.preflightFunc&&(o=await this.preflightFunc(o));const c=await this.getUrlFunc(o,_f(b(s,Rn)));let l=new Ds(c.statusCode,c.statusMessage,c.headers,c.body,s);if(l.statusCode===301||l.statusCode===302){try{const d=l.headers.location||"";return q(u=o.redirect(d),To,Gl).call(u,e+1,t,0,s,l)}catch{}return l}else if(l.statusCode===429&&(this.retryFunc==null||await this.retryFunc(o,l,e))){const d=l.headers["retry-after"];let p=b(this,sn).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return typeof d=="string"&&d.match(/^[1-9][0-9]*$/)&&(p=parseInt(d)),q(f=o.clone(),To,Gl).call(f,e+1,t,p,s,l)}if(this.processFunc){_f(b(s,Rn));try{l=await this.processFunc(o,l)}catch(d){(d.throttle==null||typeof d.stall!="number")&&l.makeServerError("error in post-processing function",d).assertOk();let p=b(this,sn).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return d.stall>=0&&(p=d.stall),q(h=o.clone(),To,Gl).call(h,e+1,t,p,s,l)}}return l};let pt=wd;var Mu,ju,zu,pr,cc,No;const Jy=class Jy{constructor(e,t,n,s,i){M(this,Mu);M(this,ju);M(this,zu);M(this,pr);M(this,cc);M(this,No);S(this,Mu,e),S(this,ju,t),S(this,zu,Object.keys(n).reduce((o,a)=>(o[a.toLowerCase()]=String(n[a]),o),{})),S(this,pr,s==null?null:new Uint8Array(s)),S(this,cc,i||null),S(this,No,{message:""})}toString(){return`<FetchResponse status=${this.statusCode} body=${b(this,pr)?K(b(this,pr)):"null"}>`}get statusCode(){return b(this,Mu)}get statusMessage(){return b(this,ju)}get headers(){return Object.assign({},b(this,zu))}get body(){return b(this,pr)==null?null:new Uint8Array(b(this,pr))}get bodyText(){try{return b(this,pr)==null?"":$i(b(this,pr))}catch{z(!1,"response body is not valid UTF-8 data","UNSUPPORTED_OPERATION",{operation:"bodyText",info:{response:this}})}}get bodyJson(){try{return JSON.parse(this.bodyText)}catch{z(!1,"response body is not valid JSON","UNSUPPORTED_OPERATION",{operation:"bodyJson",info:{response:this}})}}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let n=0;return{next:()=>{if(n<t.length){const s=t[n++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}makeServerError(e,t){let n;e?n=`CLIENT ESCALATED SERVER ERROR (${this.statusCode} ${this.statusMessage}; ${e})`:(e=`${this.statusCode} ${this.statusMessage}`,n=`CLIENT ESCALATED SERVER ERROR (${e})`);const s=new Jy(599,n,this.headers,this.body,b(this,cc)||void 0);return S(s,No,{message:e,error:t}),s}throwThrottleError(e,t){t==null?t=-1:C(Number.isInteger(t)&&t>=0,"invalid stall timeout","stall",t);const n=new Error(e||"throttling requests");throw te(n,{stall:t,throttle:!0}),n}getHeader(e){return this.headers[e.toLowerCase()]}hasBody(){return b(this,pr)!=null}get request(){return b(this,cc)}ok(){return b(this,No).message===""&&this.statusCode>=200&&this.statusCode<300}assertOk(){if(this.ok())return;let{message:e,error:t}=b(this,No);e===""&&(e=`server response ${this.statusCode} ${this.statusMessage}`);let n=null;this.request&&(n=this.request.url);let s=null;try{b(this,pr)&&(s=$i(b(this,pr)))}catch{}z(!1,e,"SERVER_ERROR",{request:this.request||"unknown request",response:this,error:t,info:{requestUrl:n,responseBody:s,responseStatus:`${this.statusCode} ${this.statusMessage}`}})}};Mu=new WeakMap,ju=new WeakMap,zu=new WeakMap,pr=new WeakMap,cc=new WeakMap,No=new WeakMap;let Ds=Jy;function pm(){return new Date().getTime()}function AA(r){return st(r.replace(/%([0-9a-f][0-9a-f])/gi,(e,t)=>String.fromCharCode(parseInt(t,16))))}function IA(r){return new Promise(e=>setTimeout(e,r))}const SA=BigInt(-1),Zr=BigInt(0),Fa=BigInt(1),OA=BigInt(5),xa={};let Ga="0000";for(;Ga.length<80;)Ga+=Ga;function Yi(r){let e=Ga;for(;e.length<r;)e+=e;return BigInt("1"+e.substring(0,r))}function Sl(r,e,t){const n=BigInt(e.width);if(e.signed){const s=Fa<<n-Fa;z(t==null||r>=-s&&r<s,"overflow","NUMERIC_FAULT",{operation:t,fault:"overflow",value:r}),r>Zr?r=gu(Di(r,n),n):r=-gu(Di(-r,n),n)}else{const s=Fa<<n;z(t==null||r>=0&&r<s,"overflow","NUMERIC_FAULT",{operation:t,fault:"overflow",value:r}),r=(r%s+s)%s&s-Fa}return r}function f0(r){typeof r=="number"&&(r=`fixed128x${r}`);let e=!0,t=128,n=18;if(typeof r=="string"){if(r!=="fixed")if(r==="ufixed")e=!1;else{const i=r.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);C(i,"invalid fixed format","format",r),e=i[1]!=="u",t=parseInt(i[2]),n=parseInt(i[3])}}else if(r){const i=r,o=(a,c,l)=>i[a]==null?l:(C(typeof i[a]===c,"invalid fixed format ("+a+" not "+c+")","format."+a,i[a]),i[a]);e=o("signed","boolean",e),t=o("width","number",t),n=o("decimals","number",n)}C(t%8===0,"invalid FixedNumber width (not byte aligned)","format.width",t),C(n<=80,"invalid FixedNumber decimals (too large)","format.decimals",n);const s=(e?"":"u")+"fixed"+String(t)+"x"+String(n);return{signed:e,width:t,decimals:n,name:s}}function PA(r,e){let t="";r<Zr&&(t="-",r*=SA);let n=r.toString();if(e===0)return t+n;for(;n.length<=e;)n=Ga+n;const s=n.length-e;for(n=n.substring(0,s)+"."+n.substring(s);n[0]==="0"&&n[1]!==".";)n=n.substring(1);for(;n[n.length-1]==="0"&&n[n.length-2]!==".";)n=n.substring(0,n.length-1);return t+n}var on,Ce,$t,Oe,no,us,_p,Bp,kp,Up;const ai=class ai{constructor(e,t,n){M(this,Oe);k(this,"format");M(this,on);M(this,Ce);M(this,$t);k(this,"_value");js(e,xa,"FixedNumber"),S(this,Ce,t),S(this,on,n);const s=PA(t,n.decimals);te(this,{format:n.name,_value:s}),S(this,$t,Yi(n.decimals))}get signed(){return b(this,on).signed}get width(){return b(this,on).width}get decimals(){return b(this,on).decimals}get value(){return b(this,Ce)}addUnsafe(e){return q(this,Oe,_p).call(this,e)}add(e){return q(this,Oe,_p).call(this,e,"add")}subUnsafe(e){return q(this,Oe,Bp).call(this,e)}sub(e){return q(this,Oe,Bp).call(this,e,"sub")}mulUnsafe(e){return q(this,Oe,kp).call(this,e)}mul(e){return q(this,Oe,kp).call(this,e,"mul")}mulSignal(e){q(this,Oe,no).call(this,e);const t=b(this,Ce)*b(e,Ce);return z(t%b(this,$t)===Zr,"precision lost during signalling mul","NUMERIC_FAULT",{operation:"mulSignal",fault:"underflow",value:this}),q(this,Oe,us).call(this,t/b(this,$t),"mulSignal")}divUnsafe(e){return q(this,Oe,Up).call(this,e)}div(e){return q(this,Oe,Up).call(this,e,"div")}divSignal(e){z(b(e,Ce)!==Zr,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),q(this,Oe,no).call(this,e);const t=b(this,Ce)*b(this,$t);return z(t%b(e,Ce)===Zr,"precision lost during signalling div","NUMERIC_FAULT",{operation:"divSignal",fault:"underflow",value:this}),q(this,Oe,us).call(this,t/b(e,Ce),"divSignal")}cmp(e){let t=this.value,n=e.value;const s=this.decimals-e.decimals;return s>0?n*=Yi(s):s<0&&(t*=Yi(-s)),t<n?-1:t>n?1:0}eq(e){return this.cmp(e)===0}lt(e){return this.cmp(e)<0}lte(e){return this.cmp(e)<=0}gt(e){return this.cmp(e)>0}gte(e){return this.cmp(e)>=0}floor(){let e=b(this,Ce);return b(this,Ce)<Zr&&(e-=b(this,$t)-Fa),e=b(this,Ce)/b(this,$t)*b(this,$t),q(this,Oe,us).call(this,e,"floor")}ceiling(){let e=b(this,Ce);return b(this,Ce)>Zr&&(e+=b(this,$t)-Fa),e=b(this,Ce)/b(this,$t)*b(this,$t),q(this,Oe,us).call(this,e,"ceiling")}round(e){if(e==null&&(e=0),e>=this.decimals)return this;const t=this.decimals-e,n=OA*Yi(t-1);let s=this.value+n;const i=Yi(t);return s=s/i*i,Sl(s,b(this,on),"round"),new ai(xa,s,b(this,on))}isZero(){return b(this,Ce)===Zr}isNegative(){return b(this,Ce)<Zr}toString(){return this._value}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(e){return ai.fromString(this.toString(),e)}static fromValue(e,t,n){const s=t==null?0:ae(t),i=f0(n);let o=re(e,"value");const a=s-i.decimals;if(a>0){const c=Yi(a);z(o%c===Zr,"value loses precision for format","NUMERIC_FAULT",{operation:"fromValue",fault:"underflow",value:e}),o/=c}else a<0&&(o*=Yi(-a));return Sl(o,i,"fromValue"),new ai(xa,o,i)}static fromString(e,t){const n=e.match(/^(-?)([0-9]*)\.?([0-9]*)$/);C(n&&n[2].length+n[3].length>0,"invalid FixedNumber string value","value",e);const s=f0(t);let i=n[2]||"0",o=n[3]||"";for(;o.length<s.decimals;)o+=Ga;z(o.substring(s.decimals).match(/^0*$/),"too many decimals for format","NUMERIC_FAULT",{operation:"fromString",fault:"underflow",value:e}),o=o.substring(0,s.decimals);const a=BigInt(n[1]+i+o);return Sl(a,s,"fromString"),new ai(xa,a,s)}static fromBytes(e,t){let n=pl(Q(e,"value"));const s=f0(t);return s.signed&&(n=gu(n,s.width)),Sl(n,s,"fromBytes"),new ai(xa,n,s)}};on=new WeakMap,Ce=new WeakMap,$t=new WeakMap,Oe=new WeakSet,no=function(e){C(this.format===e.format,"incompatible format; use fixedNumber.toFormat","other",e)},us=function(e,t){return e=Sl(e,b(this,on),t),new ai(xa,e,b(this,on))},_p=function(e,t){return q(this,Oe,no).call(this,e),q(this,Oe,us).call(this,b(this,Ce)+b(e,Ce),t)},Bp=function(e,t){return q(this,Oe,no).call(this,e),q(this,Oe,us).call(this,b(this,Ce)-b(e,Ce),t)},kp=function(e,t){return q(this,Oe,no).call(this,e),q(this,Oe,us).call(this,b(this,Ce)*b(e,Ce)/b(this,$t),t)},Up=function(e,t){return z(b(e,Ce)!==Zr,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),q(this,Oe,no).call(this,e),q(this,Oe,us).call(this,b(this,Ce)*b(this,$t)/b(e,Ce),t)};let bu=ai;function CA(r){let e=r.toString(16);for(;e.length<2;)e="0"+e;return"0x"+e}function gm(r,e,t){let n=0;for(let s=0;s<t;s++)n=n*256+r[e+s];return n}function bm(r,e,t,n){const s=[];for(;t<e+1+n;){const i=u3(r,t);s.push(i.result),t+=i.consumed,z(t<=e+1+n,"child data too short","BUFFER_OVERRUN",{buffer:r,length:n,offset:e})}return{consumed:1+n,result:s}}function u3(r,e){z(r.length!==0,"data too short","BUFFER_OVERRUN",{buffer:r,length:0,offset:1});const t=n=>{z(n<=r.length,"data short segment too short","BUFFER_OVERRUN",{buffer:r,length:r.length,offset:n})};if(r[e]>=248){const n=r[e]-247;t(e+1+n);const s=gm(r,e+1,n);return t(e+1+n+s),bm(r,e,e+1+n,n+s)}else if(r[e]>=192){const n=r[e]-192;return t(e+1+n),bm(r,e,e+1,n)}else if(r[e]>=184){const n=r[e]-183;t(e+1+n);const s=gm(r,e+1,n);t(e+1+n+s);const i=K(r.slice(e+1+n,e+1+n+s));return{consumed:1+n+s,result:i}}else if(r[e]>=128){const n=r[e]-128;t(e+1+n);const s=K(r.slice(e+1,e+1+n));return{consumed:1+n,result:s}}return{consumed:1,result:CA(r[e])}}function gl(r){const e=Q(r,"data"),t=u3(e,0);return C(t.consumed===e.length,"unexpected junk after rlp payload","data",r),t.result}function ym(r){const e=[];for(;r;)e.unshift(r&255),r>>=8;return e}function f3(r){if(Array.isArray(r)){let n=[];if(r.forEach(function(i){n=n.concat(f3(i))}),n.length<=55)return n.unshift(192+n.length),n;const s=ym(n.length);return s.unshift(247+s.length),s.concat(n)}const e=Array.prototype.slice.call(Q(r,"object"));if(e.length===1&&e[0]<=127)return e;if(e.length<=55)return e.unshift(128+e.length),e;const t=ym(e.length);return t.unshift(183+t.length),t.concat(e)}const mm="0123456789abcdef";function Xn(r){let e="0x";for(const t of f3(r))e+=mm[t>>4],e+=mm[t&15];return e}const h3=["wei","kwei","mwei","gwei","szabo","finney","ether"];function Nb(r,e){let t=18;if(typeof e=="string"){const n=h3.indexOf(e);C(n>=0,"invalid unit","unit",e),t=3*n}else e!=null&&(t=ae(e,"unit"));return bu.fromValue(r,t,{decimals:t,width:512}).toString()}function iu(r,e){C(typeof r=="string","value must be a string","value",r);let t=18;if(typeof e=="string"){const n=h3.indexOf(e);C(n>=0,"invalid unit","unit",e),t=3*n}else e!=null&&(t=ae(e,"unit"));return bu.fromString(r,{decimals:t,width:512}).value}function $p(r){return Nb(r,18)}function TA(r){return iu(r,18)}function d3(r){const e=Q(r,"randomBytes");e[6]=e[6]&15|64,e[8]=e[8]&63|128;const t=K(e);return[t.substring(2,10),t.substring(10,14),t.substring(14,18),t.substring(18,22),t.substring(22,34)].join("-")}const Mt=32,Lp=new Uint8Array(Mt),NA=["then"],Bf={},p3=new WeakMap;function co(r){return p3.get(r)}function xm(r,e){p3.set(r,e)}function Ol(r,e){const t=new Error(`deferred error during ABI decoding triggered accessing ${r}`);throw t.error=e,t}function Fp(r,e,t){return r.indexOf(null)>=0?e.map((n,s)=>n instanceof Xo?Fp(co(n),n,t):n):r.reduce((n,s,i)=>{let o=e.getValue(s);return s in n||(t&&o instanceof Xo&&(o=Fp(co(o),o,t)),n[s]=o),n},{})}var lc;const qa=class qa extends Array{constructor(...t){const n=t[0];let s=t[1],i=(t[2]||[]).slice(),o=!0;n!==Bf&&(s=t,i=[],o=!1);super(s.length);M(this,lc);s.forEach((l,u)=>{this[u]=l});const a=i.reduce((l,u)=>(typeof u=="string"&&l.set(u,(l.get(u)||0)+1),l),new Map);if(xm(this,Object.freeze(s.map((l,u)=>{const f=i[u];return f!=null&&a.get(f)===1?f:null}))),S(this,lc,[]),b(this,lc)==null&&b(this,lc),!o)return;Object.freeze(this);const c=new Proxy(this,{get:(l,u,f)=>{if(typeof u=="string"){if(u.match(/^[0-9]+$/)){const d=ae(u,"%index");if(d<0||d>=this.length)throw new RangeError("out of result range");const p=l[d];return p instanceof Error&&Ol(`index ${d}`,p),p}if(NA.indexOf(u)>=0)return Reflect.get(l,u,f);const h=l[u];if(h instanceof Function)return function(...d){return h.apply(this===f?l:this,d)};if(!(u in l))return l.getValue.apply(this===f?l:this,[u])}return Reflect.get(l,u,f)}});return xm(c,co(this)),c}toArray(t){const n=[];return this.forEach((s,i)=>{s instanceof Error&&Ol(`index ${i}`,s),t&&s instanceof qa&&(s=s.toArray(t)),n.push(s)}),n}toObject(t){const n=co(this);return n.reduce((s,i,o)=>(z(i!=null,`value at index ${o} unnamed`,"UNSUPPORTED_OPERATION",{operation:"toObject()"}),Fp(n,this,t)),{})}slice(t,n){t==null&&(t=0),t<0&&(t+=this.length,t<0&&(t=0)),n==null&&(n=this.length),n<0&&(n+=this.length,n<0&&(n=0)),n>this.length&&(n=this.length);const s=co(this),i=[],o=[];for(let a=t;a<n;a++)i.push(this[a]),o.push(s[a]);return new qa(Bf,i,o)}filter(t,n){const s=co(this),i=[],o=[];for(let a=0;a<this.length;a++){const c=this[a];c instanceof Error&&Ol(`index ${a}`,c),t.call(n,c,a,this)&&(i.push(c),o.push(s[a]))}return new qa(Bf,i,o)}map(t,n){const s=[];for(let i=0;i<this.length;i++){const o=this[i];o instanceof Error&&Ol(`index ${i}`,o),s.push(t.call(n,o,i,this))}return s}getValue(t){const n=co(this).indexOf(t);if(n===-1)return;const s=this[n];return s instanceof Error&&Ol(`property ${JSON.stringify(t)}`,s.error),s}static fromItems(t,n){return new qa(Bf,t,n)}};lc=new WeakMap;let Xo=qa;function DA(r){const e=[],t=function(n,s){if(Array.isArray(s))for(let i in s){const o=n.slice();o.push(i);try{t(o,s[i])}catch(a){e.push({path:o,error:a})}}};return t([],r),e}function wm(r){let e=Fe(r);return z(e.length<=Mt,"value out-of-bounds","BUFFER_OVERRUN",{buffer:e,length:Mt,offset:e.length}),e.length!==Mt&&(e=ut(me([Lp.slice(e.length%Mt),e]))),e}class zs{constructor(e,t,n,s){k(this,"name");k(this,"type");k(this,"localName");k(this,"dynamic");te(this,{name:e,type:t,localName:n,dynamic:s},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(e,t){C(!1,e,this.localName,t)}}var xs,Do,uc,bh;class Mp{constructor(){M(this,uc);M(this,xs);M(this,Do);S(this,xs,[]),S(this,Do,0)}get data(){return me(b(this,xs))}get length(){return b(this,Do)}appendWriter(e){return q(this,uc,bh).call(this,ut(e.data))}writeBytes(e){let t=ut(e);const n=t.length%Mt;return n&&(t=ut(me([t,Lp.slice(n)]))),q(this,uc,bh).call(this,t)}writeValue(e){return q(this,uc,bh).call(this,wm(e))}writeUpdatableValue(){const e=b(this,xs).length;return b(this,xs).push(Lp),S(this,Do,b(this,Do)+Mt),t=>{b(this,xs)[e]=wm(t)}}}xs=new WeakMap,Do=new WeakMap,uc=new WeakSet,bh=function(e){return b(this,xs).push(e),S(this,Do,b(this,Do)+e.length),e.length};var Yt,gr,Ro,_o,hi,ua,zp,g3;const Yy=class Yy{constructor(e,t,n){M(this,ua);k(this,"allowLoose");M(this,Yt);M(this,gr);M(this,Ro);M(this,_o);M(this,hi);te(this,{allowLoose:!!t}),S(this,Yt,ut(e)),S(this,Ro,0),S(this,_o,null),S(this,hi,n??1024),S(this,gr,0)}get data(){return K(b(this,Yt))}get dataLength(){return b(this,Yt).length}get consumed(){return b(this,gr)}get bytes(){return new Uint8Array(b(this,Yt))}subReader(e){const t=new Yy(b(this,Yt).slice(b(this,gr)+e),this.allowLoose,b(this,hi));return S(t,_o,this),t}readBytes(e,t){let n=q(this,ua,g3).call(this,0,e,!!t);return q(this,ua,zp).call(this,e),S(this,gr,b(this,gr)+n.length),n.slice(0,e)}readValue(){return pl(this.readBytes(Mt))}readIndex(){return Z2(this.readBytes(Mt))}};Yt=new WeakMap,gr=new WeakMap,Ro=new WeakMap,_o=new WeakMap,hi=new WeakMap,ua=new WeakSet,zp=function(e){var t;if(b(this,_o))return q(t=b(this,_o),ua,zp).call(t,e);S(this,Ro,b(this,Ro)+e),z(b(this,hi)<1||b(this,Ro)<=b(this,hi)*this.dataLength,`compressed ABI data exceeds inflation ratio of ${b(this,hi)} ( see: https://github.com/ethers-io/ethers.js/issues/4537 )`,"BUFFER_OVERRUN",{buffer:ut(b(this,Yt)),offset:b(this,gr),length:e,info:{bytesRead:b(this,Ro),dataLength:this.dataLength}})},g3=function(e,t,n){let s=Math.ceil(t/Mt)*Mt;return b(this,gr)+s>b(this,Yt).length&&(this.allowLoose&&n&&b(this,gr)+t<=b(this,Yt).length?s=t:z(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:ut(b(this,Yt)),length:b(this,Yt).length,offset:b(this,gr)+s})),b(this,Yt).slice(b(this,gr),b(this,gr)+s)};let jp=Yy;function wr(r){if(!Number.isSafeInteger(r)||r<0)throw new Error(`Wrong positive integer: ${r}`)}function Db(r,...e){if(!(r instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(r.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${r.length}`)}function b3(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");wr(r.outputLen),wr(r.blockLen)}function Jc(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function y3(r,e){Db(r);const t=e.outputLen;if(r.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}const h0=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const m3=r=>r instanceof Uint8Array,yh=r=>new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4)),mh=r=>new DataView(r.buffer,r.byteOffset,r.byteLength),En=(r,e)=>r<<32-e|r>>>e,RA=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!RA)throw new Error("Non little-endian hardware is not supported");const _A=async()=>{};async function Em(r,e,t){let n=Date.now();for(let s=0;s<r;s++){t(s);const i=Date.now()-n;i>=0&&i<e||(await _A(),n+=i)}}function BA(r){if(typeof r!="string")throw new Error(`utf8ToBytes expected string, got ${typeof r}`);return new Uint8Array(new TextEncoder().encode(r))}function Yc(r){if(typeof r=="string"&&(r=BA(r)),!m3(r))throw new Error(`expected Uint8Array, got ${typeof r}`);return r}function kA(...r){const e=new Uint8Array(r.reduce((n,s)=>n+s.length,0));let t=0;return r.forEach(n=>{if(!m3(n))throw new Error("Uint8Array expected");e.set(n,t),t+=n.length}),e}let Rb=class{clone(){return this._cloneInto()}};const UA={}.toString;function x3(r,e){if(e!==void 0&&UA.call(e)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(r,e)}function Dd(r){const e=n=>r().update(Yc(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function $A(r=32){if(h0&&typeof h0.getRandomValues=="function")return h0.getRandomValues(new Uint8Array(r));throw new Error("crypto.getRandomValues must be defined")}class w3 extends Rb{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,b3(e);const n=Yc(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(n.length>s?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return Jc(this),this.iHash.update(e),this}digestInto(e){Jc(this),Db(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Rd=(r,e,t)=>new w3(r,e).update(t).digest();Rd.create=(r,e)=>new w3(r,e);function LA(r,e,t,n){b3(r);const s=x3({dkLen:32,asyncTick:10},n),{c:i,dkLen:o,asyncTick:a}=s;if(wr(i),wr(o),wr(a),i<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const c=Yc(e),l=Yc(t),u=new Uint8Array(o),f=Rd.create(r,c),h=f._cloneInto().update(l);return{c:i,dkLen:o,asyncTick:a,DK:u,PRF:f,PRFSalt:h}}function FA(r,e,t,n,s){return r.destroy(),e.destroy(),n&&n.destroy(),s.fill(0),t}function _b(r,e,t,n){const{c:s,dkLen:i,DK:o,PRF:a,PRFSalt:c}=LA(r,e,t,n);let l;const u=new Uint8Array(4),f=mh(u),h=new Uint8Array(a.outputLen);for(let d=1,p=0;p<i;d++,p+=a.outputLen){const g=o.subarray(p,p+a.outputLen);f.setInt32(0,d,!1),(l=c._cloneInto(l)).update(u).digestInto(h),g.set(h.subarray(0,g.length));for(let y=1;y<s;y++){a._cloneInto(l).update(h).digestInto(h);for(let x=0;x<g.length;x++)g[x]^=h[x]}}return FA(a,c,o,l,h)}function MA(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i),c=n?4:0,l=n?0:4;r.setUint32(e+c,o,n),r.setUint32(e+l,a,n)}class Bb extends Rb{constructor(e,t,n,s){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=mh(this.buffer)}update(e){Jc(this);const{view:t,buffer:n,blockLen:s}=this;e=Yc(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=mh(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Jc(this),y3(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let f=o;f<s;f++)t[f]=0;MA(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=mh(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let f=0;f<l;f++)a.setUint32(4*f,u[f],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%t&&e.buffer.set(n),e}}const jA=(r,e,t)=>r&e^~r&t,zA=(r,e,t)=>r&e^r&t^e&t,HA=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),qs=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Vs=new Uint32Array(64);class qA extends Bb{constructor(){super(64,32,8,!1),this.A=qs[0]|0,this.B=qs[1]|0,this.C=qs[2]|0,this.D=qs[3]|0,this.E=qs[4]|0,this.F=qs[5]|0,this.G=qs[6]|0,this.H=qs[7]|0}get(){const{A:e,B:t,C:n,D:s,E:i,F:o,G:a,H:c}=this;return[e,t,n,s,i,o,a,c]}set(e,t,n,s,i,o,a,c){this.A=e|0,this.B=t|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,t){for(let f=0;f<16;f++,t+=4)Vs[f]=e.getUint32(t,!1);for(let f=16;f<64;f++){const h=Vs[f-15],d=Vs[f-2],p=En(h,7)^En(h,18)^h>>>3,g=En(d,17)^En(d,19)^d>>>10;Vs[f]=g+Vs[f-7]+p+Vs[f-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let f=0;f<64;f++){const h=En(a,6)^En(a,11)^En(a,25),d=u+h+jA(a,c,l)+HA[f]+Vs[f]|0,g=(En(n,2)^En(n,13)^En(n,22))+zA(n,s,i)|0;u=l,l=c,c=a,a=o+d|0,o=i,i=s,s=n,n=d+g|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(n,s,i,o,a,c,l,u)}roundClean(){Vs.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const bl=Dd(()=>new qA),kf=BigInt(2**32-1),Hp=BigInt(32);function E3(r,e=!1){return e?{h:Number(r&kf),l:Number(r>>Hp&kf)}:{h:Number(r>>Hp&kf)|0,l:Number(r&kf)|0}}function v3(r,e=!1){let t=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let s=0;s<r.length;s++){const{h:i,l:o}=E3(r[s],e);[t[s],n[s]]=[i,o]}return[t,n]}const VA=(r,e)=>BigInt(r>>>0)<<Hp|BigInt(e>>>0),KA=(r,e,t)=>r>>>t,GA=(r,e,t)=>r<<32-t|e>>>t,WA=(r,e,t)=>r>>>t|e<<32-t,QA=(r,e,t)=>r<<32-t|e>>>t,JA=(r,e,t)=>r<<64-t|e>>>t-32,YA=(r,e,t)=>r>>>t-32|e<<64-t,ZA=(r,e)=>e,XA=(r,e)=>r,A3=(r,e,t)=>r<<t|e>>>32-t,I3=(r,e,t)=>e<<t|r>>>32-t,S3=(r,e,t)=>e<<t-32|r>>>64-t,O3=(r,e,t)=>r<<t-32|e>>>64-t;function e5(r,e,t,n){const s=(e>>>0)+(n>>>0);return{h:r+t+(s/2**32|0)|0,l:s|0}}const t5=(r,e,t)=>(r>>>0)+(e>>>0)+(t>>>0),r5=(r,e,t,n)=>e+t+n+(r/2**32|0)|0,n5=(r,e,t,n)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0),s5=(r,e,t,n,s)=>e+t+n+s+(r/2**32|0)|0,i5=(r,e,t,n,s)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0)+(s>>>0),o5=(r,e,t,n,s,i)=>e+t+n+s+i+(r/2**32|0)|0,le={fromBig:E3,split:v3,toBig:VA,shrSH:KA,shrSL:GA,rotrSH:WA,rotrSL:QA,rotrBH:JA,rotrBL:YA,rotr32H:ZA,rotr32L:XA,rotlSH:A3,rotlSL:I3,rotlBH:S3,rotlBL:O3,add:e5,add3L:t5,add3H:r5,add4L:n5,add4H:s5,add5H:o5,add5L:i5},[a5,c5]=le.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))),Ks=new Uint32Array(80),Gs=new Uint32Array(80);class l5 extends Bb{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:f,Fl:h,Gh:d,Gl:p,Hh:g,Hl:y}=this;return[e,t,n,s,i,o,a,c,l,u,f,h,d,p,g,y]}set(e,t,n,s,i,o,a,c,l,u,f,h,d,p,g,y){this.Ah=e|0,this.Al=t|0,this.Bh=n|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=f|0,this.Fl=h|0,this.Gh=d|0,this.Gl=p|0,this.Hh=g|0,this.Hl=y|0}process(e,t){for(let w=0;w<16;w++,t+=4)Ks[w]=e.getUint32(t),Gs[w]=e.getUint32(t+=4);for(let w=16;w<80;w++){const O=Ks[w-15]|0,I=Gs[w-15]|0,E=le.rotrSH(O,I,1)^le.rotrSH(O,I,8)^le.shrSH(O,I,7),P=le.rotrSL(O,I,1)^le.rotrSL(O,I,8)^le.shrSL(O,I,7),T=Ks[w-2]|0,D=Gs[w-2]|0,F=le.rotrSH(T,D,19)^le.rotrBH(T,D,61)^le.shrSH(T,D,6),j=le.rotrSL(T,D,19)^le.rotrBL(T,D,61)^le.shrSL(T,D,6),L=le.add4L(P,j,Gs[w-7],Gs[w-16]),U=le.add4H(L,E,F,Ks[w-7],Ks[w-16]);Ks[w]=U|0,Gs[w]=L|0}let{Ah:n,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:f,El:h,Fh:d,Fl:p,Gh:g,Gl:y,Hh:x,Hl:A}=this;for(let w=0;w<80;w++){const O=le.rotrSH(f,h,14)^le.rotrSH(f,h,18)^le.rotrBH(f,h,41),I=le.rotrSL(f,h,14)^le.rotrSL(f,h,18)^le.rotrBL(f,h,41),E=f&d^~f&g,P=h&p^~h&y,T=le.add5L(A,I,P,c5[w],Gs[w]),D=le.add5H(T,x,O,E,a5[w],Ks[w]),F=T|0,j=le.rotrSH(n,s,28)^le.rotrBH(n,s,34)^le.rotrBH(n,s,39),L=le.rotrSL(n,s,28)^le.rotrBL(n,s,34)^le.rotrBL(n,s,39),U=n&i^n&a^i&a,_=s&o^s&c^o&c;x=g|0,A=y|0,g=d|0,y=p|0,d=f|0,p=h|0,{h:f,l:h}=le.add(l|0,u|0,D|0,F|0),l=a|0,u=c|0,a=i|0,c=o|0,i=n|0,o=s|0;const m=le.add3L(F,L,_);n=le.add3H(m,D,j,U),s=m|0}({h:n,l:s}=le.add(this.Ah|0,this.Al|0,n|0,s|0)),{h:i,l:o}=le.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=le.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=le.add(this.Dh|0,this.Dl|0,l|0,u|0),{h:f,l:h}=le.add(this.Eh|0,this.El|0,f|0,h|0),{h:d,l:p}=le.add(this.Fh|0,this.Fl|0,d|0,p|0),{h:g,l:y}=le.add(this.Gh|0,this.Gl|0,g|0,y|0),{h:x,l:A}=le.add(this.Hh|0,this.Hl|0,x|0,A|0),this.set(n,s,i,o,a,c,l,u,f,h,d,p,g,y,x,A)}roundClean(){Ks.fill(0),Gs.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const kb=Dd(()=>new l5);function u5(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}const vm=u5(),Am=vm.crypto||vm.msCrypto;function P3(r){switch(r){case"sha256":return bl.create();case"sha512":return kb.create()}C(!1,"invalid hashing algorithm name","algorithm",r)}function f5(r,e){const t={sha256:bl,sha512:kb}[r];return C(t!=null,"invalid hmac algorithm","algorithm",r),Rd.create(t,e)}function h5(r,e,t,n,s){const i={sha256:bl,sha512:kb}[s];return C(i!=null,"invalid pbkdf2 algorithm","algorithm",s),_b(i,r,e,{c:t,dkLen:n})}function d5(r){z(Am!=null,"platform does not support secure random numbers","UNSUPPORTED_OPERATION",{operation:"randomBytes"}),C(Number.isInteger(r)&&r>0&&r<=1024,"invalid length","length",r);const e=new Uint8Array(r);return Am.getRandomValues(e),e}let C3=!1;const T3=function(r,e,t){return f5(r,e).update(t).digest()};let N3=T3;function zi(r,e,t){const n=Q(e,"key"),s=Q(t,"data");return K(N3(r,n,s))}zi._=T3;zi.lock=function(){C3=!0};zi.register=function(r){if(C3)throw new Error("computeHmac is locked");N3=r};Object.freeze(zi);const[D3,R3,_3]=[[],[],[]],p5=BigInt(0),Pl=BigInt(1),g5=BigInt(2),b5=BigInt(7),y5=BigInt(256),m5=BigInt(113);for(let r=0,e=Pl,t=1,n=0;r<24;r++){[t,n]=[n,(2*t+3*n)%5],D3.push(2*(5*n+t)),R3.push((r+1)*(r+2)/2%64);let s=p5;for(let i=0;i<7;i++)e=(e<<Pl^(e>>b5)*m5)%y5,e&g5&&(s^=Pl<<(Pl<<BigInt(i))-Pl);_3.push(s)}const[x5,w5]=v3(_3,!0),Im=(r,e,t)=>t>32?S3(r,e,t):A3(r,e,t),Sm=(r,e,t)=>t>32?O3(r,e,t):I3(r,e,t);function E5(r,e=24){const t=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)t[o]=r[o]^r[o+10]^r[o+20]^r[o+30]^r[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=t[c],u=t[c+1],f=Im(l,u,1)^t[a],h=Sm(l,u,1)^t[a+1];for(let d=0;d<50;d+=10)r[o+d]^=f,r[o+d+1]^=h}let s=r[2],i=r[3];for(let o=0;o<24;o++){const a=R3[o],c=Im(s,i,a),l=Sm(s,i,a),u=D3[o];s=r[u],i=r[u+1],r[u]=c,r[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=r[o+a];for(let a=0;a<10;a++)r[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}r[0]^=x5[n],r[1]^=w5[n]}t.fill(0)}let v5=class B3 extends Rb{constructor(e,t,n,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,wr(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=yh(this.state)}keccak(){E5(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){Jc(this);const{blockLen:t,state:n}=this;e=Yc(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(t-this.pos,s-i);for(let a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:s}=this;e[n]^=t,(t&128)!==0&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Jc(this,!1),Db(e),this.finish();const t=this.state,{blockLen:n}=this;for(let s=0,i=e.length;s<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-s);e.set(t.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return wr(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(y3(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new B3(t,n,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const A5=(r,e,t)=>Dd(()=>new v5(e,r,t)),I5=A5(1,136,256/8);let k3=!1;const U3=function(r){return I5(r)};let $3=U3;function Ne(r){const e=Q(r,"data");return K($3(e))}Ne._=U3;Ne.lock=function(){k3=!0};Ne.register=function(r){if(k3)throw new TypeError("keccak256 is locked");$3=r};Object.freeze(Ne);const S5=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),L3=Uint8Array.from({length:16},(r,e)=>e),O5=L3.map(r=>(9*r+5)%16);let Ub=[L3],$b=[O5];for(let r=0;r<4;r++)for(let e of[Ub,$b])e.push(e[r].map(t=>S5[t]));const F3=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(r=>new Uint8Array(r)),P5=Ub.map((r,e)=>r.map(t=>F3[e][t])),C5=$b.map((r,e)=>r.map(t=>F3[e][t])),T5=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),N5=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]),Uf=(r,e)=>r<<e|r>>>32-e;function Om(r,e,t,n){return r===0?e^t^n:r===1?e&t|~e&n:r===2?(e|~t)^n:r===3?e&n|t&~n:e^(t|~n)}const $f=new Uint32Array(16);class D5 extends Bb{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:e,h1:t,h2:n,h3:s,h4:i}=this;return[e,t,n,s,i]}set(e,t,n,s,i){this.h0=e|0,this.h1=t|0,this.h2=n|0,this.h3=s|0,this.h4=i|0}process(e,t){for(let d=0;d<16;d++,t+=4)$f[d]=e.getUint32(t,!0);let n=this.h0|0,s=n,i=this.h1|0,o=i,a=this.h2|0,c=a,l=this.h3|0,u=l,f=this.h4|0,h=f;for(let d=0;d<5;d++){const p=4-d,g=T5[d],y=N5[d],x=Ub[d],A=$b[d],w=P5[d],O=C5[d];for(let I=0;I<16;I++){const E=Uf(n+Om(d,i,a,l)+$f[x[I]]+g,w[I])+f|0;n=f,f=l,l=Uf(a,10)|0,a=i,i=E}for(let I=0;I<16;I++){const E=Uf(s+Om(p,o,c,u)+$f[A[I]]+y,O[I])+h|0;s=h,h=u,u=Uf(c,10)|0,c=o,o=E}}this.set(this.h1+a+u|0,this.h2+l+h|0,this.h3+f+s|0,this.h4+n+o|0,this.h0+i+c|0)}roundClean(){$f.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}}const R5=Dd(()=>new D5);let M3=!1;const j3=function(r){return R5(r)};let z3=j3;function Hi(r){const e=Q(r,"data");return K(z3(e))}Hi._=j3;Hi.lock=function(){M3=!0};Hi.register=function(r){if(M3)throw new TypeError("ripemd160 is locked");z3=r};Object.freeze(Hi);let H3=!1;const q3=function(r,e,t,n,s){return h5(r,e,t,n,s)};let V3=q3;function rs(r,e,t,n,s){const i=Q(r,"password"),o=Q(e,"salt");return K(V3(i,o,t,n,s))}rs._=q3;rs.lock=function(){H3=!0};rs.register=function(r){if(H3)throw new Error("pbkdf2 is locked");V3=r};Object.freeze(rs);let K3=!1;const G3=function(r){return new Uint8Array(d5(r))};let W3=G3;function qr(r){return W3(r)}qr._=G3;qr.lock=function(){K3=!0};qr.register=function(r){if(K3)throw new Error("randomBytes is locked");W3=r};Object.freeze(qr);const xe=(r,e)=>r<<e|r>>>32-e;function Pm(r,e,t,n,s,i){let o=r[e++]^t[n++],a=r[e++]^t[n++],c=r[e++]^t[n++],l=r[e++]^t[n++],u=r[e++]^t[n++],f=r[e++]^t[n++],h=r[e++]^t[n++],d=r[e++]^t[n++],p=r[e++]^t[n++],g=r[e++]^t[n++],y=r[e++]^t[n++],x=r[e++]^t[n++],A=r[e++]^t[n++],w=r[e++]^t[n++],O=r[e++]^t[n++],I=r[e++]^t[n++],E=o,P=a,T=c,D=l,F=u,j=f,L=h,U=d,_=p,m=g,v=y,N=x,$=A,R=w,B=O,H=I;for(let V=0;V<8;V+=2)F^=xe(E+$|0,7),_^=xe(F+E|0,9),$^=xe(_+F|0,13),E^=xe($+_|0,18),m^=xe(j+P|0,7),R^=xe(m+j|0,9),P^=xe(R+m|0,13),j^=xe(P+R|0,18),B^=xe(v+L|0,7),T^=xe(B+v|0,9),L^=xe(T+B|0,13),v^=xe(L+T|0,18),D^=xe(H+N|0,7),U^=xe(D+H|0,9),N^=xe(U+D|0,13),H^=xe(N+U|0,18),P^=xe(E+D|0,7),T^=xe(P+E|0,9),D^=xe(T+P|0,13),E^=xe(D+T|0,18),L^=xe(j+F|0,7),U^=xe(L+j|0,9),F^=xe(U+L|0,13),j^=xe(F+U|0,18),N^=xe(v+m|0,7),_^=xe(N+v|0,9),m^=xe(_+N|0,13),v^=xe(m+_|0,18),$^=xe(H+B|0,7),R^=xe($+H|0,9),B^=xe(R+$|0,13),H^=xe(B+R|0,18);s[i++]=o+E|0,s[i++]=a+P|0,s[i++]=c+T|0,s[i++]=l+D|0,s[i++]=u+F|0,s[i++]=f+j|0,s[i++]=h+L|0,s[i++]=d+U|0,s[i++]=p+_|0,s[i++]=g+m|0,s[i++]=y+v|0,s[i++]=x+N|0,s[i++]=A+$|0,s[i++]=w+R|0,s[i++]=O+B|0,s[i++]=I+H|0}function Wa(r,e,t,n,s){let i=n+0,o=n+16*s;for(let a=0;a<16;a++)t[o+a]=r[e+(2*s-1)*16+a];for(let a=0;a<s;a++,i+=16,e+=16)Pm(t,o,r,e,t,i),a>0&&(o+=16),Pm(t,i,r,e+=16,t,o)}function Q3(r,e,t){const n=x3({dkLen:32,asyncTick:10,maxmem:1073742848},t),{N:s,r:i,p:o,dkLen:a,asyncTick:c,maxmem:l,onProgress:u}=n;if(wr(s),wr(i),wr(o),wr(a),wr(c),wr(l),u!==void 0&&typeof u!="function")throw new Error("progressCb should be function");const f=128*i,h=f/4;if(s<=1||(s&s-1)!==0||s>=2**(f/8)||s>2**32)throw new Error("Scrypt: N must be larger than 1, a power of 2, less than 2^(128 * r / 8) and less than 2^32");if(o<0||o>(2**32-1)*32/f)throw new Error("Scrypt: p must be a positive integer less than or equal to ((2^32 - 1) * 32) / (128 * r)");if(a<0||a>(2**32-1)*32)throw new Error("Scrypt: dkLen should be positive integer less than or equal to (2^32 - 1) * 32");const d=f*(s+o);if(d>l)throw new Error(`Scrypt: parameters too large, ${d} (128 * r * (N + p)) > ${l} (maxmem)`);const p=_b(bl,r,e,{c:1,dkLen:f*o}),g=yh(p),y=yh(new Uint8Array(f*s)),x=yh(new Uint8Array(f));let A=()=>{};if(u){const w=2*s*o,O=Math.max(Math.floor(w/1e4),1);let I=0;A=()=>{I++,u&&(!(I%O)||I===w)&&u(I/w)}}return{N:s,r:i,p:o,dkLen:a,blockSize32:h,V:y,B32:g,B:p,tmp:x,blockMixCb:A,asyncTick:c}}function J3(r,e,t,n,s){const i=_b(bl,r,t,{c:1,dkLen:e});return t.fill(0),n.fill(0),s.fill(0),i}function _5(r,e,t){const{N:n,r:s,p:i,dkLen:o,blockSize32:a,V:c,B32:l,B:u,tmp:f,blockMixCb:h}=Q3(r,e,t);for(let d=0;d<i;d++){const p=a*d;for(let g=0;g<a;g++)c[g]=l[p+g];for(let g=0,y=0;g<n-1;g++)Wa(c,y,c,y+=a,s),h();Wa(c,(n-1)*a,l,p,s),h();for(let g=0;g<n;g++){const y=l[p+a-16]%n;for(let x=0;x<a;x++)f[x]=l[p+x]^c[y*a+x];Wa(f,0,l,p,s),h()}}return J3(r,o,u,c,f)}async function B5(r,e,t){const{N:n,r:s,p:i,dkLen:o,blockSize32:a,V:c,B32:l,B:u,tmp:f,blockMixCb:h,asyncTick:d}=Q3(r,e,t);for(let p=0;p<i;p++){const g=a*p;for(let x=0;x<a;x++)c[x]=l[g+x];let y=0;await Em(n-1,d,()=>{Wa(c,y,c,y+=a,s),h()}),Wa(c,(n-1)*a,l,g,s),h(),await Em(n,d,()=>{const x=l[g+a-16]%n;for(let A=0;A<a;A++)f[A]=l[g+A]^c[x*a+A];Wa(f,0,l,g,s),h()})}return J3(r,o,u,c,f)}let Y3=!1,Z3=!1;const X3=async function(r,e,t,n,s,i,o){return await B5(r,e,{N:t,r:n,p:s,dkLen:i,onProgress:o})},e8=function(r,e,t,n,s,i){return _5(r,e,{N:t,r:n,p:s,dkLen:i})};let t8=X3,r8=e8;async function qi(r,e,t,n,s,i,o){const a=Q(r,"passwd"),c=Q(e,"salt");return K(await t8(a,c,t,n,s,i,o))}qi._=X3;qi.lock=function(){Z3=!0};qi.register=function(r){if(Z3)throw new Error("scrypt is locked");t8=r};Object.freeze(qi);function Vi(r,e,t,n,s,i){const o=Q(r,"passwd"),a=Q(e,"salt");return K(r8(o,a,t,n,s,i))}Vi._=e8;Vi.lock=function(){Y3=!0};Vi.register=function(r){if(Y3)throw new Error("scryptSync is locked");r8=r};Object.freeze(Vi);const n8=function(r){return P3("sha256").update(r).digest()},s8=function(r){return P3("sha512").update(r).digest()};let i8=n8,o8=s8,a8=!1,c8=!1;function Vt(r){const e=Q(r,"data");return K(i8(e))}Vt._=n8;Vt.lock=function(){a8=!0};Vt.register=function(r){if(a8)throw new Error("sha256 is locked");i8=r};Object.freeze(Vt);function cf(r){const e=Q(r,"data");return K(o8(e))}cf._=s8;cf.lock=function(){c8=!0};cf.register=function(r){if(c8)throw new Error("sha512 is locked");o8=r};Object.freeze(Vt);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const l8=BigInt(0),_d=BigInt(1),k5=BigInt(2),Bd=r=>r instanceof Uint8Array,U5=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function Zc(r){if(!Bd(r))throw new Error("Uint8Array expected");let e="";for(let t=0;t<r.length;t++)e+=U5[r[t]];return e}function u8(r){const e=r.toString(16);return e.length&1?`0${e}`:e}function Lb(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return BigInt(r===""?"0":`0x${r}`)}function Xc(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);const e=r.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const t=new Uint8Array(e/2);for(let n=0;n<t.length;n++){const s=n*2,i=r.slice(s,s+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");t[n]=o}return t}function Zo(r){return Lb(Zc(r))}function Fb(r){if(!Bd(r))throw new Error("Uint8Array expected");return Lb(Zc(Uint8Array.from(r).reverse()))}function el(r,e){return Xc(r.toString(16).padStart(e*2,"0"))}function Mb(r,e){return el(r,e).reverse()}function $5(r){return Xc(u8(r))}function rn(r,e,t){let n;if(typeof e=="string")try{n=Xc(e)}catch(i){throw new Error(`${r} must be valid hex string, got "${e}". Cause: ${i}`)}else if(Bd(e))n=Uint8Array.from(e);else throw new Error(`${r} must be hex string or Uint8Array`);const s=n.length;if(typeof t=="number"&&s!==t)throw new Error(`${r} expected ${t} bytes, got ${s}`);return n}function yu(...r){const e=new Uint8Array(r.reduce((n,s)=>n+s.length,0));let t=0;return r.forEach(n=>{if(!Bd(n))throw new Error("Uint8Array expected");e.set(n,t),t+=n.length}),e}function L5(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0}function F5(r){if(typeof r!="string")throw new Error(`utf8ToBytes expected string, got ${typeof r}`);return new Uint8Array(new TextEncoder().encode(r))}function M5(r){let e;for(e=0;r>l8;r>>=_d,e+=1);return e}function j5(r,e){return r>>BigInt(e)&_d}const z5=(r,e,t)=>r|(t?_d:l8)<<BigInt(e),jb=r=>(k5<<BigInt(r-1))-_d,d0=r=>new Uint8Array(r),Cm=r=>Uint8Array.from(r);function f8(r,e,t){if(typeof r!="number"||r<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let n=d0(r),s=d0(r),i=0;const o=()=>{n.fill(1),s.fill(0),i=0},a=(...f)=>t(s,n,...f),c=(f=d0())=>{s=a(Cm([0]),f),n=a(),f.length!==0&&(s=a(Cm([1]),f),n=a())},l=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let f=0;const h=[];for(;f<e;){n=a();const d=n.slice();h.push(d),f+=n.length}return yu(...h)};return(f,h)=>{o(),c(f);let d;for(;!(d=h(l()));)c();return o(),d}}const H5={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||r instanceof Uint8Array,isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,e)=>e.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function lf(r,e,t={}){const n=(s,i,o)=>{const a=H5[i];if(typeof a!="function")throw new Error(`Invalid validator "${i}", expected function`);const c=r[s];if(!(o&&c===void 0)&&!a(c,r))throw new Error(`Invalid param ${String(s)}=${c} (${typeof c}), expected ${i}`)};for(const[s,i]of Object.entries(e))n(s,i,!1);for(const[s,i]of Object.entries(t))n(s,i,!0);return r}const q5=Object.freeze(Object.defineProperty({__proto__:null,bitGet:j5,bitLen:M5,bitMask:jb,bitSet:z5,bytesToHex:Zc,bytesToNumberBE:Zo,bytesToNumberLE:Fb,concatBytes:yu,createHmacDrbg:f8,ensureBytes:rn,equalBytes:L5,hexToBytes:Xc,hexToNumber:Lb,numberToBytesBE:el,numberToBytesLE:Mb,numberToHexUnpadded:u8,numberToVarBytesBE:$5,utf8ToBytes:F5,validateObject:lf},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ft=BigInt(0),Ge=BigInt(1),lo=BigInt(2),V5=BigInt(3),qp=BigInt(4),Tm=BigInt(5),Nm=BigInt(8);BigInt(9);BigInt(16);function er(r,e){const t=r%e;return t>=ft?t:e+t}function K5(r,e,t){if(t<=ft||e<ft)throw new Error("Expected power/modulo > 0");if(t===Ge)return ft;let n=Ge;for(;e>ft;)e&Ge&&(n=n*r%t),r=r*r%t,e>>=Ge;return n}function Ir(r,e,t){let n=r;for(;e-- >ft;)n*=n,n%=t;return n}function Vp(r,e){if(r===ft||e<=ft)throw new Error(`invert: expected positive integers, got n=${r} mod=${e}`);let t=er(r,e),n=e,s=ft,i=Ge;for(;t!==ft;){const a=n/t,c=n%t,l=s-i*a;n=t,t=c,s=i,i=l}if(n!==Ge)throw new Error("invert: does not exist");return er(s,e)}function G5(r){const e=(r-Ge)/lo;let t,n,s;for(t=r-Ge,n=0;t%lo===ft;t/=lo,n++);for(s=lo;s<r&&K5(s,e,r)!==r-Ge;s++);if(n===1){const o=(r+Ge)/qp;return function(c,l){const u=c.pow(l,o);if(!c.eql(c.sqr(u),l))throw new Error("Cannot find square root");return u}}const i=(t+Ge)/lo;return function(a,c){if(a.pow(c,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let l=n,u=a.pow(a.mul(a.ONE,s),t),f=a.pow(c,i),h=a.pow(c,t);for(;!a.eql(h,a.ONE);){if(a.eql(h,a.ZERO))return a.ZERO;let d=1;for(let g=a.sqr(h);d<l&&!a.eql(g,a.ONE);d++)g=a.sqr(g);const p=a.pow(u,Ge<<BigInt(l-d-1));u=a.sqr(p),f=a.mul(f,p),h=a.mul(h,u),l=d}return f}}function W5(r){if(r%qp===V5){const e=(r+Ge)/qp;return function(n,s){const i=n.pow(s,e);if(!n.eql(n.sqr(i),s))throw new Error("Cannot find square root");return i}}if(r%Nm===Tm){const e=(r-Tm)/Nm;return function(n,s){const i=n.mul(s,lo),o=n.pow(i,e),a=n.mul(s,o),c=n.mul(n.mul(a,lo),o),l=n.mul(a,n.sub(c,n.ONE));if(!n.eql(n.sqr(l),s))throw new Error("Cannot find square root");return l}}return G5(r)}const Q5=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function J5(r){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=Q5.reduce((n,s)=>(n[s]="function",n),e);return lf(r,t)}function Y5(r,e,t){if(t<ft)throw new Error("Expected power > 0");if(t===ft)return r.ONE;if(t===Ge)return e;let n=r.ONE,s=e;for(;t>ft;)t&Ge&&(n=r.mul(n,s)),s=r.sqr(s),t>>=Ge;return n}function Z5(r,e){const t=new Array(e.length),n=e.reduce((i,o,a)=>r.is0(o)?i:(t[a]=i,r.mul(i,o)),r.ONE),s=r.inv(n);return e.reduceRight((i,o,a)=>r.is0(o)?i:(t[a]=r.mul(i,t[a]),r.mul(i,o)),s),t}function h8(r,e){const t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function X5(r,e,t=!1,n={}){if(r<=ft)throw new Error(`Expected Field ORDER > 0, got ${r}`);const{nBitLength:s,nByteLength:i}=h8(r,e);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const o=W5(r),a=Object.freeze({ORDER:r,BITS:s,BYTES:i,MASK:jb(s),ZERO:ft,ONE:Ge,create:c=>er(c,r),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return ft<=c&&c<r},is0:c=>c===ft,isOdd:c=>(c&Ge)===Ge,neg:c=>er(-c,r),eql:(c,l)=>c===l,sqr:c=>er(c*c,r),add:(c,l)=>er(c+l,r),sub:(c,l)=>er(c-l,r),mul:(c,l)=>er(c*l,r),pow:(c,l)=>Y5(a,c,l),div:(c,l)=>er(c*Vp(l,r),r),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>Vp(c,r),sqrt:n.sqrt||(c=>o(a,c)),invertBatch:c=>Z5(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>t?Mb(c,i):el(c,i),fromBytes:c=>{if(c.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${c.length}`);return t?Fb(c):Zo(c)}});return Object.freeze(a)}function d8(r){if(typeof r!="bigint")throw new Error("field order must be bigint");const e=r.toString(2).length;return Math.ceil(e/8)}function p8(r){const e=d8(r);return e+Math.ceil(e/2)}function e9(r,e,t=!1){const n=r.length,s=d8(e),i=p8(e);if(n<16||n<i||n>1024)throw new Error(`expected ${i}-1024 bytes of input, got ${n}`);const o=t?Zo(r):Fb(r),a=er(o,e-Ge)+Ge;return t?Mb(a,s):el(a,s)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const t9=BigInt(0),p0=BigInt(1);function r9(r,e){const t=(s,i)=>{const o=i.negate();return s?o:i},n=s=>{const i=Math.ceil(e/s)+1,o=2**(s-1);return{windows:i,windowSize:o}};return{constTimeNegate:t,unsafeLadder(s,i){let o=r.ZERO,a=s;for(;i>t9;)i&p0&&(o=o.add(a)),a=a.double(),i>>=p0;return o},precomputeWindow(s,i){const{windows:o,windowSize:a}=n(i),c=[];let l=s,u=l;for(let f=0;f<o;f++){u=l,c.push(u);for(let h=1;h<a;h++)u=u.add(l),c.push(u);l=u.double()}return c},wNAF(s,i,o){const{windows:a,windowSize:c}=n(s);let l=r.ZERO,u=r.BASE;const f=BigInt(2**s-1),h=2**s,d=BigInt(s);for(let p=0;p<a;p++){const g=p*c;let y=Number(o&f);o>>=d,y>c&&(y-=h,o+=p0);const x=g,A=g+Math.abs(y)-1,w=p%2!==0,O=y<0;y===0?u=u.add(t(w,i[x])):l=l.add(t(O,i[A]))}return{p:l,f:u}},wNAFCached(s,i,o,a){const c=s._WINDOW_SIZE||1;let l=i.get(s);return l||(l=this.precomputeWindow(s,c),c!==1&&i.set(s,a(l))),this.wNAF(c,l,o)}}}function g8(r){return J5(r.Fp),lf(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...h8(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function n9(r){const e=g8(r);lf(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:t,Fp:n,a:s}=e;if(t){if(!n.eql(s,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:s9,hexToBytes:i9}=q5,mo={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(r){const{Err:e}=mo;if(r.length<2||r[0]!==2)throw new e("Invalid signature integer tag");const t=r[1],n=r.subarray(2,t+2);if(!t||n.length!==t)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:s9(n),l:r.subarray(t+2)}},toSig(r){const{Err:e}=mo,t=typeof r=="string"?i9(r):r;if(!(t instanceof Uint8Array))throw new Error("ui8a expected");let n=t.length;if(n<2||t[0]!=48)throw new e("Invalid signature tag");if(t[1]!==n-2)throw new e("Invalid signature: incorrect length");const{d:s,l:i}=mo._parseInt(t.subarray(2)),{d:o,l:a}=mo._parseInt(i);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:s,s:o}},hexFromSig(r){const e=l=>Number.parseInt(l[0],16)&8?"00"+l:l,t=l=>{const u=l.toString(16);return u.length&1?`0${u}`:u},n=e(t(r.s)),s=e(t(r.r)),i=n.length/2,o=s.length/2,a=t(i),c=t(o);return`30${t(o+i+4)}02${c}${s}02${a}${n}`}},Ts=BigInt(0),Fr=BigInt(1);BigInt(2);const Dm=BigInt(3);BigInt(4);function o9(r){const e=n9(r),{Fp:t}=e,n=e.toBytes||((p,g,y)=>{const x=g.toAffine();return yu(Uint8Array.from([4]),t.toBytes(x.x),t.toBytes(x.y))}),s=e.fromBytes||(p=>{const g=p.subarray(1),y=t.fromBytes(g.subarray(0,t.BYTES)),x=t.fromBytes(g.subarray(t.BYTES,2*t.BYTES));return{x:y,y:x}});function i(p){const{a:g,b:y}=e,x=t.sqr(p),A=t.mul(x,p);return t.add(t.add(A,t.mul(p,g)),y)}if(!t.eql(t.sqr(e.Gy),i(e.Gx)))throw new Error("bad generator point: equation left != right");function o(p){return typeof p=="bigint"&&Ts<p&&p<e.n}function a(p){if(!o(p))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(p){const{allowedPrivateKeyLengths:g,nByteLength:y,wrapPrivateKey:x,n:A}=e;if(g&&typeof p!="bigint"){if(p instanceof Uint8Array&&(p=Zc(p)),typeof p!="string"||!g.includes(p.length))throw new Error("Invalid key");p=p.padStart(y*2,"0")}let w;try{w=typeof p=="bigint"?p:Zo(rn("private key",p,y))}catch{throw new Error(`private key must be ${y} bytes, hex or bigint, not ${typeof p}`)}return x&&(w=er(w,A)),a(w),w}const l=new Map;function u(p){if(!(p instanceof f))throw new Error("ProjectivePoint expected")}class f{constructor(g,y,x){if(this.px=g,this.py=y,this.pz=x,g==null||!t.isValid(g))throw new Error("x required");if(y==null||!t.isValid(y))throw new Error("y required");if(x==null||!t.isValid(x))throw new Error("z required")}static fromAffine(g){const{x:y,y:x}=g||{};if(!g||!t.isValid(y)||!t.isValid(x))throw new Error("invalid affine point");if(g instanceof f)throw new Error("projective point not allowed");const A=w=>t.eql(w,t.ZERO);return A(y)&&A(x)?f.ZERO:new f(y,x,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(g){const y=t.invertBatch(g.map(x=>x.pz));return g.map((x,A)=>x.toAffine(y[A])).map(f.fromAffine)}static fromHex(g){const y=f.fromAffine(s(rn("pointHex",g)));return y.assertValidity(),y}static fromPrivateKey(g){return f.BASE.multiply(c(g))}_setWindowSize(g){this._WINDOW_SIZE=g,l.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!t.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:g,y}=this.toAffine();if(!t.isValid(g)||!t.isValid(y))throw new Error("bad point: x or y not FE");const x=t.sqr(y),A=i(g);if(!t.eql(x,A))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:g}=this.toAffine();if(t.isOdd)return!t.isOdd(g);throw new Error("Field doesn't support isOdd")}equals(g){u(g);const{px:y,py:x,pz:A}=this,{px:w,py:O,pz:I}=g,E=t.eql(t.mul(y,I),t.mul(w,A)),P=t.eql(t.mul(x,I),t.mul(O,A));return E&&P}negate(){return new f(this.px,t.neg(this.py),this.pz)}double(){const{a:g,b:y}=e,x=t.mul(y,Dm),{px:A,py:w,pz:O}=this;let I=t.ZERO,E=t.ZERO,P=t.ZERO,T=t.mul(A,A),D=t.mul(w,w),F=t.mul(O,O),j=t.mul(A,w);return j=t.add(j,j),P=t.mul(A,O),P=t.add(P,P),I=t.mul(g,P),E=t.mul(x,F),E=t.add(I,E),I=t.sub(D,E),E=t.add(D,E),E=t.mul(I,E),I=t.mul(j,I),P=t.mul(x,P),F=t.mul(g,F),j=t.sub(T,F),j=t.mul(g,j),j=t.add(j,P),P=t.add(T,T),T=t.add(P,T),T=t.add(T,F),T=t.mul(T,j),E=t.add(E,T),F=t.mul(w,O),F=t.add(F,F),T=t.mul(F,j),I=t.sub(I,T),P=t.mul(F,D),P=t.add(P,P),P=t.add(P,P),new f(I,E,P)}add(g){u(g);const{px:y,py:x,pz:A}=this,{px:w,py:O,pz:I}=g;let E=t.ZERO,P=t.ZERO,T=t.ZERO;const D=e.a,F=t.mul(e.b,Dm);let j=t.mul(y,w),L=t.mul(x,O),U=t.mul(A,I),_=t.add(y,x),m=t.add(w,O);_=t.mul(_,m),m=t.add(j,L),_=t.sub(_,m),m=t.add(y,A);let v=t.add(w,I);return m=t.mul(m,v),v=t.add(j,U),m=t.sub(m,v),v=t.add(x,A),E=t.add(O,I),v=t.mul(v,E),E=t.add(L,U),v=t.sub(v,E),T=t.mul(D,m),E=t.mul(F,U),T=t.add(E,T),E=t.sub(L,T),T=t.add(L,T),P=t.mul(E,T),L=t.add(j,j),L=t.add(L,j),U=t.mul(D,U),m=t.mul(F,m),L=t.add(L,U),U=t.sub(j,U),U=t.mul(D,U),m=t.add(m,U),j=t.mul(L,m),P=t.add(P,j),j=t.mul(v,m),E=t.mul(_,E),E=t.sub(E,j),j=t.mul(_,L),T=t.mul(v,T),T=t.add(T,j),new f(E,P,T)}subtract(g){return this.add(g.negate())}is0(){return this.equals(f.ZERO)}wNAF(g){return d.wNAFCached(this,l,g,y=>{const x=t.invertBatch(y.map(A=>A.pz));return y.map((A,w)=>A.toAffine(x[w])).map(f.fromAffine)})}multiplyUnsafe(g){const y=f.ZERO;if(g===Ts)return y;if(a(g),g===Fr)return this;const{endo:x}=e;if(!x)return d.unsafeLadder(this,g);let{k1neg:A,k1:w,k2neg:O,k2:I}=x.splitScalar(g),E=y,P=y,T=this;for(;w>Ts||I>Ts;)w&Fr&&(E=E.add(T)),I&Fr&&(P=P.add(T)),T=T.double(),w>>=Fr,I>>=Fr;return A&&(E=E.negate()),O&&(P=P.negate()),P=new f(t.mul(P.px,x.beta),P.py,P.pz),E.add(P)}multiply(g){a(g);let y=g,x,A;const{endo:w}=e;if(w){const{k1neg:O,k1:I,k2neg:E,k2:P}=w.splitScalar(y);let{p:T,f:D}=this.wNAF(I),{p:F,f:j}=this.wNAF(P);T=d.constTimeNegate(O,T),F=d.constTimeNegate(E,F),F=new f(t.mul(F.px,w.beta),F.py,F.pz),x=T.add(F),A=D.add(j)}else{const{p:O,f:I}=this.wNAF(y);x=O,A=I}return f.normalizeZ([x,A])[0]}multiplyAndAddUnsafe(g,y,x){const A=f.BASE,w=(I,E)=>E===Ts||E===Fr||!I.equals(A)?I.multiplyUnsafe(E):I.multiply(E),O=w(this,y).add(w(g,x));return O.is0()?void 0:O}toAffine(g){const{px:y,py:x,pz:A}=this,w=this.is0();g==null&&(g=w?t.ONE:t.inv(A));const O=t.mul(y,g),I=t.mul(x,g),E=t.mul(A,g);if(w)return{x:t.ZERO,y:t.ZERO};if(!t.eql(E,t.ONE))throw new Error("invZ was invalid");return{x:O,y:I}}isTorsionFree(){const{h:g,isTorsionFree:y}=e;if(g===Fr)return!0;if(y)return y(f,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:g,clearCofactor:y}=e;return g===Fr?this:y?y(f,this):this.multiplyUnsafe(e.h)}toRawBytes(g=!0){return this.assertValidity(),n(f,this,g)}toHex(g=!0){return Zc(this.toRawBytes(g))}}f.BASE=new f(e.Gx,e.Gy,t.ONE),f.ZERO=new f(t.ZERO,t.ONE,t.ZERO);const h=e.nBitLength,d=r9(f,e.endo?Math.ceil(h/2):h);return{CURVE:e,ProjectivePoint:f,normPrivateKeyToScalar:c,weierstrassEquation:i,isWithinCurveOrder:o}}function a9(r){const e=g8(r);return lf(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function c9(r){const e=a9(r),{Fp:t,n}=e,s=t.BYTES+1,i=2*t.BYTES+1;function o(m){return Ts<m&&m<t.ORDER}function a(m){return er(m,n)}function c(m){return Vp(m,n)}const{ProjectivePoint:l,normPrivateKeyToScalar:u,weierstrassEquation:f,isWithinCurveOrder:h}=o9({...e,toBytes(m,v,N){const $=v.toAffine(),R=t.toBytes($.x),B=yu;return N?B(Uint8Array.from([v.hasEvenY()?2:3]),R):B(Uint8Array.from([4]),R,t.toBytes($.y))},fromBytes(m){const v=m.length,N=m[0],$=m.subarray(1);if(v===s&&(N===2||N===3)){const R=Zo($);if(!o(R))throw new Error("Point is not on curve");const B=f(R);let H=t.sqrt(B);const V=(H&Fr)===Fr;return(N&1)===1!==V&&(H=t.neg(H)),{x:R,y:H}}else if(v===i&&N===4){const R=t.fromBytes($.subarray(0,t.BYTES)),B=t.fromBytes($.subarray(t.BYTES,2*t.BYTES));return{x:R,y:B}}else throw new Error(`Point of length ${v} was invalid. Expected ${s} compressed bytes or ${i} uncompressed bytes`)}}),d=m=>Zc(el(m,e.nByteLength));function p(m){const v=n>>Fr;return m>v}function g(m){return p(m)?a(-m):m}const y=(m,v,N)=>Zo(m.slice(v,N));class x{constructor(v,N,$){this.r=v,this.s=N,this.recovery=$,this.assertValidity()}static fromCompact(v){const N=e.nByteLength;return v=rn("compactSignature",v,N*2),new x(y(v,0,N),y(v,N,2*N))}static fromDER(v){const{r:N,s:$}=mo.toSig(rn("DER",v));return new x(N,$)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(v){return new x(this.r,this.s,v)}recoverPublicKey(v){const{r:N,s:$,recovery:R}=this,B=P(rn("msgHash",v));if(R==null||![0,1,2,3].includes(R))throw new Error("recovery id invalid");const H=R===2||R===3?N+e.n:N;if(H>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");const V=(R&1)===0?"02":"03",X=l.fromHex(V+d(H)),W=c(H),J=a(-B*W),ne=a($*W),oe=l.BASE.multiplyAndAddUnsafe(X,J,ne);if(!oe)throw new Error("point at infinify");return oe.assertValidity(),oe}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new x(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return Xc(this.toDERHex())}toDERHex(){return mo.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Xc(this.toCompactHex())}toCompactHex(){return d(this.r)+d(this.s)}}const A={isValidPrivateKey(m){try{return u(m),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const m=p8(e.n);return e9(e.randomBytes(m),e.n)},precompute(m=8,v=l.BASE){return v._setWindowSize(m),v.multiply(BigInt(3)),v}};function w(m,v=!0){return l.fromPrivateKey(m).toRawBytes(v)}function O(m){const v=m instanceof Uint8Array,N=typeof m=="string",$=(v||N)&&m.length;return v?$===s||$===i:N?$===2*s||$===2*i:m instanceof l}function I(m,v,N=!0){if(O(m))throw new Error("first arg must be private key");if(!O(v))throw new Error("second arg must be public key");return l.fromHex(v).multiply(u(m)).toRawBytes(N)}const E=e.bits2int||function(m){const v=Zo(m),N=m.length*8-e.nBitLength;return N>0?v>>BigInt(N):v},P=e.bits2int_modN||function(m){return a(E(m))},T=jb(e.nBitLength);function D(m){if(typeof m!="bigint")throw new Error("bigint expected");if(!(Ts<=m&&m<T))throw new Error(`bigint expected < 2^${e.nBitLength}`);return el(m,e.nByteLength)}function F(m,v,N=j){if(["recovered","canonical"].some(ie=>ie in N))throw new Error("sign() legacy options not supported");const{hash:$,randomBytes:R}=e;let{lowS:B,prehash:H,extraEntropy:V}=N;B==null&&(B=!0),m=rn("msgHash",m),H&&(m=rn("prehashed msgHash",$(m)));const X=P(m),W=u(v),J=[D(W),D(X)];if(V!=null){const ie=V===!0?R(t.BYTES):V;J.push(rn("extraEntropy",ie))}const ne=yu(...J),oe=X;function fe(ie){const de=E(ie);if(!h(de))return;const je=c(de),Je=l.BASE.multiply(de).toAffine(),ze=a(Je.x);if(ze===Ts)return;const Pt=a(je*a(oe+ze*W));if(Pt===Ts)return;let ya=(Je.x===ze?0:2)|Number(Je.y&Fr),Nf=Pt;return B&&p(Pt)&&(Nf=g(Pt),ya^=1),new x(ze,Nf,ya)}return{seed:ne,k2sig:fe}}const j={lowS:e.lowS,prehash:!1},L={lowS:e.lowS,prehash:!1};function U(m,v,N=j){const{seed:$,k2sig:R}=F(m,v,N),B=e;return f8(B.hash.outputLen,B.nByteLength,B.hmac)($,R)}l.BASE._setWindowSize(8);function _(m,v,N,$=L){var Je;const R=m;if(v=rn("msgHash",v),N=rn("publicKey",N),"strict"in $)throw new Error("options.strict was renamed to lowS");const{lowS:B,prehash:H}=$;let V,X;try{if(typeof R=="string"||R instanceof Uint8Array)try{V=x.fromDER(R)}catch(ze){if(!(ze instanceof mo.Err))throw ze;V=x.fromCompact(R)}else if(typeof R=="object"&&typeof R.r=="bigint"&&typeof R.s=="bigint"){const{r:ze,s:Pt}=R;V=new x(ze,Pt)}else throw new Error("PARSE");X=l.fromHex(N)}catch(ze){if(ze.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(B&&V.hasHighS())return!1;H&&(v=e.hash(v));const{r:W,s:J}=V,ne=P(v),oe=c(J),fe=a(ne*oe),ie=a(W*oe),de=(Je=l.BASE.multiplyAndAddUnsafe(X,fe,ie))==null?void 0:Je.toAffine();return de?a(de.x)===W:!1}return{CURVE:e,getPublicKey:w,getSharedSecret:I,sign:U,verify:_,ProjectivePoint:l,Signature:x,utils:A}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function l9(r){return{hash:r,hmac:(e,...t)=>Rd(r,e,kA(...t)),randomBytes:$A}}function u9(r,e){const t=n=>c9({...r,...l9(n)});return Object.freeze({...t(e),create:t})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const b8=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Rm=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),f9=BigInt(1),Kp=BigInt(2),_m=(r,e)=>(r+e/Kp)/e;function h9(r){const e=b8,t=BigInt(3),n=BigInt(6),s=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),l=r*r*r%e,u=l*l*r%e,f=Ir(u,t,e)*u%e,h=Ir(f,t,e)*u%e,d=Ir(h,Kp,e)*l%e,p=Ir(d,s,e)*d%e,g=Ir(p,i,e)*p%e,y=Ir(g,a,e)*g%e,x=Ir(y,c,e)*y%e,A=Ir(x,a,e)*g%e,w=Ir(A,t,e)*u%e,O=Ir(w,o,e)*p%e,I=Ir(O,n,e)*l%e,E=Ir(I,Kp,e);if(!Gp.eql(Gp.sqr(E),r))throw new Error("Cannot find square root");return E}const Gp=X5(b8,void 0,void 0,{sqrt:h9}),ni=u9({a:BigInt(0),b:BigInt(7),Fp:Gp,n:Rm,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:r=>{const e=Rm,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-f9*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=t,o=BigInt("0x100000000000000000000000000000000"),a=_m(i*r,e),c=_m(-n*r,e);let l=er(r-a*t-c*s,e),u=er(-a*n-c*i,e);const f=l>o,h=u>o;if(f&&(l=e-l),h&&(u=e-u),l>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+r);return{k1neg:f,k1:l,k2neg:h,k2:u}}}},bl);BigInt(0);ni.ProjectivePoint;const tl="0x0000000000000000000000000000000000000000",Wp="0x0000000000000000000000000000000000000000000000000000000000000000",d9=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),p9=BigInt("1000000000000000000"),g9=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),b9=BigInt("0x8000000000000000000000000000000000000000000000000000000000000000")*BigInt(-1),y9=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),m9="Ξ",y8=`Ethereum Signed Message:
`,Bm=BigInt(0),km=BigInt(1),Um=BigInt(2),$m=BigInt(27),Lm=BigInt(28),Lf=BigInt(35),wa={};function Fm(r){return vr(Fe(r),32)}var fc,_n,hc,Bo;const en=class en{constructor(e,t,n,s){M(this,fc);M(this,_n);M(this,hc);M(this,Bo);js(e,wa,"Signature"),S(this,fc,t),S(this,_n,n),S(this,hc,s),S(this,Bo,null)}get r(){return b(this,fc)}set r(e){C(_i(e)===32,"invalid r","value",e),S(this,fc,K(e))}get s(){return C(parseInt(b(this,_n).substring(0,3))<8,"non-canonical s; use ._s","s",b(this,_n)),b(this,_n)}set s(e){C(_i(e)===32,"invalid s","value",e),S(this,_n,K(e))}get _s(){return b(this,_n)}isValid(){return parseInt(b(this,_n).substring(0,3))<8}get v(){return b(this,hc)}set v(e){const t=ae(e,"value");C(t===27||t===28,"invalid v","v",e),S(this,hc,t)}get networkV(){return b(this,Bo)}get legacyChainId(){const e=this.networkV;return e==null?null:en.getChainId(e)}get yParity(){return this.v===27?0:1}get yParityAndS(){const e=Q(this.s);return this.yParity&&(e[0]|=128),K(e)}get compactSerialized(){return me([this.r,this.yParityAndS])}get serialized(){return me([this.r,this.s,this.yParity?"0x1c":"0x1b"])}[Symbol.for("nodejs.util.inspect.custom")](){return`Signature { r: "${this.r}", s: "${this._s}"${this.isValid()?"":', valid: "false"'}, yParity: ${this.yParity}, networkV: ${this.networkV} }`}clone(){const e=new en(wa,this.r,this._s,this.v);return this.networkV&&S(e,Bo,this.networkV),e}toJSON(){const e=this.networkV;return{_type:"signature",networkV:e!=null?e.toString():null,r:this.r,s:this._s,v:this.v}}static getChainId(e){const t=re(e,"v");return t==$m||t==Lm?Bm:(C(t>=Lf,"invalid EIP-155 v","v",e),(t-Lf)/Um)}static getChainIdV(e,t){return re(e)*Um+BigInt(35+t-27)}static getNormalizedV(e){const t=re(e);return t===Bm||t===$m?27:t===km||t===Lm?28:(C(t>=Lf,"invalid v","v",e),t&km?27:28)}static from(e){function t(l,u){C(l,u,"signature",e)}if(e==null)return new en(wa,Wp,Wp,27);if(typeof e=="string"){const l=Q(e,"signature");if(l.length===64){const u=K(l.slice(0,32)),f=l.slice(32,64),h=f[0]&128?28:27;return f[0]&=127,new en(wa,u,K(f),h)}if(l.length===65){const u=K(l.slice(0,32)),f=K(l.slice(32,64)),h=en.getNormalizedV(l[64]);return new en(wa,u,f,h)}t(!1,"invalid raw signature length")}if(e instanceof en)return e.clone();const n=e.r;t(n!=null,"missing r");const s=Fm(n),i=(function(l,u){if(l!=null)return Fm(l);if(u!=null){t(De(u,32),"invalid yParityAndS");const f=Q(u);return f[0]&=127,K(f)}t(!1,"missing s")})(e.s,e.yParityAndS),{networkV:o,v:a}=(function(l,u,f){if(l!=null){const h=re(l);return{networkV:h>=Lf?h:void 0,v:en.getNormalizedV(h)}}if(u!=null)return t(De(u,32),"invalid yParityAndS"),{v:Q(u)[0]&128?28:27};if(f!=null){switch(ae(f,"sig.yParity")){case 0:return{v:27};case 1:return{v:28}}t(!1,"invalid yParity")}t(!1,"missing v")})(e.v,e.yParityAndS,e.yParity),c=new en(wa,s,i,a);return o&&S(c,Bo,o),t(e.yParity==null||ae(e.yParity,"sig.yParity")===c.yParity,"yParity mismatch"),t(e.yParityAndS==null||e.yParityAndS===c.yParityAndS,"yParityAndS mismatch"),c}};fc=new WeakMap,_n=new WeakMap,hc=new WeakMap,Bo=new WeakMap;let zt=en;var ws;const po=class po{constructor(e){M(this,ws);C(_i(e)===32,"invalid private key","privateKey","[REDACTED]"),S(this,ws,K(e))}get privateKey(){return b(this,ws)}get publicKey(){return po.computePublicKey(b(this,ws))}get compressedPublicKey(){return po.computePublicKey(b(this,ws),!0)}sign(e){C(_i(e)===32,"invalid digest length","digest",e);const t=ni.sign(ut(e),ut(b(this,ws)),{lowS:!0});return zt.from({r:Zn(t.r,32),s:Zn(t.s,32),v:t.recovery?28:27})}computeSharedSecret(e){const t=po.computePublicKey(e);return K(ni.getSharedSecret(ut(b(this,ws)),Q(t),!1))}static computePublicKey(e,t){let n=Q(e,"key");if(n.length===32){const i=ni.getPublicKey(n,!!t);return K(i)}if(n.length===64){const i=new Uint8Array(65);i[0]=4,i.set(n,1),n=i}const s=ni.ProjectivePoint.fromHex(n);return K(s.toRawBytes(t))}static recoverPublicKey(e,t){C(_i(e)===32,"invalid digest length","digest",e);const n=zt.from(t);let s=ni.Signature.fromCompact(ut(me([n.r,n.s])));s=s.addRecoveryBit(n.yParity);const i=s.recoverPublicKey(ut(e));return C(i!=null,"invalid signature for digest","signature",t),"0x"+i.toHex(!1)}static addPoints(e,t,n){const s=ni.ProjectivePoint.fromHex(po.computePublicKey(e).substring(2)),i=ni.ProjectivePoint.fromHex(po.computePublicKey(t).substring(2));return"0x"+s.add(i).toHex(!!n)}};ws=new WeakMap;let bn=po;function x9(){zi.lock(),Ne.lock(),rs.lock(),qr.lock(),Hi.lock(),qi.lock(),Vi.lock(),Vt.lock(),cf.lock(),qr.lock()}const w9=BigInt(0),E9=BigInt(36);function Mm(r){r=r.toLowerCase();const e=r.substring(2).split(""),t=new Uint8Array(40);for(let s=0;s<40;s++)t[s]=e[s].charCodeAt(0);const n=Q(Ne(t));for(let s=0;s<40;s+=2)n[s>>1]>>4>=8&&(e[s]=e[s].toUpperCase()),(n[s>>1]&15)>=8&&(e[s+1]=e[s+1].toUpperCase());return"0x"+e.join("")}const zb={};for(let r=0;r<10;r++)zb[String(r)]=String(r);for(let r=0;r<26;r++)zb[String.fromCharCode(65+r)]=String(10+r);const jm=15;function m8(r){r=r.toUpperCase(),r=r.substring(4)+r.substring(0,2)+"00";let e=r.split("").map(n=>zb[n]).join("");for(;e.length>=jm;){let n=e.substring(0,jm);e=parseInt(n,10)%97+e.substring(n.length)}let t=String(98-parseInt(e,10)%97);for(;t.length<2;)t="0"+t;return t}const v9=(function(){const r={};for(let e=0;e<36;e++){const t="0123456789abcdefghijklmnopqrstuvwxyz"[e];r[t]=BigInt(e)}return r})();function A9(r){r=r.toLowerCase();let e=w9;for(let t=0;t<r.length;t++)e=e*E9+v9[r[t]];return e}function ce(r){if(C(typeof r=="string","invalid address","address",r),r.match(/^(0x)?[0-9a-fA-F]{40}$/)){r.startsWith("0x")||(r="0x"+r);const e=Mm(r);return C(!r.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||e===r,"bad address checksum","address",r),e}if(r.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){C(r.substring(2,4)===m8(r),"bad icap checksum","address",r);let e=A9(r.substring(4)).toString(16);for(;e.length<40;)e="0"+e;return Mm("0x"+e)}C(!1,"invalid address","address",r)}function I9(r){let e=BigInt(ce(r)).toString(36).toUpperCase();for(;e.length<30;)e="0"+e;return"XE"+m8("XE00"+e)+e}function Hb(r){const e=ce(r.from);let n=re(r.nonce,"tx.nonce").toString(16);return n==="0"?n="0x":n.length%2?n="0x0"+n:n="0x"+n,ce(ke(Ne(Xn([e,n])),12))}function S9(r,e,t){const n=ce(r),s=Q(e,"salt"),i=Q(t,"initCodeHash");return C(s.length===32,"salt must be 32 bytes","salt",e),C(i.length===32,"initCodeHash must be 32 bytes","initCodeHash",t),ce(ke(Ne(me(["0xff",n,s,i])),12))}function qb(r){return r&&typeof r.getAddress=="function"}function O9(r){try{return ce(r),!0}catch{}return!1}async function g0(r,e){const t=await e;return(t==null||t==="0x0000000000000000000000000000000000000000")&&(z(typeof r!="string","unconfigured name","UNCONFIGURED_NAME",{value:r}),C(!1,"invalid AddressLike value; did not resolve to a value address","target",r)),ce(t)}function nt(r,e){if(typeof r=="string")return r.match(/^0x[0-9a-f]{40}$/i)?ce(r):(z(e!=null,"ENS resolution requires a provider","UNSUPPORTED_OPERATION",{operation:"resolveName"}),g0(r,e.resolveName(r)));if(qb(r))return g0(r,r.getAddress());if(r&&typeof r.then=="function")return g0(r,r);C(!1,"unsupported addressable value","target",r)}const ps={};function se(r,e){let t=!1;return e<0&&(t=!0,e*=-1),new At(ps,`${t?"":"u"}int${e}`,r,{signed:t,width:e})}function we(r,e){return new At(ps,`bytes${e||""}`,r,{size:e})}const zm=Symbol.for("_ethers_typed");var ko;const gs=class gs{constructor(e,t,n,s){k(this,"type");k(this,"value");M(this,ko);k(this,"_typedSymbol");s==null&&(s=null),js(ps,e,"Typed"),te(this,{_typedSymbol:zm,type:t,value:n}),S(this,ko,s),this.format()}format(){if(this.type==="array")throw new Error("");if(this.type==="dynamicArray")throw new Error("");return this.type==="tuple"?`tuple(${this.value.map(e=>e.format()).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return this.type==="string"}get tupleName(){if(this.type!=="tuple")throw TypeError("not a tuple");return b(this,ko)}get arrayLength(){if(this.type!=="array")throw TypeError("not an array");return b(this,ko)===!0?-1:b(this,ko)===!1?this.value.length:null}static from(e,t){return new gs(ps,e,t)}static uint8(e){return se(e,8)}static uint16(e){return se(e,16)}static uint24(e){return se(e,24)}static uint32(e){return se(e,32)}static uint40(e){return se(e,40)}static uint48(e){return se(e,48)}static uint56(e){return se(e,56)}static uint64(e){return se(e,64)}static uint72(e){return se(e,72)}static uint80(e){return se(e,80)}static uint88(e){return se(e,88)}static uint96(e){return se(e,96)}static uint104(e){return se(e,104)}static uint112(e){return se(e,112)}static uint120(e){return se(e,120)}static uint128(e){return se(e,128)}static uint136(e){return se(e,136)}static uint144(e){return se(e,144)}static uint152(e){return se(e,152)}static uint160(e){return se(e,160)}static uint168(e){return se(e,168)}static uint176(e){return se(e,176)}static uint184(e){return se(e,184)}static uint192(e){return se(e,192)}static uint200(e){return se(e,200)}static uint208(e){return se(e,208)}static uint216(e){return se(e,216)}static uint224(e){return se(e,224)}static uint232(e){return se(e,232)}static uint240(e){return se(e,240)}static uint248(e){return se(e,248)}static uint256(e){return se(e,256)}static uint(e){return se(e,256)}static int8(e){return se(e,-8)}static int16(e){return se(e,-16)}static int24(e){return se(e,-24)}static int32(e){return se(e,-32)}static int40(e){return se(e,-40)}static int48(e){return se(e,-48)}static int56(e){return se(e,-56)}static int64(e){return se(e,-64)}static int72(e){return se(e,-72)}static int80(e){return se(e,-80)}static int88(e){return se(e,-88)}static int96(e){return se(e,-96)}static int104(e){return se(e,-104)}static int112(e){return se(e,-112)}static int120(e){return se(e,-120)}static int128(e){return se(e,-128)}static int136(e){return se(e,-136)}static int144(e){return se(e,-144)}static int152(e){return se(e,-152)}static int160(e){return se(e,-160)}static int168(e){return se(e,-168)}static int176(e){return se(e,-176)}static int184(e){return se(e,-184)}static int192(e){return se(e,-192)}static int200(e){return se(e,-200)}static int208(e){return se(e,-208)}static int216(e){return se(e,-216)}static int224(e){return se(e,-224)}static int232(e){return se(e,-232)}static int240(e){return se(e,-240)}static int248(e){return se(e,-248)}static int256(e){return se(e,-256)}static int(e){return se(e,-256)}static bytes1(e){return we(e,1)}static bytes2(e){return we(e,2)}static bytes3(e){return we(e,3)}static bytes4(e){return we(e,4)}static bytes5(e){return we(e,5)}static bytes6(e){return we(e,6)}static bytes7(e){return we(e,7)}static bytes8(e){return we(e,8)}static bytes9(e){return we(e,9)}static bytes10(e){return we(e,10)}static bytes11(e){return we(e,11)}static bytes12(e){return we(e,12)}static bytes13(e){return we(e,13)}static bytes14(e){return we(e,14)}static bytes15(e){return we(e,15)}static bytes16(e){return we(e,16)}static bytes17(e){return we(e,17)}static bytes18(e){return we(e,18)}static bytes19(e){return we(e,19)}static bytes20(e){return we(e,20)}static bytes21(e){return we(e,21)}static bytes22(e){return we(e,22)}static bytes23(e){return we(e,23)}static bytes24(e){return we(e,24)}static bytes25(e){return we(e,25)}static bytes26(e){return we(e,26)}static bytes27(e){return we(e,27)}static bytes28(e){return we(e,28)}static bytes29(e){return we(e,29)}static bytes30(e){return we(e,30)}static bytes31(e){return we(e,31)}static bytes32(e){return we(e,32)}static address(e){return new gs(ps,"address",e)}static bool(e){return new gs(ps,"bool",!!e)}static bytes(e){return new gs(ps,"bytes",e)}static string(e){return new gs(ps,"string",e)}static array(e,t){throw new Error("not implemented yet")}static tuple(e,t){throw new Error("not implemented yet")}static overrides(e){return new gs(ps,"overrides",Object.assign({},e))}static isTyped(e){return e&&typeof e=="object"&&"_typedSymbol"in e&&e._typedSymbol===zm}static dereference(e,t){if(gs.isTyped(e)){if(e.type!==t)throw new Error(`invalid type: expecetd ${t}, got ${e.type}`);return e.value}return e}};ko=new WeakMap;let At=gs;class P9 extends zs{constructor(e){super("address","address",e,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(e,t){let n=At.dereference(t,"string");try{n=ce(n)}catch(s){return this._throwError(s.message,t)}return e.writeValue(n)}decode(e){return ce(Zn(e.readValue(),20))}}class C9 extends zs{constructor(t){super(t.name,t.type,"_",t.dynamic);k(this,"coder");this.coder=t}defaultValue(){return this.coder.defaultValue()}encode(t,n){return this.coder.encode(t,n)}decode(t){return this.coder.decode(t)}}function x8(r,e,t){let n=[];if(Array.isArray(t))n=t;else if(t&&typeof t=="object"){let c={};n=e.map(l=>{const u=l.localName;return z(u,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:l},value:t}),z(!c[u],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:l},value:t}),c[u]=!0,t[u]})}else C(!1,"invalid tuple value","tuple",t);C(e.length===n.length,"types/value length mismatch","tuple",t);let s=new Mp,i=new Mp,o=[];e.forEach((c,l)=>{let u=n[l];if(c.dynamic){let f=i.length;c.encode(i,u);let h=s.writeUpdatableValue();o.push(d=>{h(d+f)})}else c.encode(s,u)}),o.forEach(c=>{c(s.length)});let a=r.appendWriter(s);return a+=r.appendWriter(i),a}function w8(r,e){let t=[],n=[],s=r.subReader(0);return e.forEach(i=>{let o=null;if(i.dynamic){let a=r.readIndex(),c=s.subReader(a);try{o=i.decode(c)}catch(l){if(Qe(l,"BUFFER_OVERRUN"))throw l;o=l,o.baseType=i.name,o.name=i.localName,o.type=i.type}}else try{o=i.decode(r)}catch(a){if(Qe(a,"BUFFER_OVERRUN"))throw a;o=a,o.baseType=i.name,o.name=i.localName,o.type=i.type}if(o==null)throw new Error("investigate");t.push(o),n.push(i.localName||null)}),Xo.fromItems(t,n)}class T9 extends zs{constructor(t,n,s){const i=t.type+"["+(n>=0?n:"")+"]",o=n===-1||t.dynamic;super("array",i,s,o);k(this,"coder");k(this,"length");te(this,{coder:t,length:n})}defaultValue(){const t=this.coder.defaultValue(),n=[];for(let s=0;s<this.length;s++)n.push(t);return n}encode(t,n){const s=At.dereference(n,"array");Array.isArray(s)||this._throwError("expected array value",s);let i=this.length;i===-1&&(i=s.length,t.writeValue(s.length)),Ob(s.length,i,"coder array"+(this.localName?" "+this.localName:""));let o=[];for(let a=0;a<s.length;a++)o.push(this.coder);return x8(t,o,s)}decode(t){let n=this.length;n===-1&&(n=t.readIndex(),z(n*Mt<=t.dataLength,"insufficient data length","BUFFER_OVERRUN",{buffer:t.bytes,offset:n*Mt,length:t.dataLength}));let s=[];for(let i=0;i<n;i++)s.push(new C9(this.coder));return w8(t,s)}}class N9 extends zs{constructor(e){super("bool","bool",e,!1)}defaultValue(){return!1}encode(e,t){const n=At.dereference(t,"bool");return e.writeValue(n?1:0)}decode(e){return!!e.readValue()}}class E8 extends zs{constructor(e,t){super(e,e,t,!0)}defaultValue(){return"0x"}encode(e,t){t=ut(t);let n=e.writeValue(t.length);return n+=e.writeBytes(t),n}decode(e){return e.readBytes(e.readIndex(),!0)}}class D9 extends E8{constructor(e){super("bytes",e)}decode(e){return K(super.decode(e))}}class R9 extends zs{constructor(t,n){let s="bytes"+String(t);super(s,s,n,!1);k(this,"size");te(this,{size:t},{size:"number"})}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+this.size*2)}encode(t,n){let s=ut(At.dereference(n,this.type));return s.length!==this.size&&this._throwError("incorrect data length",n),t.writeBytes(s)}decode(t){return K(t.readBytes(this.size))}}const _9=new Uint8Array([]);class B9 extends zs{constructor(e){super("null","",e,!1)}defaultValue(){return null}encode(e,t){return t!=null&&this._throwError("not null",t),e.writeBytes(_9)}decode(e){return e.readBytes(0),null}}const k9=BigInt(0),U9=BigInt(1),$9=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class L9 extends zs{constructor(t,n,s){const i=(n?"int":"uint")+t*8;super(i,i,s,!1);k(this,"size");k(this,"signed");te(this,{size:t,signed:n},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(t,n){let s=re(At.dereference(n,this.type)),i=Di($9,Mt*8);if(this.signed){let o=Di(i,this.size*8-1);(s>o||s<-(o+U9))&&this._throwError("value out-of-bounds",n),s=Nd(s,8*Mt)}else(s<k9||s>Di(i,this.size*8))&&this._throwError("value out-of-bounds",n);return t.writeValue(s)}decode(t){let n=Di(t.readValue(),this.size*8);return this.signed&&(n=gu(n,this.size*8)),n}}class F9 extends E8{constructor(e){super("string",e)}defaultValue(){return""}encode(e,t){return super.encode(e,st(At.dereference(t,"string")))}decode(e){return $i(super.decode(e))}}class Ff extends zs{constructor(t,n){let s=!1;const i=[];t.forEach(a=>{a.dynamic&&(s=!0),i.push(a.type)});const o="tuple("+i.join(",")+")";super("tuple",o,n,s);k(this,"coders");te(this,{coders:Object.freeze(t.slice())})}defaultValue(){const t=[];this.coders.forEach(s=>{t.push(s.defaultValue())});const n=this.coders.reduce((s,i)=>{const o=i.localName;return o&&(s[o]||(s[o]=0),s[o]++),s},{});return this.coders.forEach((s,i)=>{let o=s.localName;!o||n[o]!==1||(o==="length"&&(o="_length"),t[o]==null&&(t[o]=t[i]))}),Object.freeze(t)}encode(t,n){const s=At.dereference(n,"tuple");return x8(t,this.coders,s)}decode(t){return w8(t,this.coders)}}function b0(r,e){return{address:ce(r),storageKeys:e.map((t,n)=>(C(De(t,32),"invalid slot",`storageKeys[${n}]`,t),t.toLowerCase()))}}function Hs(r){if(Array.isArray(r))return r.map((t,n)=>Array.isArray(t)?(C(t.length===2,"invalid slot set",`value[${n}]`,t),b0(t[0],t[1])):(C(t!=null&&typeof t=="object","invalid address-slot set","value",r),b0(t.address,t.storageKeys)));C(r!=null&&typeof r=="object","invalid access list","value",r);const e=Object.keys(r).map(t=>{const n=r[t].reduce((s,i)=>(s[i]=!0,s),{});return b0(t,Object.keys(n).sort())});return e.sort((t,n)=>t.address.localeCompare(n.address)),e}function Vb(r){return{address:ce(r.address),nonce:re(r.nonce!=null?r.nonce:0),chainId:re(r.chainId!=null?r.chainId:0),signature:zt.from(r.signature)}}function yl(r){let e;return typeof r=="string"?e=bn.computePublicKey(r,!1):e=r.publicKey,ce(Ne("0x"+e.substring(4)).substring(26))}function uf(r,e){return yl(bn.recoverPublicKey(r,e))}const lt=BigInt(0),M9=BigInt(2),j9=BigInt(27),z9=BigInt(28),H9=BigInt(35),q9=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),y0=4096*32;function V9(r){return{blobToKzgCommitment:n=>{if("computeBlobProof"in r){if("blobToKzgCommitment"in r&&typeof r.blobToKzgCommitment=="function")return Q(r.blobToKzgCommitment(K(n)))}else if("blobToKzgCommitment"in r&&typeof r.blobToKzgCommitment=="function")return Q(r.blobToKzgCommitment(n));if("blobToKZGCommitment"in r&&typeof r.blobToKZGCommitment=="function")return Q(r.blobToKZGCommitment(K(n)));C(!1,"unsupported KZG library","kzg",r)},computeBlobKzgProof:(n,s)=>{if("computeBlobProof"in r&&typeof r.computeBlobProof=="function")return Q(r.computeBlobProof(K(n),K(s)));if("computeBlobKzgProof"in r&&typeof r.computeBlobKzgProof=="function")return r.computeBlobKzgProof(n,s);if("computeBlobKZGProof"in r&&typeof r.computeBlobKZGProof=="function")return Q(r.computeBlobKZGProof(K(n),K(s)));C(!1,"unsupported KZG library","kzg",r)}}}function Hm(r,e){let t=r.toString(16);for(;t.length<2;)t="0"+t;return t+=Vt(e).substring(4),"0x"+t}function ml(r){return r==="0x"?null:ce(r)}function kd(r,e){try{return Hs(r)}catch(t){C(!1,t.message,e,r)}}function K9(r,e){try{if(!Array.isArray(r))throw new Error("authorizationList: invalid array");const t=[];for(let n=0;n<r.length;n++){const s=r[n];if(!Array.isArray(s))throw new Error(`authorization[${n}]: invalid array`);if(s.length!==6)throw new Error(`authorization[${n}]: wrong length`);if(!s[1])throw new Error(`authorization[${n}]: null address`);t.push({address:ml(s[1]),nonce:Te(s[2],"nonce"),chainId:Te(s[0],"chainId"),signature:zt.from({yParity:fa(s[3],"yParity"),r:vr(s[4],32),s:vr(s[5],32)})})}return t}catch(t){C(!1,t.message,e,r)}}function fa(r,e){return r==="0x"?0:ae(r,e)}function Te(r,e){if(r==="0x")return lt;const t=re(r,e);return C(t<=q9,"value exceeds uint size",e,t),t}function ye(r,e){const t=re(r,"value"),n=Fe(t);return C(n.length<=32,"value too large",`tx.${e}`,t),n}function Ud(r){return Hs(r).map(e=>[e.address,e.storageKeys])}function G9(r){return r.map(e=>[ye(e.chainId,"chainId"),e.address,ye(e.nonce,"nonce"),ye(e.signature.yParity,"yParity"),Fe(e.signature.r),Fe(e.signature.s)])}function W9(r,e){C(Array.isArray(r),`invalid ${e}`,"value",r);for(let t=0;t<r.length;t++)C(De(r[t],32),"invalid ${ param } hash",`value[${t}]`,r[t]);return r}function Q9(r){const e=gl(r);C(Array.isArray(e)&&(e.length===9||e.length===6),"invalid field count for legacy transaction","data",r);const t={type:0,nonce:fa(e[0],"nonce"),gasPrice:Te(e[1],"gasPrice"),gasLimit:Te(e[2],"gasLimit"),to:ml(e[3]),value:Te(e[4],"value"),data:K(e[5]),chainId:lt};if(e.length===6)return t;const n=Te(e[6],"v"),s=Te(e[7],"r"),i=Te(e[8],"s");if(s===lt&&i===lt)t.chainId=n;else{let o=(n-H9)/M9;o<lt&&(o=lt),t.chainId=o,C(o!==lt||n===j9||n===z9,"non-canonical legacy v","v",e[6]),t.signature=zt.from({r:vr(e[7],32),s:vr(e[8],32),v:n})}return t}function J9(r,e){const t=[ye(r.nonce,"nonce"),ye(r.gasPrice||0,"gasPrice"),ye(r.gasLimit,"gasLimit"),r.to||"0x",ye(r.value,"value"),r.data];let n=lt;if(r.chainId!=lt)n=re(r.chainId,"tx.chainId"),C(!e||e.networkV==null||e.legacyChainId===n,"tx.chainId/sig.v mismatch","sig",e);else if(r.signature){const i=r.signature.legacyChainId;i!=null&&(n=i)}if(!e)return n!==lt&&(t.push(Fe(n)),t.push("0x"),t.push("0x")),Xn(t);let s=BigInt(27+e.yParity);return n!==lt?s=zt.getChainIdV(n,e.v):BigInt(e.v)!==s&&C(!1,"tx.chainId/sig.v mismatch","sig",e),t.push(Fe(s)),t.push(Fe(e.r)),t.push(Fe(e.s)),Xn(t)}function $d(r,e){let t;try{if(t=fa(e[0],"yParity"),t!==0&&t!==1)throw new Error("bad yParity")}catch{C(!1,"invalid yParity","yParity",e[0])}const n=vr(e[1],32),s=vr(e[2],32),i=zt.from({r:n,s,yParity:t});r.signature=i}function Y9(r){const e=gl(Q(r).slice(1));C(Array.isArray(e)&&(e.length===9||e.length===12),"invalid field count for transaction type: 2","data",K(r));const t={type:2,chainId:Te(e[0],"chainId"),nonce:fa(e[1],"nonce"),maxPriorityFeePerGas:Te(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Te(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Te(e[4],"gasLimit"),to:ml(e[5]),value:Te(e[6],"value"),data:K(e[7]),accessList:kd(e[8],"accessList")};return e.length===9||$d(t,e.slice(9)),t}function Z9(r,e){const t=[ye(r.chainId,"chainId"),ye(r.nonce,"nonce"),ye(r.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),ye(r.maxFeePerGas||0,"maxFeePerGas"),ye(r.gasLimit,"gasLimit"),r.to||"0x",ye(r.value,"value"),r.data,Ud(r.accessList||[])];return e&&(t.push(ye(e.yParity,"yParity")),t.push(Fe(e.r)),t.push(Fe(e.s))),me(["0x02",Xn(t)])}function X9(r){const e=gl(Q(r).slice(1));C(Array.isArray(e)&&(e.length===8||e.length===11),"invalid field count for transaction type: 1","data",K(r));const t={type:1,chainId:Te(e[0],"chainId"),nonce:fa(e[1],"nonce"),gasPrice:Te(e[2],"gasPrice"),gasLimit:Te(e[3],"gasLimit"),to:ml(e[4]),value:Te(e[5],"value"),data:K(e[6]),accessList:kd(e[7],"accessList")};return e.length===8||$d(t,e.slice(8)),t}function e7(r,e){const t=[ye(r.chainId,"chainId"),ye(r.nonce,"nonce"),ye(r.gasPrice||0,"gasPrice"),ye(r.gasLimit,"gasLimit"),r.to||"0x",ye(r.value,"value"),r.data,Ud(r.accessList||[])];return e&&(t.push(ye(e.yParity,"recoveryParam")),t.push(Fe(e.r)),t.push(Fe(e.s))),me(["0x01",Xn(t)])}function t7(r){let e=gl(Q(r).slice(1)),t="3",n=null;if(e.length===4&&Array.isArray(e[0])){t="3 (network format)";const i=e[1],o=e[2],a=e[3];C(Array.isArray(i),"invalid network format: blobs not an array","fields[1]",i),C(Array.isArray(o),"invalid network format: commitments not an array","fields[2]",o),C(Array.isArray(a),"invalid network format: proofs not an array","fields[3]",a),C(i.length===o.length,"invalid network format: blobs/commitments length mismatch","fields",e),C(i.length===a.length,"invalid network format: blobs/proofs length mismatch","fields",e),n=[];for(let c=0;c<e[1].length;c++)n.push({data:i[c],commitment:o[c],proof:a[c]});e=e[0]}C(Array.isArray(e)&&(e.length===11||e.length===14),`invalid field count for transaction type: ${t}`,"data",K(r));const s={type:3,chainId:Te(e[0],"chainId"),nonce:fa(e[1],"nonce"),maxPriorityFeePerGas:Te(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Te(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Te(e[4],"gasLimit"),to:ml(e[5]),value:Te(e[6],"value"),data:K(e[7]),accessList:kd(e[8],"accessList"),maxFeePerBlobGas:Te(e[9],"maxFeePerBlobGas"),blobVersionedHashes:e[10]};n&&(s.blobs=n),C(s.to!=null,`invalid address for transaction type: ${t}`,"data",r),C(Array.isArray(s.blobVersionedHashes),"invalid blobVersionedHashes: must be an array","data",r);for(let i=0;i<s.blobVersionedHashes.length;i++)C(De(s.blobVersionedHashes[i],32),`invalid blobVersionedHash at index ${i}: must be length 32`,"data",r);return e.length===11||$d(s,e.slice(11)),s}function r7(r,e,t){const n=[ye(r.chainId,"chainId"),ye(r.nonce,"nonce"),ye(r.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),ye(r.maxFeePerGas||0,"maxFeePerGas"),ye(r.gasLimit,"gasLimit"),r.to||tl,ye(r.value,"value"),r.data,Ud(r.accessList||[]),ye(r.maxFeePerBlobGas||0,"maxFeePerBlobGas"),W9(r.blobVersionedHashes||[],"blobVersionedHashes")];return e&&(n.push(ye(e.yParity,"yParity")),n.push(Fe(e.r)),n.push(Fe(e.s)),t)?me(["0x03",Xn([n,t.map(s=>s.data),t.map(s=>s.commitment),t.map(s=>s.proof)])]):me(["0x03",Xn(n)])}function n7(r){const e=gl(Q(r).slice(1));C(Array.isArray(e)&&(e.length===10||e.length===13),"invalid field count for transaction type: 4","data",K(r));const t={type:4,chainId:Te(e[0],"chainId"),nonce:fa(e[1],"nonce"),maxPriorityFeePerGas:Te(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Te(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Te(e[4],"gasLimit"),to:ml(e[5]),value:Te(e[6],"value"),data:K(e[7]),accessList:kd(e[8],"accessList"),authorizationList:K9(e[9],"authorizationList")};return e.length===10||$d(t,e.slice(10)),t}function s7(r,e){const t=[ye(r.chainId,"chainId"),ye(r.nonce,"nonce"),ye(r.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),ye(r.maxFeePerGas||0,"maxFeePerGas"),ye(r.gasLimit,"gasLimit"),r.to||"0x",ye(r.value,"value"),r.data,Ud(r.accessList||[]),G9(r.authorizationList||[])];return e&&(t.push(ye(e.yParity,"yParity")),t.push(Fe(e.r)),t.push(Fe(e.s))),me(["0x04",Xn(t)])}var an,dc,pc,gc,bc,yc,mc,xc,wc,Ec,vc,Ac,Uo,di,Bn,pi,Ic,Sc,xh;const Nn=class Nn{constructor(){M(this,Sc);M(this,an);M(this,dc);M(this,pc);M(this,gc);M(this,bc);M(this,yc);M(this,mc);M(this,xc);M(this,wc);M(this,Ec);M(this,vc);M(this,Ac);M(this,Uo);M(this,di);M(this,Bn);M(this,pi);M(this,Ic);S(this,an,null),S(this,dc,null),S(this,gc,0),S(this,bc,lt),S(this,yc,null),S(this,mc,null),S(this,xc,null),S(this,pc,"0x"),S(this,wc,lt),S(this,Ec,lt),S(this,vc,null),S(this,Ac,null),S(this,Uo,null),S(this,di,null),S(this,Bn,null),S(this,pi,null),S(this,Ic,null)}get type(){return b(this,an)}set type(e){switch(e){case null:S(this,an,null);break;case 0:case"legacy":S(this,an,0);break;case 1:case"berlin":case"eip-2930":S(this,an,1);break;case 2:case"london":case"eip-1559":S(this,an,2);break;case 3:case"cancun":case"eip-4844":S(this,an,3);break;case 4:case"pectra":case"eip-7702":S(this,an,4);break;default:C(!1,"unsupported transaction type","type",e)}}get typeName(){switch(this.type){case 0:return"legacy";case 1:return"eip-2930";case 2:return"eip-1559";case 3:return"eip-4844";case 4:return"eip-7702"}return null}get to(){const e=b(this,dc);return e==null&&this.type===3?tl:e}set to(e){S(this,dc,e==null?null:ce(e))}get nonce(){return b(this,gc)}set nonce(e){S(this,gc,ae(e,"value"))}get gasLimit(){return b(this,bc)}set gasLimit(e){S(this,bc,re(e))}get gasPrice(){const e=b(this,yc);return e==null&&(this.type===0||this.type===1)?lt:e}set gasPrice(e){S(this,yc,e==null?null:re(e,"gasPrice"))}get maxPriorityFeePerGas(){const e=b(this,mc);return e??(this.type===2||this.type===3?lt:null)}set maxPriorityFeePerGas(e){S(this,mc,e==null?null:re(e,"maxPriorityFeePerGas"))}get maxFeePerGas(){const e=b(this,xc);return e??(this.type===2||this.type===3?lt:null)}set maxFeePerGas(e){S(this,xc,e==null?null:re(e,"maxFeePerGas"))}get data(){return b(this,pc)}set data(e){S(this,pc,K(e))}get value(){return b(this,wc)}set value(e){S(this,wc,re(e,"value"))}get chainId(){return b(this,Ec)}set chainId(e){S(this,Ec,re(e))}get signature(){return b(this,vc)||null}set signature(e){S(this,vc,e==null?null:zt.from(e))}get accessList(){const e=b(this,Ac)||null;return e??(this.type===1||this.type===2||this.type===3?[]:null)}set accessList(e){S(this,Ac,e==null?null:Hs(e))}get authorizationList(){const e=b(this,Ic)||null;return e==null&&this.type===4?[]:e}set authorizationList(e){S(this,Ic,e==null?null:e.map(t=>Vb(t)))}get maxFeePerBlobGas(){const e=b(this,Uo);return e==null&&this.type===3?lt:e}set maxFeePerBlobGas(e){S(this,Uo,e==null?null:re(e,"maxFeePerBlobGas"))}get blobVersionedHashes(){let e=b(this,di);return e==null&&this.type===3?[]:e}set blobVersionedHashes(e){if(e!=null){C(Array.isArray(e),"blobVersionedHashes must be an Array","value",e),e=e.slice();for(let t=0;t<e.length;t++)C(De(e[t],32),"invalid blobVersionedHash",`value[${t}]`,e[t])}S(this,di,e)}get blobs(){return b(this,pi)==null?null:b(this,pi).map(e=>Object.assign({},e))}set blobs(e){if(e==null){S(this,pi,null);return}const t=[],n=[];for(let s=0;s<e.length;s++){const i=e[s];if(of(i)){z(b(this,Bn),"adding a raw blob requires a KZG library","UNSUPPORTED_OPERATION",{operation:"set blobs()"});let o=Q(i);if(C(o.length<=y0,"blob is too large",`blobs[${s}]`,i),o.length!==y0){const l=new Uint8Array(y0);l.set(o),o=l}const a=b(this,Bn).blobToKzgCommitment(o),c=K(b(this,Bn).computeBlobKzgProof(o,a));t.push({data:K(o),commitment:K(a),proof:c}),n.push(Hm(1,a))}else{const o=K(i.commitment);t.push({data:K(i.data),commitment:o,proof:K(i.proof)}),n.push(Hm(1,o))}}S(this,pi,t),S(this,di,n)}get kzg(){return b(this,Bn)}set kzg(e){e==null?S(this,Bn,null):S(this,Bn,V9(e))}get hash(){return this.signature==null?null:Ne(q(this,Sc,xh).call(this,!0,!1))}get unsignedHash(){return Ne(this.unsignedSerialized)}get from(){return this.signature==null?null:uf(this.unsignedHash,this.signature)}get fromPublicKey(){return this.signature==null?null:bn.recoverPublicKey(this.unsignedHash,this.signature)}isSigned(){return this.signature!=null}get serialized(){return q(this,Sc,xh).call(this,!0,!0)}get unsignedSerialized(){return q(this,Sc,xh).call(this,!1,!1)}inferType(){const e=this.inferTypes();return e.indexOf(2)>=0?2:e.pop()}inferTypes(){const e=this.gasPrice!=null,t=this.maxFeePerGas!=null||this.maxPriorityFeePerGas!=null,n=this.accessList!=null,s=b(this,Uo)!=null||b(this,di);this.maxFeePerGas!=null&&this.maxPriorityFeePerGas!=null&&z(this.maxFeePerGas>=this.maxPriorityFeePerGas,"priorityFee cannot be more than maxFee","BAD_DATA",{value:this}),z(!t||this.type!==0&&this.type!==1,"transaction type cannot have maxFeePerGas or maxPriorityFeePerGas","BAD_DATA",{value:this}),z(this.type!==0||!n,"legacy transaction cannot have accessList","BAD_DATA",{value:this});const i=[];return this.type!=null?i.push(this.type):this.authorizationList&&this.authorizationList.length?i.push(4):t?i.push(2):e?(i.push(1),n||i.push(0)):n?(i.push(1),i.push(2)):(s&&this.to||(i.push(0),i.push(1),i.push(2)),i.push(3)),i.sort(),i}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}clone(){return Nn.from(this)}toJSON(){const e=t=>t==null?null:t.toString();return{type:this.type,to:this.to,data:this.data,nonce:this.nonce,gasLimit:e(this.gasLimit),gasPrice:e(this.gasPrice),maxPriorityFeePerGas:e(this.maxPriorityFeePerGas),maxFeePerGas:e(this.maxFeePerGas),value:e(this.value),chainId:e(this.chainId),sig:this.signature?this.signature.toJSON():null,accessList:this.accessList}}static from(e){if(e==null)return new Nn;if(typeof e=="string"){const n=Q(e);if(n[0]>=127)return Nn.from(Q9(n));switch(n[0]){case 1:return Nn.from(X9(n));case 2:return Nn.from(Y9(n));case 3:return Nn.from(t7(n));case 4:return Nn.from(n7(n))}z(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:"from"})}const t=new Nn;return e.type!=null&&(t.type=e.type),e.to!=null&&(t.to=e.to),e.nonce!=null&&(t.nonce=e.nonce),e.gasLimit!=null&&(t.gasLimit=e.gasLimit),e.gasPrice!=null&&(t.gasPrice=e.gasPrice),e.maxPriorityFeePerGas!=null&&(t.maxPriorityFeePerGas=e.maxPriorityFeePerGas),e.maxFeePerGas!=null&&(t.maxFeePerGas=e.maxFeePerGas),e.maxFeePerBlobGas!=null&&(t.maxFeePerBlobGas=e.maxFeePerBlobGas),e.data!=null&&(t.data=e.data),e.value!=null&&(t.value=e.value),e.chainId!=null&&(t.chainId=e.chainId),e.signature!=null&&(t.signature=zt.from(e.signature)),e.accessList!=null&&(t.accessList=e.accessList),e.authorizationList!=null&&(t.authorizationList=e.authorizationList),e.blobVersionedHashes!=null&&(t.blobVersionedHashes=e.blobVersionedHashes),e.kzg!=null&&(t.kzg=e.kzg),e.blobs!=null&&(t.blobs=e.blobs),e.hash!=null&&(C(t.isSigned(),"unsigned transaction cannot define '.hash'","tx",e),C(t.hash===e.hash,"hash mismatch","tx",e)),e.from!=null&&(C(t.isSigned(),"unsigned transaction cannot define '.from'","tx",e),C(t.from.toLowerCase()===(e.from||"").toLowerCase(),"from mismatch","tx",e)),t}};an=new WeakMap,dc=new WeakMap,pc=new WeakMap,gc=new WeakMap,bc=new WeakMap,yc=new WeakMap,mc=new WeakMap,xc=new WeakMap,wc=new WeakMap,Ec=new WeakMap,vc=new WeakMap,Ac=new WeakMap,Uo=new WeakMap,di=new WeakMap,Bn=new WeakMap,pi=new WeakMap,Ic=new WeakMap,Sc=new WeakSet,xh=function(e,t){z(!e||this.signature!=null,"cannot serialize unsigned transaction; maybe you meant .unsignedSerialized","UNSUPPORTED_OPERATION",{operation:".serialized"});const n=e?this.signature:null;switch(this.inferType()){case 0:return J9(this,n);case 1:return e7(this,n);case 2:return Z9(this,n);case 3:return r7(this,n,t?this.blobs:null);case 4:return s7(this,n)}z(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:".serialized"})};let ea=Nn;function Kb(r){return C(typeof r.address=="string","invalid address for hashAuthorization","auth.address",r),Ne(me(["0x05",Xn([r.chainId!=null?Fe(r.chainId):"0x",ce(r.address),r.nonce!=null?Fe(r.nonce):"0x"])]))}function i7(r,e){return uf(Kb(r),e)}function es(r){return Ne(st(r))}var o7="AEEUdwmgDS8BxQKKAP4BOgDjATAAngDUAIMAoABoAOAAagCOAEQAhABMAHIAOwA9ACsANgAmAGIAHgAuACgAJwAXAC0AGgAjAB8ALwAUACkAEgAeAAkAGwARABkAFgA5ACgALQArADcAFQApABAAHgAiABAAGgAeABMAGAUhBe8BFxREN8sF2wC5AK5HAW8ArQkDzQCuhzc3NzcBP68NEfMABQdHBuw5BV8FYAA9MzkI9r4ZBg7QyQAWA9CeOwLNCjcCjqkChuA/lm+RAsXTAoP6ASfnEQDytQFJAjWVCkeXAOsA6godAB/cwdAUE0WlBCN/AQUCQRjFD/MRBjHxDQSJbw0jBzUAswBxme+tnIcAYwabAysG8QAjAEMMmxcDqgPKQyDXCMMxA7kUQwD3NXOrAKmFIAAfBC0D3x4BJQDBGdUFAhEgVD8JnwmQJiNWYUzrg0oAGwAUAB0AFnNcACkAFgBP9h3gPfsDOWDKneY2ChglX1UDYD30ABsAFAAdABZzIGRAnwDD8wAjAEEMzRbDqgMB2sAFYwXqAtCnAsS4AwpUJKRtFHsadUz9AMMVbwLpABM1NJEX0ZkCgYMBEyMAxRVvAukAEzUBUFAtmUwSAy4DBTER33EftQHfSwB5MxJ/AjkWKQLzL8E/cwBB6QH9LQDPDtO9ASNriQC5DQANAwCK21EFI91zHwCoL9kBqQcHBwcHKzUDowBvAQohPvU3fAQgHwCyAc8CKQMA5zMSezr7ULgFmDp/LzVQBgEGAi8FYQVgt8AFcTtlQhpCWEmfe5tmZ6IAExsDzQ8t+X8rBKtTAltbAn0jsy8Bl6utPWMDTR8Ei2kRANkDBrNHNysDBzECQWUAcwFpJ3kAiyUhAJ0BUb8AL3EfAbfNAz81KUsFWwF3YQZtAm0A+VEfAzEJDQBRSQCzAQBlAHsAM70GD/v3IZWHBwARKQAxALsjTwHZAeMPEzmXgIHwABIAGQA8AEUAQDt3gdvIEGcQZAkGTRFMdEIVEwK0D64L7REdDNkq09PgADSxB/MDWwfzA1sDWwfzB/MDWwfzA1sDWwNbA1scEvAi28gQZw9QBHUFlgWTBN4IiyZREYkHMAjaVBV0JhxPA00BBCMtSSQ7mzMTJUpMFE0LCAQ2SmyvfUADTzGzVP2QqgPTMlc5dAkGHnkSqAAyD3skNb1OhnpPcagKU0+2tYdJak5vAsY6sEAACikJm2/Dd1YGRRAfJ6kQ+ww3AbkBPw3xS9wE9QY/BM0fgRkdD9GVoAipLeEM8SbnLqWAXiP5KocF8Uv4POELUVFsD10LaQnnOmeBUgMlAREijwrhDT0IcRD3Cs1vDekRSQc9A9lJngCpBwULFR05FbkmFGKwCw05ewb/GvoLkyazEy17AAXXGiUGUQEtGwMA0y7rhbRaNVwgT2MGBwspI8sUrFAkDSlAu3hMGh8HGSWtApVDdEqLUToelyH6PEENai4XUYAH+TwJGVMLhTyiRq9FEhHWPpE9TCJNTDAEOYMsMyePCdMPiQy9fHYBXQklCbUMdRM1ERs3yQg9Bx0xlygnGQglRplgngT7owP3E9UDDwVDCUUHFwO5HDETMhUtBRGBKNsC9zbZLrcCk1aEARsFzw8pH+MQVEfkDu0InwJpA4cl7wAxFSUAGyKfCEdnAGOP3FMJLs8Iy2pwI3gDaxTrZRF3B5UOWwerHDcVwxzlcMxeD4YMKKezCV8BeQmdAWME5wgNNV+MpCBFZ1eLXBifIGVBQ14AAjUMaRWjRMGHfAKPD28SHwE5AXcHPQ0FAnsR8RFvEJkI74YINbkz/DopBFMhhyAVCisDU2zSCysm/Qz8bQGnEmYDEDRBd/Jnr2C6KBgBBx0yyUFkIfULlk/RDKAaxRhGVDIZ6AfDA/ca9yfuQVsGAwOnBxc6UTPyBMELbQiPCUMATQ6nGwfbGG4KdYzUATWPAbudA1uVhwJzkwY7Bw8Aaw+LBX3pACECqwinAAkA0wNbAD0CsQehAB0AiUUBQQMrMwEl6QKTA5cINc8BmTMB9y0EH8cMGQD7O25OAsO1AoBuZqYF4VwCkgJNOQFRKQQJUktVA7N15QDfAE8GF+NLARmvTs8e50cB43MvAMsA/wAJOQcJRQHRAfdxALsBYws1Caa3uQFR7S0AhwAZbwHbAo0A4QA5AIP1AVcAUQVd/QXXAlNNARU1HC9bZQG/AyMBNwERAH0Gz5GpzQsjBHEH1wIQHxXlAu8yB7kFAyLjE9FCyQK94lkAMhoKPAqrCqpgX2Q3CjV2PVQAEh+sPss/UgVVO1c7XDtXO1w7VztcO1c7XDtXO1wDm8Pmw+YKcF9JYe8Mqg3YRMw6TRPfYFVgNhPMLbsUxRXSJVoZQRrAJwkl6FUNDwgt12Y0CDA0eRfAAEMpbINFY4oeNApPHOtTlVT8LR8AtUumM7MNsBsZREQFS3XxYi4WEgomAmSFAmJGX1GzAV83JAKh+wJonAJmDQKfiDgfDwJmPwJmKgRyBIMDfxcDfpY5Cjl7GzmGOicnAmwhAjI6OA4CbcsCbbLzjgM3a0kvAWsA4gDlAE4JB5wMkQECD8YAEbkCdzMCdqZDAnlPRwJ4viFg30WyRvcCfEMCeswCfQ0CfPRIBEiBZygALxlJXEpfGRtK0ALRBQLQ0EsrA4hTA4fqRMmRNgLypV0HAwOyS9JMMSkH001QTbMCi0MCitzFHwshR2sJuwKOOwKOYESbhQKO3QKOYHxRuFM5AQ5S2FSJApP/ApMQAO0AIFUiVbNV1AosHymZijLleGpFPz0Cl6MC77ZYJawAXSkClpMCloCgAK1ZsFoNhVEAPwKWuQKWUlxIXNUCmc8CmWhczl0LHQKcnznGOqECnBoCn58CnryOACETNS4TAp31Ap6WALlBYThh8wKe1wKgcgGtAp6jIwKeUqljzGQrKS8CJ7MCJoICoP8CoFDbAqYzAqXSAqgDAIECp/ZogGi1AAdNaiBq1QKs5wKssgKtawKtBgJXIQJV4AKx5dsDH1JsmwKywRECsuwbbORtZ21MYwMl0QK2YD9DbpQDKUkCuGICuUsZArkue3A6cOUCvR0DLbYDMhUCvoxyBgMzdQK+HnMmc1MCw88CwwhzhnRPOUl05AM8qwEDPJ4DPcMCxYACxksCxhSNAshtVQLISALJUwLJMgJkoQLd1nh9ZXiyeSlL1AMYp2cGAmH4GfeVKHsPXpZevxUCz28Cz3AzT1fW9xejAMqxAs93AS3uA04Wfk8JAtwrAtuOAtJTA1JgA1NjAQUDVZCAjUMEzxrxZEl5A4LSg5EC2ssC2eKEFIRNp0ADhqkAMwNkEoZ1Xf0AWQLfaQLevHd7AuIz7RgB8zQrAfSfAfLWiwLr9wLpdH0DAur9AuroAP1LAb0C7o0C66CWrpcHAu5DA4XkmH1w5HGlAvMHAG0DjhqZlwL3FwORcgOSiwL3nAL53QL4apogmq+/O5siA52HAv7+AR8APZ8gAZ+3AwWRA6ZuA6bdANXJAwZuoYyiCQ0DDE0BEwEjB3EGZb1rCQC/BG/DFY8etxEAG3k9ACcDNxJRA42DAWcrJQCM8wAlAOanC6OVCLsGI6fJBgCvBRnDBvElRUYFFoAFcD9GSDNCKUK8X3kZX8QAls0FOgCQVCGbwTsuYDoZutcONxjOGJHJ/gVfBWAFXwVgBWsFYAVfBWAFXwVgBV8FYAVfBWBOHQjfjW8KCgoKbF7xMwTRA7kGN8PDAMMEr8MA70gxFroFTj5xPnhCR0K+X30/X/AAWBkzswCNBsxzzASm70aCRS4rDDMeLz49fnXfcsH5GcoscQFz13Y4HwVnBXLJycnACNdRYwgICAqEXoWTxgA7P4kACxbZBu21Kw0AjMsTAwkVAOVtJUUsJ1JCuULESUArXy9gPi9AKwnJRQYKTD9LPoA+iT54PnkCkULEUUpDX9NWV3JVEjQAc1w3A3IBE3YnX+g7QiMJb6MKaiszRCUuQrNCxDPMCcwEX9EWJzYREBEEBwIHKn6l33JCNVIfybPJtAltydPUCmhBZw/tEKsZAJOVJU1CLRuxbUHOQAo7P0s+eEJHHA8SJVRPdGM0NVrpvBoKhfUlM0JHHGUQUhEWO1xLSj8MO0ucNAqJIzVCRxv9EFsqKyA4OQgNj2nwZgp5ZNFgE2A1K3YHS2AhQQojJmC7DgpzGG1WYFUZCQYHZO9gHWCdYIVgu2BTYJlwFh8GvRbcXbG8YgtDHrMBwzPVyQonHQgkCyYBgQJ0Ajc4nVqIAwGSCsBPIgDsK3SWEtIVBa5N8gGjAo+kVwVIZwD/AEUSCDweX4ITrRQsJ8K3TwBXFDwEAB0TvzVcAtoTS20RIwDgVgZ9BBImYgA5AL4Coi8LFnezOkCnIQFjAY4KBAPh9RcGsgZSBsEAJctdsWIRu2kTkQstRw7DAcMBKgpPBGIGMDAwKCYnKTQaLg4AKRSVAFwCdl+YUZ0JdicFD3lPAdt1F9ZZKCGxuE3yBxkFVGcA/wBFEgiCBwAOLHQSjxOtQDg1z7deFRMAZ8QTAGtKb1ApIiPHADkAvgKiLy1DFtYCmBiDAlDDWNB0eo7fpaMO/aEVRRv0ATEQZBIODyMEAc8JQhCbDRgzFD4TAEMAu9YBCgCsAOkAm5I3ABwAYxvONnR+MhXJAxgKQyxL2+kkJhMbhQKDBMkSsvF0AD9BNQ6uQC7WqSQHwxEAEEIu1hkhAH2z4iQPwyJPHNWpdyYBRSpnJALzoBAEVPPsH20MxA0CCEQKRgAFyAtFAlMNwwjEDUQJRArELtapMg7DDZgJIw+TGukEIwvDFkMAqAtDEMMMBhioe+QAO3MMRAACrgnEBSPY9Q0FDnbSBoMAB8MSYxkSxAEJAPIJAAB8FWMOFtMc/HcXwxhDAC7DAvOowwAewwJdKDKHAAHDAALrFUQVwwAbwyvzpWMWv8wA/ABpAy++bcYDUKPD0KhDCwKmJ1MAAmMA5+UZwxAagwipBRL/eADfw6fDGOMCGsOjk3l6BwOpo4sAEsMOGxMAA5sAbcMOAAvDp0MJGkMDwgipnNIPAwfIqUMGAOGDAAPzABXDAAcDAAnDAGmTABrDAA7DChjDjnEWAwABYwAOcwAuUyYABsMAF8MIKQANUgC6wy4AA8MADqMq8wCyYgAcIwAB8wqpAAXOCx0V4wAHowBCwwEKAGnDAAuDAB3DAAjDCakABdIAbqcZ3QCZCCkABdIAAAFDAAfjAB2jCCkABqIACYMAGzMAbSMA5sOIAAhjAAhDABTDBAkpAAbSAOOTAAlDC6kOzPtnAAdDAG6kQFAATwAKwwwAA0MACbUDPwAHIwAZgwACE6cDAAojAApDAAoDp/MGwwAJIwADEwAQQwgAFEMAEXMAD5MADfMADcMAGRMOFiMAFUMAbqMWuwHDAMIAE0MLAGkzEgDhUwACQwAEWgAXgwUjAAbYABjDBSYBgzBaAEFNALcQBxUMegAwMngBrA0IZgJ0KxQHBREPd1N0ZzKRJwaIHAZqNT4DqQq8BwngAB4DAwt2AX56T1ocKQNXAh1GATQGC3tOxYNagkgAMQA5CQADAQEAWxLjAIOYNAEzAH7tFRk6TglSAF8NAAlYAQ+S1ACAQwQorQBiAN4dAJ1wPyeTANVzuQDX3AIeEMp9eyMgXiUAEdkBkJizKltbVVAaRMqRAAEAhyQ/SDEz6BmfVwB6ATEsOClKIRcDOF0E/832AFNt5AByAnkCRxGCOs94NjXdAwINGBonDBwPALW2AwICAgAAAAAAAAYDBQMDARrUAwAtAAAAAgEGBgYGBgYFBQUFBQUEBQYHCAkEBQUFBQQAAAICAAAAIgCNAJAAlT0A6gC7ANwApEQAwgCyAK0AqADuAKYA2gCjAOcBCAEDAMcAgQBiANIA1AEDAN4A8gCQAKkBMQDqAN8A3AsBCQ8yO9ra2tq8xuLT1tRJOB0BUgFcNU0BWgFpAWgBWwFMUUlLbhMBUxsNEAs6PhMOACcUKy0vMj5AQENDQ0RFFEYGJFdXV1dZWVhZL1pbXVxcI2NnZ2ZoZypsbnZ1eHh4eHh4enp6enp6enp6enp8fH18e2IARPIASQCaAHgAMgBm+ACOAFcAVwA3AnbvAIsABfj4AGQAk/IAnwBPAGIAZP//sACFAIUAaQBWALEAJAC2AIMCQAJDAPwA5wD+AP4A6AD/AOkA6QDoAOYALwJ7AVEBQAE+AVQBPgE+AT4BOQE4ATgBOAEcAVgXADEQCAEAUx8SHgsdHhYAjgCWAKYAUQBqIAIxAHYAbwCXAxUDJzIDIUlGTzEAkQJPAMcCVwKkAMAClgKWApYClgKWApYCiwKWApYClgKWApYClgKVApUCmAKgApcClgKWApQClAKUApQCkgKVAnUB1AKXAp8ClgKWApUeAIETBQD+DQOfAmECOh8BVBg9AuIZEjMbAU4/G1WZAXusRAFpYQEFA0FPAQYAmTEeIJdyADFoAHEANgCRA5zMk/C2jGINwjMWygIZCaXdfDILBCs5dAE7YnQBugDlhoiHhoiGiYqKhouOjIaNkI6Ij4qQipGGkoaThpSSlYaWhpeKmIaZhpqGm4aci52QnoqfhuIC4XTpAt90AIp0LHSoAIsAdHQEQwRABEIERQRDBEkERgRBBEcESQRIBEQERgRJAJ5udACrA490ALxuAQ10ANFZdHQA13QCFHQA/mJ0AP4BIQD+APwA/AD9APwDhGZ03ASMK23HAP4A/AD8AP0A/CR0dACRYnQA/gCRASEA/gCRAvQA/gCRA4RmdNwEjCttxyR0AP9idAEhAP4A/gD8APwA/QD8AP8A/AD8AP0A/AOEZnTcBIwrbcckdHQAkWJ0ASEA/gCRAP4AkQL0AP4AkQOEZnTcBIwrbcckdAJLAT50AlIBQXQCU8l0dAJfdHQDpgL0A6YDpgOnA6cDpwOnA4RmdNwEjCttxyR0dACRYnQBIQOmAJEDpgCRAvQDpgCRA4RmdNwEjCttxyR0BDh0AJEEOQCRDpU5dSgCADR03gV2CwArdAEFAM5iCnR0AF1iAAYcOgp0dACRCnQAXAEIwWZ0CnRmdHQAkWZ0CnRmdEXgAFF03gp0dEY0tlT2u3SOAQTwscwhjZZKrhYcBSfFp9XNbKiVDOD2b+cpe4/Z17mQnbtzzhaeQtE2GGj0IDNTjRUSyTxxw/RPHW/+vS7d1NfRt9z9QPZg4X7QFfhCnkvgNPIItOsC2eV6hPannZNHlZ9xrwZXIMOlu3jSoQSq78WEjwLjw1ELSlF1aBvfzwk5ZX7AUvQzjPQKbDuQ+sm4wNOp4A6AdVuRS0t1y/DZpg4R6m7FNjM9HgvW7Bi88zaMjOo6lM8wtBBdj8LP4ylv3zCXPhebMKJc066o9sF71oFW/8JXu86HJbwDID5lzw5GWLR/LhT0Qqnp2JQxNZNfcbLIzPy+YypqRm/lBmGmex+82+PisxUumSeJkALIT6rJezxMH+CTJmQtt5uwTVbL3ptmjDUQzlSIvWi8Tl7ng1NpuRn1Ng4n14Qc+3Iil7OwkvNWogLSPkn3pihIFytyIGmMhOe3n1tWsuMy9BdKyqF4Z3v2SgggTL9KVvMXPnCbRe+oOuFFP3HejBG/w9gvmfNYvg6JuWia2lcSSN1uIjBktzoIazOHPJZ7kKHPz8mRWVdW3lA8WGF9dQF6Bm673boov3BUWDU2JNcahR23GtfHKLOz/viZ+rYnZFaIznXO67CYEJ1fXuTRpZhYZkKe54xeoagkNGLs+NTZHE0rX45/XvQ2RGADX6vcAvdxIUBV27wxGm2zjZo4X3ILgAlrOFheuZ6wtsvaIj4yLY7qqawlliaIcrz2G+c3vscAnCkCuMzMmZvMfu9lLwTvfX+3cVSyPdN9ZwgDZhfjRgNJcLiJ67b9xx8JHswprbiE3v9UphotAPIgnXVIN5KmMc0piXhc6cChPnN+MRhG9adtdttQTTwSIpl8I4/j//d3sz1326qTBTpPRM/Hgh3kzqEXs8ZAk4ErQhNO8hzrQ0DLkWMA/N+91tn2MdOJnWC2FCZehkQrwzwbKOjhvZsbM95QoeL9skYyMf4srVPVJSgg7pOLUtr/n9eT99oe9nLtFRpjA9okV2Kj8h9k5HaC0oivRD8VyXkJ81tcd4fHNXPCfloIQasxsuO18/46dR2jgul/UIet2G0kRvnyONMKhHs6J26FEoqSqd+rfYjeEGwHWVDpX1fh1jBBcKGMqRepju9Y00mDVHC+Xdij/j44rKfvfjGinNs1jO/0F3jB83XCDINN/HB84axlP+3E/klktRo+vl3U/aiyMJbIodE1XSsDn6UAzIoMtUObY2+k/4gY/l+AkZJ5Sj2vQrkyLm3FoxjhDX+31UXBFf9XrAH31fFqoBmDEZvhvvpnZ87N+oZEu7U9O/nnk+QWj3x8uyoRbEnf+O5UMr9i0nHP38IF5AvzrBW8YWBUR0mIAzIvndQq9N3v/Jto3aPjPXUPl8ASdPPyAp7jENf8bk7VMM9ol9XGmlBmeDMuGqt+WzuL6CXAxXjIhCPM5vACchgMJ/8XBGLO/D1isVvGhwwHHr1DLaI5mn2Jr/b1pUD90uciDaS8cXNDzCWvNmT/PhQe5e8nTnnnkt8Ds/SIjibcum/fqDhKopxAY8AkSrPn+IGDEKOO+U3XOP6djFs2H5N9+orhOahiQk5KnEUWa+CzkVzhp8bMHRbg81qhjjXuIKbHjSLSIBKWqockGtKinY+z4/RdBUF6pcc3JmnlxVcNgrI4SEzKUZSwcD2QCyxzKve+gAmg6ZuSRkpPFa6mfThu7LJNu3H5K42uCpNvPAsoedolKV/LHe/eJ+BbaG5MG0NaSGVPRUmNFMFFSSpXEcXwbVh7UETOZZtoVNRGOIbbkig3McEtR68cG0RZAoJevWYo7Dg/lZ1CQzblWeUvVHmr8fY4Nqd9JJiH/zEX24mJviH60fAyFr0A3c4bC1j3yZU60VgJxXn8JgJXLUIsiBnmKmMYz+7yBQFBvqb2eYnuW59joZBf56/wXvWIR4R8wTmV80i1mZy+S4+BUES+hzjk0uXpC///z/IlqHZ1monzlXp8aCfhGKMti73FI1KbL1q6IKO4fuBuZ59gagjn5xU79muMpHXg6S+e+gDM/U9BKLHbl9l6o8czQKl4RUkJJiqftQG2i3BMg/TQlUYFkJDYBOOvAugYuzYSDnZbDDd/aSd9x0Oe6F+bJcHfl9+gp6L5/TgA+BdFFovbfCrQ40s5vMPw8866pNX8zyFGeFWdxIpPVp9Rg1UPOVFbFZrvaFq/YAzHQgqMWpahMYfqHpmwXfHL1/kpYmGuHFwT55mQu0dylfNuq2Oq0hTMCPwqfxnuBIPLXfci4Y1ANy+1CUipQxld/izVh16WyG2Q0CQQ9NqtAnx1HCHwDj7sYxOSB0wopZSnOzxQOcExmxrVTF2BkOthVpGfuhaGECfCJpJKpjnihY+xOT2QJxN61+9K6QSqtv2Shr82I3jgJrqBg0wELFZPjvHpvzTtaJnLK6Vb97Yn933koO/saN7fsjwNKzp4l2lJVx2orjCGzC/4ZL4zCver6aQYtC5sdoychuFE6ufOiog+VWi5UDkbmvmtah/3aArEBIi39s5ILUnlFLgilcGuz9CQshEY7fw2ouoILAYPVT/gyAIq3TFAIwVsl+ktkRz/qGfnCDGrm5gsl/l9QdvCWGsjPz3dU7XuqKfdUrr/6XIgjp4rey6AJBmCmUJMjITHVdFb5m1p+dLMCL8t55zD42cmftmLEJC0Da04YiRCVUBLLa8D071/N5UBNBXDh0LFsmhV/5B5ExOB4j3WVG/S3lfK5o+V6ELHvy6RR9n4ac+VsK4VE4yphPvV+kG9FegTBH4ZRXL2HytUHCduJazB/KykjfetYxOXTLws267aGOd+I+JhKP//+VnXmS90OD/jvLcVu0asyqcuYN1mSb6XTlCkqv1vigZPIYwNF/zpWcT1GR/6aEIRjkh0yhg4LXJfaGobYJTY4JI58KiAKgmmgAKWdl5nYCeLqavRJGQNuYuZtZFGx+IkI4w4NS2xwbetNMunOjBu/hmKCI/w7tfiiyUd//4rbTeWt4izBY8YvGIN6vyKYmP/8X8wHKCeN+WRcKM70+tXKNGyevU9H2Dg5BsljnTf8YbsJ1TmMs74Ce2XlHisleguhyeg44rQOHZuw/6HTkhnnurK2d62q6yS7210SsAIaR+jXMQA+svkrLpsUY+F30Uw89uOdGAR6vo4FIME0EfVVeHTu6eKicfhSqOeXJhbftcd08sWEnNUL1C9fnprTgd83IMut8onVUF0hvqzZfHduPjbjwEXIcoYmy+P6tcJZHmeOv6VrvEdkHDJecjHuHeWANe79VG662qTjA/HCvumVv3qL+LrOcpqGps2ZGwQdFJ7PU4iuyRlBrwfO+xnPyr47s2cXVbWzAyznDiBGjCM3ksxjjqM62GE9C8f5U38kB3VjtabKp/nRdvMESPGDG90bWRLAt1Qk5DyLuazRR1YzdC1c+hZXvAWV8xA72S4A8B67vjVhbba3MMop293FeEXpe7zItMWrJG/LOH9ByOXmYnNJfjmfuX9KbrpgLOba4nZ+fl8Gbdv/ihv+6wFGKHCYrVwmhFC0J3V2bn2tIB1wCc1CST3d3X2OyxhguXcs4sm679UngzofuSeBewMFJboIQHbUh/m2JhW2hG9DIvG2t7yZIzKBTz9wBtnNC+2pCRYhSIuQ1j8xsz5VvqnyUIthvuoyyu7fNIrg/KQUVmGQaqkqZk/Vx5b33/gsEs8yX7SC1J+NV4icz6bvIE7C5G6McBaI8rVg56q5QBJWxn/87Q1sPK4+sQa8fLU5gXo4paaq4cOcQ4wR0VBHPGjKh+UlPCbA1nLXyEUX45qZ8J7/Ln4FPJE2TdzD0Z8MLSNQiykMMmSyOCiFfy84Rq60emYB2vD09KjYwsoIpeDcBDTElBbXxND72yhd9pC/1CMid/5HUMvAL27OtcIJDzNKpRPNqPOpyt2aPGz9QWIs9hQ9LiX5s8m9hjTUu/f7MyIatjjd+tSfQ3ufZxPpmJhTaBtZtKLUcfOCUqADuO+QoH8B9v6U+P0HV1GLQmtoNFTb3s74ivZgjES0qfK+8RdGgBbcCMSy8eBvh98+et1KIFqSe1KQPyXULBMTsIYnysIwiZBJYdI20vseV+wuJkcqGemehKjaAb9L57xZm3g2zX0bZ2xk/fU+bCo7TlnbW7JuF1YdURo/2Gw7VclDG1W7LOtas2LX4upifZ/23rzpsnY/ALfRgrcWP5hYmV9VxVOQA1fZvp9F2UNU+7d7xRyVm5wiLp3/0dlV7vdw1PMiZrbDAYzIVqEjRY2YU03sJhPnlwIPcZUG5ltL6S8XCxU1eYS5cjr34veBmXAvy7yN4ZjArIG0dfD/5UpBNlX1ZPoxJOwyqRi3wQWtOzd4oNKh0LkoTm8cwqgIfKhqqGOhwo71I+zXnMemTv2B2AUzABWyFztGgGULjDDzWYwJUVBTjKCn5K2QGMK1CQT7SzziOjo+BhAmqBjzuc3xYym2eedGeOIRJVyTwDw37iCMe4g5Vbnsb5ZBdxOAnMT7HU4DHpxWGuQ7GeiY30Cpbvzss55+5Km1YsbD5ea3NI9QNYIXol5apgSu9dZ8f8xS5dtHpido5BclDuLWY4lhik0tbJa07yJhH0BOyEut/GRbYTS6RfiTYWGMCkNpfSHi7HvdiTglEVHKZXaVhezH4kkXiIvKopYAlPusftpE4a5IZwvw1x/eLvoDIh/zpo9FiQInsTb2SAkKHV42XYBjpJDg4374XiVb3ws4qM0s9eSQ5HzsMU4OZJKuopFjBM+dAZEl8RUMx5uU2N486Kr141tVsGQfGjORYMCJAMsxELeNT4RmWjRcpdTGBwcx6XN9drWqPmJzcrGrH4+DRc7+n1w3kPZwu0BkNr6hQrqgo7JTB9A5kdJ/H7P4cWBMwsmuixAzJB3yrQpnGIq90lxAXLzDCdn1LPibsRt7rHNjgQBklRgPZ8vTbjXdgXrTWQsK5MdrXXQVPp0Rinq3frzZKJ0qD6Qhc40VzAraUXlob1gvkhK3vpmHgI6FRlQZNx6eRqkp0zy4AQlX813fAPtL3jMRaitGFFjo0zmErloC+h+YYdVQ6k4F/epxAoF0BmqEoKNTt6j4vQZNQ2BoqF9Vj53TOIoNmDiu9Xp15RkIgQIGcoLpfoIbenzpGUAtqFJp5W+LLnx38jHeECTJ/navKY1NWfN0sY1T8/pB8kIH3DU3DX+u6W3YwpypBMYOhbSxGjq84RZ84fWJow8pyHqn4S/9J15EcCMsXqrfwyd9mhiu3+rEo9pPpoJkdZqHjra4NvzFwuThNKy6hao/SlLw3ZADUcUp3w3SRVfW2rhl80zOgTYnKE0Hs2qp1J6H3xqPqIkvUDRMFDYyRbsFI3M9MEyovPk8rlw7/0a81cDVLmBsR2ze2pBuKb23fbeZC0uXoIvDppfTwIDxk1Oq2dGesGc+oJXWJLGkOha3CX+DUnzgAp9HGH9RsPZN63Hn4RMA5eSVhPHO+9RcRb/IOgtW31V1Q5IPGtoxPjC+MEJbVlIMYADd9aHYWUIQKopuPOHmoqSkubnAKnzgKHqgIOfW5RdAgotN6BN+O2ZYHkuemLnvQ8U9THVrS1RtLmKbcC7PeeDsYznvqzeg6VCNwmr0Yyx1wnLjyT84BZz3EJyCptD3yeueAyDWIs0L2qs/VQ3HUyqfrja0V1LdDzqAikeWuV4sc7RLIB69jEIBjCkyZedoUHqCrOvShVzyd73OdrJW0hPOuQv2qOoHDc9xVb6Yu6uq3Xqp2ZaH46A7lzevbxQEmfrzvAYSJuZ4WDk1Hz3QX1LVdiUK0EvlAGAYlG3Md30r7dcPN63yqBCIj25prpvZP0nI4+EgWoFG95V596CurXpKRBGRjQlHCvy5Ib/iW8nZJWwrET3mgd6mEhfP4KCuaLjopWs7h+MdXFdIv8dHQJgg1xi1eYqB0uDYjxwVmri0Sv5XKut/onqapC+FQiC2C1lvYJ9MVco6yDYsS3AANUfMtvtbYI2hfwZatiSsnoUeMZd34GVjkMMKA+XnjJpXgRW2SHTZplVowPmJsvXy6w3cfO1AK2dvtZEKTkC/TY9LFiKHCG0DnrMQdGm2lzlBHM9iEYynH2UcVMhUEjsc0oDBTgo2ZSQ1gzkAHeWeBXYFjYLuuf8yzTCy7/RFR81WDjXMbq2BOH5dURnxo6oivmxL3cKzKInlZkD31nvpHB9Kk7GfcfE1t+1V64b9LtgeJGlpRFxQCAqWJ5DoY77ski8gsOEOr2uywZaoO/NGa0X0y1pNQHBi3b2SUGNpcZxDT7rLbBf1FSnQ8guxGW3W+36BW0gBje4DOz6Ba6SVk0xiKgt+q2JOFyr4SYfnu+Ic1QZYIuwHBrgzr6UvOcSCzPTOo7D6IC4ISeS7zkl4h+2VoeHpnG/uWR3+ysNgPcOIXQbv0n4mr3BwQcdKJxgPSeyuP/z1Jjg4e9nUvoXegqQVIE30EHx5GHv+FAVUNTowYDJgyFhf5IvlYmEqRif6+WN1MkEJmDcQITx9FX23a4mxy1AQRsOHO/+eImX9l8EMJI3oPWzVXxSOeHU1dUWYr2uAA7AMb+vAEZSbU3qob9ibCyXeypEMpZ6863o6QPqlqGHZkuWABSTVNd4cOh9hv3qEpSx2Zy/DJMP6cItEmiBJ5PFqQnDEIt3NrA3COlOSgz43D7gpNFNJ5MBh4oFzhDPiglC2ypsNU4ISywY2erkyb1NC3Qh/IfWj0eDgZI4/ln8WPfBsT3meTjq1Uqt1E7Zl/qftqkx6aM9KueMCekSnMrcHj1CqTWWzEzPsZGcDe3Ue4Ws+XFYVxNbOFF8ezkvQGR6ZOtOLU2lQEnMBStx47vE6Pb7AYMBRj2OOfZXfisjJnpTfSNjo6sZ6qSvNxZNmDeS7Gk3yYyCk1HtKN2UnhMIjOXUzAqDv90lx9O/q/AT1ZMnit5XQe9wmQxnE/WSH0CqZ9/2Hy+Sfmpeg8RwsHI5Z8kC8H293m/LHVVM/BA7HaTJYg5Enk7M/xWpq0192ACfBai2LA/qrCjCr6Dh1BIMzMXINBmX96MJ5Hn2nxln/RXPFhwHxUmSV0EV2V0jm86/dxxuYSU1W7sVkEbN9EzkG0QFwPhyHKyb3t+Fj5WoUUTErcazE/N6EW6Lvp0d//SDPj7EV9UdJN+Amnf3Wwk3A0SlJ9Z00yvXZ7n3z70G47Hfsow8Wq1JXcfwnA+Yxa5mFsgV464KKP4T31wqIgzFPd3eCe3j5ory5fBF2hgCFyVFrLzI9eetNXvM7oQqyFgDo4CTp/hDV9NMX9JDHQ/nyHTLvZLNLF6ftn2OxjGm8+PqOwhxnPHWipkE/8wbtyri80Sr7pMNkQGMfo4ZYK9OcCC4ESVFFbLMIvlxSoRqWie0wxqnLfcLSXMSpMMQEJYDVObYsXIQNv4TGNwjq1kvT1UOkicTrG3IaBZ3XdScS3u8sgeZPVpOLkbiF940FjbCeNRINNvDbd01EPBrTCPpm12m43ze1bBB59Ia6Ovhnur/Nvx3IxwSWol+3H2qfCJR8df6aQf4v6WiONxkK+IqT4pKQrZK/LplgDI/PJZbOep8dtbV7oCr6CgfpWa8NczOkPx81iSHbsNhVSJBOtrLIMrL31LK9TqHqAbAHe0RLmmV806kRLDLNEhUEJfm9u0sxpkL93Zgd6rw+tqBfTMi59xqXHLXSHwSbSBl0EK0+loECOPtrl+/nsaFe197di4yUgoe4jKoAJDXc6DGDjrQOoFDWZJ9HXwt8xDrQP+7aRwWKWI1GF8s8O4KzxWBBcwnl3vnl1Oez3oh6Ea1vjR7/z7DDTrFtqU2W/KAEzAuXDNZ7MY73MF216dzdSbWmUp4lcm7keJfWaMHgut9x5C9mj66Z0lJ+yhsjVvyiWrfk1lzPOTdhG15Y7gQlXtacvI7qv/XNSscDwqkgwHT/gUsD5yB7LdRRvJxQGYINn9hTpodKFVSTPrtGvyQw+HlRFXIkodErAGu9Iy1YpfSPc3jkFh5CX3lPxv7aqjE/JAfTIpEjGb/H7MO0e2vsViSW1qa/Lmi4/n4DEI3g7lYrcanspDfEpKkdV1OjSLOy0BCUqVoECaB55vs06rXl4jqmLsPsFM/7vYJ0vrBhDCm/00A/H81l1uekJ/6Lml3Hb9+NKiLqATJmDpyzfYZFHumEjC662L0Bwkxi7E9U4cQA0XMVDuMYAIeLMPgQaMVOd8fmt5SflFIfuBoszeAw7ow5gXPE2Y/yBc/7jExARUf/BxIHQBF5Sn3i61w4z5xJdCyO1F1X3+3ax+JSvMeZ7S6QSKp1Fp/sjYz6Z+VgCZzibGeEoujryfMulH7Rai5kAft9ebcW50DyJr2uo2z97mTWIu45YsSnNSMrrNUuG1XsYBtD9TDYzQffKB87vWbkM4EbPAFgoBV4GQS+vtFDUqOFAoi1nTtmIOvg38N4hT2Sn8r8clmBCXspBlMBYTnrqFJGBT3wZOzAyJDre9dHH7+x7qaaKDOB4UQALD5ecS0DE4obubQEiuJZ0EpBVpLuYcce8Aa4PYd/V4DLDAJBYKQPCWTcrEaZ5HYbJi11Gd6hjGom1ii18VHYnG28NKpkz2UKVPxlhYSp8uZr367iOmoy7zsxehW9wzcy2zG0a80PBMCRQMb32hnaHeOR8fnNDzZhaNYhkOdDsBUZ3loDMa1YP0uS0cjUP3b/6DBlqmZOeNABDsLl5BI5QJups8uxAuWJdkUB/pO6Zax6tsg7fN5mjjDgMGngO+DPcKqiHIDbFIGudxtPTIyDi9SFMKBDcfdGQRv41q1AqmxgkVfJMnP8w/Bc7N9/TR6C7mGObFqFkIEom8sKi2xYqJLTCHK7cxzaZvqODo22c3wisBCP4HeAgcRbNPAsBkNRhSmD48dHupdBRw4mIvtS5oeF6zeT1KMCyhMnmhpkFAGWnGscoNkwvQ8ZM5lE/vgTHFYL99OuNxdFBxTEDd5v2qLR8y9WkXsWgG6kZNndFG+pO/UAkOCipqIhL3hq7cRSdrCq7YhUsTocEcnaFa6nVkhnSeRYUA1YO0z5itF9Sly3VlxYDw239TJJH6f3EUfYO5lb7bcFcz8Bp7Oo8QmnsUHOz/fagVUBtKEw1iT88j+aKkv8cscKNkMxjYr8344D1kFoZ7/td1W6LCNYN594301tUGRmFjAzeRg5vyoM1F6+bJZ/Q54jN/k8SFd3DxPTYaAUsivsBfgTn7Mx8H2SpPt4GOdYRnEJOH6jHM2p6SgB0gzIRq6fHxGMmSmqaPCmlfwxiuloaVIitLGN8wie2CDWhkzLoCJcODh7KIOAqbHEvXdUxaS4TTTs07Clzj/6GmVs9kiZDerMxEnhUB6QQPlcfqkG9882RqHoLiHGBoHfQuXIsAG8GTAtao2KVwRnvvam8jo1e312GQAKWEa4sUVEAMG4G6ckcONDwRcg1e2D3+ohXgY4UAWF8wHKQMrSnzCgfFpsxh+aHXMGtPQroQasRY4U6UdG0rz1Vjbka0MekOGRZQEvqQFlxseFor8zWFgHek3v29+WqN6gaK5gZOTOMZzpQIC1201LkMCXild3vWXSc5UX9xcFYfbRPzGFa1FDcPfPB/jUEq/FeGt419CI3YmBlVoHsa4KdcwQP5ZSwHHhFJ7/Ph/Rap/4vmG91eDwPP0lDfCDRCLszTqfzM71xpmiKi2HwS4WlqvGNwtvwF5Dqpn6KTq8ax00UMPkxDcZrEEEsIvHiUXXEphdb4GB4FymlPwBz4Gperqq5pW7TQ6/yNRhW8VT5NhuP0udlxo4gILq5ZxAZk8ZGh3g4CqxJlPKY7AQxupfUcVpWT5VItp1+30UqoyP4wWsRo3olRRgkWZZ2ZN6VC3OZFeXB8NbnUrSdikNptD1QiGuKkr8EmSR/AK9Rw+FF3s5uwuPbvHGiPeFOViltMK7AUaOsq9+x9cndk3iJEE5LKZRlWJbKOZweROzmPNVPkjE3K/TyA57Rs68TkZ3MR8akKpm7cFjnjPd/DdkWjgYoKHSr5Wu5ssoBYU4acRs5g2DHxUmdq8VXOXRbunD8QN0LhgkssgahcdoYsNvuXGUK/KXD/7oFb+VGdhqIn02veuM5bLudJOc2Ky0GMaG4W/xWBxIJcL7yliJOXOpx0AkBqUgzlDczmLT4iILXDxxtRR1oZa2JWFgiAb43obrJnG/TZC2KSK2wqOzRZTXavZZFMb1f3bXvVaNaK828w9TO610gk8JNf3gMfETzXXsbcvRGCG9JWQZ6+cDPqc4466Yo2RcKH+PILeKOqtnlbInR3MmBeGG3FH10yzkybuqEC2HSQwpA0An7d9+73BkDUTm30bZmoP/RGbgFN+GrCOfADgqr0WbI1a1okpFms8iHYw9hm0zUvlEMivBRxModrbJJ+9/p3jUdQQ9BCtQdxnOGrT5dzRUmw0593/mbRSdBg0nRvRZM5/E16m7ZHmDEtWhwvfdZCZ8J8M12W0yRMszXamWfQTwIZ4ayYktrnscQuWr8idp3PjT2eF/jmtdhIfcpMnb+IfZY2FebW6UY/AK3jP4u3Tu4zE4qlnQgLFbM19EBIsNf7KhjdbqQ/D6yiDb+NlEi2SKD+ivXVUK8ib0oBo366gXkR8ZxGjpJIDcEgZPa9TcYe0TIbiPl/rPUQDu3XBJ9X/GNq3FAUsKsll57DzaGMrjcT+gctp+9MLYXCq+sqP81eVQ0r9lt+gcQfZbACRbEjvlMskztZG8gbC8Qn9tt26Q7y7nDrbZq/LEz7kR6Jc6pg3N9rVX8Y5MJrGlML9p9lU4jbTkKqCveeZUJjHB03m2KRKR2TytoFkTXOLg7keU1s1lrPMQJpoOKLuAAC+y1HlJucU6ysB5hsXhvSPPLq5J7JtnqHKZ4vYjC4Vy8153QY+6780xDuGARsGbOs1WqzH0QS765rnSKEbbKlkO8oI/VDwUd0is13tKpqILu1mDJFNy/iJAWcvDgjxvusIT+PGz3ST/J9r9Mtfd0jpaGeiLYIqXc7DiHSS8TcjFVksi66PEkxW1z6ujbLLUGNNYnzOWpH8BZGK4bCK7iR+MbIv8ncDAz1u4StN3vTTzewr9IQjk9wxFxn+6N1ddKs0vffJiS08N3a4G1SVrlZ97Q/M+8G9fe5AP6d9/Qq4WRnORVhofPIKEdCr3llspUfE0oKIIYoByBRPh+bX1HLS3JWGJRhIvE1aW4NTd8ePi4Z+kXb+Z8snYfSNcqijhAgVsx4RCM54cXUiYkjeBmmC4ajOHrChoELscJJC7+9jjMjw5BagZKlgRMiSNYz7h7vvZIoQqbtQmspc0cUk1G/73iXtSpROl5wtLgQi0mW2Ex8i3WULhcggx6E1LMVHUsdc9GHI1PH3U2Ko0PyGdn9KdVOLm7FPBui0i9a0HpA60MsewVE4z8CAt5d401Gv6zXlIT5Ybit1VIA0FCs7wtvYreru1fUyW3oLAZ/+aTnZrOcYRNVA8spoRtlRoWflsRClFcgzkqiHOrf0/SVw+EpVaFlJ0g4Kxq1MMOmiQdpMNpte8lMMQqm6cIFXlnGbfJllysKDi+0JJMotkqgIxOSQgU9dn/lWkeVf8nUm3iwX2Nl3WDw9i6AUK3vBAbZZrcJpDQ/N64AVwjT07Jef30GSSmtNu2WlW7YoyW2FlWfZFQUwk867EdLYKk9VG6JgEnBiBxkY7LMo4YLQJJlAo9l/oTvJkSARDF/XtyAzM8O2t3eT/iXa6wDN3WewNmQHdPfsxChU/KtLG2Mn8i4ZqKdSlIaBZadxJmRzVS/o4yA65RTSViq60oa395Lqw0pzY4SipwE0SXXsKV+GZraGSkr/RW08wPRvqvSUkYBMA9lPx4m24az+IHmCbXA+0faxTRE9wuGeO06DIXa6QlKJ3puIyiuAVfPr736vzo2pBirS+Vxel3TMm3JKhz9o2ZoRvaFVpIkykb0Hcm4oHFBMcNSNj7/4GJt43ogonY2Vg4nsDQIWxAcorpXACzgBqQPjYsE/VUpXpwNManEru4NwMCFPkXvMoqvoeLN3qyu/N1eWEHttMD65v19l/0kH2mR35iv/FI+yjoHJ9gPMz67af3Mq/BoWXqu3rphiWMXVkmnPSEkpGpUI2h1MThideGFEOK6YZHPwYzMBvpNC7+ZHxPb7epfefGyIB4JzO9DTNEYnDLVVHdQyvOEVefrk6Uv5kTQYVYWWdqrdcIl7yljwwIWdfQ/y+2QB3eR/qxYObuYyB4gTbo2in4PzarU1sO9nETkmj9/AoxDA+JM3GMqQtJR4jtduHtnoCLxd1gQUscHRB/MoRYIEsP2pDZ9KvHgtlk1iTbWWbHhohwFEYX7y51fUV2nuUmnoUcqnWIQAAgl9LTVX+Bc0QGNEhChxHR4YjfE51PUdGfsSFE6ck7BL3/hTf9jLq4G1IafINxOLKeAtO7quulYvH5YOBc+zX7CrMgWnW47/jfRsWnJjYYoE7xMfWV2HN2iyIqLI";const qm=new Map([[8217,"apostrophe"],[8260,"fraction slash"],[12539,"middle dot"]]),Vm=4;function a7(r){let e=0;function t(){return r[e++]<<8|r[e++]}let n=t(),s=1,i=[0,1];for(let I=1;I<n;I++)i.push(s+=t());let o=t(),a=e;e+=o;let c=0,l=0;function u(){return c==0&&(l=l<<8|r[e++],c=8),l>>--c&1}const f=31,h=2**f,d=h>>>1,p=d>>1,g=h-1;let y=0;for(let I=0;I<f;I++)y=y<<1|u();let x=[],A=0,w=h;for(;;){let I=Math.floor(((y-A+1)*s-1)/w),E=0,P=n;for(;P-E>1;){let F=E+P>>>1;I<i[F]?P=F:E=F}if(E==0)break;x.push(E);let T=A+Math.floor(w*i[E]/s),D=A+Math.floor(w*i[E+1]/s)-1;for(;((T^D)&d)==0;)y=y<<1&g|u(),T=T<<1&g,D=D<<1&g|1;for(;T&~D&p;)y=y&d|y<<1&g>>>1|u(),T=T<<1^d,D=(D^d)<<1|d|1;A=T,w=1+D-T}let O=n-4;return x.map(I=>{switch(I-O){case 3:return O+65792+(r[a++]<<16|r[a++]<<8|r[a++]);case 2:return O+256+(r[a++]<<8|r[a++]);case 1:return O+r[a++];default:return I-1}})}function c7(r){let e=0;return()=>r[e++]}function v8(r){return c7(a7(l7(r)))}function l7(r){let e=[];[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"].forEach((s,i)=>e[s.charCodeAt(0)]=i);let t=r.length,n=new Uint8Array(6*t>>3);for(let s=0,i=0,o=0,a=0;s<t;s++)a=a<<6|e[r.charCodeAt(s)],o+=6,o>=8&&(n[i++]=a>>(o-=8));return n}function u7(r){return r&1?~r>>1:r>>1}function f7(r,e){let t=Array(r);for(let n=0,s=0;n<r;n++)t[n]=s+=u7(e());return t}function mu(r,e=0){let t=[];for(;;){let n=r(),s=r();if(!s)break;e+=n;for(let i=0;i<s;i++)t.push(e+i);e+=s+1}return t}function A8(r){return xu(()=>{let e=mu(r);if(e.length)return e})}function I8(r){let e=[];for(;;){let t=r();if(t==0)break;e.push(h7(t,r))}for(;;){let t=r()-1;if(t<0)break;e.push(d7(t,r))}return e.flat()}function xu(r){let e=[];for(;;){let t=r(e.length);if(!t)break;e.push(t)}return e}function S8(r,e,t){let n=Array(r).fill().map(()=>[]);for(let s=0;s<e;s++)f7(r,t).forEach((i,o)=>n[o].push(i));return n}function h7(r,e){let t=1+e(),n=e(),s=xu(e);return S8(s.length,1+r,e).flatMap((o,a)=>{let[c,...l]=o;return Array(s[a]).fill().map((u,f)=>{let h=f*n;return[c+f*t,l.map(d=>d+h)]})})}function d7(r,e){let t=1+e();return S8(t,1+r,e).map(s=>[s[0],s.slice(1)])}function p7(r){let e=[],t=mu(r);return s(n([]),[]),e;function n(i){let o=r(),a=xu(()=>{let c=mu(r).map(l=>t[l]);if(c.length)return n(c)});return{S:o,B:a,Q:i}}function s({S:i,B:o},a,c){if(!(i&4&&c===a[a.length-1])){i&2&&(c=a[a.length-1]),i&1&&e.push(a);for(let l of o)for(let u of l.Q)s(l,[...a,u],c)}}}function g7(r){return r.toString(16).toUpperCase().padStart(2,"0")}function O8(r){return`{${g7(r)}}`}function b7(r){let e=[];for(let t=0,n=r.length;t<n;){let s=r.codePointAt(t);t+=s<65536?1:2,e.push(s)}return e}function rl(r){let t=r.length;if(t<4096)return String.fromCodePoint(...r);let n=[];for(let s=0;s<t;)n.push(String.fromCodePoint(...r.slice(s,s+=4096)));return n.join("")}function y7(r,e){let t=r.length,n=t-e.length;for(let s=0;n==0&&s<t;s++)n=r[s]-e[s];return n}var m7="AEUDTAHBCFQATQDRADAAcgAgADQAFAAsABQAHwAOACQADQARAAoAFwAHABIACAAPAAUACwAFAAwABAAQAAMABwAEAAoABQAIAAIACgABAAQAFAALAAIACwABAAIAAQAHAAMAAwAEAAsADAAMAAwACgANAA0AAwAKAAkABAAdAAYAZwDSAdsDJgC0CkMB8xhZAqfoC190UGcThgBurwf7PT09Pb09AjgJum8OjDllxHYUKXAPxzq6tABAxgK8ysUvWAgMPT09PT09PSs6LT2HcgWXWwFLoSMEEEl5RFVMKvO0XQ8ExDdJMnIgsj26PTQyy8FfEQ8AY8IPAGcEbwRwBHEEcgRzBHQEdQR2BHcEeAR6BHsEfAR+BIAEgfndBQoBYgULAWIFDAFiBNcE2ATZBRAFEQUvBdALFAsVDPcNBw13DYcOMA4xDjMB4BllHI0B2grbAMDpHLkQ7QHVAPRNQQFnGRUEg0yEB2uaJF8AJpIBpob5AERSMAKNoAXqaQLUBMCzEiACnwRZEkkVsS7tANAsBG0RuAQLEPABv9HICTUBXigPZwRBApMDOwAamhtaABqEAY8KvKx3LQ4ArAB8UhwEBAVSagD8AEFZADkBIadVj2UMUgx5Il4ANQC9AxIB1BlbEPMAs30CGxlXAhwZKQIECBc6EbsCoxngzv7UzRQA8M0BawL6ZwkN7wABAD33OQRcsgLJCjMCjqUChtw/km+NAsXPAoP2BT84PwURAK0RAvptb6cApQS/OMMey5HJS84UdxpxTPkCogVFITaTOwERAK5pAvkNBOVyA7q3BKlOJSALAgUIBRcEdASpBXqzABXFSWZOawLCOqw//AolCZdvv3dSBkEQGyelEPcMMwG1ATsN7UvYBPEGOwTJH30ZGQ/NlZwIpS3dDO0m4y6hgFoj9SqDBe1L9DzdC01RaA9ZC2UJ4zpjgU4DIQENIosK3Q05CG0Q8wrJaw3lEUUHOQPVSZoApQcBCxEdNRW1JhBirAsJOXcG+xr2C48mrxMpevwF0xohBk0BKRr/AM8u54WwWjFcHE9fBgMLJSPHFKhQIA0lQLd4SBobBxUlqQKRQ3BKh1E2HpMh9jw9DWYuE1F8B/U8BRlPC4E8nkarRQ4R0j6NPUgiSUwsBDV/LC8niwnPD4UMuXxyAVkJIQmxDHETMREXN8UIOQcZLZckJxUIIUaVYJoE958D8xPRAwsFPwlBBxMDtRwtEy4VKQUNgSTXAvM21S6zAo9WgAEXBcsPJR/fEFBH4A7pCJsCZQODJesALRUhABcimwhDYwBfj9hTBS7LCMdqbCN0A2cU52ERcweRDlcHpxwzFb8c4XDIXguGCCijrwlbAXUJmQFfBOMICTVbjKAgQWdTi1gYmyBhQT9d/AIxDGUVn0S9h3gCiw9rEhsBNQFzBzkNAQJ3Ee0RaxCVCOuGBDW1M/g6JQRPIYMgEQonA09szgsnJvkM+GkBoxJiAww0PXfuZ6tgtiQX/QcZMsVBYCHxC5JPzQycGsEYQlQuGeQHvwPzGvMn6kFXBf8DowMTOk0z7gS9C2kIiwk/AEkOoxcH1xhqCnGM0AExiwG3mQNXkYMCb48GNwcLAGcLhwV55QAdAqcIowAFAM8DVwA5Aq0HnQAZAIVBAT0DJy8BIeUCjwOTCDHLAZUvAfMpBBvDDBUA9zduSgLDsQKAamaiBd1YAo4CSTUBTSUEBU5HUQOvceEA2wBLBhPfRwEVq0rLGuNDAd9vKwDHAPsABTUHBUEBzQHzbQC3AV8LMQmis7UBTekpAIMAFWsB1wKJAN0ANQB/8QFTAE0FWfkF0wJPSQERMRgrV2EBuwMfATMBDQB5BsuNpckHHwRtB9MCEBsV4QLvLge1AQMi3xPNQsUCvd5VoWACZIECYkJbTa9bNyACofcCaJgCZgkCn4Q4GwsCZjsCZiYEbgR/A38TA36SOQY5dxc5gjojIwJsHQIyNjgKAm3HAm2u74ozZ0UrAWcA3gDhAEoFB5gMjQD+C8IADbUCdy8CdqI/AnlLQwJ4uh1c20WuRtcCfD8CesgCfQkCfPAFWQUgSABIfWMkAoFtAoAAAoAFAn+uSVhKWxUXSswC0QEC0MxLJwOITwOH5kTFkTIC8qFdAwMDrkvOTC0lA89NTE2vAos/AorYwRsHHUNnBbcCjjcCjlxAl4ECjtkCjlx4UbRTNQpS1FSFApP7ApMMAOkAHFUeVa9V0AYsGymVhjLheGZFOzkCl58C77JYIagAWSUClo8ClnycAKlZrFoJgU0AOwKWtQKWTlxEXNECmcsCmWRcyl0HGQKcmznCOp0CnBYCn5sCnriKAB0PMSoPAp3xAp6SALU9YTRh7wKe0wKgbgGpAp6fHwKeTqVjyGQnJSsCJ68CJn4CoPsCoEwCot0CocQCpi8Cpc4Cp/8AfQKn8mh8aLEAA0lqHGrRAqzjAqyuAq1nAq0CAlcdAlXcArHh1wMfTmyXArK9DQKy6Bds4G1jbUhfAyXNArZcOz9ukAMpRQK4XgK5RxUCuSp3cDZw4QK9GQK72nCWAzIRAr6IcgIDM3ECvhpzInNPAsPLAsMEc4J0SzVFdOADPKcDPJoDPb8CxXwCxkcCxhCJAshpUQLIRALJTwLJLgJknQLd0nh5YXiueSVL0AMYo2cCAmH0GfOVJHsLXpJeuxECz2sCz2wvS1PS8xOfAMatAs9zASnqA04SfksFAtwnAtuKAtJPA1JcA1NfAQEDVYyAiT8AyxbtYEWCHILTgs6DjQLaxwLZ3oQQhEmnPAOGpQAvA2QOhnFZ+QBVAt9lAt64c3cC4i/tFAHzMCcB9JsB8tKHAuvzAulweQLq+QLq5AD5RwG5Au6JAuuclqqXAwLuPwOF4Jh5cOBxoQLzAwBpA44WmZMC9xMDkW4DkocC95gC+dkC+GaaHJqruzebHgOdgwL++gEbADmfHJ+zAwWNA6ZqA6bZANHFAwZqoYiiBQkDDEkCwAA/AwDhQRdTARHzA2sHl2cFAJMtK7evvdsBiZkUfxEEOQH7KQUhDp0JnwCS/SlXxQL3AZ0AtwW5AG8LbUEuFCaNLgFDAYD8AbUmAHUDDgRtACwCFgyhAAAKAj0CagPdA34EkQEgRQUhfAoABQBEABMANhICdwEABdUDa+8KxQIA9wqfJ7+xt+UBkSFBQgHpFH8RNMCJAAQAGwBaAkUChIsABjpTOpSNbQC4Oo860ACNOME63AClAOgAywE6gTo7Ofw5+Tt2iTpbO56JOm85GAFWATMBbAUvNV01njWtNWY1dTW2NcU1gjWRNdI14TWeNa017jX9NbI1wTYCNhE1xjXVNhY2JzXeNe02LjY9Ni41LSE2OjY9Njw2yTcIBJA8VzY4Nt03IDcPNsogN4k3MAoEsDxnNiQ3GTdsOo03IULUQwdC4EMLHA8PCZsobShRVQYA6X8A6bABFCnXAukBowC9BbcAbwNzBL8MDAMMAQgDAAkKCwsLCQoGBAVVBI/DvwDz9b29kaUCb0QtsRTNLt4eGBcSHAMZFhYZEhYEARAEBUEcQRxBHEEcQRxBHEEaQRxBHEFCSTxBPElISUhBNkM2QTYbNklISVmBVIgBFLWZAu0BhQCjBcEAbykBvwGJAaQcEZ0ePCklMAAhMvAIMAL54gC7Bm8EescjzQMpARQpKgDUABavAj626xQAJP0A3etzuf4NNRA7efy2Z9NQrCnC0OSyANz5BBIbJ5IFDR6miIavYS6tprjjmuKebxm5C74Q225X1pkaYYPb6f1DK4k3xMEBb9S2WMjEibTNWhsRJIA+vwNVEiXTE5iXs/wezV66oFLfp9NZGYW+Gk19J2+bCT6Ye2w6LDYdgzKMUabk595eLBCXANz9HUpWbATq9vqXVx9XDg+Pc9Xp4+bsS005SVM/BJBM4687WUuf+Uj9dEi8aDNaPxtpbDxcG1THTImUMZq4UCaaNYpsVqraNyKLJXDYsFZ/5jl7bLRtO88t7P3xZaAxhb5OdPMXqsSkp1WCieG8jXm1U99+blvLlXzPCS+M93VnJCiK+09LfaSaBAVBomyDgJua8dfUzR7ga34IvR2Nvj+A9heJ6lsl1KG4NkI1032Cnff1m1wof2B9oHJK4bi6JkEdSqeNeiuo6QoZZincoc73/TH9SXF8sCE7XyuYyW8WSgbGFCjPV0ihLKhdPs08Tx82fYAkLLc4I2wdl4apY7GU5lHRFzRWJep7Ww3wbeA3qmd59/86P4xuNaqDpygXt6M85glSBHOCGgJDnt+pN9bK7HApMguX6+06RZNjzVmcZJ+wcUrJ9//bpRNxNuKpNl9uFds+S9tdx7LaM5ZkIrPj6nIU9mnbFtVbs9s/uLgl8MVczAwet+iOEzzBlYW7RCMgE6gyNLeq6+1tIx4dpgZnd0DksJS5f+JNDpwwcPNXaaVspq1fbQajOrJgK0ofKtJ1Ne90L6VO4MOl5S886p7u6xo7OLjG8TGL+HU1JXGJgppg4nNbNJ5nlzSpuPYy21JUEcUA94PoFiZfjZue+QnyQ80ekOuZVkxx4g+cvhJfHgNl4hy1/a6+RKcKlar/J29y//EztlbVPHVUeQ1zX86eQVAjR/M3dA9w4W8LfaXp4EgM85wOWasli837PzVMOnsLzR+k3o75/lRPAJSE1xAKQzEi5v10ke+VBvRt1cwQRMd+U5mLCTGVd6XiZtgBG5cDi0w22GKcVNvHiu5LQbZEDVtz0onn7k5+heuKXVsZtSzilkLRAUmjMXEMB3J9YC50XBxPiz53SC+EhnPl9WsKCv92SM/OFFIMJZYfl0WW8tIO3UxYcwdMAj7FSmgrsZ2aAZO03BOhP1bNNZItyXYQFTpC3SG1VuPDqH9GkiCDmE+JwxyIVSO5siDErAOpEXFgjy6PQtOVDj+s6e1r8heWVvmZnTciuf4EiNZzCAd7SOMhXERIOlsHIMG399i9aLTy3m2hRLZjJVDNLS53iGIK11dPqQt0zBDyg6qc7YqkDm2M5Ve6dCWCaCbTXX2rToaIgz6+zh4lYUi/+6nqcFMAkQJKHYLK0wYk5N9szV6xihDbDDFr45lN1K4aCXBq/FitPSud9gLt5ZVn+ZqGX7cwm2z5EGMgfFpIFyhGGuDPmso6TItTMwny+7uPnLCf4W6goFQFV0oQSsc9VfMmVLcLr6ZetDZbaSFTLqnSO/bIPjA3/zAUoqgGFAEQS4IhuMzEp2I3jJzbzkk/IEmyax+rhZTwd6f+CGtwPixu8IvzACquPWPREu9ZvGkUzpRwvRRuaNN6cr0W1wWits9ICdYJ7ltbgMiSL3sTPeufgNcVqMVWFkCPDH4jG2jA0XcVgQj62Cb29v9f/z/+2KbYvIv/zzjpQAPkliaVDzNrW57TZ/ZOyZD0nlfMmAIBIAGAI0D3k/mdN4xr9v85ZbZbbqfH2jGd5hUqNZWwl5SPfoGmfElmazUIeNL1j/mkF7VNAzTq4jNt8JoQ11NQOcmhprXoxSxfRGJ9LDEOAQ+dmxAQH90iti9e2u/MoeuaGcDTHoC+xsmEeWmxEKefQuIzHbpw5Tc5cEocboAD09oipWQhtTO1wivf/O+DRe2rpl/E9wlrzBorjJsOeG1B/XPW4EaJEFdNlECEZga5ZoGRHXgYouGRuVkm8tDESiEyFNo+3s5M5puSdTyUL2llnINVHEt91XUNW4ewdMgJ4boJfEyt/iY5WXqbA+A2Fkt5Z0lutiWhe9nZIyIUjyXDC3UsaG1t+eNx6z4W/OYoTB7A6x+dNSTOi9AInctbESqm5gvOLww7OWXPrmHwVZasrl4eD113pm+JtT7JVOvnCXqdzzdTRHgJ0PiGTFYW5Gvt9R9LD6Lzfs0v/TZZHSmyVNq7viIHE6DBK7Qp07Iz55EM8SYtQvZf/obBniTWi5C2/ovHfw4VndkE5XYdjOhCMRjDeOEfXeN/CwfGduiUIfsoFeUxXeQXba7c7972XNv8w+dTjjUM0QeNAReW+J014dKAD/McQYXT7c0GQPIkn3Ll6R7gGjuiQoZD0TEeEqQpKoZ15g/0OPQI17QiSv9AUROa/V/TQN3dvLArec3RrsYlvBm1b8LWzltdugsC50lNKYLEp2a+ZZYqPejULRlOJh5zj/LVMyTDvwKhMxxwuDkxJ1QpoNI0OTWLom4Z71SNzI9TV1iXJrIu9Wcnd+MCaAw8o1jSXd94YU/1gnkrC9BUEOtQvEIQ7g0i6h+KL2JKk8Ydl7HruvgWMSAmNe+LshGhV4qnWHhO9/RIPQzY1tHRj2VqOyNsDpK0cww+56AdDC4gsWwY0XxoucIWIqs/GcwnWqlaT0KPr8mbK5U94/301i1WLt4YINTVvCFBrFZbIbY8eycOdeJ2teD5IfPLCRg7jjcFTwlMFNl9zdh/o3E/hHPwj7BWg0MU09pPrBLbrCgm54A6H+I6v27+jL5gkjWg/iYdks9jbfVP5y/n0dlgWEMlKasl7JvFZd56LfybW1eeaVO0gxTfXZwD8G4SI116yx7UKVRgui6Ya1YpixqXeNLc8IxtAwCU5IhwQgn+NqHnRaDv61CxKhOq4pOX7M6pkA+Pmpd4j1vn6ACUALoLLc4vpXci8VidLxzm7qFBe7s+quuJs6ETYmnpgS3LwSZxPIltgBDXz8M1k/W2ySNv2f9/NPhxLGK2D21dkHeSGmenRT3Yqcdl0m/h3OYr8V+lXNYGf8aCCpd4bWjE4QIPj7vUKN4Nrfs7ML6Y2OyS830JCnofg/k7lpFpt4SqZc5HGg1HCOrHvOdC8bP6FGDbE/VV0mX4IakzbdS/op+Kt3G24/8QbBV7y86sGSQ/vZzU8FXs7u6jIvwchsEP2BpIhW3G8uWNwa3HmjfH/ZjhhCWvluAcF+nMf14ClKg5hGgtPLJ98ueNAkc5Hs2WZlk2QHvfreCK1CCGO6nMZVSb99VM/ajr8WHTte9JSmkXq/i/U943HEbdzW6Re/S88dKgg8pGOLlAeNiqrcLkUR3/aClFpMXcOUP3rmETcWSfMXZE3TUOi8i+fqRnTYLflVx/Vb/6GJ7eIRZUA6k3RYR3iFSK9c4iDdNwJuZL2FKz/IK5VimcNWEqdXjSoxSgmF0UPlDoUlNrPcM7ftmA8Y9gKiqKEHuWN+AZRIwtVSxye2Kf8rM3lhJ5XcBXU9n4v0Oy1RU2M+4qM8AQPVwse8ErNSob5oFPWxuqZnVzo1qB/IBxkM3EVUKFUUlO3e51259GgNcJbCmlvrdjtoTW7rChm1wyCKzpCTwozUUEOIcWLneRLgMXh+SjGSFkAllzbGS5HK7LlfCMRNRDSvbQPjcXaenNYxCvu2Qyznz6StuxVj66SgI0T8B6/sfHAJYZaZ78thjOSIFumNWLQbeZixDCCC+v0YBtkxiBB3jefHqZ/dFHU+crbj6OvS1x/JDD7vlm7zOVPwpUC01nhxZuY/63E7g";const wu=44032,zh=4352,Hh=4449,qh=4519,P8=19,C8=21,nl=28,Vh=C8*nl,x7=P8*Vh,w7=wu+x7,E7=zh+P8,v7=Hh+C8,A7=qh+nl;function Wl(r){return r>>24&255}function T8(r){return r&16777215}let Qp,Km,Jp,wh;function I7(){let r=v8(m7);Qp=new Map(A8(r).flatMap((e,t)=>e.map(n=>[n,t+1<<24]))),Km=new Set(mu(r)),Jp=new Map,wh=new Map;for(let[e,t]of I8(r)){if(!Km.has(e)&&t.length==2){let[n,s]=t,i=wh.get(n);i||(i=new Map,wh.set(n,i)),i.set(s,e)}Jp.set(e,t.reverse())}}function N8(r){return r>=wu&&r<w7}function S7(r,e){if(r>=zh&&r<E7&&e>=Hh&&e<v7)return wu+(r-zh)*Vh+(e-Hh)*nl;if(N8(r)&&e>qh&&e<A7&&(r-wu)%nl==0)return r+(e-qh);{let t=wh.get(r);return t&&(t=t.get(e),t)?t:-1}}function D8(r){Qp||I7();let e=[],t=[],n=!1;function s(i){let o=Qp.get(i);o&&(n=!0,i|=o),e.push(i)}for(let i of r)for(;;){if(i<128)e.push(i);else if(N8(i)){let o=i-wu,a=o/Vh|0,c=o%Vh/nl|0,l=o%nl;s(zh+a),s(Hh+c),l>0&&s(qh+l)}else{let o=Jp.get(i);o?t.push(...o):s(i)}if(!t.length)break;i=t.pop()}if(n&&e.length>1){let i=Wl(e[0]);for(let o=1;o<e.length;o++){let a=Wl(e[o]);if(a==0||i<=a){i=a;continue}let c=o-1;for(;;){let l=e[c+1];if(e[c+1]=e[c],e[c]=l,!c||(i=Wl(e[--c]),i<=a))break}i=Wl(e[o])}}return e}function O7(r){let e=[],t=[],n=-1,s=0;for(let i of r){let o=Wl(i),a=T8(i);if(n==-1)o==0?n=a:e.push(a);else if(s>0&&s>=o)o==0?(e.push(n,...t),t.length=0,n=a):t.push(a),s=o;else{let c=S7(n,a);c>=0?n=c:s==0&&o==0?(e.push(n),n=a):(t.push(a),s=o)}}return n>=0&&e.push(n,...t),e}function R8(r){return D8(r).map(T8)}function P7(r){return O7(D8(r))}const Gm=45,_8=".",B8=65039,k8=1,Kh=r=>Array.from(r);function Eu(r,e){return r.P.has(e)||r.Q.has(e)}class C7 extends Array{get is_emoji(){return!0}}let Yp,U8,xo,Zp,$8,Qa,m0,_a,so,Wm,Xp;function Gb(){if(Yp)return;let r=v8(o7);const e=()=>mu(r),t=()=>new Set(e()),n=(u,f)=>f.forEach(h=>u.add(h));Yp=new Map(I8(r)),U8=t(),xo=e(),Zp=new Set(e().map(u=>xo[u])),xo=new Set(xo),$8=t(),t();let s=A8(r),i=r();const o=()=>{let u=new Set;return e().forEach(f=>n(u,s[f])),n(u,e()),u};Qa=xu(u=>{let f=xu(r).map(h=>h+96);if(f.length){let h=u>=i;f[0]-=32,f=rl(f),h&&(f=`Restricted[${f}]`);let d=o(),p=o(),g=!r();return{N:f,P:d,Q:p,M:g,R:h}}}),m0=t(),_a=new Map;let a=e().concat(Kh(m0)).sort((u,f)=>u-f);a.forEach((u,f)=>{let h=r(),d=a[f]=h?a[f-h]:{V:[],M:new Map};d.V.push(u),m0.has(u)||_a.set(u,d)});for(let{V:u,M:f}of new Set(_a.values())){let h=[];for(let p of u){let g=Qa.filter(x=>Eu(x,p)),y=h.find(({G:x})=>g.some(A=>x.has(A)));y||(y={G:new Set,V:[]},h.push(y)),y.V.push(p),n(y.G,g)}let d=h.flatMap(p=>Kh(p.G));for(let{G:p,V:g}of h){let y=new Set(d.filter(x=>!p.has(x)));for(let x of g)f.set(x,y)}}so=new Set;let c=new Set;const l=u=>so.has(u)?c.add(u):so.add(u);for(let u of Qa){for(let f of u.P)l(f);for(let f of u.Q)l(f)}for(let u of so)!_a.has(u)&&!c.has(u)&&_a.set(u,k8);n(so,R8(so)),Wm=p7(r).map(u=>C7.from(u)).sort(y7),Xp=new Map;for(let u of Wm){let f=[Xp];for(let h of u){let d=f.map(p=>{let g=p.get(h);return g||(g=new Map,p.set(h,g)),g});h===B8?f.push(...d):f=d}for(let h of f)h.V=u}}function Wb(r){return(L8(r)?"":`${Qb(Ld([r]))} `)+O8(r)}function Qb(r){return`"${r}"‎`}function T7(r){if(r.length>=4&&r[2]==Gm&&r[3]==Gm)throw new Error(`invalid label extension: "${rl(r.slice(0,4))}"`)}function N7(r){for(let t=r.lastIndexOf(95);t>0;)if(r[--t]!==95)throw new Error("underscore allowed only at start")}function D7(r){let e=r[0],t=qm.get(e);if(t)throw ou(`leading ${t}`);let n=r.length,s=-1;for(let i=1;i<n;i++){e=r[i];let o=qm.get(e);if(o){if(s==i)throw ou(`${t} + ${o}`);s=i+1,t=o}}if(s==n)throw ou(`trailing ${t}`)}function Ld(r,e=1/0,t=O8){let n=[];R7(r[0])&&n.push("◌"),r.length>e&&(e>>=1,r=[...r.slice(0,e),8230,...r.slice(-e)]);let s=0,i=r.length;for(let o=0;o<i;o++){let a=r[o];L8(a)&&(n.push(rl(r.slice(s,o))),n.push(t(a)),s=o+1)}return n.push(rl(r.slice(s,i))),n.join("")}function R7(r){return Gb(),xo.has(r)}function L8(r){return Gb(),$8.has(r)}function _7(r){return $7(B7(r,P7,M7))}function B7(r,e,t){if(!r)return[];Gb();let n=0;return r.split(_8).map(s=>{let i=b7(s),o={input:i,offset:n};n+=i.length+1;try{let a=o.tokens=F7(i,e,t),c=a.length,l;if(!c)throw new Error("empty label");let u=o.output=a.flat();if(N7(u),!(o.emoji=c>1||a[0].is_emoji)&&u.every(h=>h<128))T7(u),l="ASCII";else{let h=a.flatMap(d=>d.is_emoji?[]:d);if(!h.length)l="Emoji";else{if(xo.has(u[0]))throw ou("leading combining mark");for(let g=1;g<c;g++){let y=a[g];if(!y.is_emoji&&xo.has(y[0]))throw ou(`emoji + combining mark: "${rl(a[g-1])} + ${Ld([y[0]])}"`)}D7(u);let d=Kh(new Set(h)),[p]=U7(d);L7(p,h),k7(p,d),l=p.N}}o.type=l}catch(a){o.error=a}return o})}function k7(r,e){let t,n=[];for(let s of e){let i=_a.get(s);if(i===k8)return;if(i){let o=i.M.get(s);if(t=t?t.filter(a=>o.has(a)):Kh(o),!t.length)return}else n.push(s)}if(t){for(let s of t)if(n.every(i=>Eu(s,i)))throw new Error(`whole-script confusable: ${r.N}/${s.N}`)}}function U7(r){let e=Qa;for(let t of r){let n=e.filter(s=>Eu(s,t));if(!n.length)throw Qa.some(s=>Eu(s,t))?M8(e[0],t):F8(t);if(e=n,n.length==1)break}return e}function $7(r){return r.map(({input:e,error:t,output:n})=>{if(t){let s=t.message;throw new Error(r.length==1?s:`Invalid label ${Qb(Ld(e,63))}: ${s}`)}return rl(n)}).join(_8)}function F8(r){return new Error(`disallowed character: ${Wb(r)}`)}function M8(r,e){let t=Wb(e),n=Qa.find(s=>s.P.has(e));return n&&(t=`${n.N} ${t}`),new Error(`illegal mixture: ${r.N} + ${t}`)}function ou(r){return new Error(`illegal placement: ${r}`)}function L7(r,e){for(let t of e)if(!Eu(r,t))throw M8(r,t);if(r.M){let t=R8(e);for(let n=1,s=t.length;n<s;n++)if(Zp.has(t[n])){let i=n+1;for(let o;i<s&&Zp.has(o=t[i]);i++)for(let a=n;a<i;a++)if(t[a]==o)throw new Error(`duplicate non-spacing marks: ${Wb(o)}`);if(i-n>Vm)throw new Error(`excessive non-spacing marks: ${Qb(Ld(t.slice(n-1,i)))} (${i-n}/${Vm})`);n=i}}}function F7(r,e,t){let n=[],s=[];for(r=r.slice().reverse();r.length;){let i=j7(r);if(i)s.length&&(n.push(e(s)),s=[]),n.push(t(i));else{let o=r.pop();if(so.has(o))s.push(o);else{let a=Yp.get(o);if(a)s.push(...a);else if(!U8.has(o))throw F8(o)}}}return s.length&&n.push(e(s)),n}function M7(r){return r.filter(e=>e!=B8)}function j7(r,e){let t=Xp,n,s=r.length;for(;s&&(t=t.get(r[--s]),!!t);){let{V:i}=t;i&&(n=i,r.length=s)}return n}const j8=new Uint8Array(32);j8.fill(0);function Qm(r){return C(r.length!==0,"invalid ENS name; empty component","comp",r),r}function Jb(r){const e=st(z8(r)),t=[];if(r.length===0)return t;let n=0;for(let s=0;s<e.length;s++)e[s]===46&&(t.push(Qm(e.slice(n,s))),n=s+1);return C(n<e.length,"invalid ENS name; empty component","name",r),t.push(Qm(e.slice(n))),t}function z8(r){try{if(r.length===0)throw new Error("empty label");return _7(r)}catch(e){C(!1,`invalid ENS name (${e.message})`,"name",r)}}function z7(r){try{return Jb(r).length!==0}catch{}return!1}function Gh(r){C(typeof r=="string","invalid ENS name; not a string","name",r),C(r.length,"invalid ENS name (empty label)","name",r);let e=j8;const t=Jb(r);for(;t.length;)e=Ne(me([e,Ne(t.pop())]));return K(e)}function H8(r,e){const t=e??63;return C(t<=255,"DNS encoded label cannot exceed 255","length",t),K(me(Jb(r).map(n=>{C(n.length<=t,`label ${JSON.stringify(r)} exceeds ${t} bytes`,"name",r);const s=new Uint8Array(n.length+1);return s.set(n,1),s[0]=s.length-1,s})))+"00"}function Yb(r){return typeof r=="string"&&(r=st(r)),Ne(me([st(y8),st(String(r.length)),r]))}function H7(r,e){const t=Yb(r);return uf(t,e)}const q7=new RegExp("^bytes([0-9]+)$"),V7=new RegExp("^(u?int)([0-9]*)$"),K7=new RegExp("^(.*)\\[([0-9]*)\\]$");function q8(r,e,t){switch(r){case"address":return Q(t?vr(e,32):ce(e));case"string":return st(e);case"bytes":return Q(e);case"bool":return e=e?"0x01":"0x00",Q(t?vr(e,32):e)}let n=r.match(V7);if(n){let s=n[1]==="int",i=parseInt(n[2]||"256");return C((!n[2]||n[2]===String(i))&&i%8===0&&i!==0&&i<=256,"invalid number type","type",r),t&&(i=256),s&&(e=Nd(e,i)),Q(vr(Fe(e),i/8))}if(n=r.match(q7),n){const s=parseInt(n[1]);return C(String(s)===n[1]&&s!==0&&s<=32,"invalid bytes type","type",r),C(_i(e)===s,`invalid value for ${r}`,"value",e),t?Q(Cd(e,32)):e}if(n=r.match(K7),n&&Array.isArray(e)){const s=n[1],i=parseInt(n[2]||String(e.length));C(i===e.length,`invalid array length for ${r}`,"value",e);const o=[];return e.forEach(function(a){o.push(q8(s,a,!0))}),Q(me(o))}C(!1,"invalid type","type",r)}function Zb(r,e){C(r.length===e.length,"wrong number of values; expected ${ types.length }","values",e);const t=[];return r.forEach(function(n,s){t.push(q8(n,e[s]))}),K(me(t))}function G7(r,e){return Ne(Zb(r,e))}function W7(r,e){return Vt(Zb(r,e))}const V8=new Uint8Array(32);V8.fill(0);const Q7=BigInt(-1),K8=BigInt(0),G8=BigInt(1),J7=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function Y7(r){const e=Q(r),t=e.length%32;return t?me([e,V8.slice(t)]):K(e)}const Z7=Zn(G8,32),X7=Zn(K8,32),Jm={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},x0=["name","version","chainId","verifyingContract","salt"];function Ym(r){return function(e){return C(typeof e=="string",`invalid domain value for ${JSON.stringify(r)}`,`domain.${r}`,e),e}}const eI={name:Ym("name"),version:Ym("version"),chainId:function(r){const e=re(r,"domain.chainId");return C(e>=0,"invalid chain ID","domain.chainId",r),Number.isSafeInteger(e)?Number(e):xr(e)},verifyingContract:function(r){try{return ce(r).toLowerCase()}catch{}C(!1,'invalid domain value "verifyingContract"',"domain.verifyingContract",r)},salt:function(r){const e=Q(r,"domain.salt");return C(e.length===32,'invalid domain value "salt"',"domain.salt",r),K(e)}};function w0(r){{const e=r.match(/^(u?)int(\d+)$/);if(e){const t=e[1]==="",n=parseInt(e[2]);C(n%8===0&&n!==0&&n<=256&&e[2]===String(n),"invalid numeric width","type",r);const s=Di(J7,t?n-1:n),i=t?(s+G8)*Q7:K8;return function(o){const a=re(o,"value");return C(a>=i&&a<=s,`value out-of-bounds for ${r}`,"value",a),Zn(t?Nd(a,256):a,32)}}}{const e=r.match(/^bytes(\d+)$/);if(e){const t=parseInt(e[1]);return C(t!==0&&t<=32&&e[1]===String(t),"invalid bytes width","type",r),function(n){const s=Q(n);return C(s.length===t,`invalid length for ${r}`,"value",n),Y7(n)}}}switch(r){case"address":return function(e){return vr(ce(e),32)};case"bool":return function(e){return e?Z7:X7};case"bytes":return function(e){return Ne(e)};case"string":return function(e){return es(e)}}return null}function Zm(r,e){return`${r}(${e.map(({name:t,type:n})=>n+" "+t).join(",")})`}function Mf(r){const e=r.match(/^([^\x5b]*)((\x5b\d*\x5d)*)(\x5b(\d*)\x5d)$/);return e?{base:e[1],index:e[2]+e[4],array:{base:e[1],prefix:e[1]+e[2],count:e[5]?parseInt(e[5]):-1}}:{base:r}}var Hu,Es,Oc,Ed,W8;const _r=class _r{constructor(e){M(this,Ed);k(this,"primaryType");M(this,Hu);M(this,Es);M(this,Oc);S(this,Es,new Map),S(this,Oc,new Map);const t=new Map,n=new Map,s=new Map,i={};Object.keys(e).forEach(c=>{i[c]=e[c].map(({name:l,type:u})=>{let{base:f,index:h}=Mf(u);return f==="int"&&!e.int&&(f="int256"),f==="uint"&&!e.uint&&(f="uint256"),{name:l,type:f+(h||"")}}),t.set(c,new Set),n.set(c,[]),s.set(c,new Set)}),S(this,Hu,JSON.stringify(i));for(const c in i){const l=new Set;for(const u of i[c]){C(!l.has(u.name),`duplicate variable name ${JSON.stringify(u.name)} in ${JSON.stringify(c)}`,"types",e),l.add(u.name);const f=Mf(u.type).base;C(f!==c,`circular type reference to ${JSON.stringify(f)}`,"types",e),!w0(f)&&(C(n.has(f),`unknown type ${JSON.stringify(f)}`,"types",e),n.get(f).push(c),t.get(c).add(f))}}const o=Array.from(n.keys()).filter(c=>n.get(c).length===0);C(o.length!==0,"missing primary type","types",e),C(o.length===1,`ambiguous primary types or unused types: ${o.map(c=>JSON.stringify(c)).join(", ")}`,"types",e),te(this,{primaryType:o[0]});function a(c,l){C(!l.has(c),`circular type reference to ${JSON.stringify(c)}`,"types",e),l.add(c);for(const u of t.get(c))if(n.has(u)){a(u,l);for(const f of l)s.get(f).add(u)}l.delete(c)}a(this.primaryType,new Set);for(const[c,l]of s){const u=Array.from(l);u.sort(),b(this,Es).set(c,Zm(c,i[c])+u.map(f=>Zm(f,i[f])).join(""))}}get types(){return JSON.parse(b(this,Hu))}getEncoder(e){let t=b(this,Oc).get(e);return t||(t=q(this,Ed,W8).call(this,e),b(this,Oc).set(e,t)),t}encodeType(e){const t=b(this,Es).get(e);return C(t,`unknown type: ${JSON.stringify(e)}`,"name",e),t}encodeData(e,t){return this.getEncoder(e)(t)}hashStruct(e,t){return Ne(this.encodeData(e,t))}encode(e){return this.encodeData(this.primaryType,e)}hash(e){return this.hashStruct(this.primaryType,e)}_visit(e,t,n){if(w0(e))return n(e,t);const s=Mf(e).array;if(s)return C(s.count===-1||s.count===t.length,`array length mismatch; expected length ${s.count}`,"value",t),t.map(o=>this._visit(s.prefix,o,n));const i=this.types[e];if(i)return i.reduce((o,{name:a,type:c})=>(o[a]=this._visit(c,t[a],n),o),{});C(!1,`unknown type: ${e}`,"type",e)}visit(e,t){return this._visit(this.primaryType,e,t)}static from(e){return new _r(e)}static getPrimaryType(e){return _r.from(e).primaryType}static hashStruct(e,t,n){return _r.from(t).hashStruct(e,n)}static hashDomain(e){const t=[];for(const n in e){if(e[n]==null)continue;const s=Jm[n];C(s,`invalid typed-data domain key: ${JSON.stringify(n)}`,"domain",e),t.push({name:n,type:s})}return t.sort((n,s)=>x0.indexOf(n.name)-x0.indexOf(s.name)),_r.hashStruct("EIP712Domain",{EIP712Domain:t},e)}static encode(e,t,n){return me(["0x1901",_r.hashDomain(e),_r.from(t).hash(n)])}static hash(e,t,n){return Ne(_r.encode(e,t,n))}static async resolveNames(e,t,n,s){e=Object.assign({},e);for(const a in e)e[a]==null&&delete e[a];const i={};e.verifyingContract&&!De(e.verifyingContract,20)&&(i[e.verifyingContract]="0x");const o=_r.from(t);o.visit(n,(a,c)=>(a==="address"&&!De(c,20)&&(i[c]="0x"),c));for(const a in i)i[a]=await s(a);return e.verifyingContract&&i[e.verifyingContract]&&(e.verifyingContract=i[e.verifyingContract]),n=o.visit(n,(a,c)=>a==="address"&&i[c]?i[c]:c),{domain:e,value:n}}static getPayload(e,t,n){_r.hashDomain(e);const s={},i=[];x0.forEach(c=>{const l=e[c];l!=null&&(s[c]=eI[c](l),i.push({name:c,type:Jm[c]}))});const o=_r.from(t);t=o.types;const a=Object.assign({},t);return C(a.EIP712Domain==null,"types must not contain EIP712Domain type","types.EIP712Domain",t),a.EIP712Domain=i,o.encode(n),{types:a,domain:s,primaryType:o.primaryType,message:o.visit(n,(c,l)=>{if(c.match(/^bytes(\d*)/))return K(Q(l));if(c.match(/^u?int/))return re(l).toString();switch(c){case"address":return l.toLowerCase();case"bool":return!!l;case"string":return C(typeof l=="string","invalid string","value",l),l}C(!1,"unsupported type","type",c)})}}};Hu=new WeakMap,Es=new WeakMap,Oc=new WeakMap,Ed=new WeakSet,W8=function(e){{const s=w0(e);if(s)return s}const t=Mf(e).array;if(t){const s=t.prefix,i=this.getEncoder(s);return o=>{C(t.count===-1||t.count===o.length,`array length mismatch; expected length ${t.count}`,"value",o);let a=o.map(i);return b(this,Es).has(s)&&(a=a.map(Ne)),Ne(me(a))}}const n=this.types[e];if(n){const s=es(b(this,Es).get(e));return i=>{const o=n.map(({name:a,type:c})=>{const l=this.getEncoder(c)(i[a]);return b(this,Es).has(c)?Ne(l):l});return o.unshift(s),me(o)}}C(!1,`unknown type: ${e}`,"type",e)};let Li=_r;function tI(r,e,t,n){return uf(Li.hash(r,e,t),n)}function jt(r){const e=new Set;return r.forEach(t=>e.add(t)),Object.freeze(e)}const rI="external public payable override",nI=jt(rI.split(" ")),Q8="constant external internal payable private public pure view override",sI=jt(Q8.split(" ")),J8="constructor error event fallback function receive struct",Y8=jt(J8.split(" ")),Z8="calldata memory storage payable indexed",iI=jt(Z8.split(" ")),oI="tuple returns",aI=[J8,Z8,oI,Q8].join(" "),cI=jt(aI.split(" ")),lI={"(":"OPEN_PAREN",")":"CLOSE_PAREN","[":"OPEN_BRACKET","]":"CLOSE_BRACKET",",":"COMMA","@":"AT"},uI=new RegExp("^(\\s*)"),fI=new RegExp("^([0-9]+)"),hI=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)"),X8=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)$"),eE=new RegExp("^(address|bool|bytes([0-9]*)|string|u?int([0-9]*))$");var wt,cn,qu,eg;const vd=class vd{constructor(e){M(this,qu);M(this,wt);M(this,cn);S(this,wt,0),S(this,cn,e.slice())}get offset(){return b(this,wt)}get length(){return b(this,cn).length-b(this,wt)}clone(){return new vd(b(this,cn))}reset(){S(this,wt,0)}popKeyword(e){const t=this.peek();if(t.type!=="KEYWORD"||!e.has(t.text))throw new Error(`expected keyword ${t.text}`);return this.pop().text}popType(e){if(this.peek().type!==e){const t=this.peek();throw new Error(`expected ${e}; got ${t.type} ${JSON.stringify(t.text)}`)}return this.pop().text}popParen(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const t=q(this,qu,eg).call(this,b(this,wt)+1,e.match+1);return S(this,wt,e.match+1),t}popParams(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const t=[];for(;b(this,wt)<e.match-1;){const n=this.peek().linkNext;t.push(q(this,qu,eg).call(this,b(this,wt)+1,n)),S(this,wt,n)}return S(this,wt,e.match+1),t}peek(){if(b(this,wt)>=b(this,cn).length)throw new Error("out-of-bounds");return b(this,cn)[b(this,wt)]}peekKeyword(e){const t=this.peekType("KEYWORD");return t!=null&&e.has(t)?t:null}peekType(e){if(this.length===0)return null;const t=this.peek();return t.type===e?t.text:null}pop(){const e=this.peek();return ma(this,wt)._++,e}toString(){const e=[];for(let t=b(this,wt);t<b(this,cn).length;t++){const n=b(this,cn)[t];e.push(`${n.type}:${n.text}`)}return`<TokenString ${e.join(" ")}>`}};wt=new WeakMap,cn=new WeakMap,qu=new WeakSet,eg=function(e=0,t=0){return new vd(b(this,cn).slice(e,t).map(n=>Object.freeze(Object.assign({},n,{match:n.match-e,linkBack:n.linkBack-e,linkNext:n.linkNext-e}))))};let mn=vd;function Ki(r){const e=[],t=o=>{const a=i<r.length?JSON.stringify(r[i]):"$EOI";throw new Error(`invalid token ${a} at ${i}: ${o}`)};let n=[],s=[],i=0;for(;i<r.length;){let o=r.substring(i),a=o.match(uI);a&&(i+=a[1].length,o=r.substring(i));const c={depth:n.length,linkBack:-1,linkNext:-1,match:-1,type:"",text:"",offset:i,value:-1};e.push(c);let l=lI[o[0]]||"";if(l){if(c.type=l,c.text=o[0],i++,l==="OPEN_PAREN")n.push(e.length-1),s.push(e.length-1);else if(l=="CLOSE_PAREN")n.length===0&&t("no matching open bracket"),c.match=n.pop(),e[c.match].match=e.length-1,c.depth--,c.linkBack=s.pop(),e[c.linkBack].linkNext=e.length-1;else if(l==="COMMA")c.linkBack=s.pop(),e[c.linkBack].linkNext=e.length-1,s.push(e.length-1);else if(l==="OPEN_BRACKET")c.type="BRACKET";else if(l==="CLOSE_BRACKET"){let u=e.pop().text;if(e.length>0&&e[e.length-1].type==="NUMBER"){const f=e.pop().text;u=f+u,e[e.length-1].value=ae(f)}if(e.length===0||e[e.length-1].type!=="BRACKET")throw new Error("missing opening bracket");e[e.length-1].text+=u}continue}if(a=o.match(hI),a){if(c.text=a[1],i+=c.text.length,cI.has(c.text)){c.type="KEYWORD";continue}if(c.text.match(eE)){c.type="TYPE";continue}c.type="ID";continue}if(a=o.match(fI),a){c.text=a[1],c.type="NUMBER",i+=c.text.length;continue}throw new Error(`unexpected token ${JSON.stringify(o[0])} at position ${i}`)}return new mn(e.map(o=>Object.freeze(o)))}function Xm(r,e){let t=[];for(const n in e.keys())r.has(n)&&t.push(n);if(t.length>1)throw new Error(`conflicting types: ${t.join(", ")}`)}function Fd(r,e){if(e.peekKeyword(Y8)){const t=e.pop().text;if(t!==r)throw new Error(`expected ${r}, got ${t}`)}return e.popType("ID")}function Us(r,e){const t=new Set;for(;;){const n=r.peekType("KEYWORD");if(n==null||e&&!e.has(n))break;if(r.pop(),t.has(n))throw new Error(`duplicate keywords: ${JSON.stringify(n)}`);t.add(n)}return Object.freeze(t)}function tE(r){let e=Us(r,sI);return Xm(e,jt("constant payable nonpayable".split(" "))),Xm(e,jt("pure view payable nonpayable".split(" "))),e.has("view")?"view":e.has("pure")?"pure":e.has("payable")?"payable":e.has("nonpayable")?"nonpayable":e.has("constant")?"view":"nonpayable"}function Rs(r,e){return r.popParams().map(t=>dt.from(t,e))}function rE(r){if(r.peekType("AT")){if(r.pop(),r.peekType("NUMBER"))return re(r.pop().text);throw new Error("invalid gas")}return null}function ta(r){if(r.length)throw new Error(`unexpected tokens at offset ${r.offset}: ${r.toString()}`)}const dI=new RegExp(/^(.*)\[([0-9]*)\]$/);function ex(r){const e=r.match(eE);if(C(e,"invalid type","type",r),r==="uint")return"uint256";if(r==="int")return"int256";if(e[2]){const t=parseInt(e[2]);C(t!==0&&t<=32,"invalid bytes length","type",r)}else if(e[3]){const t=parseInt(e[3]);C(t!==0&&t<=256&&t%8===0,"invalid numeric width","type",r)}return r}const Me={},ir=Symbol.for("_ethers_internal"),tx="_ParamTypeInternal",rx="_ErrorInternal",nx="_EventInternal",sx="_ConstructorInternal",ix="_FallbackInternal",ox="_FunctionInternal",ax="_StructInternal";var Pc,Eh;const Br=class Br{constructor(e,t,n,s,i,o,a,c){M(this,Pc);k(this,"name");k(this,"type");k(this,"baseType");k(this,"indexed");k(this,"components");k(this,"arrayLength");k(this,"arrayChildren");if(js(e,Me,"ParamType"),Object.defineProperty(this,ir,{value:tx}),o&&(o=Object.freeze(o.slice())),s==="array"){if(a==null||c==null)throw new Error("")}else if(a!=null||c!=null)throw new Error("");if(s==="tuple"){if(o==null)throw new Error("")}else if(o!=null)throw new Error("");te(this,{name:t,type:n,baseType:s,indexed:i,components:o,arrayLength:a,arrayChildren:c})}format(e){if(e==null&&(e="sighash"),e==="json"){const n=this.name||"";if(this.isArray()){const i=JSON.parse(this.arrayChildren.format("json"));return i.name=n,i.type+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`,JSON.stringify(i)}const s={type:this.baseType==="tuple"?"tuple":this.type,name:n};return typeof this.indexed=="boolean"&&(s.indexed=this.indexed),this.isTuple()&&(s.components=this.components.map(i=>JSON.parse(i.format(e)))),JSON.stringify(s)}let t="";return this.isArray()?(t+=this.arrayChildren.format(e),t+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`):this.isTuple()?t+="("+this.components.map(n=>n.format(e)).join(e==="full"?", ":",")+")":t+=this.type,e!=="sighash"&&(this.indexed===!0&&(t+=" indexed"),e==="full"&&this.name&&(t+=" "+this.name)),t}isArray(){return this.baseType==="array"}isTuple(){return this.baseType==="tuple"}isIndexable(){return this.indexed!=null}walk(e,t){if(this.isArray()){if(!Array.isArray(e))throw new Error("invalid array value");if(this.arrayLength!==-1&&e.length!==this.arrayLength)throw new Error("array is wrong length");const n=this;return e.map(s=>n.arrayChildren.walk(s,t))}if(this.isTuple()){if(!Array.isArray(e))throw new Error("invalid tuple value");if(e.length!==this.components.length)throw new Error("array is wrong length");const n=this;return e.map((s,i)=>n.components[i].walk(s,t))}return t(this.type,e)}async walkAsync(e,t){const n=[],s=[e];return q(this,Pc,Eh).call(this,n,e,t,i=>{s[0]=i}),n.length&&await Promise.all(n),s[0]}static from(e,t){if(Br.isParamType(e))return e;if(typeof e=="string")try{return Br.from(Ki(e),t)}catch{C(!1,"invalid param type","obj",e)}else if(e instanceof mn){let a="",c="",l=null;Us(e,jt(["tuple"])).has("tuple")||e.peekType("OPEN_PAREN")?(c="tuple",l=e.popParams().map(g=>Br.from(g)),a=`tuple(${l.map(g=>g.format()).join(",")})`):(a=ex(e.popType("TYPE")),c=a);let u=null,f=null;for(;e.length&&e.peekType("BRACKET");){const g=e.pop();u=new Br(Me,"",a,c,null,l,f,u),f=g.value,a+=g.text,c="array",l=null}let h=null;if(Us(e,iI).has("indexed")){if(!t)throw new Error("");h=!0}const p=e.peekType("ID")?e.pop().text:"";if(e.length)throw new Error("leftover tokens");return new Br(Me,p,a,c,h,l,f,u)}const n=e.name;C(!n||typeof n=="string"&&n.match(X8),"invalid name","obj.name",n);let s=e.indexed;s!=null&&(C(t,"parameter cannot be indexed","obj.indexed",e.indexed),s=!!s);let i=e.type,o=i.match(dI);if(o){const a=parseInt(o[2]||"-1"),c=Br.from({type:o[1],components:e.components});return new Br(Me,n||"",i,"array",s,null,a,c)}if(i==="tuple"||i.startsWith("tuple(")||i.startsWith("(")){const a=e.components!=null?e.components.map(l=>Br.from(l)):null;return new Br(Me,n||"",i,"tuple",s,a,null,null)}return i=ex(e.type),new Br(Me,n||"",i,i,s,null,null,null)}static isParamType(e){return e&&e[ir]===tx}};Pc=new WeakSet,Eh=function(e,t,n,s){if(this.isArray()){if(!Array.isArray(t))throw new Error("invalid array value");if(this.arrayLength!==-1&&t.length!==this.arrayLength)throw new Error("array is wrong length");const o=this.arrayChildren,a=t.slice();a.forEach((c,l)=>{var u;q(u=o,Pc,Eh).call(u,e,c,n,f=>{a[l]=f})}),s(a);return}if(this.isTuple()){const o=this.components;let a;if(Array.isArray(t))a=t.slice();else{if(t==null||typeof t!="object")throw new Error("invalid tuple value");a=o.map(c=>{if(!c.name)throw new Error("cannot use object value with unnamed components");if(!(c.name in t))throw new Error(`missing value for component ${c.name}`);return t[c.name]})}if(a.length!==this.components.length)throw new Error("array is wrong length");a.forEach((c,l)=>{var u;q(u=o[l],Pc,Eh).call(u,e,c,n,f=>{a[l]=f})}),s(a);return}const i=n(this.type,t);i.then?e.push((async function(){s(await i)})()):s(i)};let dt=Br;class Fi{constructor(e,t,n){k(this,"type");k(this,"inputs");js(e,Me,"Fragment"),n=Object.freeze(n.slice()),te(this,{type:t,inputs:n})}static from(e){if(typeof e=="string"){try{Fi.from(JSON.parse(e))}catch{}return Fi.from(Ki(e))}if(e instanceof mn)switch(e.peekKeyword(Y8)){case"constructor":return Vn.from(e);case"error":return Ft.from(e);case"event":return dn.from(e);case"fallback":case"receive":return zn.from(e);case"function":return pn.from(e);case"struct":return Bi.from(e)}else if(typeof e=="object"){switch(e.type){case"constructor":return Vn.from(e);case"error":return Ft.from(e);case"event":return dn.from(e);case"fallback":case"receive":return zn.from(e);case"function":return pn.from(e);case"struct":return Bi.from(e)}z(!1,`unsupported type: ${e.type}`,"UNSUPPORTED_OPERATION",{operation:"Fragment.from"})}C(!1,"unsupported frgament object","obj",e)}static isConstructor(e){return Vn.isFragment(e)}static isError(e){return Ft.isFragment(e)}static isEvent(e){return dn.isFragment(e)}static isFunction(e){return pn.isFragment(e)}static isStruct(e){return Bi.isFragment(e)}}class ff extends Fi{constructor(t,n,s,i){super(t,n,i);k(this,"name");C(typeof s=="string"&&s.match(X8),"invalid identifier","name",s),i=Object.freeze(i.slice()),te(this,{name:s})}}function vu(r,e){return"("+e.map(t=>t.format(r)).join(r==="full"?", ":",")+")"}class Ft extends ff{constructor(e,t,n){super(e,"error",t,n),Object.defineProperty(this,ir,{value:rx})}get selector(){return es(this.format("sighash")).substring(0,10)}format(e){if(e==null&&(e="sighash"),e==="json")return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(n=>JSON.parse(n.format(e)))});const t=[];return e!=="sighash"&&t.push("error"),t.push(this.name+vu(e,this.inputs)),t.join(" ")}static from(e){if(Ft.isFragment(e))return e;if(typeof e=="string")return Ft.from(Ki(e));if(e instanceof mn){const t=Fd("error",e),n=Rs(e);return ta(e),new Ft(Me,t,n)}return new Ft(Me,e.name,e.inputs?e.inputs.map(dt.from):[])}static isFragment(e){return e&&e[ir]===rx}}class dn extends ff{constructor(t,n,s,i){super(t,"event",n,s);k(this,"anonymous");Object.defineProperty(this,ir,{value:nx}),te(this,{anonymous:i})}get topicHash(){return es(this.format("sighash"))}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(s=>JSON.parse(s.format(t)))});const n=[];return t!=="sighash"&&n.push("event"),n.push(this.name+vu(t,this.inputs)),t!=="sighash"&&this.anonymous&&n.push("anonymous"),n.join(" ")}static getTopicHash(t,n){return n=(n||[]).map(i=>dt.from(i)),new dn(Me,t,n,!1).topicHash}static from(t){if(dn.isFragment(t))return t;if(typeof t=="string")try{return dn.from(Ki(t))}catch{C(!1,"invalid event fragment","obj",t)}else if(t instanceof mn){const n=Fd("event",t),s=Rs(t,!0),i=!!Us(t,jt(["anonymous"])).has("anonymous");return ta(t),new dn(Me,n,s,i)}return new dn(Me,t.name,t.inputs?t.inputs.map(n=>dt.from(n,!0)):[],!!t.anonymous)}static isFragment(t){return t&&t[ir]===nx}}class Vn extends Fi{constructor(t,n,s,i,o){super(t,n,s);k(this,"payable");k(this,"gas");Object.defineProperty(this,ir,{value:sx}),te(this,{payable:i,gas:o})}format(t){if(z(t!=null&&t!=="sighash","cannot format a constructor for sighash","UNSUPPORTED_OPERATION",{operation:"format(sighash)"}),t==="json")return JSON.stringify({type:"constructor",stateMutability:this.payable?"payable":"undefined",payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(t)))});const n=[`constructor${vu(t,this.inputs)}`];return this.payable&&n.push("payable"),this.gas!=null&&n.push(`@${this.gas.toString()}`),n.join(" ")}static from(t){if(Vn.isFragment(t))return t;if(typeof t=="string")try{return Vn.from(Ki(t))}catch{C(!1,"invalid constuctor fragment","obj",t)}else if(t instanceof mn){Us(t,jt(["constructor"]));const n=Rs(t),s=!!Us(t,nI).has("payable"),i=rE(t);return ta(t),new Vn(Me,"constructor",n,s,i)}return new Vn(Me,"constructor",t.inputs?t.inputs.map(dt.from):[],!!t.payable,t.gas!=null?t.gas:null)}static isFragment(t){return t&&t[ir]===sx}}class zn extends Fi{constructor(t,n,s){super(t,"fallback",n);k(this,"payable");Object.defineProperty(this,ir,{value:ix}),te(this,{payable:s})}format(t){const n=this.inputs.length===0?"receive":"fallback";if(t==="json"){const s=this.payable?"payable":"nonpayable";return JSON.stringify({type:n,stateMutability:s})}return`${n}()${this.payable?" payable":""}`}static from(t){if(zn.isFragment(t))return t;if(typeof t=="string")try{return zn.from(Ki(t))}catch{C(!1,"invalid fallback fragment","obj",t)}else if(t instanceof mn){const n=t.toString(),s=t.peekKeyword(jt(["fallback","receive"]));if(C(s,"type must be fallback or receive","obj",n),t.popKeyword(jt(["fallback","receive"]))==="receive"){const c=Rs(t);return C(c.length===0,"receive cannot have arguments","obj.inputs",c),Us(t,jt(["payable"])),ta(t),new zn(Me,[],!0)}let o=Rs(t);o.length?C(o.length===1&&o[0].type==="bytes","invalid fallback inputs","obj.inputs",o.map(c=>c.format("minimal")).join(", ")):o=[dt.from("bytes")];const a=tE(t);if(C(a==="nonpayable"||a==="payable","fallback cannot be constants","obj.stateMutability",a),Us(t,jt(["returns"])).has("returns")){const c=Rs(t);C(c.length===1&&c[0].type==="bytes","invalid fallback outputs","obj.outputs",c.map(l=>l.format("minimal")).join(", "))}return ta(t),new zn(Me,o,a==="payable")}if(t.type==="receive")return new zn(Me,[],!0);if(t.type==="fallback"){const n=[dt.from("bytes")],s=t.stateMutability==="payable";return new zn(Me,n,s)}C(!1,"invalid fallback description","obj",t)}static isFragment(t){return t&&t[ir]===ix}}class pn extends ff{constructor(t,n,s,i,o,a){super(t,"function",n,i);k(this,"constant");k(this,"outputs");k(this,"stateMutability");k(this,"payable");k(this,"gas");Object.defineProperty(this,ir,{value:ox}),o=Object.freeze(o.slice()),te(this,{constant:s==="view"||s==="pure",gas:a,outputs:o,payable:s==="payable",stateMutability:s})}get selector(){return es(this.format("sighash")).substring(0,10)}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(t))),outputs:this.outputs.map(s=>JSON.parse(s.format(t)))});const n=[];return t!=="sighash"&&n.push("function"),n.push(this.name+vu(t,this.inputs)),t!=="sighash"&&(this.stateMutability!=="nonpayable"&&n.push(this.stateMutability),this.outputs&&this.outputs.length&&(n.push("returns"),n.push(vu(t,this.outputs))),this.gas!=null&&n.push(`@${this.gas.toString()}`)),n.join(" ")}static getSelector(t,n){return n=(n||[]).map(i=>dt.from(i)),new pn(Me,t,"view",n,[],null).selector}static from(t){if(pn.isFragment(t))return t;if(typeof t=="string")try{return pn.from(Ki(t))}catch{C(!1,"invalid function fragment","obj",t)}else if(t instanceof mn){const s=Fd("function",t),i=Rs(t),o=tE(t);let a=[];Us(t,jt(["returns"])).has("returns")&&(a=Rs(t));const c=rE(t);return ta(t),new pn(Me,s,o,i,a,c)}let n=t.stateMutability;return n==null&&(n="payable",typeof t.constant=="boolean"?(n="view",t.constant||(n="payable",typeof t.payable=="boolean"&&!t.payable&&(n="nonpayable"))):typeof t.payable=="boolean"&&!t.payable&&(n="nonpayable")),new pn(Me,t.name,n,t.inputs?t.inputs.map(dt.from):[],t.outputs?t.outputs.map(dt.from):[],t.gas!=null?t.gas:null)}static isFragment(t){return t&&t[ir]===ox}}class Bi extends ff{constructor(e,t,n){super(e,"struct",t,n),Object.defineProperty(this,ir,{value:ax})}format(){throw new Error("@TODO")}static from(e){if(typeof e=="string")try{return Bi.from(Ki(e))}catch{C(!1,"invalid struct fragment","obj",e)}else if(e instanceof mn){const t=Fd("struct",e),n=Rs(e);return ta(e),new Bi(Me,t,n)}return new Bi(Me,e.name,e.inputs?e.inputs.map(dt.from):[])}static isFragment(e){return e&&e[ir]===ax}}const wn=new Map;wn.set(0,"GENERIC_PANIC");wn.set(1,"ASSERT_FALSE");wn.set(17,"OVERFLOW");wn.set(18,"DIVIDE_BY_ZERO");wn.set(33,"ENUM_RANGE_ERROR");wn.set(34,"BAD_STORAGE_DATA");wn.set(49,"STACK_UNDERFLOW");wn.set(50,"ARRAY_RANGE_ERROR");wn.set(65,"OUT_OF_MEMORY");wn.set(81,"UNINITIALIZED_FUNCTION_CALL");const pI=new RegExp(/^bytes([0-9]*)$/),gI=new RegExp(/^(u?int)([0-9]*)$/);let E0=null,cx=1024;function bI(r,e,t,n){let s="missing revert data",i=null;const o=null;let a=null;if(t){s="execution reverted";const l=Q(t);if(t=K(t),l.length===0)s+=" (no data present; likely require(false) occurred",i="require(false)";else if(l.length%32!==4)s+=" (could not decode reason; invalid data length)";else if(K(l.slice(0,4))==="0x08c379a0")try{i=n.decode(["string"],l.slice(4))[0],a={signature:"Error(string)",name:"Error",args:[i]},s+=`: ${JSON.stringify(i)}`}catch{s+=" (could not decode reason; invalid string data)"}else if(K(l.slice(0,4))==="0x4e487b71")try{const u=Number(n.decode(["uint256"],l.slice(4))[0]);a={signature:"Panic(uint256)",name:"Panic",args:[u]},i=`Panic due to ${wn.get(u)||"UNKNOWN"}(${u})`,s+=`: ${i}`}catch{s+=" (could not decode panic code)"}else s+=" (unknown custom error)"}const c={to:e.to?ce(e.to):null,data:e.data||"0x"};return e.from&&(c.from=ce(e.from)),Be(s,"CALL_EXCEPTION",{action:r,data:t,reason:i,transaction:c,invocation:o,revert:a})}var gi,Ba;const Ad=class Ad{constructor(){M(this,gi)}getDefaultValue(e){const t=e.map(s=>q(this,gi,Ba).call(this,dt.from(s)));return new Ff(t,"_").defaultValue()}encode(e,t){Ob(t.length,e.length,"types/values length mismatch");const n=e.map(o=>q(this,gi,Ba).call(this,dt.from(o))),s=new Ff(n,"_"),i=new Mp;return s.encode(i,t),i.data}decode(e,t,n){const s=e.map(o=>q(this,gi,Ba).call(this,dt.from(o)));return new Ff(s,"_").decode(new jp(t,n,cx))}static _setDefaultMaxInflation(e){C(typeof e=="number"&&Number.isInteger(e),"invalid defaultMaxInflation factor","value",e),cx=e}static defaultAbiCoder(){return E0==null&&(E0=new Ad),E0}static getBuiltinCallException(e,t,n){return bI(e,t,n,Ad.defaultAbiCoder())}};gi=new WeakSet,Ba=function(e){if(e.isArray())return new T9(q(this,gi,Ba).call(this,e.arrayChildren),e.arrayLength,e.name);if(e.isTuple())return new Ff(e.components.map(n=>q(this,gi,Ba).call(this,n)),e.name);switch(e.baseType){case"address":return new P9(e.name);case"bool":return new N9(e.name);case"string":return new F9(e.name);case"bytes":return new D9(e.name);case"":return new B9(e.name)}let t=e.type.match(gI);if(t){let n=parseInt(t[2]||"256");return C(n!==0&&n<=256&&n%8===0,"invalid "+t[1]+" bit length","param",e),new L9(n/8,t[1]==="int",e.name)}if(t=e.type.match(pI),t){let n=parseInt(t[1]);return C(n!==0&&n<=32,"invalid bytes length","param",e),new R9(n,e.name)}C(!1,"invalid type","type",e.type)};let ra=Ad;function yI(r){const e=st(r);if(e.length>31)throw new Error("bytes32 string must be less than 32 bytes");return Cd(e,32)}function mI(r){const e=Q(r,"bytes");if(e.length!==32)throw new Error("invalid bytes32 - not 32 bytes long");if(e[31]!==0)throw new Error("invalid bytes32 string - no null terminator");let t=31;for(;e[t-1]===0;)t--;return $i(e.slice(0,t))}class nE{constructor(e,t,n){k(this,"fragment");k(this,"name");k(this,"signature");k(this,"topic");k(this,"args");const s=e.name,i=e.format();te(this,{fragment:e,name:s,signature:i,topic:t,args:n})}}class sE{constructor(e,t,n,s){k(this,"fragment");k(this,"name");k(this,"args");k(this,"signature");k(this,"selector");k(this,"value");const i=e.name,o=e.format();te(this,{fragment:e,name:i,args:n,signature:o,selector:t,value:s})}}class iE{constructor(e,t,n){k(this,"fragment");k(this,"name");k(this,"args");k(this,"signature");k(this,"selector");const s=e.name,i=e.format();te(this,{fragment:e,name:s,args:n,signature:i,selector:t})}}class tg{constructor(e){k(this,"hash");k(this,"_isIndexed");te(this,{hash:e,_isIndexed:!0})}static isIndexed(e){return!!(e&&e._isIndexed)}}const lx={0:"generic panic",1:"assert(false)",17:"arithmetic overflow",18:"division or modulo by zero",33:"enum overflow",34:"invalid encoded storage byte array accessed",49:"out-of-bounds array access; popping on an empty array",50:"out-of-bounds access of an array or bytesN",65:"out of memory",81:"uninitialized function"},ux={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:r=>`reverted with reason string ${JSON.stringify(r)}`},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"],reason:r=>{let e="unknown panic code";return r>=0&&r<=255&&lx[r.toString()]&&(e=lx[r.toString()]),`reverted with panic code 0x${r.toString(16)} (${e})`}}};var kn,Un,$n,_t,Yn,vh,Ah;const go=class go{constructor(e){M(this,Yn);k(this,"fragments");k(this,"deploy");k(this,"fallback");k(this,"receive");M(this,kn);M(this,Un);M(this,$n);M(this,_t);let t=[];typeof e=="string"?t=JSON.parse(e):t=e,S(this,$n,new Map),S(this,kn,new Map),S(this,Un,new Map);const n=[];for(const o of t)try{n.push(Fi.from(o))}catch(a){console.log(`[Warning] Invalid Fragment ${JSON.stringify(o)}:`,a.message)}te(this,{fragments:Object.freeze(n)});let s=null,i=!1;S(this,_t,this.getAbiCoder()),this.fragments.forEach((o,a)=>{let c;switch(o.type){case"constructor":if(this.deploy){console.log("duplicate definition - constructor");return}te(this,{deploy:o});return;case"fallback":o.inputs.length===0?i=!0:(C(!s||o.payable!==s.payable,"conflicting fallback fragments",`fragments[${a}]`,o),s=o,i=s.payable);return;case"function":c=b(this,$n);break;case"event":c=b(this,Un);break;case"error":c=b(this,kn);break;default:return}const l=o.format();c.has(l)||c.set(l,o)}),this.deploy||te(this,{deploy:Vn.from("constructor()")}),te(this,{fallback:s,receive:i})}format(e){const t=e?"minimal":"full";return this.fragments.map(s=>s.format(t))}formatJson(){const e=this.fragments.map(t=>t.format("json"));return JSON.stringify(e.map(t=>JSON.parse(t)))}getAbiCoder(){return ra.defaultAbiCoder()}getFunctionName(e){const t=q(this,Yn,vh).call(this,e,null,!1);return C(t,"no matching function","key",e),t.name}hasFunction(e){return!!q(this,Yn,vh).call(this,e,null,!1)}getFunction(e,t){return q(this,Yn,vh).call(this,e,t||null,!0)}forEachFunction(e){const t=Array.from(b(this,$n).keys());t.sort((n,s)=>n.localeCompare(s));for(let n=0;n<t.length;n++){const s=t[n];e(b(this,$n).get(s),n)}}getEventName(e){const t=q(this,Yn,Ah).call(this,e,null,!1);return C(t,"no matching event","key",e),t.name}hasEvent(e){return!!q(this,Yn,Ah).call(this,e,null,!1)}getEvent(e,t){return q(this,Yn,Ah).call(this,e,t||null,!0)}forEachEvent(e){const t=Array.from(b(this,Un).keys());t.sort((n,s)=>n.localeCompare(s));for(let n=0;n<t.length;n++){const s=t[n];e(b(this,Un).get(s),n)}}getError(e,t){if(De(e)){const s=e.toLowerCase();if(ux[s])return Ft.from(ux[s].signature);for(const i of b(this,kn).values())if(s===i.selector)return i;return null}if(e.indexOf("(")===-1){const s=[];for(const[i,o]of b(this,kn))i.split("(")[0]===e&&s.push(o);if(s.length===0)return e==="Error"?Ft.from("error Error(string)"):e==="Panic"?Ft.from("error Panic(uint256)"):null;if(s.length>1){const i=s.map(o=>JSON.stringify(o.format())).join(", ");C(!1,`ambiguous error description (i.e. ${i})`,"name",e)}return s[0]}if(e=Ft.from(e).format(),e==="Error(string)")return Ft.from("error Error(string)");if(e==="Panic(uint256)")return Ft.from("error Panic(uint256)");const n=b(this,kn).get(e);return n||null}forEachError(e){const t=Array.from(b(this,kn).keys());t.sort((n,s)=>n.localeCompare(s));for(let n=0;n<t.length;n++){const s=t[n];e(b(this,kn).get(s),n)}}_decodeParams(e,t){return b(this,_t).decode(e,t)}_encodeParams(e,t){return b(this,_t).encode(e,t)}encodeDeploy(e){return this._encodeParams(this.deploy.inputs,e||[])}decodeErrorResult(e,t){if(typeof e=="string"){const n=this.getError(e);C(n,"unknown error","fragment",e),e=n}return C(ke(t,0,4)===e.selector,`data signature does not match error ${e.name}.`,"data",t),this._decodeParams(e.inputs,ke(t,4))}encodeErrorResult(e,t){if(typeof e=="string"){const n=this.getError(e);C(n,"unknown error","fragment",e),e=n}return me([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionData(e,t){if(typeof e=="string"){const n=this.getFunction(e);C(n,"unknown function","fragment",e),e=n}return C(ke(t,0,4)===e.selector,`data signature does not match function ${e.name}.`,"data",t),this._decodeParams(e.inputs,ke(t,4))}encodeFunctionData(e,t){if(typeof e=="string"){const n=this.getFunction(e);C(n,"unknown function","fragment",e),e=n}return me([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionResult(e,t){if(typeof e=="string"){const i=this.getFunction(e);C(i,"unknown function","fragment",e),e=i}let n="invalid length for result data";const s=ut(t);if(s.length%32===0)try{return b(this,_t).decode(e.outputs,s)}catch{n="could not decode result data"}z(!1,n,"BAD_DATA",{value:K(s),info:{method:e.name,signature:e.format()}})}makeError(e,t){const n=Q(e,"data"),s=ra.getBuiltinCallException("call",t,n);if(s.message.startsWith("execution reverted (unknown custom error)")){const a=K(n.slice(0,4)),c=this.getError(a);if(c)try{const l=b(this,_t).decode(c.inputs,n.slice(4));s.revert={name:c.name,signature:c.format(),args:l},s.reason=s.revert.signature,s.message=`execution reverted: ${s.reason}`}catch{s.message="execution reverted (coult not decode custom error)"}}const o=this.parseTransaction(t);return o&&(s.invocation={method:o.name,signature:o.signature,args:o.args}),s}encodeFunctionResult(e,t){if(typeof e=="string"){const n=this.getFunction(e);C(n,"unknown function","fragment",e),e=n}return K(b(this,_t).encode(e.outputs,t||[]))}encodeFilterTopics(e,t){if(typeof e=="string"){const i=this.getEvent(e);C(i,"unknown event","eventFragment",e),e=i}z(t.length<=e.inputs.length,`too many arguments for ${e.format()}`,"UNEXPECTED_ARGUMENT",{count:t.length,expectedCount:e.inputs.length});const n=[];e.anonymous||n.push(e.topicHash);const s=(i,o)=>i.type==="string"?es(o):i.type==="bytes"?Ne(K(o)):(i.type==="bool"&&typeof o=="boolean"?o=o?"0x01":"0x00":i.type.match(/^u?int/)?o=Zn(o):i.type.match(/^bytes/)?o=Cd(o,32):i.type==="address"&&b(this,_t).encode(["address"],[o]),vr(K(o),32));for(t.forEach((i,o)=>{const a=e.inputs[o];if(!a.indexed){C(i==null,"cannot filter non-indexed parameters; must be null","contract."+a.name,i);return}i==null?n.push(null):a.baseType==="array"||a.baseType==="tuple"?C(!1,"filtering with tuples or arrays not supported","contract."+a.name,i):Array.isArray(i)?n.push(i.map(c=>s(a,c))):n.push(s(a,i))});n.length&&n[n.length-1]===null;)n.pop();return n}encodeEventLog(e,t){if(typeof e=="string"){const o=this.getEvent(e);C(o,"unknown event","eventFragment",e),e=o}const n=[],s=[],i=[];return e.anonymous||n.push(e.topicHash),C(t.length===e.inputs.length,"event arguments/values mismatch","values",t),e.inputs.forEach((o,a)=>{const c=t[a];if(o.indexed)if(o.type==="string")n.push(es(c));else if(o.type==="bytes")n.push(Ne(c));else{if(o.baseType==="tuple"||o.baseType==="array")throw new Error("not implemented");n.push(b(this,_t).encode([o.type],[c]))}else s.push(o),i.push(c)}),{data:b(this,_t).encode(s,i),topics:n}}decodeEventLog(e,t,n){if(typeof e=="string"){const d=this.getEvent(e);C(d,"unknown event","eventFragment",e),e=d}if(n!=null&&!e.anonymous){const d=e.topicHash;C(De(n[0],32)&&n[0].toLowerCase()===d,"fragment/topic mismatch","topics[0]",n[0]),n=n.slice(1)}const s=[],i=[],o=[];e.inputs.forEach((d,p)=>{d.indexed?d.type==="string"||d.type==="bytes"||d.baseType==="tuple"||d.baseType==="array"?(s.push(dt.from({type:"bytes32",name:d.name})),o.push(!0)):(s.push(d),o.push(!1)):(i.push(d),o.push(!1))});const a=n!=null?b(this,_t).decode(s,me(n)):null,c=b(this,_t).decode(i,t,!0),l=[],u=[];let f=0,h=0;return e.inputs.forEach((d,p)=>{let g=null;if(d.indexed)if(a==null)g=new tg(null);else if(o[p])g=new tg(a[h++]);else try{g=a[h++]}catch(y){g=y}else try{g=c[f++]}catch(y){g=y}l.push(g),u.push(d.name||null)}),Xo.fromItems(l,u)}parseTransaction(e){const t=Q(e.data,"tx.data"),n=re(e.value!=null?e.value:0,"tx.value"),s=this.getFunction(K(t.slice(0,4)));if(!s)return null;const i=b(this,_t).decode(s.inputs,t.slice(4));return new sE(s,s.selector,i,n)}parseCallResult(e){throw new Error("@TODO")}parseLog(e){const t=this.getEvent(e.topics[0]);return!t||t.anonymous?null:new nE(t,t.topicHash,this.decodeEventLog(t,e.data,e.topics))}parseError(e){const t=K(e),n=this.getError(ke(t,0,4));if(!n)return null;const s=b(this,_t).decode(n.inputs,ke(t,4));return new iE(n,n.selector,s)}static from(e){return e instanceof go?e:typeof e=="string"?new go(JSON.parse(e)):typeof e.formatJson=="function"?new go(e.formatJson()):typeof e.format=="function"?new go(e.format("json")):new go(e)}};kn=new WeakMap,Un=new WeakMap,$n=new WeakMap,_t=new WeakMap,Yn=new WeakSet,vh=function(e,t,n){if(De(e)){const i=e.toLowerCase();for(const o of b(this,$n).values())if(i===o.selector)return o;return null}if(e.indexOf("(")===-1){const i=[];for(const[o,a]of b(this,$n))o.split("(")[0]===e&&i.push(a);if(t){const o=t.length>0?t[t.length-1]:null;let a=t.length,c=!0;At.isTyped(o)&&o.type==="overrides"&&(c=!1,a--);for(let l=i.length-1;l>=0;l--){const u=i[l].inputs.length;u!==a&&(!c||u!==a-1)&&i.splice(l,1)}for(let l=i.length-1;l>=0;l--){const u=i[l].inputs;for(let f=0;f<t.length;f++)if(At.isTyped(t[f])){if(f>=u.length){if(t[f].type==="overrides")continue;i.splice(l,1);break}if(t[f].type!==u[f].baseType){i.splice(l,1);break}}}}if(i.length===1&&t&&t.length!==i[0].inputs.length){const o=t[t.length-1];(o==null||Array.isArray(o)||typeof o!="object")&&i.splice(0,1)}if(i.length===0)return null;if(i.length>1&&n){const o=i.map(a=>JSON.stringify(a.format())).join(", ");C(!1,`ambiguous function description (i.e. matches ${o})`,"key",e)}return i[0]}const s=b(this,$n).get(pn.from(e).format());return s||null},Ah=function(e,t,n){if(De(e)){const i=e.toLowerCase();for(const o of b(this,Un).values())if(i===o.topicHash)return o;return null}if(e.indexOf("(")===-1){const i=[];for(const[o,a]of b(this,Un))o.split("(")[0]===e&&i.push(a);if(t){for(let o=i.length-1;o>=0;o--)i[o].inputs.length<t.length&&i.splice(o,1);for(let o=i.length-1;o>=0;o--){const a=i[o].inputs;for(let c=0;c<t.length;c++)if(At.isTyped(t[c])&&t[c].type!==a[c].baseType){i.splice(o,1);break}}}if(i.length===0)return null;if(i.length>1&&n){const o=i.map(a=>JSON.stringify(a.format())).join(", ");C(!1,`ambiguous event description (i.e. matches ${o})`,"key",e)}return i[0]}const s=b(this,Un).get(dn.from(e).format());return s||null};let Au=go;const oE=BigInt(0);function Ja(r){return r??null}function Ke(r){return r==null?null:r.toString()}class rg{constructor(e,t,n){k(this,"gasPrice");k(this,"maxFeePerGas");k(this,"maxPriorityFeePerGas");te(this,{gasPrice:Ja(e),maxFeePerGas:Ja(t),maxPriorityFeePerGas:Ja(n)})}toJSON(){const{gasPrice:e,maxFeePerGas:t,maxPriorityFeePerGas:n}=this;return{_type:"FeeData",gasPrice:Ke(e),maxFeePerGas:Ke(t),maxPriorityFeePerGas:Ke(n)}}}function sl(r){const e={};r.to&&(e.to=r.to),r.from&&(e.from=r.from),r.data&&(e.data=K(r.data));const t="chainId,gasLimit,gasPrice,maxFeePerBlobGas,maxFeePerGas,maxPriorityFeePerGas,value".split(/,/);for(const s of t)!(s in r)||r[s]==null||(e[s]=re(r[s],`request.${s}`));const n="type,nonce".split(/,/);for(const s of n)!(s in r)||r[s]==null||(e[s]=ae(r[s],`request.${s}`));return r.accessList&&(e.accessList=Hs(r.accessList)),r.authorizationList&&(e.authorizationList=r.authorizationList.slice()),"blockTag"in r&&(e.blockTag=r.blockTag),"enableCcipRead"in r&&(e.enableCcipRead=!!r.enableCcipRead),"customData"in r&&(e.customData=r.customData),"blobVersionedHashes"in r&&r.blobVersionedHashes&&(e.blobVersionedHashes=r.blobVersionedHashes.slice()),"kzg"in r&&(e.kzg=r.kzg),"blobs"in r&&r.blobs&&(e.blobs=r.blobs.map(s=>of(s)?K(s):Object.assign({},s))),e}var vs;class aE{constructor(e,t){k(this,"provider");k(this,"number");k(this,"hash");k(this,"timestamp");k(this,"parentHash");k(this,"parentBeaconBlockRoot");k(this,"nonce");k(this,"difficulty");k(this,"gasLimit");k(this,"gasUsed");k(this,"stateRoot");k(this,"receiptsRoot");k(this,"blobGasUsed");k(this,"excessBlobGas");k(this,"miner");k(this,"prevRandao");k(this,"extraData");k(this,"baseFeePerGas");M(this,vs);S(this,vs,e.transactions.map(n=>typeof n!="string"?new il(n,t):n)),te(this,{provider:t,hash:Ja(e.hash),number:e.number,timestamp:e.timestamp,parentHash:e.parentHash,parentBeaconBlockRoot:e.parentBeaconBlockRoot,nonce:e.nonce,difficulty:e.difficulty,gasLimit:e.gasLimit,gasUsed:e.gasUsed,blobGasUsed:e.blobGasUsed,excessBlobGas:e.excessBlobGas,miner:e.miner,prevRandao:Ja(e.prevRandao),extraData:e.extraData,baseFeePerGas:Ja(e.baseFeePerGas),stateRoot:e.stateRoot,receiptsRoot:e.receiptsRoot})}get transactions(){return b(this,vs).map(e=>typeof e=="string"?e:e.hash)}get prefetchedTransactions(){const e=b(this,vs).slice();return e.length===0?[]:(z(typeof e[0]=="object","transactions were not prefetched with block request","UNSUPPORTED_OPERATION",{operation:"transactionResponses()"}),e)}toJSON(){const{baseFeePerGas:e,difficulty:t,extraData:n,gasLimit:s,gasUsed:i,hash:o,miner:a,prevRandao:c,nonce:l,number:u,parentHash:f,parentBeaconBlockRoot:h,stateRoot:d,receiptsRoot:p,timestamp:g,transactions:y}=this;return{_type:"Block",baseFeePerGas:Ke(e),difficulty:Ke(t),extraData:n,gasLimit:Ke(s),gasUsed:Ke(i),blobGasUsed:Ke(this.blobGasUsed),excessBlobGas:Ke(this.excessBlobGas),hash:o,miner:a,prevRandao:c,nonce:l,number:u,parentHash:f,timestamp:g,parentBeaconBlockRoot:h,stateRoot:d,receiptsRoot:p,transactions:y}}[Symbol.iterator](){let e=0;const t=this.transactions;return{next:()=>e<this.length?{value:t[e++],done:!1}:{value:void 0,done:!0}}}get length(){return b(this,vs).length}get date(){return this.timestamp==null?null:new Date(this.timestamp*1e3)}async getTransaction(e){let t;if(typeof e=="number")t=b(this,vs)[e];else{const n=e.toLowerCase();for(const s of b(this,vs))if(typeof s=="string"){if(s!==n)continue;t=s;break}else{if(s.hash!==n)continue;t=s;break}}if(t==null)throw new Error("no such tx");return typeof t=="string"?await this.provider.getTransaction(t):t}getPrefetchedTransaction(e){const t=this.prefetchedTransactions;if(typeof e=="number")return t[e];e=e.toLowerCase();for(const n of t)if(n.hash===e)return n;C(!1,"no matching transaction","indexOrHash",e)}isMined(){return!!this.hash}isLondon(){return!!this.baseFeePerGas}orphanedEvent(){if(!this.isMined())throw new Error("");return xI(this)}}vs=new WeakMap;class xl{constructor(e,t){k(this,"provider");k(this,"transactionHash");k(this,"blockHash");k(this,"blockNumber");k(this,"removed");k(this,"address");k(this,"data");k(this,"topics");k(this,"index");k(this,"transactionIndex");this.provider=t;const n=Object.freeze(e.topics.slice());te(this,{transactionHash:e.transactionHash,blockHash:e.blockHash,blockNumber:e.blockNumber,removed:e.removed,address:e.address,data:e.data,topics:n,index:e.index,transactionIndex:e.transactionIndex})}toJSON(){const{address:e,blockHash:t,blockNumber:n,data:s,index:i,removed:o,topics:a,transactionHash:c,transactionIndex:l}=this;return{_type:"log",address:e,blockHash:t,blockNumber:n,data:s,index:i,removed:o,topics:a,transactionHash:c,transactionIndex:l}}async getBlock(){const e=await this.provider.getBlock(this.blockHash);return z(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransaction(){const e=await this.provider.getTransaction(this.transactionHash);return z(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransactionReceipt(){const e=await this.provider.getTransactionReceipt(this.transactionHash);return z(!!e,"failed to find transaction receipt","UNKNOWN_ERROR",{}),e}removedEvent(){return wI(this)}}var Vu;class Xb{constructor(e,t){k(this,"provider");k(this,"to");k(this,"from");k(this,"contractAddress");k(this,"hash");k(this,"index");k(this,"blockHash");k(this,"blockNumber");k(this,"logsBloom");k(this,"gasUsed");k(this,"blobGasUsed");k(this,"cumulativeGasUsed");k(this,"gasPrice");k(this,"blobGasPrice");k(this,"type");k(this,"status");k(this,"root");M(this,Vu);S(this,Vu,Object.freeze(e.logs.map(s=>new xl(s,t))));let n=oE;e.effectiveGasPrice!=null?n=e.effectiveGasPrice:e.gasPrice!=null&&(n=e.gasPrice),te(this,{provider:t,to:e.to,from:e.from,contractAddress:e.contractAddress,hash:e.hash,index:e.index,blockHash:e.blockHash,blockNumber:e.blockNumber,logsBloom:e.logsBloom,gasUsed:e.gasUsed,cumulativeGasUsed:e.cumulativeGasUsed,blobGasUsed:e.blobGasUsed,gasPrice:n,blobGasPrice:e.blobGasPrice,type:e.type,status:e.status,root:e.root})}get logs(){return b(this,Vu)}toJSON(){const{to:e,from:t,contractAddress:n,hash:s,index:i,blockHash:o,blockNumber:a,logsBloom:c,logs:l,status:u,root:f}=this;return{_type:"TransactionReceipt",blockHash:o,blockNumber:a,contractAddress:n,cumulativeGasUsed:Ke(this.cumulativeGasUsed),from:t,gasPrice:Ke(this.gasPrice),blobGasUsed:Ke(this.blobGasUsed),blobGasPrice:Ke(this.blobGasPrice),gasUsed:Ke(this.gasUsed),hash:s,index:i,logs:l,logsBloom:c,root:f,status:u,to:e}}get length(){return this.logs.length}[Symbol.iterator](){let e=0;return{next:()=>e<this.length?{value:this.logs[e++],done:!1}:{value:void 0,done:!0}}}get fee(){return this.gasUsed*this.gasPrice}async getBlock(){const e=await this.provider.getBlock(this.blockHash);if(e==null)throw new Error("TODO");return e}async getTransaction(){const e=await this.provider.getTransaction(this.hash);if(e==null)throw new Error("TODO");return e}async getResult(){return await this.provider.getTransactionResult(this.hash)}async confirmations(){return await this.provider.getBlockNumber()-this.blockNumber+1}removedEvent(){return lE(this)}reorderedEvent(e){return z(!e||e.isMined(),"unmined 'other' transction cannot be orphaned","UNSUPPORTED_OPERATION",{operation:"reorderedEvent(other)"}),cE(this,e)}}Vu=new WeakMap;var bi;const Zy=class Zy{constructor(e,t){k(this,"provider");k(this,"blockNumber");k(this,"blockHash");k(this,"index");k(this,"hash");k(this,"type");k(this,"to");k(this,"from");k(this,"nonce");k(this,"gasLimit");k(this,"gasPrice");k(this,"maxPriorityFeePerGas");k(this,"maxFeePerGas");k(this,"maxFeePerBlobGas");k(this,"data");k(this,"value");k(this,"chainId");k(this,"signature");k(this,"accessList");k(this,"blobVersionedHashes");k(this,"authorizationList");M(this,bi);this.provider=t,this.blockNumber=e.blockNumber!=null?e.blockNumber:null,this.blockHash=e.blockHash!=null?e.blockHash:null,this.hash=e.hash,this.index=e.index,this.type=e.type,this.from=e.from,this.to=e.to||null,this.gasLimit=e.gasLimit,this.nonce=e.nonce,this.data=e.data,this.value=e.value,this.gasPrice=e.gasPrice,this.maxPriorityFeePerGas=e.maxPriorityFeePerGas!=null?e.maxPriorityFeePerGas:null,this.maxFeePerGas=e.maxFeePerGas!=null?e.maxFeePerGas:null,this.maxFeePerBlobGas=e.maxFeePerBlobGas!=null?e.maxFeePerBlobGas:null,this.chainId=e.chainId,this.signature=e.signature,this.accessList=e.accessList!=null?e.accessList:null,this.blobVersionedHashes=e.blobVersionedHashes!=null?e.blobVersionedHashes:null,this.authorizationList=e.authorizationList!=null?e.authorizationList:null,S(this,bi,-1)}toJSON(){const{blockNumber:e,blockHash:t,index:n,hash:s,type:i,to:o,from:a,nonce:c,data:l,signature:u,accessList:f,blobVersionedHashes:h}=this;return{_type:"TransactionResponse",accessList:f,blockNumber:e,blockHash:t,blobVersionedHashes:h,chainId:Ke(this.chainId),data:l,from:a,gasLimit:Ke(this.gasLimit),gasPrice:Ke(this.gasPrice),hash:s,maxFeePerGas:Ke(this.maxFeePerGas),maxPriorityFeePerGas:Ke(this.maxPriorityFeePerGas),maxFeePerBlobGas:Ke(this.maxFeePerBlobGas),nonce:c,signature:u,to:o,index:n,type:i,value:Ke(this.value)}}async getBlock(){let e=this.blockNumber;if(e==null){const n=await this.getTransaction();n&&(e=n.blockNumber)}if(e==null)return null;const t=this.provider.getBlock(e);if(t==null)throw new Error("TODO");return t}async getTransaction(){return this.provider.getTransaction(this.hash)}async confirmations(){if(this.blockNumber==null){const{tx:t,blockNumber:n}=await ct({tx:this.getTransaction(),blockNumber:this.provider.getBlockNumber()});return t==null||t.blockNumber==null?0:n-t.blockNumber+1}return await this.provider.getBlockNumber()-this.blockNumber+1}async wait(e,t){const n=e??1,s=t??0;let i=b(this,bi),o=-1,a=i===-1;const c=async()=>{if(a)return null;const{blockNumber:h,nonce:d}=await ct({blockNumber:this.provider.getBlockNumber(),nonce:this.provider.getTransactionCount(this.from)});if(d<this.nonce){i=h;return}if(a)return null;const p=await this.getTransaction();if(!(p&&p.blockNumber!=null))for(o===-1&&(o=i-3,o<b(this,bi)&&(o=b(this,bi)));o<=h;){if(a)return null;const g=await this.provider.getBlock(o,!0);if(g==null)return;for(const y of g)if(y===this.hash)return;for(let y=0;y<g.length;y++){const x=await g.getTransaction(y);if(x.from===this.from&&x.nonce===this.nonce){if(a)return null;const A=await this.provider.getTransactionReceipt(x.hash);if(A==null||h-A.blockNumber+1<n)return;let w="replaced";x.data===this.data&&x.to===this.to&&x.value===this.value?w="repriced":x.data==="0x"&&x.from===x.to&&x.value===oE&&(w="cancelled"),z(!1,"transaction was replaced","TRANSACTION_REPLACED",{cancelled:w==="replaced"||w==="cancelled",reason:w,replacement:x.replaceableTransaction(i),hash:x.hash,receipt:A})}}o++}},l=h=>{if(h==null||h.status!==0)return h;z(!1,"transaction execution reverted","CALL_EXCEPTION",{action:"sendTransaction",data:null,reason:null,invocation:null,revert:null,transaction:{to:h.to,from:h.from,data:""},receipt:h})},u=await this.provider.getTransactionReceipt(this.hash);if(n===0)return l(u);if(u){if(n===1||await u.confirmations()>=n)return l(u)}else if(await c(),n===0)return null;return await new Promise((h,d)=>{const p=[],g=()=>{p.forEach(x=>x())};if(p.push(()=>{a=!0}),s>0){const x=setTimeout(()=>{g(),d(Be("wait for transaction timeout","TIMEOUT"))},s);p.push(()=>{clearTimeout(x)})}const y=async x=>{if(await x.confirmations()>=n){g();try{h(l(x))}catch(A){d(A)}}};if(p.push(()=>{this.provider.off(this.hash,y)}),this.provider.on(this.hash,y),i>=0){const x=async()=>{try{await c()}catch(A){if(Qe(A,"TRANSACTION_REPLACED")){g(),d(A);return}}a||this.provider.once("block",x)};p.push(()=>{this.provider.off("block",x)}),this.provider.once("block",x)}})}isMined(){return this.blockHash!=null}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}removedEvent(){return z(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),lE(this)}reorderedEvent(e){return z(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),z(!e||e.isMined(),"unmined 'other' transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),cE(this,e)}replaceableTransaction(e){C(Number.isInteger(e)&&e>=0,"invalid startBlock","startBlock",e);const t=new Zy(this,this.provider);return S(t,bi,e),t}};bi=new WeakMap;let il=Zy;function xI(r){return{orphan:"drop-block",hash:r.hash,number:r.number}}function cE(r,e){return{orphan:"reorder-transaction",tx:r,other:e}}function lE(r){return{orphan:"drop-transaction",tx:r}}function wI(r){return{orphan:"drop-log",log:{transactionHash:r.transactionHash,blockHash:r.blockHash,blockNumber:r.blockNumber,address:r.address,data:r.data,topics:Object.freeze(r.topics.slice()),index:r.index}}}class Md extends xl{constructor(t,n,s){super(t,t.provider);k(this,"interface");k(this,"fragment");k(this,"args");const i=n.decodeEventLog(s,t.data,t.topics);te(this,{args:i,fragment:s,interface:n})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}class ey extends xl{constructor(t,n){super(t,t.provider);k(this,"error");te(this,{error:n})}}var Cc;class uE extends Xb{constructor(t,n,s){super(s,n);M(this,Cc);S(this,Cc,t)}get logs(){return super.logs.map(t=>{const n=t.topics.length?b(this,Cc).getEvent(t.topics[0]):null;if(n)try{return new Md(t,b(this,Cc),n)}catch(s){return new ey(t,s)}return t})}}Cc=new WeakMap;var Ku;class jd extends il{constructor(t,n,s){super(s,n);M(this,Ku);S(this,Ku,t)}async wait(t,n){const s=await super.wait(t,n);return s==null?null:new uE(b(this,Ku),this.provider,s)}}Ku=new WeakMap;class ty extends Tb{constructor(t,n,s,i){super(t,n,s);k(this,"log");te(this,{log:i})}async getBlock(){return await this.log.getBlock()}async getTransaction(){return await this.log.getTransaction()}async getTransactionReceipt(){return await this.log.getTransactionReceipt()}}class fE extends ty{constructor(e,t,n,s,i){super(e,t,n,new Md(i,e.interface,s));const o=e.interface.decodeEventLog(s,this.log.data,this.log.topics);te(this,{args:o,fragment:s})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}const fx=BigInt(0);function hE(r){return r&&typeof r.call=="function"}function dE(r){return r&&typeof r.estimateGas=="function"}function zd(r){return r&&typeof r.resolveName=="function"}function pE(r){return r&&typeof r.sendTransaction=="function"}function gE(r){if(r!=null){if(zd(r))return r;if(r.provider)return r.provider}}var Gu;class EI{constructor(e,t,n){M(this,Gu);k(this,"fragment");if(te(this,{fragment:t}),t.inputs.length<n.length)throw new Error("too many arguments");const s=na(e.runner,"resolveName"),i=zd(s)?s:null;S(this,Gu,(async function(){const o=await Promise.all(t.inputs.map((a,c)=>n[c]==null?null:a.walkAsync(n[c],(u,f)=>u==="address"?Array.isArray(f)?Promise.all(f.map(h=>nt(h,i))):nt(f,i):f)));return e.interface.encodeFilterTopics(t,o)})())}getTopicFilter(){return b(this,Gu)}}Gu=new WeakMap;function na(r,e){return r==null?null:typeof r[e]=="function"?r:r.provider&&typeof r.provider[e]=="function"?r.provider:null}function wo(r){return r==null?null:r.provider||null}async function ry(r,e){const t=At.dereference(r,"overrides");C(typeof t=="object","invalid overrides parameter","overrides",r);const n=sl(t);return C(n.to==null||(e||[]).indexOf("to")>=0,"cannot override to","overrides.to",n.to),C(n.data==null||(e||[]).indexOf("data")>=0,"cannot override data","overrides.data",n.data),n.from&&(n.from=n.from),n}async function bE(r,e,t){const n=na(r,"resolveName"),s=zd(n)?n:null;return await Promise.all(e.map((i,o)=>i.walkAsync(t[o],(a,c)=>(c=At.dereference(c,a),a==="address"?nt(c,s):c))))}function vI(r){const e=async function(o){const a=await ry(o,["data"]);a.to=await r.getAddress(),a.from&&(a.from=await nt(a.from,gE(r.runner)));const c=r.interface,l=re(a.value||fx,"overrides.value")===fx,u=(a.data||"0x")==="0x";c.fallback&&!c.fallback.payable&&c.receive&&!u&&!l&&C(!1,"cannot send data to receive or send value to non-payable fallback","overrides",o),C(c.fallback||u,"cannot send data to receive-only contract","overrides.data",a.data);const f=c.receive||c.fallback&&c.fallback.payable;return C(f||l,"cannot send value to non-payable fallback","overrides.value",a.value),C(c.fallback||u,"cannot send data to receive-only contract","overrides.data",a.data),a},t=async function(o){const a=na(r.runner,"call");z(hE(a),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const c=await e(o);try{return await a.call(c)}catch(l){throw Pd(l)&&l.data?r.interface.makeError(l.data,c):l}},n=async function(o){const a=r.runner;z(pE(a),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const c=await a.sendTransaction(await e(o)),l=wo(r.runner);return new jd(r.interface,l,c)},s=async function(o){const a=na(r.runner,"estimateGas");return z(dE(a),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await a.estimateGas(await e(o))},i=async o=>await n(o);return te(i,{_contract:r,estimateGas:s,populateTransaction:e,send:n,staticCall:t}),i}function AI(r,e){const t=function(...l){const u=r.interface.getFunction(e,l);return z(u,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:l}}),u},n=async function(...l){const u=t(...l);let f={};if(u.inputs.length+1===l.length&&(f=await ry(l.pop()),f.from&&(f.from=await nt(f.from,gE(r.runner)))),u.inputs.length!==l.length)throw new Error("internal error: fragment inputs doesn't match arguments; should not happen");const h=await bE(r.runner,u.inputs,l);return Object.assign({},f,await ct({to:r.getAddress(),data:r.interface.encodeFunctionData(u,h)}))},s=async function(...l){const u=await a(...l);return u.length===1?u[0]:u},i=async function(...l){const u=r.runner;z(pE(u),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const f=await u.sendTransaction(await n(...l)),h=wo(r.runner);return new jd(r.interface,h,f)},o=async function(...l){const u=na(r.runner,"estimateGas");return z(dE(u),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await u.estimateGas(await n(...l))},a=async function(...l){const u=na(r.runner,"call");z(hE(u),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const f=await n(...l);let h="0x";try{h=await u.call(f)}catch(p){throw Pd(p)&&p.data?r.interface.makeError(p.data,f):p}const d=t(...l);return r.interface.decodeFunctionResult(d,h)},c=async(...l)=>t(...l).constant?await s(...l):await i(...l);return te(c,{name:r.interface.getFunctionName(e),_contract:r,_key:e,getFragment:t,estimateGas:o,populateTransaction:n,send:i,staticCall:s,staticCallResult:a}),Object.defineProperty(c,"fragment",{configurable:!1,enumerable:!0,get:()=>{const l=r.interface.getFunction(e);return z(l,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),l}}),c}function II(r,e){const t=function(...s){const i=r.interface.getEvent(e,s);return z(i,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:s}}),i},n=function(...s){return new EI(r,t(...s),s)};return te(n,{name:r.interface.getEventName(e),_contract:r,_key:e,getFragment:t}),Object.defineProperty(n,"fragment",{configurable:!1,enumerable:!0,get:()=>{const s=r.interface.getEvent(e);return z(s,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),s}}),n}const Wh=Symbol.for("_ethersInternal_contract"),yE=new WeakMap;function SI(r,e){yE.set(r[Wh],e)}function hr(r){return yE.get(r[Wh])}function OI(r){return r&&typeof r=="object"&&"getTopicFilter"in r&&typeof r.getTopicFilter=="function"&&r.fragment}async function ny(r,e){let t,n=null;if(Array.isArray(e)){const i=function(o){if(De(o,32))return o;const a=r.interface.getEvent(o);return C(a,"unknown fragment","name",o),a.topicHash};t=e.map(o=>o==null?null:Array.isArray(o)?o.map(i):i(o))}else e==="*"?t=[null]:typeof e=="string"?De(e,32)?t=[e]:(n=r.interface.getEvent(e),C(n,"unknown fragment","event",e),t=[n.topicHash]):OI(e)?t=await e.getTopicFilter():"fragment"in e?(n=e.fragment,t=[n.topicHash]):C(!1,"unknown event name","event",e);t=t.map(i=>{if(i==null)return null;if(Array.isArray(i)){const o=Array.from(new Set(i.map(a=>a.toLowerCase())).values());return o.length===1?o[0]:(o.sort(),o)}return i.toLowerCase()});const s=t.map(i=>i==null?"null":Array.isArray(i)?i.join("|"):i).join("&");return{fragment:n,tag:s,topics:t}}async function Ql(r,e){const{subs:t}=hr(r);return t.get((await ny(r,e)).tag)||null}async function hx(r,e,t){const n=wo(r.runner);z(n,"contract runner does not support subscribing","UNSUPPORTED_OPERATION",{operation:e});const{fragment:s,tag:i,topics:o}=await ny(r,t),{addr:a,subs:c}=hr(r);let l=c.get(i);if(!l){const f={address:a||r,topics:o},h=y=>{let x=s;if(x==null)try{x=r.interface.getEvent(y.topics[0])}catch{}if(x){const A=x,w=s?r.interface.decodeEventLog(s,y.data,y.topics):[];sg(r,t,w,O=>new fE(r,O,t,A,y))}else sg(r,t,[],A=>new ty(r,A,t,y))};let d=[];l={tag:i,listeners:[],start:()=>{d.length||d.push(n.on(f,h))},stop:async()=>{if(d.length==0)return;let y=d;d=[],await Promise.all(y),n.off(f,h)}},c.set(i,l)}return l}let ng=Promise.resolve();async function PI(r,e,t,n){await ng;const s=await Ql(r,e);if(!s)return!1;const i=s.listeners.length;return s.listeners=s.listeners.filter(({listener:o,once:a})=>{const c=Array.from(t);n&&c.push(n(a?null:o));try{o.call(r,...c)}catch{}return!a}),s.listeners.length===0&&(s.stop(),hr(r).subs.delete(s.tag)),i>0}async function sg(r,e,t,n){try{await ng}catch{}const s=PI(r,e,t,n);return ng=s,await s}const jf=["then"];var Q2;Q2=Wh;const pu=class pu{constructor(e,t,n,s){k(this,"target");k(this,"interface");k(this,"runner");k(this,"filters");k(this,Q2);k(this,"fallback");C(typeof e=="string"||qb(e),"invalid value for Contract target","target",e),n==null&&(n=null);const i=Au.from(t);te(this,{target:e,runner:n,interface:i}),Object.defineProperty(this,Wh,{value:{}});let o,a=null,c=null;if(s){const f=wo(n);c=new jd(this.interface,f,s)}let l=new Map;if(typeof e=="string")if(De(e))a=e,o=Promise.resolve(e);else{const f=na(n,"resolveName");if(!zd(f))throw Be("contract runner does not support name resolution","UNSUPPORTED_OPERATION",{operation:"resolveName"});o=f.resolveName(e).then(h=>{if(h==null)throw Be("an ENS name used for a contract target must be correctly configured","UNCONFIGURED_NAME",{value:e});return hr(this).addr=h,h})}else o=e.getAddress().then(f=>{if(f==null)throw new Error("TODO");return hr(this).addr=f,f});SI(this,{addrPromise:o,addr:a,deployTx:c,subs:l});const u=new Proxy({},{get:(f,h,d)=>{if(typeof h=="symbol"||jf.indexOf(h)>=0)return Reflect.get(f,h,d);try{return this.getEvent(h)}catch(p){if(!Qe(p,"INVALID_ARGUMENT")||p.argument!=="key")throw p}},has:(f,h)=>jf.indexOf(h)>=0?Reflect.has(f,h):Reflect.has(f,h)||this.interface.hasEvent(String(h))});return te(this,{filters:u}),te(this,{fallback:i.receive||i.fallback?vI(this):null}),new Proxy(this,{get:(f,h,d)=>{if(typeof h=="symbol"||h in f||jf.indexOf(h)>=0)return Reflect.get(f,h,d);try{return f.getFunction(h)}catch(p){if(!Qe(p,"INVALID_ARGUMENT")||p.argument!=="key")throw p}},has:(f,h)=>typeof h=="symbol"||h in f||jf.indexOf(h)>=0?Reflect.has(f,h):f.interface.hasFunction(h)})}connect(e){return new pu(this.target,this.interface,e)}attach(e){return new pu(e,this.interface,this.runner)}async getAddress(){return await hr(this).addrPromise}async getDeployedCode(){const e=wo(this.runner);z(e,"runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"getDeployedCode"});const t=await e.getCode(await this.getAddress());return t==="0x"?null:t}async waitForDeployment(){const e=this.deploymentTransaction();if(e)return await e.wait(),this;if(await this.getDeployedCode()!=null)return this;const n=wo(this.runner);return z(n!=null,"contract runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"waitForDeployment"}),new Promise((s,i)=>{const o=async()=>{try{if(await this.getDeployedCode()!=null)return s(this);n.once("block",o)}catch(a){i(a)}};o()})}deploymentTransaction(){return hr(this).deployTx}getFunction(e){return typeof e!="string"&&(e=e.format()),AI(this,e)}getEvent(e){return typeof e!="string"&&(e=e.format()),II(this,e)}async queryTransaction(e){throw new Error("@TODO")}async queryFilter(e,t,n){t==null&&(t=0),n==null&&(n="latest");const{addr:s,addrPromise:i}=hr(this),o=s||await i,{fragment:a,topics:c}=await ny(this,e),l={address:o,topics:c,fromBlock:t,toBlock:n},u=wo(this.runner);return z(u,"contract runner does not have a provider","UNSUPPORTED_OPERATION",{operation:"queryFilter"}),(await u.getLogs(l)).map(f=>{let h=a;if(h==null)try{h=this.interface.getEvent(f.topics[0])}catch{}if(h)try{return new Md(f,this.interface,h)}catch(d){return new ey(f,d)}return new xl(f,u)})}async on(e,t){const n=await hx(this,"on",e);return n.listeners.push({listener:t,once:!1}),n.start(),this}async once(e,t){const n=await hx(this,"once",e);return n.listeners.push({listener:t,once:!0}),n.start(),this}async emit(e,...t){return await sg(this,e,t,null)}async listenerCount(e){if(e){const s=await Ql(this,e);return s?s.listeners.length:0}const{subs:t}=hr(this);let n=0;for(const{listeners:s}of t.values())n+=s.length;return n}async listeners(e){if(e){const s=await Ql(this,e);return s?s.listeners.map(({listener:i})=>i):[]}const{subs:t}=hr(this);let n=[];for(const{listeners:s}of t.values())n=n.concat(s.map(({listener:i})=>i));return n}async off(e,t){const n=await Ql(this,e);if(!n)return this;if(t){const s=n.listeners.map(({listener:i})=>i).indexOf(t);s>=0&&n.listeners.splice(s,1)}return(t==null||n.listeners.length===0)&&(n.stop(),hr(this).subs.delete(n.tag)),this}async removeAllListeners(e){if(e){const t=await Ql(this,e);if(!t)return this;t.stop(),hr(this).subs.delete(t.tag)}else{const{subs:t}=hr(this);for(const{tag:n,stop:s}of t.values())s(),t.delete(n)}return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return await this.off(e,t)}static buildClass(e){class t extends pu{constructor(s,i=null){super(s,e,i)}}return t}static from(e,t,n){return n==null&&(n=null),new this(e,t,n)}};let ol=pu;function CI(){return ol}class ki extends CI(){}class sy{constructor(e,t,n){k(this,"interface");k(this,"bytecode");k(this,"runner");const s=Au.from(e);t instanceof Uint8Array||(typeof t=="object"&&(t=t.object),t.startsWith("0x")||(t="0x"+t)),t=K(Q(t)),te(this,{bytecode:t,interface:s,runner:n||null})}attach(e){return new ol(e,this.interface,this.runner)}async getDeployTransaction(...e){let t={};const n=this.interface.deploy;if(n.inputs.length+1===e.length&&(t=await ry(e.pop())),n.inputs.length!==e.length)throw new Error("incorrect number of arguments to constructor");const s=await bE(this.runner,n.inputs,e),i=me([this.bytecode,this.interface.encodeDeploy(s)]);return Object.assign({},t,{data:i})}async deploy(...e){const t=await this.getDeployTransaction(...e);z(this.runner&&typeof this.runner.sendTransaction=="function","factory runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const n=await this.runner.sendTransaction(t),s=Hb(n);return new ol(s,this.interface,this.runner,n)}connect(e){return new sy(this.interface,this.bytecode,e)}static fromSolidity(e,t){C(e!=null,"bad compiler output","output",e),typeof e=="string"&&(e=JSON.parse(e));const n=e.abi;let s="";return e.bytecode?s=e.bytecode:e.evm&&e.evm.bytecode&&(s=e.evm.bytecode),new this(n,s,t)}}function v0(r){return r.match(/^ipfs:\/\/ipfs\//i)?r=r.substring(12):r.match(/^ipfs:\/\//i)?r=r.substring(7):C(!1,"unsupported IPFS format","link",r),`https://gateway.ipfs.io/ipfs/${r}`}class mE{constructor(e){k(this,"name");te(this,{name:e})}connect(e){return this}supportsCoinType(e){return!1}async encodeAddress(e,t){throw new Error("unsupported coin")}async decodeAddress(e,t){throw new Error("unsupported coin")}}const xE=new RegExp("^(ipfs)://(.*)$","i"),dx=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),xE,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];var yi,$o,mi,ka,Id,wE;const Va=class Va{constructor(e,t,n){M(this,mi);k(this,"provider");k(this,"address");k(this,"name");M(this,yi);M(this,$o);te(this,{provider:e,address:t,name:n}),S(this,yi,null),S(this,$o,new ki(t,["function supportsInterface(bytes4) view returns (bool)","function resolve(bytes, bytes) view returns (bytes)","function addr(bytes32) view returns (address)","function addr(bytes32, uint) view returns (bytes)","function text(bytes32, string) view returns (string)","function contenthash(bytes32) view returns (bytes)"],e))}async supportsWildcard(){return b(this,yi)==null&&S(this,yi,(async()=>{try{return await b(this,$o).supportsInterface("0x9061b923")}catch(e){if(Qe(e,"CALL_EXCEPTION"))return!1;throw S(this,yi,null),e}})()),await b(this,yi)}async getAddress(e){if(e==null&&(e=60),e===60)try{const i=await q(this,mi,ka).call(this,"addr(bytes32)");return i==null||i===tl?null:i}catch(i){if(Qe(i,"CALL_EXCEPTION"))return null;throw i}if(e>=0&&e<2147483648){let i=e+2147483648;const o=await q(this,mi,ka).call(this,"addr(bytes32,uint)",[i]);if(De(o,20))return ce(o)}let t=null;for(const i of this.provider.plugins)if(i instanceof mE&&i.supportsCoinType(e)){t=i;break}if(t==null)return null;const n=await q(this,mi,ka).call(this,"addr(bytes32,uint)",[e]);if(n==null||n==="0x")return null;const s=await t.decodeAddress(e,n);if(s!=null)return s;z(!1,"invalid coin data","UNSUPPORTED_OPERATION",{operation:`getAddress(${e})`,info:{coinType:e,data:n}})}async getText(e){const t=await q(this,mi,ka).call(this,"text(bytes32,string)",[e]);return t==null||t==="0x"?null:t}async getContentHash(){const e=await q(this,mi,ka).call(this,"contenthash(bytes32)");if(e==null||e==="0x")return null;const t=e.match(/^0x(e3010170|e5010172)(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(t){const s=t[1]==="e3010170"?"ipfs":"ipns",i=parseInt(t[4],16);if(t[5].length===i*2)return`${s}://${Cb("0x"+t[2])}`}const n=e.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(n&&n[1].length===64)return`bzz://${n[1]}`;z(!1,"invalid or unsupported content hash data","UNSUPPORTED_OPERATION",{operation:"getContentHash()",info:{data:e}})}async getAvatar(){return(await this._getAvatar()).url}async _getAvatar(){const e=[{type:"name",value:this.name}];try{const t=await this.getText("avatar");if(t==null)return e.push({type:"!avatar",value:""}),{url:null,linkage:e};e.push({type:"avatar",value:t});for(let n=0;n<dx.length;n++){const s=t.match(dx[n]);if(s==null)continue;const i=s[1].toLowerCase();switch(i){case"https":case"data":return e.push({type:"url",value:t}),{linkage:e,url:t};case"ipfs":{const o=v0(t);return e.push({type:"ipfs",value:t}),e.push({type:"url",value:o}),{linkage:e,url:o}}case"erc721":case"erc1155":{const o=i==="erc721"?"tokenURI(uint256)":"uri(uint256)";e.push({type:i,value:t});const a=await this.getAddress();if(a==null)return e.push({type:"!owner",value:""}),{url:null,linkage:e};const c=(s[2]||"").split("/");if(c.length!==2)return e.push({type:`!${i}caip`,value:s[2]||""}),{url:null,linkage:e};const l=c[1],u=new ki(c[0],["function tokenURI(uint) view returns (string)","function ownerOf(uint) view returns (address)","function uri(uint) view returns (string)","function balanceOf(address, uint256) view returns (uint)"],this.provider);if(i==="erc721"){const g=await u.ownerOf(l);if(a!==g)return e.push({type:"!owner",value:g}),{url:null,linkage:e};e.push({type:"owner",value:g})}else if(i==="erc1155"){const g=await u.balanceOf(a,l);if(!g)return e.push({type:"!balance",value:"0"}),{url:null,linkage:e};e.push({type:"balance",value:g.toString()})}let f=await u[o](l);if(f==null||f==="0x")return e.push({type:"!metadata-url",value:""}),{url:null,linkage:e};e.push({type:"metadata-url-base",value:f}),i==="erc1155"&&(f=f.replace("{id}",Zn(l,32).substring(2)),e.push({type:"metadata-url-expanded",value:f})),f.match(/^ipfs:/i)&&(f=v0(f)),e.push({type:"metadata-url",value:f});let h={};const d=await new pt(f).send();d.assertOk();try{h=d.bodyJson}catch{try{e.push({type:"!metadata",value:d.bodyText})}catch{const x=d.body;return x&&e.push({type:"!metadata",value:K(x)}),{url:null,linkage:e}}return{url:null,linkage:e}}if(!h)return e.push({type:"!metadata",value:""}),{url:null,linkage:e};e.push({type:"metadata",value:JSON.stringify(h)});let p=h.image;if(typeof p!="string")return e.push({type:"!imageUrl",value:""}),{url:null,linkage:e};if(!p.match(/^(https:\/\/|data:)/i)){if(p.match(xE)==null)return e.push({type:"!imageUrl-ipfs",value:p}),{url:null,linkage:e};e.push({type:"imageUrl-ipfs",value:p}),p=v0(p)}return e.push({type:"url",value:p}),{linkage:e,url:p}}}}}catch{}return{linkage:e,url:null}}static async getEnsAddress(e){const t=await e.getNetwork(),n=t.getPlugin("org.ethers.plugins.network.Ens");return z(n,"network does not support ENS","UNSUPPORTED_OPERATION",{operation:"getEnsAddress",info:{network:t}}),n.address}static async fromName(e,t){var s;let n=t;for(;;){if(n===""||n==="."||t!=="eth"&&n==="eth")return null;const i=await q(s=Va,Id,wE).call(s,e,n);if(i!=null){const o=new Va(e,i,t);return n!==t&&!await o.supportsWildcard()?null:o}n=n.split(".").slice(1).join(".")}}};yi=new WeakMap,$o=new WeakMap,mi=new WeakSet,ka=async function(e,t){t=(t||[]).slice();const n=b(this,$o).interface;t.unshift(Gh(this.name));let s=null;await this.supportsWildcard()&&(s=n.getFunction(e),z(s,"missing fragment","UNKNOWN_ERROR",{info:{funcName:e}}),t=[H8(this.name,255),n.encodeFunctionData(s,t)],e="resolve(bytes,bytes)"),t.push({enableCcipRead:!0});try{const i=await b(this,$o)[e](...t);return s?n.decodeFunctionResult(s,i)[0]:i}catch(i){if(!Qe(i,"CALL_EXCEPTION"))throw i}return null},Id=new WeakSet,wE=async function(e,t){const n=await Va.getEnsAddress(e);try{const i=await new ki(n,["function resolver(bytes32) view returns (address)"],e).resolver(Gh(t),{enableCcipRead:!0});return i===tl?null:i}catch(s){throw s}return null},M(Va,Id);let Iu=Va;const px=BigInt(0);function be(r,e){return(function(t){return t==null?e:r(t)})}function Su(r,e){return(t=>{if(e&&t==null)return null;if(!Array.isArray(t))throw new Error("not an array");return t.map(n=>r(n))})}function hf(r,e){return(t=>{const n={};for(const s in r){let i=s;if(e&&s in e&&!(i in t)){for(const o of e[s])if(o in t){i=o;break}}try{const o=r[s](t[i]);o!==void 0&&(n[s]=o)}catch(o){const a=o instanceof Error?o.message:"not-an-error";z(!1,`invalid value for value.${s} (${a})`,"BAD_DATA",{value:t})}}return n})}function TI(r){switch(r){case!0:case"true":return!0;case!1:case"false":return!1}C(!1,`invalid boolean; ${JSON.stringify(r)}`,"value",r)}function al(r){return C(De(r,!0),"invalid data","value",r),r}function Et(r){return C(De(r,32),"invalid hash","value",r),r}const NI=hf({address:ce,blockHash:Et,blockNumber:ae,data:al,index:ae,removed:be(TI,!1),topics:Su(Et),transactionHash:Et,transactionIndex:ae},{index:["logIndex"]});function DI(r){return NI(r)}const RI=hf({hash:be(Et),parentHash:Et,parentBeaconBlockRoot:be(Et,null),number:ae,timestamp:ae,nonce:be(al),difficulty:re,gasLimit:re,gasUsed:re,stateRoot:be(Et,null),receiptsRoot:be(Et,null),blobGasUsed:be(re,null),excessBlobGas:be(re,null),miner:be(ce),prevRandao:be(Et,null),extraData:al,baseFeePerGas:be(re)},{prevRandao:["mixHash"]});function _I(r){const e=RI(r);return e.transactions=r.transactions.map(t=>typeof t=="string"?t:EE(t)),e}const BI=hf({transactionIndex:ae,blockNumber:ae,transactionHash:Et,address:ce,topics:Su(Et),data:al,index:ae,blockHash:Et},{index:["logIndex"]});function kI(r){return BI(r)}const UI=hf({to:be(ce,null),from:be(ce,null),contractAddress:be(ce,null),index:ae,root:be(K),gasUsed:re,blobGasUsed:be(re,null),logsBloom:be(al),blockHash:Et,hash:Et,logs:Su(kI),blockNumber:ae,cumulativeGasUsed:re,effectiveGasPrice:be(re),blobGasPrice:be(re,null),status:be(ae),type:be(ae,0)},{effectiveGasPrice:["gasPrice"],hash:["transactionHash"],index:["transactionIndex"]});function $I(r){return UI(r)}function EE(r){r.to&&re(r.to)===px&&(r.to="0x0000000000000000000000000000000000000000");const e=hf({hash:Et,index:be(ae,void 0),type:t=>t==="0x"||t==null?0:ae(t),accessList:be(Hs,null),blobVersionedHashes:be(Su(Et,!0),null),authorizationList:be(Su(t=>{let n;if(t.signature)n=t.signature;else{let s=t.yParity;s==="0x1b"?s=0:s==="0x1c"&&(s=1),n=Object.assign({},t,{yParity:s})}return{address:ce(t.address),chainId:re(t.chainId),nonce:re(t.nonce),signature:zt.from(n)}},!1),null),blockHash:be(Et,null),blockNumber:be(ae,null),transactionIndex:be(ae,null),from:ce,gasPrice:be(re),maxPriorityFeePerGas:be(re),maxFeePerGas:be(re),maxFeePerBlobGas:be(re,null),gasLimit:re,to:be(ce,null),value:re,nonce:ae,data:al,creates:be(ce,null),chainId:be(re,null)},{data:["input"],gasLimit:["gas"],index:["transactionIndex"]})(r);if(e.to==null&&e.creates==null&&(e.creates=Hb(e)),(r.type===1||r.type===2)&&r.accessList==null&&(e.accessList=[]),r.signature?e.signature=zt.from(r.signature):e.signature=zt.from(r),e.chainId==null){const t=e.signature.legacyChainId;t!=null&&(e.chainId=t)}return e.blockHash&&re(e.blockHash)===px&&(e.blockHash=null),e}const LI="0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e";class Gi{constructor(e){k(this,"name");te(this,{name:e})}clone(){return new Gi(this.name)}}class df extends Gi{constructor(t,n){t==null&&(t=0);super(`org.ethers.network.plugins.GasCost#${t||0}`);k(this,"effectiveBlock");k(this,"txBase");k(this,"txCreate");k(this,"txDataZero");k(this,"txDataNonzero");k(this,"txAccessListStorageKey");k(this,"txAccessListAddress");const s={effectiveBlock:t};function i(o,a){let c=(n||{})[o];c==null&&(c=a),C(typeof c=="number",`invalud value for ${o}`,"costs",n),s[o]=c}i("txBase",21e3),i("txCreate",32e3),i("txDataZero",4),i("txDataNonzero",16),i("txAccessListStorageKey",1900),i("txAccessListAddress",2400),te(this,s)}clone(){return new df(this.effectiveBlock,this)}}class pf extends Gi{constructor(t,n){super("org.ethers.plugins.network.Ens");k(this,"address");k(this,"targetNetwork");te(this,{address:t||LI,targetNetwork:n??1})}clone(){return new pf(this.address,this.targetNetwork)}}var Lo;const Xy=class Xy extends Gi{constructor(t){super("org.ethers.plugins.network.FeeData");M(this,Lo);S(this,Lo,t)}get feeDataFunc(){return b(this,Lo)}async getFeeData(t){return await b(this,Lo).call(this,t)}clone(){return new Xy(b(this,Lo))}};Lo=new WeakMap;let ig=Xy;var Wu,Qu;class vE extends Gi{constructor(t,n){super("org.ethers.plugins.network.FetchUrlFeeDataPlugin");M(this,Wu);M(this,Qu);S(this,Wu,t),S(this,Qu,n)}get url(){return b(this,Wu)}get processFunc(){return b(this,Qu)}clone(){return this}}Wu=new WeakMap,Qu=new WeakMap;const A0=new Map;var Tc,Nc,xi;const Ka=class Ka{constructor(e,t){M(this,Tc);M(this,Nc);M(this,xi);S(this,Tc,e),S(this,Nc,re(t)),S(this,xi,new Map)}toJSON(){return{name:this.name,chainId:String(this.chainId)}}get name(){return b(this,Tc)}set name(e){S(this,Tc,e)}get chainId(){return b(this,Nc)}set chainId(e){S(this,Nc,re(e,"chainId"))}matches(e){if(e==null)return!1;if(typeof e=="string"){try{return this.chainId===re(e)}catch{}return this.name===e}if(typeof e=="number"||typeof e=="bigint"){try{return this.chainId===re(e)}catch{}return!1}if(typeof e=="object"){if(e.chainId!=null){try{return this.chainId===re(e.chainId)}catch{}return!1}return e.name!=null?this.name===e.name:!1}return!1}get plugins(){return Array.from(b(this,xi).values())}attachPlugin(e){if(b(this,xi).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return b(this,xi).set(e.name,e.clone()),this}getPlugin(e){return b(this,xi).get(e)||null}getPlugins(e){return this.plugins.filter(t=>t.name.split("#")[0]===e)}clone(){const e=new Ka(this.name,this.chainId);return this.plugins.forEach(t=>{e.attachPlugin(t.clone())}),e}computeIntrinsicGas(e){const t=this.getPlugin("org.ethers.plugins.network.GasCost")||new df;let n=t.txBase;if(e.to==null&&(n+=t.txCreate),e.data)for(let s=2;s<e.data.length;s+=2)e.data.substring(s,s+2)==="00"?n+=t.txDataZero:n+=t.txDataNonzero;if(e.accessList){const s=Hs(e.accessList);for(const i in s)n+=t.txAccessListAddress+t.txAccessListStorageKey*s[i].storageKeys.length}return n}static from(e){if(FI(),e==null)return Ka.from("mainnet");if(typeof e=="number"&&(e=BigInt(e)),typeof e=="string"||typeof e=="bigint"){const t=A0.get(e);if(t)return t();if(typeof e=="bigint")return new Ka("unknown",e);C(!1,"unknown network","network",e)}if(typeof e.clone=="function")return e.clone();if(typeof e=="object"){C(typeof e.name=="string"&&typeof e.chainId=="number","invalid network object name or chainId","network",e);const t=new Ka(e.name,e.chainId);return(e.ensAddress||e.ensNetwork!=null)&&t.attachPlugin(new pf(e.ensAddress,e.ensNetwork)),t}C(!1,"invalid network","network",e)}static register(e,t){typeof e=="number"&&(e=BigInt(e));const n=A0.get(e);n&&C(!1,`conflicting network for ${JSON.stringify(n.name)}`,"nameOrChainId",e),A0.set(e,t)}};Tc=new WeakMap,Nc=new WeakMap,xi=new WeakMap;let He=Ka;function gx(r,e){const t=String(r);if(!t.match(/^[0-9.]+$/))throw new Error(`invalid gwei value: ${r}`);const n=t.split(".");if(n.length===1&&n.push(""),n.length!==2)throw new Error(`invalid gwei value: ${r}`);for(;n[1].length<e;)n[1]+="0";if(n[1].length>9){let s=BigInt(n[1].substring(0,9));n[1].substring(9).match(/^0+$/)||s++,n[1]=s.toString()}return BigInt(n[0]+n[1])}function bx(r){return new vE(r,async(e,t,n)=>{n.setHeader("User-Agent","ethers");let s;try{const[i,o]=await Promise.all([n.send(),e()]);s=i;const a=s.bodyJson.standard;return{gasPrice:o.gasPrice,maxFeePerGas:gx(a.maxFee,9),maxPriorityFeePerGas:gx(a.maxPriorityFee,9)}}catch(i){z(!1,`error encountered with polygon gas station (${JSON.stringify(n.url)})`,"SERVER_ERROR",{request:n,response:s,error:i})}})}let yx=!1;function FI(){if(yx)return;yx=!0;function r(e,t,n){const s=function(){const i=new He(e,t);return n.ensNetwork!=null&&i.attachPlugin(new pf(null,n.ensNetwork)),i.attachPlugin(new df),(n.plugins||[]).forEach(o=>{i.attachPlugin(o)}),i};He.register(e,s),He.register(t,s),n.altNames&&n.altNames.forEach(i=>{He.register(i,s)})}r("mainnet",1,{ensNetwork:1,altNames:["homestead"]}),r("ropsten",3,{ensNetwork:3}),r("rinkeby",4,{ensNetwork:4}),r("goerli",5,{ensNetwork:5}),r("kovan",42,{ensNetwork:42}),r("sepolia",11155111,{ensNetwork:11155111}),r("holesky",17e3,{ensNetwork:17e3}),r("classic",61,{}),r("classicKotti",6,{}),r("arbitrum",42161,{ensNetwork:1}),r("arbitrum-goerli",421613,{}),r("arbitrum-sepolia",421614,{}),r("base",8453,{ensNetwork:1}),r("base-goerli",84531,{}),r("base-sepolia",84532,{}),r("bnb",56,{ensNetwork:1}),r("bnbt",97,{}),r("linea",59144,{ensNetwork:1}),r("linea-goerli",59140,{}),r("linea-sepolia",59141,{}),r("matic",137,{ensNetwork:1,plugins:[bx("https://gasstation.polygon.technology/v2")]}),r("matic-amoy",80002,{}),r("matic-mumbai",80001,{altNames:["maticMumbai","maticmum"],plugins:[bx("https://gasstation-testnet.polygon.technology/v2")]}),r("optimism",10,{ensNetwork:1,plugins:[]}),r("optimism-goerli",420,{}),r("optimism-sepolia",11155420,{}),r("xdai",100,{ensNetwork:1})}function og(r){return JSON.parse(JSON.stringify(r))}var As,kr,wi,Ln,Dc,Ih;class MI{constructor(e){M(this,Dc);M(this,As);M(this,kr);M(this,wi);M(this,Ln);S(this,As,e),S(this,kr,null),S(this,wi,4e3),S(this,Ln,-2)}get pollingInterval(){return b(this,wi)}set pollingInterval(e){S(this,wi,e)}start(){b(this,kr)||(S(this,kr,b(this,As)._setTimeout(q(this,Dc,Ih).bind(this),b(this,wi))),q(this,Dc,Ih).call(this))}stop(){b(this,kr)&&(b(this,As)._clearTimeout(b(this,kr)),S(this,kr,null))}pause(e){this.stop(),e&&S(this,Ln,-2)}resume(){this.start()}}As=new WeakMap,kr=new WeakMap,wi=new WeakMap,Ln=new WeakMap,Dc=new WeakSet,Ih=async function(){try{const e=await b(this,As).getBlockNumber();if(b(this,Ln)===-2){S(this,Ln,e);return}if(e!==b(this,Ln)){for(let t=b(this,Ln)+1;t<=e;t++){if(b(this,kr)==null)return;await b(this,As).emit("block",t)}S(this,Ln,e)}}catch{}b(this,kr)!=null&&S(this,kr,b(this,As)._setTimeout(q(this,Dc,Ih).bind(this),b(this,wi)))};var Fo,Mo,Ei;class iy{constructor(e){M(this,Fo);M(this,Mo);M(this,Ei);S(this,Fo,e),S(this,Ei,!1),S(this,Mo,t=>{this._poll(t,b(this,Fo))})}async _poll(e,t){throw new Error("sub-classes must override this")}start(){b(this,Ei)||(S(this,Ei,!0),b(this,Mo).call(this,-2),b(this,Fo).on("block",b(this,Mo)))}stop(){b(this,Ei)&&(S(this,Ei,!1),b(this,Fo).off("block",b(this,Mo)))}pause(e){this.stop()}resume(){this.start()}}Fo=new WeakMap,Mo=new WeakMap,Ei=new WeakMap;var Rc,Is;class jI extends iy{constructor(t,n){super(t);M(this,Rc);M(this,Is);S(this,Rc,n),S(this,Is,-2)}pause(t){t&&S(this,Is,-2),super.pause(t)}async _poll(t,n){const s=await n.getBlock(b(this,Rc));s!=null&&(b(this,Is)===-2?S(this,Is,s.number):s.number>b(this,Is)&&(n.emit(b(this,Rc),s.number),S(this,Is,s.number)))}}Rc=new WeakMap,Is=new WeakMap;var Sd;class zI extends iy{constructor(t,n){super(t);M(this,Sd);S(this,Sd,og(n))}async _poll(t,n){throw new Error("@TODO")}}Sd=new WeakMap;var _c;class HI extends iy{constructor(t,n){super(t);M(this,_c);S(this,_c,n)}async _poll(t,n){const s=await n.getTransactionReceipt(b(this,_c));s&&n.emit(b(this,_c),s)}}_c=new WeakMap;var Ss,Bc,kc,vi,Ur,Od,AE;class oy{constructor(e,t){M(this,Od);M(this,Ss);M(this,Bc);M(this,kc);M(this,vi);M(this,Ur);S(this,Ss,e),S(this,Bc,og(t)),S(this,kc,q(this,Od,AE).bind(this)),S(this,vi,!1),S(this,Ur,-2)}start(){b(this,vi)||(S(this,vi,!0),b(this,Ur)===-2&&b(this,Ss).getBlockNumber().then(e=>{S(this,Ur,e)}),b(this,Ss).on("block",b(this,kc)))}stop(){b(this,vi)&&(S(this,vi,!1),b(this,Ss).off("block",b(this,kc)))}pause(e){this.stop(),e&&S(this,Ur,-2)}resume(){this.start()}}Ss=new WeakMap,Bc=new WeakMap,kc=new WeakMap,vi=new WeakMap,Ur=new WeakMap,Od=new WeakSet,AE=async function(e){if(b(this,Ur)===-2)return;const t=og(b(this,Bc));t.fromBlock=b(this,Ur)+1,t.toBlock=e;const n=await b(this,Ss).getLogs(t);if(n.length===0){b(this,Ur)<e-60&&S(this,Ur,e-60);return}for(const s of n)b(this,Ss).emit(b(this,Bc),s),S(this,Ur,s.blockNumber)};const qI=BigInt(2),VI=10;function zf(r){return r&&typeof r.then=="function"}function Sh(r,e){return r+":"+JSON.stringify(e,(t,n)=>{if(n==null)return"null";if(typeof n=="bigint")return`bigint:${n.toString()}`;if(typeof n=="string")return n.toLowerCase();if(typeof n=="object"&&!Array.isArray(n)){const s=Object.keys(n);return s.sort(),s.reduce((i,o)=>(i[o]=n[o],i),{})}return n})}class Ou{constructor(e){k(this,"name");te(this,{name:e})}start(){}stop(){}pause(e){}resume(){}}function KI(r){return JSON.parse(JSON.stringify(r))}function ag(r){return r=Array.from(new Set(r).values()),r.sort(),r}async function I0(r,e){if(r==null)throw new Error("invalid event");if(Array.isArray(r)&&(r={topics:r}),typeof r=="string")switch(r){case"block":case"debug":case"error":case"finalized":case"network":case"pending":case"safe":return{type:r,tag:r}}if(De(r,32)){const t=r.toLowerCase();return{type:"transaction",tag:Sh("tx",{hash:t}),hash:t}}if(r.orphan){const t=r;return{type:"orphan",tag:Sh("orphan",t),filter:KI(t)}}if(r.address||r.topics){const t=r,n={topics:(t.topics||[]).map(s=>s==null?null:Array.isArray(s)?ag(s.map(i=>i.toLowerCase())):s.toLowerCase())};if(t.address){const s=[],i=[],o=a=>{De(a)?s.push(a):i.push((async()=>{s.push(await nt(a,e))})())};Array.isArray(t.address)?t.address.forEach(o):o(t.address),i.length&&await Promise.all(i),n.address=ag(s.map(a=>a.toLowerCase()))}return{filter:n,tag:Sh("event",n),type:"event"}}C(!1,"unknown ProviderEvent","event",r)}function S0(){return new Date().getTime()}const GI={cacheTimeout:250,pollingInterval:4e3};var Bt,Ai,kt,Uc,br,jo,Ii,Os,Ju,$r,$c,Lc,he,ur,cg,lg,Jl,ug,Yl,Oh;class Pu{constructor(e,t){M(this,he);M(this,Bt);M(this,Ai);M(this,kt);M(this,Uc);M(this,br);M(this,jo);M(this,Ii);M(this,Os);M(this,Ju);M(this,$r);M(this,$c);M(this,Lc);if(S(this,Lc,Object.assign({},GI,t||{})),e==="any")S(this,jo,!0),S(this,br,null);else if(e){const n=He.from(e);S(this,jo,!1),S(this,br,Promise.resolve(n)),setTimeout(()=>{this.emit("network",n,null)},0)}else S(this,jo,!1),S(this,br,null);S(this,Os,-1),S(this,Ii,new Map),S(this,Bt,new Map),S(this,Ai,new Map),S(this,kt,null),S(this,Uc,!1),S(this,Ju,1),S(this,$r,new Map),S(this,$c,!1)}get pollingInterval(){return b(this,Lc).pollingInterval}get provider(){return this}get plugins(){return Array.from(b(this,Ai).values())}attachPlugin(e){if(b(this,Ai).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return b(this,Ai).set(e.name,e.connect(this)),this}getPlugin(e){return b(this,Ai).get(e)||null}get disableCcipRead(){return b(this,$c)}set disableCcipRead(e){S(this,$c,!!e)}async ccipReadFetch(e,t,n){if(this.disableCcipRead||n.length===0||e.to==null)return null;const s=e.to.toLowerCase(),i=t.toLowerCase(),o=[];for(let a=0;a<n.length;a++){const c=n[a],l=c.replace("{sender}",s).replace("{data}",i),u=new pt(l);c.indexOf("{data}")===-1&&(u.body={data:i,sender:s}),this.emit("debug",{action:"sendCcipReadFetchRequest",request:u,index:a,urls:n});let f="unknown error",h;try{h=await u.send()}catch(d){o.push(d.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:u,result:{error:d}});continue}try{const d=h.bodyJson;if(d.data)return this.emit("debug",{action:"receiveCcipReadFetchResult",request:u,result:d}),d.data;d.message&&(f=d.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:u,result:d})}catch{}z(h.statusCode<400||h.statusCode>=500,`response not found during CCIP fetch: ${f}`,"OFFCHAIN_FAULT",{reason:"404_MISSING_RESOURCE",transaction:e,info:{url:c,errorMessage:f}}),o.push(f)}z(!1,`error encountered during CCIP fetch: ${o.map(a=>JSON.stringify(a)).join(", ")}`,"OFFCHAIN_FAULT",{reason:"500_SERVER_ERROR",transaction:e,info:{urls:n,errorMessages:o}})}_wrapBlock(e,t){return new aE(_I(e),this)}_wrapLog(e,t){return new xl(DI(e),this)}_wrapTransactionReceipt(e,t){return new Xb($I(e),this)}_wrapTransactionResponse(e,t){return new il(EE(e),this)}_detectNetwork(){z(!1,"sub-classes must implement this","UNSUPPORTED_OPERATION",{operation:"_detectNetwork"})}async _perform(e){z(!1,`unsupported method: ${e.method}`,"UNSUPPORTED_OPERATION",{operation:e.method,info:e})}async getBlockNumber(){const e=ae(await q(this,he,ur).call(this,{method:"getBlockNumber"}),"%response");return b(this,Os)>=0&&S(this,Os,e),e}_getAddress(e){return nt(e,this)}_getBlockTag(e){if(e==null)return"latest";switch(e){case"earliest":return"0x0";case"finalized":case"latest":case"pending":case"safe":return e}if(De(e))return De(e,32)?e:xr(e);if(typeof e=="bigint"&&(e=ae(e,"blockTag")),typeof e=="number")return e>=0?xr(e):b(this,Os)>=0?xr(b(this,Os)+e):this.getBlockNumber().then(t=>xr(t+e));C(!1,"invalid blockTag","blockTag",e)}_getFilter(e){const t=(e.topics||[]).map(c=>c==null?null:Array.isArray(c)?ag(c.map(l=>l.toLowerCase())):c.toLowerCase()),n="blockHash"in e?e.blockHash:void 0,s=(c,l,u)=>{let f;switch(c.length){case 0:break;case 1:f=c[0];break;default:c.sort(),f=c}if(n&&(l!=null||u!=null))throw new Error("invalid filter");const h={};return f&&(h.address=f),t.length&&(h.topics=t),l&&(h.fromBlock=l),u&&(h.toBlock=u),n&&(h.blockHash=n),h};let i=[];if(e.address)if(Array.isArray(e.address))for(const c of e.address)i.push(this._getAddress(c));else i.push(this._getAddress(e.address));let o;"fromBlock"in e&&(o=this._getBlockTag(e.fromBlock));let a;return"toBlock"in e&&(a=this._getBlockTag(e.toBlock)),i.filter(c=>typeof c!="string").length||o!=null&&typeof o!="string"||a!=null&&typeof a!="string"?Promise.all([Promise.all(i),o,a]).then(c=>s(c[0],c[1],c[2])):s(i,o,a)}_getTransactionRequest(e){const t=sl(e),n=[];if(["to","from"].forEach(s=>{if(t[s]==null)return;const i=nt(t[s],this);zf(i)?n.push((async function(){t[s]=await i})()):t[s]=i}),t.blockTag!=null){const s=this._getBlockTag(t.blockTag);zf(s)?n.push((async function(){t.blockTag=await s})()):t.blockTag=s}return n.length?(async function(){return await Promise.all(n),t})():t}async getNetwork(){if(b(this,br)==null){const s=(async()=>{try{const i=await this._detectNetwork();return this.emit("network",i,null),i}catch(i){throw b(this,br)===s&&S(this,br,null),i}})();return S(this,br,s),(await s).clone()}const e=b(this,br),[t,n]=await Promise.all([e,this._detectNetwork()]);return t.chainId!==n.chainId&&(b(this,jo)?(this.emit("network",n,t),b(this,br)===e&&S(this,br,Promise.resolve(n))):z(!1,`network changed: ${t.chainId} => ${n.chainId} `,"NETWORK_ERROR",{event:"changed"})),t.clone()}async getFeeData(){const e=await this.getNetwork(),t=async()=>{const{_block:s,gasPrice:i,priorityFee:o}=await ct({_block:q(this,he,ug).call(this,"latest",!1),gasPrice:(async()=>{try{const u=await q(this,he,ur).call(this,{method:"getGasPrice"});return re(u,"%response")}catch{}return null})(),priorityFee:(async()=>{try{const u=await q(this,he,ur).call(this,{method:"getPriorityFee"});return re(u,"%response")}catch{}return null})()});let a=null,c=null;const l=this._wrapBlock(s,e);return l&&l.baseFeePerGas&&(c=o??BigInt("1000000000"),a=l.baseFeePerGas*qI+c),new rg(i,a,c)},n=e.getPlugin("org.ethers.plugins.network.FetchUrlFeeDataPlugin");if(n){const s=new pt(n.url),i=await n.processFunc(t,this,s);return new rg(i.gasPrice,i.maxFeePerGas,i.maxPriorityFeePerGas)}return await t()}async estimateGas(e){let t=this._getTransactionRequest(e);return zf(t)&&(t=await t),re(await q(this,he,ur).call(this,{method:"estimateGas",transaction:t}),"%response")}async call(e){const{tx:t,blockTag:n}=await ct({tx:this._getTransactionRequest(e),blockTag:this._getBlockTag(e.blockTag)});return await q(this,he,lg).call(this,q(this,he,cg).call(this,t,n,e.enableCcipRead?0:-1))}async getBalance(e,t){return re(await q(this,he,Jl).call(this,{method:"getBalance"},e,t),"%response")}async getTransactionCount(e,t){return ae(await q(this,he,Jl).call(this,{method:"getTransactionCount"},e,t),"%response")}async getCode(e,t){return K(await q(this,he,Jl).call(this,{method:"getCode"},e,t))}async getStorage(e,t,n){const s=re(t,"position");return K(await q(this,he,Jl).call(this,{method:"getStorage",position:s},e,n))}async broadcastTransaction(e){const{blockNumber:t,hash:n,network:s}=await ct({blockNumber:this.getBlockNumber(),hash:this._perform({method:"broadcastTransaction",signedTransaction:e}),network:this.getNetwork()}),i=ea.from(e);if(i.hash!==n)throw new Error("@TODO: the returned hash did not match");return this._wrapTransactionResponse(i,s).replaceableTransaction(t)}async getBlock(e,t){const{network:n,params:s}=await ct({network:this.getNetwork(),params:q(this,he,ug).call(this,e,!!t)});return s==null?null:this._wrapBlock(s,n)}async getTransaction(e){const{network:t,params:n}=await ct({network:this.getNetwork(),params:q(this,he,ur).call(this,{method:"getTransaction",hash:e})});return n==null?null:this._wrapTransactionResponse(n,t)}async getTransactionReceipt(e){const{network:t,params:n}=await ct({network:this.getNetwork(),params:q(this,he,ur).call(this,{method:"getTransactionReceipt",hash:e})});if(n==null)return null;if(n.gasPrice==null&&n.effectiveGasPrice==null){const s=await q(this,he,ur).call(this,{method:"getTransaction",hash:e});if(s==null)throw new Error("report this; could not find tx or effectiveGasPrice");n.effectiveGasPrice=s.gasPrice}return this._wrapTransactionReceipt(n,t)}async getTransactionResult(e){const{result:t}=await ct({network:this.getNetwork(),result:q(this,he,ur).call(this,{method:"getTransactionResult",hash:e})});return t==null?null:K(t)}async getLogs(e){let t=this._getFilter(e);zf(t)&&(t=await t);const{network:n,params:s}=await ct({network:this.getNetwork(),params:q(this,he,ur).call(this,{method:"getLogs",filter:t})});return s.map(i=>this._wrapLog(i,n))}_getProvider(e){z(!1,"provider cannot connect to target network","UNSUPPORTED_OPERATION",{operation:"_getProvider()"})}async getResolver(e){return await Iu.fromName(this,e)}async getAvatar(e){const t=await this.getResolver(e);return t?await t.getAvatar():null}async resolveName(e){const t=await this.getResolver(e);return t?await t.getAddress():null}async lookupAddress(e){e=ce(e);const t=Gh(e.substring(2).toLowerCase()+".addr.reverse");try{const n=await Iu.getEnsAddress(this),i=await new ki(n,["function resolver(bytes32) view returns (address)"],this).resolver(t);if(i==null||i===tl)return null;const a=await new ki(i,["function name(bytes32) view returns (string)"],this).name(t);return await this.resolveName(a)!==e?null:a}catch(n){if(Qe(n,"BAD_DATA")&&n.value==="0x"||Qe(n,"CALL_EXCEPTION"))return null;throw n}return null}async waitForTransaction(e,t,n){const s=t??1;return s===0?this.getTransactionReceipt(e):new Promise(async(i,o)=>{let a=null;const c=(async l=>{try{const u=await this.getTransactionReceipt(e);if(u!=null&&l-u.blockNumber+1>=s){i(u),a&&(clearTimeout(a),a=null);return}}catch(u){console.log("EEE",u)}this.once("block",c)});n!=null&&(a=setTimeout(()=>{a!=null&&(a=null,this.off("block",c),o(Be("timeout","TIMEOUT",{reason:"timeout"})))},n)),c(await this.getBlockNumber())})}async waitForBlock(e){z(!1,"not implemented yet","NOT_IMPLEMENTED",{operation:"waitForBlock"})}_clearTimeout(e){const t=b(this,$r).get(e);t&&(t.timer&&clearTimeout(t.timer),b(this,$r).delete(e))}_setTimeout(e,t){t==null&&(t=0);const n=ma(this,Ju)._++,s=()=>{b(this,$r).delete(n),e()};if(this.paused)b(this,$r).set(n,{timer:null,func:s,time:t});else{const i=setTimeout(s,t);b(this,$r).set(n,{timer:i,func:s,time:S0()})}return n}_forEachSubscriber(e){for(const t of b(this,Bt).values())e(t.subscriber)}_getSubscriber(e){switch(e.type){case"debug":case"error":case"network":return new Ou(e.type);case"block":{const t=new MI(this);return t.pollingInterval=this.pollingInterval,t}case"safe":case"finalized":return new jI(this,e.type);case"event":return new oy(this,e.filter);case"transaction":return new HI(this,e.hash);case"orphan":return new zI(this,e.filter)}throw new Error(`unsupported event: ${e.type}`)}_recoverSubscriber(e,t){for(const n of b(this,Bt).values())if(n.subscriber===e){n.started&&n.subscriber.stop(),n.subscriber=t,n.started&&t.start(),b(this,kt)!=null&&t.pause(b(this,kt));break}}async on(e,t){const n=await q(this,he,Oh).call(this,e);return n.listeners.push({listener:t,once:!1}),n.started||(n.subscriber.start(),n.started=!0,b(this,kt)!=null&&n.subscriber.pause(b(this,kt))),this}async once(e,t){const n=await q(this,he,Oh).call(this,e);return n.listeners.push({listener:t,once:!0}),n.started||(n.subscriber.start(),n.started=!0,b(this,kt)!=null&&n.subscriber.pause(b(this,kt))),this}async emit(e,...t){const n=await q(this,he,Yl).call(this,e,t);if(!n||n.listeners.length===0)return!1;const s=n.listeners.length;return n.listeners=n.listeners.filter(({listener:i,once:o})=>{const a=new Tb(this,o?null:i,e);try{i.call(this,...t,a)}catch{}return!o}),n.listeners.length===0&&(n.started&&n.subscriber.stop(),b(this,Bt).delete(n.tag)),s>0}async listenerCount(e){if(e){const n=await q(this,he,Yl).call(this,e);return n?n.listeners.length:0}let t=0;for(const{listeners:n}of b(this,Bt).values())t+=n.length;return t}async listeners(e){if(e){const n=await q(this,he,Yl).call(this,e);return n?n.listeners.map(({listener:s})=>s):[]}let t=[];for(const{listeners:n}of b(this,Bt).values())t=t.concat(n.map(({listener:s})=>s));return t}async off(e,t){const n=await q(this,he,Yl).call(this,e);if(!n)return this;if(t){const s=n.listeners.map(({listener:i})=>i).indexOf(t);s>=0&&n.listeners.splice(s,1)}return(!t||n.listeners.length===0)&&(n.started&&n.subscriber.stop(),b(this,Bt).delete(n.tag)),this}async removeAllListeners(e){if(e){const{tag:t,started:n,subscriber:s}=await q(this,he,Oh).call(this,e);n&&s.stop(),b(this,Bt).delete(t)}else for(const[t,{started:n,subscriber:s}]of b(this,Bt))n&&s.stop(),b(this,Bt).delete(t);return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return this.off(e,t)}get destroyed(){return b(this,Uc)}destroy(){this.removeAllListeners();for(const e of b(this,$r).keys())this._clearTimeout(e);S(this,Uc,!0)}get paused(){return b(this,kt)!=null}set paused(e){!!e!==this.paused&&(this.paused?this.resume():this.pause(!1))}pause(e){if(S(this,Os,-1),b(this,kt)!=null){if(b(this,kt)==!!e)return;z(!1,"cannot change pause type; resume first","UNSUPPORTED_OPERATION",{operation:"pause"})}this._forEachSubscriber(t=>t.pause(e)),S(this,kt,!!e);for(const t of b(this,$r).values())t.timer&&clearTimeout(t.timer),t.time=S0()-t.time}resume(){if(b(this,kt)!=null){this._forEachSubscriber(e=>e.resume()),S(this,kt,null);for(const e of b(this,$r).values()){let t=e.time;t<0&&(t=0),e.time=S0(),setTimeout(e.func,t)}}}}Bt=new WeakMap,Ai=new WeakMap,kt=new WeakMap,Uc=new WeakMap,br=new WeakMap,jo=new WeakMap,Ii=new WeakMap,Os=new WeakMap,Ju=new WeakMap,$r=new WeakMap,$c=new WeakMap,Lc=new WeakMap,he=new WeakSet,ur=async function(e){const t=b(this,Lc).cacheTimeout;if(t<0)return await this._perform(e);const n=Sh(e.method,e);let s=b(this,Ii).get(n);return s||(s=this._perform(e),b(this,Ii).set(n,s),setTimeout(()=>{b(this,Ii).get(n)===s&&b(this,Ii).delete(n)},t)),await s},cg=async function(e,t,n){z(n<VI,"CCIP read exceeded maximum redirections","OFFCHAIN_FAULT",{reason:"TOO_MANY_REDIRECTS",transaction:Object.assign({},e,{blockTag:t,enableCcipRead:!0})});const s=sl(e);try{return K(await this._perform({method:"call",transaction:s,blockTag:t}))}catch(i){if(!this.disableCcipRead&&Pd(i)&&i.data&&n>=0&&t==="latest"&&s.to!=null&&ke(i.data,0,4)==="0x556f1830"){const o=i.data,a=await nt(s.to,this);let c;try{c=ZI(ke(i.data,4))}catch(f){z(!1,f.message,"OFFCHAIN_FAULT",{reason:"BAD_DATA",transaction:s,info:{data:o}})}z(c.sender.toLowerCase()===a.toLowerCase(),"CCIP Read sender mismatch","CALL_EXCEPTION",{action:"call",data:o,reason:"OffchainLookup",transaction:s,invocation:null,revert:{signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",name:"OffchainLookup",args:c.errorArgs}});const l=await this.ccipReadFetch(s,c.calldata,c.urls);z(l!=null,"CCIP Read failed to fetch data","OFFCHAIN_FAULT",{reason:"FETCH_FAILED",transaction:s,info:{data:i.data,errorArgs:c.errorArgs}});const u={to:a,data:me([c.selector,YI([l,c.extraData])])};this.emit("debug",{action:"sendCcipReadCall",transaction:u});try{const f=await q(this,he,cg).call(this,u,t,n+1);return this.emit("debug",{action:"receiveCcipReadCallResult",transaction:Object.assign({},u),result:f}),f}catch(f){throw this.emit("debug",{action:"receiveCcipReadCallError",transaction:Object.assign({},u),error:f}),f}}throw i}},lg=async function(e){const{value:t}=await ct({network:this.getNetwork(),value:e});return t},Jl=async function(e,t,n){let s=this._getAddress(t),i=this._getBlockTag(n);return(typeof s!="string"||typeof i!="string")&&([s,i]=await Promise.all([s,i])),await q(this,he,lg).call(this,q(this,he,ur).call(this,Object.assign(e,{address:s,blockTag:i})))},ug=async function(e,t){if(De(e,32))return await q(this,he,ur).call(this,{method:"getBlock",blockHash:e,includeTransactions:t});let n=this._getBlockTag(e);return typeof n!="string"&&(n=await n),await q(this,he,ur).call(this,{method:"getBlock",blockTag:n,includeTransactions:t})},Yl=async function(e,t){let n=await I0(e,this);return n.type==="event"&&t&&t.length>0&&t[0].removed===!0&&(n=await I0({orphan:"drop-log",log:t[0]},this)),b(this,Bt).get(n.tag)||null},Oh=async function(e){const t=await I0(e,this),n=t.tag;let s=b(this,Bt).get(n);return s||(s={subscriber:this._getSubscriber(t),tag:n,addressableMap:new WeakMap,nameMap:new Map,started:!1,listeners:[]},b(this,Bt).set(n,s)),s};function WI(r,e){try{const t=fg(r,e);if(t)return $i(t)}catch{}return null}function fg(r,e){if(r==="0x")return null;try{const t=ae(ke(r,e,e+32)),n=ae(ke(r,t,t+32));return ke(r,t+32,t+32+n)}catch{}return null}function mx(r){const e=Fe(r);if(e.length>32)throw new Error("internal; should not happen");const t=new Uint8Array(32);return t.set(e,32-e.length),t}function QI(r){if(r.length%32===0)return r;const e=new Uint8Array(Math.ceil(r.length/32)*32);return e.set(r),e}const JI=new Uint8Array([]);function YI(r){const e=[];let t=0;for(let n=0;n<r.length;n++)e.push(JI),t+=32;for(let n=0;n<r.length;n++){const s=Q(r[n]);e[n]=mx(t),e.push(mx(s.length)),e.push(QI(s)),t+=32+Math.ceil(s.length/32)*32}return me(e)}const xx="0x0000000000000000000000000000000000000000000000000000000000000000";function ZI(r){const e={sender:"",urls:[],calldata:"",selector:"",extraData:"",errorArgs:[]};z(_i(r)>=160,"insufficient OffchainLookup data","OFFCHAIN_FAULT",{reason:"insufficient OffchainLookup data"});const t=ke(r,0,32);z(ke(t,0,12)===ke(xx,0,12),"corrupt OffchainLookup sender","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup sender"}),e.sender=ke(t,12);try{const n=[],s=ae(ke(r,32,64)),i=ae(ke(r,s,s+32)),o=ke(r,s+32);for(let a=0;a<i;a++){const c=WI(o,a*32);if(c==null)throw new Error("abort");n.push(c)}e.urls=n}catch{z(!1,"corrupt OffchainLookup urls","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup urls"})}try{const n=fg(r,64);if(n==null)throw new Error("abort");e.calldata=n}catch{z(!1,"corrupt OffchainLookup calldata","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup calldata"})}z(ke(r,100,128)===ke(xx,0,28),"corrupt OffchainLookup callbaackSelector","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup callbaackSelector"}),e.selector=ke(r,96,100);try{const n=fg(r,128);if(n==null)throw new Error("abort");e.extraData=n}catch{z(!1,"corrupt OffchainLookup extraData","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup extraData"})}return e.errorArgs="sender,urls,calldata,selector,extraData".split(/,/).map(n=>e[n]),e}function Zi(r,e){if(r.provider)return r.provider;z(!1,"missing provider","UNSUPPORTED_OPERATION",{operation:e})}async function wx(r,e){let t=sl(e);if(t.to!=null&&(t.to=nt(t.to,r)),t.from!=null){const n=t.from;t.from=Promise.all([r.getAddress(),nt(n,r)]).then(([s,i])=>(C(s.toLowerCase()===i.toLowerCase(),"transaction from mismatch","tx.from",i),s))}else t.from=r.getAddress();return await ct(t)}class gf{constructor(e){k(this,"provider");te(this,{provider:e||null})}async getNonce(e){return Zi(this,"getTransactionCount").getTransactionCount(await this.getAddress(),e)}async populateCall(e){return await wx(this,e)}async populateTransaction(e){const t=Zi(this,"populateTransaction"),n=await wx(this,e);n.nonce==null&&(n.nonce=await this.getNonce("pending")),n.gasLimit==null&&(n.gasLimit=await this.estimateGas(n));const s=await this.provider.getNetwork();if(n.chainId!=null){const o=re(n.chainId);C(o===s.chainId,"transaction chainId mismatch","tx.chainId",e.chainId)}else n.chainId=s.chainId;const i=n.maxFeePerGas!=null||n.maxPriorityFeePerGas!=null;if(n.gasPrice!=null&&(n.type===2||i)?C(!1,"eip-1559 transaction do not support gasPrice","tx",e):(n.type===0||n.type===1)&&i&&C(!1,"pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","tx",e),(n.type===2||n.type==null)&&n.maxFeePerGas!=null&&n.maxPriorityFeePerGas!=null)n.type=2;else if(n.type===0||n.type===1){const o=await t.getFeeData();z(o.gasPrice!=null,"network does not support gasPrice","UNSUPPORTED_OPERATION",{operation:"getGasPrice"}),n.gasPrice==null&&(n.gasPrice=o.gasPrice)}else{const o=await t.getFeeData();if(n.type==null)if(o.maxFeePerGas!=null&&o.maxPriorityFeePerGas!=null)if(n.authorizationList&&n.authorizationList.length?n.type=4:n.type=2,n.gasPrice!=null){const a=n.gasPrice;delete n.gasPrice,n.maxFeePerGas=a,n.maxPriorityFeePerGas=a}else n.maxFeePerGas==null&&(n.maxFeePerGas=o.maxFeePerGas),n.maxPriorityFeePerGas==null&&(n.maxPriorityFeePerGas=o.maxPriorityFeePerGas);else o.gasPrice!=null?(z(!i,"network does not support EIP-1559","UNSUPPORTED_OPERATION",{operation:"populateTransaction"}),n.gasPrice==null&&(n.gasPrice=o.gasPrice),n.type=0):z(!1,"failed to get consistent fee data","UNSUPPORTED_OPERATION",{operation:"signer.getFeeData"});else(n.type===2||n.type===3||n.type===4)&&(n.maxFeePerGas==null&&(n.maxFeePerGas=o.maxFeePerGas),n.maxPriorityFeePerGas==null&&(n.maxPriorityFeePerGas=o.maxPriorityFeePerGas))}return await ct(n)}async populateAuthorization(e){const t=Object.assign({},e);return t.chainId==null&&(t.chainId=(await Zi(this,"getNetwork").getNetwork()).chainId),t.nonce==null&&(t.nonce=await this.getNonce()),t}async estimateGas(e){return Zi(this,"estimateGas").estimateGas(await this.populateCall(e))}async call(e){return Zi(this,"call").call(await this.populateCall(e))}async resolveName(e){return await Zi(this,"resolveName").resolveName(e)}async sendTransaction(e){const t=Zi(this,"sendTransaction"),n=await this.populateTransaction(e);delete n.from;const s=ea.from(n);return await t.broadcastTransaction(await this.signTransaction(s))}authorize(e){z(!1,"authorization not implemented for this signer","UNSUPPORTED_OPERATION",{operation:"authorize"})}}var Fc,Ph;const em=class em extends gf{constructor(t,n){super(n);M(this,Fc);k(this,"address");te(this,{address:t})}async getAddress(){return this.address}connect(t){return new em(this.address,t)}async signTransaction(t){q(this,Fc,Ph).call(this,"transactions","signTransaction")}async signMessage(t){q(this,Fc,Ph).call(this,"messages","signMessage")}async signTypedData(t,n,s){q(this,Fc,Ph).call(this,"typed-data","signTypedData")}};Fc=new WeakSet,Ph=function(t,n){z(!1,`VoidSigner cannot sign ${t}`,"UNSUPPORTED_OPERATION",{operation:n})};let Qh=em;const Ex=new Set;function Wi(r){Ex.has(r)||(Ex.add(r),console.log("========= NOTICE ========="),console.log(`Request-Rate Exceeded for ${r} (this message will not be repeated)`),console.log(""),console.log("The default API keys for each service are provided as a highly-throttled,"),console.log("community resource for low-traffic projects and early prototyping."),console.log(""),console.log("While your application will continue to function, we highly recommended"),console.log("signing up for your own API keys to improve performance, increase your"),console.log("request rate/limit and enable other perks, such as metrics and advanced APIs."),console.log(""),console.log("For more details: https://docs.ethers.org/api-keys/"),console.log("=========================="))}function XI(r){return JSON.parse(JSON.stringify(r))}var Lt,Fn,zo,Si,Ho,Mc,ji,hg,dg;class IE{constructor(e){M(this,ji);M(this,Lt);M(this,Fn);M(this,zo);M(this,Si);M(this,Ho);M(this,Mc);S(this,Lt,e),S(this,Fn,null),S(this,zo,q(this,ji,hg).bind(this)),S(this,Si,!1),S(this,Ho,null),S(this,Mc,!1)}_subscribe(e){throw new Error("subclasses must override this")}_emitResults(e,t){throw new Error("subclasses must override this")}_recover(e){throw new Error("subclasses must override this")}start(){b(this,Si)||(S(this,Si,!0),q(this,ji,hg).call(this,-2))}stop(){b(this,Si)&&(S(this,Si,!1),S(this,Mc,!0),q(this,ji,dg).call(this),b(this,Lt).off("block",b(this,zo)))}pause(e){e&&q(this,ji,dg).call(this),b(this,Lt).off("block",b(this,zo))}resume(){this.start()}}Lt=new WeakMap,Fn=new WeakMap,zo=new WeakMap,Si=new WeakMap,Ho=new WeakMap,Mc=new WeakMap,ji=new WeakSet,hg=async function(e){try{b(this,Fn)==null&&S(this,Fn,this._subscribe(b(this,Lt)));let t=null;try{t=await b(this,Fn)}catch(i){if(!Qe(i,"UNSUPPORTED_OPERATION")||i.operation!=="eth_newFilter")throw i}if(t==null){S(this,Fn,null),b(this,Lt)._recoverSubscriber(this,this._recover(b(this,Lt)));return}const n=await b(this,Lt).getNetwork();if(b(this,Ho)||S(this,Ho,n),b(this,Ho).chainId!==n.chainId)throw new Error("chaid changed");if(b(this,Mc))return;const s=await b(this,Lt).send("eth_getFilterChanges",[t]);await this._emitResults(b(this,Lt),s)}catch(t){console.log("@TODO",t)}b(this,Lt).once("block",b(this,zo))},dg=function(){const e=b(this,Fn);e&&(S(this,Fn,null),e.then(t=>{b(this,Lt).destroyed||b(this,Lt).send("eth_uninstallFilter",[t])}))};var qo;class eS extends IE{constructor(t,n){super(t);M(this,qo);S(this,qo,XI(n))}_recover(t){return new oy(t,b(this,qo))}async _subscribe(t){return await t.send("eth_newFilter",[b(this,qo)])}async _emitResults(t,n){for(const s of n)t.emit(b(this,qo),t._wrapLog(s,t._network))}}qo=new WeakMap;class tS extends IE{async _subscribe(e){return await e.send("eth_newPendingTransactionFilter",[])}async _emitResults(e,t){for(const n of t)e.emit("pending",n)}}const rS="bigint,boolean,function,number,string,symbol".split(/,/g);function Ch(r){if(r==null||rS.indexOf(typeof r)>=0||typeof r.getAddress=="function")return r;if(Array.isArray(r))return r.map(Ch);if(typeof r=="object")return Object.keys(r).reduce((e,t)=>(e[t]=r[t],e),{});throw new Error(`should not happen: ${r} (${typeof r})`)}function nS(r){return new Promise(e=>{setTimeout(e,r)})}function Ea(r){return r&&r.toLowerCase()}function vx(r){return r&&typeof r.pollingInterval=="number"}const SE={polling:!1,staticNetwork:null,batchStallTime:10,batchMaxSize:1<<20,batchMaxCount:100,cacheTimeout:250,pollingInterval:4e3};class Th extends gf{constructor(t,n){super(t);k(this,"address");n=ce(n),te(this,{address:n})}connect(t){z(!1,"cannot reconnect JsonRpcSigner","UNSUPPORTED_OPERATION",{operation:"signer.connect"})}async getAddress(){return this.address}async populateTransaction(t){return await this.populateCall(t)}async sendUncheckedTransaction(t){const n=Ch(t),s=[];if(n.from){const o=n.from;s.push((async()=>{const a=await nt(o,this.provider);C(a!=null&&a.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",t),n.from=a})())}else n.from=this.address;if(n.gasLimit==null&&s.push((async()=>{n.gasLimit=await this.provider.estimateGas({...n,from:this.address})})()),n.to!=null){const o=n.to;s.push((async()=>{n.to=await nt(o,this.provider)})())}s.length&&await Promise.all(s);const i=this.provider.getRpcTransaction(n);return this.provider.send("eth_sendTransaction",[i])}async sendTransaction(t){const n=await this.provider.getBlockNumber(),s=await this.sendUncheckedTransaction(t);return await new Promise((i,o)=>{const a=[1e3,100];let c=0;const l=async()=>{try{const u=await this.provider.getTransaction(s);if(u!=null){i(u.replaceableTransaction(n));return}}catch(u){if(Qe(u,"CANCELLED")||Qe(u,"BAD_DATA")||Qe(u,"NETWORK_ERROR")||Qe(u,"UNSUPPORTED_OPERATION")){u.info==null&&(u.info={}),u.info.sendTransactionHash=s,o(u);return}if(Qe(u,"INVALID_ARGUMENT")&&(c++,u.info==null&&(u.info={}),u.info.sendTransactionHash=s,c>10)){o(u);return}this.provider.emit("error",Be("failed to fetch transation after sending (will try again)","UNKNOWN_ERROR",{error:u}))}this.provider._setTimeout(()=>{l()},a.pop()||4e3)};l()})}async signTransaction(t){const n=Ch(t);if(n.from){const i=await nt(n.from,this.provider);C(i!=null&&i.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",t),n.from=i}else n.from=this.address;const s=this.provider.getRpcTransaction(n);return await this.provider.send("eth_signTransaction",[s])}async signMessage(t){const n=typeof t=="string"?st(t):t;return await this.provider.send("personal_sign",[K(n),this.address.toLowerCase()])}async signTypedData(t,n,s){const i=Ch(s),o=await Li.resolveNames(t,n,i,async a=>{const c=await nt(a);return C(c!=null,"TypedData does not support null address","value",a),c});return await this.provider.send("eth_signTypedData_v4",[this.address.toLowerCase(),JSON.stringify(Li.getPayload(o.domain,n,o.value))])}async unlock(t){return this.provider.send("personal_unlockAccount",[this.address.toLowerCase(),t,null])}async _legacySignMessage(t){const n=typeof t=="string"?st(t):t;return await this.provider.send("eth_sign",[this.address.toLowerCase(),K(n)])}}var Vo,jc,Ps,Mn,ln,Lr,Zt,Yu,pg;class ay extends Pu{constructor(t,n){super(t,n);M(this,Yu);M(this,Vo);M(this,jc);M(this,Ps);M(this,Mn);M(this,ln);M(this,Lr);M(this,Zt);S(this,jc,1),S(this,Vo,Object.assign({},SE,n||{})),S(this,Ps,[]),S(this,Mn,null),S(this,Lr,null),S(this,Zt,null);{let i=null;const o=new Promise(a=>{i=a});S(this,ln,{promise:o,resolve:i})}const s=this._getOption("staticNetwork");typeof s=="boolean"?(C(!s||t!=="any","staticNetwork cannot be used on special network 'any'","options",n),s&&t!=null&&S(this,Lr,He.from(t))):s&&(C(t==null||s.matches(t),"staticNetwork MUST match network object","options",n),S(this,Lr,s))}_getOption(t){return b(this,Vo)[t]}get _network(){return z(b(this,Lr),"network is not available yet","NETWORK_ERROR"),b(this,Lr)}async _perform(t){if(t.method==="call"||t.method==="estimateGas"){let s=t.transaction;if(s&&s.type!=null&&re(s.type)&&s.maxFeePerGas==null&&s.maxPriorityFeePerGas==null){const i=await this.getFeeData();i.maxFeePerGas==null&&i.maxPriorityFeePerGas==null&&(t=Object.assign({},t,{transaction:Object.assign({},s,{type:void 0})}))}}const n=this.getRpcRequest(t);return n!=null?await this.send(n.method,n.args):super._perform(t)}async _detectNetwork(){const t=this._getOption("staticNetwork");if(t)if(t===!0){if(b(this,Lr))return b(this,Lr)}else return t;return b(this,Zt)?await b(this,Zt):this.ready?(S(this,Zt,(async()=>{try{const n=He.from(re(await this.send("eth_chainId",[])));return S(this,Zt,null),n}catch(n){throw S(this,Zt,null),n}})()),await b(this,Zt)):(S(this,Zt,(async()=>{const n={id:ma(this,jc)._++,method:"eth_chainId",params:[],jsonrpc:"2.0"};this.emit("debug",{action:"sendRpcPayload",payload:n});let s;try{s=(await this._send(n))[0],S(this,Zt,null)}catch(i){throw S(this,Zt,null),this.emit("debug",{action:"receiveRpcError",error:i}),i}if(this.emit("debug",{action:"receiveRpcResult",result:s}),"result"in s)return He.from(re(s.result));throw this.getRpcError(n,s)})()),await b(this,Zt))}_start(){b(this,ln)==null||b(this,ln).resolve==null||(b(this,ln).resolve(),S(this,ln,null),(async()=>{for(;b(this,Lr)==null&&!this.destroyed;)try{S(this,Lr,await this._detectNetwork())}catch(t){if(this.destroyed)break;console.log("JsonRpcProvider failed to detect network and cannot start up; retry in 1s (perhaps the URL is wrong or the node is not started)"),this.emit("error",Be("failed to bootstrap network detection","NETWORK_ERROR",{event:"initial-network-discovery",info:{error:t}})),await nS(1e3)}q(this,Yu,pg).call(this)})())}async _waitUntilReady(){if(b(this,ln)!=null)return await b(this,ln).promise}_getSubscriber(t){return t.type==="pending"?new tS(this):t.type==="event"?this._getOption("polling")?new oy(this,t.filter):new eS(this,t.filter):t.type==="orphan"&&t.filter.orphan==="drop-log"?new Ou("orphan"):super._getSubscriber(t)}get ready(){return b(this,ln)==null}getRpcTransaction(t){const n={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach(s=>{if(t[s]==null)return;let i=s;s==="gasLimit"&&(i="gas"),n[i]=xr(re(t[s],`tx.${s}`))}),["from","to","data"].forEach(s=>{t[s]!=null&&(n[s]=K(t[s]))}),t.accessList&&(n.accessList=Hs(t.accessList)),t.blobVersionedHashes&&(n.blobVersionedHashes=t.blobVersionedHashes.map(s=>s.toLowerCase())),t.authorizationList&&(n.authorizationList=t.authorizationList.map(s=>{const i=Vb(s);return{address:i.address,nonce:xr(i.nonce),chainId:xr(i.chainId),yParity:xr(i.signature.yParity),r:xr(i.signature.r),s:xr(i.signature.s)}})),n}getRpcRequest(t){switch(t.method){case"chainId":return{method:"eth_chainId",args:[]};case"getBlockNumber":return{method:"eth_blockNumber",args:[]};case"getGasPrice":return{method:"eth_gasPrice",args:[]};case"getPriorityFee":return{method:"eth_maxPriorityFeePerGas",args:[]};case"getBalance":return{method:"eth_getBalance",args:[Ea(t.address),t.blockTag]};case"getTransactionCount":return{method:"eth_getTransactionCount",args:[Ea(t.address),t.blockTag]};case"getCode":return{method:"eth_getCode",args:[Ea(t.address),t.blockTag]};case"getStorage":return{method:"eth_getStorageAt",args:[Ea(t.address),"0x"+t.position.toString(16),t.blockTag]};case"broadcastTransaction":return{method:"eth_sendRawTransaction",args:[t.signedTransaction]};case"getBlock":if("blockTag"in t)return{method:"eth_getBlockByNumber",args:[t.blockTag,!!t.includeTransactions]};if("blockHash"in t)return{method:"eth_getBlockByHash",args:[t.blockHash,!!t.includeTransactions]};break;case"getTransaction":return{method:"eth_getTransactionByHash",args:[t.hash]};case"getTransactionReceipt":return{method:"eth_getTransactionReceipt",args:[t.hash]};case"call":return{method:"eth_call",args:[this.getRpcTransaction(t.transaction),t.blockTag]};case"estimateGas":return{method:"eth_estimateGas",args:[this.getRpcTransaction(t.transaction)]};case"getLogs":return t.filter&&t.filter.address!=null&&(Array.isArray(t.filter.address)?t.filter.address=t.filter.address.map(Ea):t.filter.address=Ea(t.filter.address)),{method:"eth_getLogs",args:[t.filter]}}return null}getRpcError(t,n){const{method:s}=t,{error:i}=n;if(s==="eth_estimateGas"&&i.message){const c=i.message;if(!c.match(/revert/i)&&c.match(/insufficient funds/i))return Be("insufficient funds","INSUFFICIENT_FUNDS",{transaction:t.params[0],info:{payload:t,error:i}});if(c.match(/nonce/i)&&c.match(/too low/i))return Be("nonce has already been used","NONCE_EXPIRED",{transaction:t.params[0],info:{payload:t,error:i}})}if(s==="eth_call"||s==="eth_estimateGas"){const c=gg(i),l=ra.getBuiltinCallException(s==="eth_call"?"call":"estimateGas",t.params[0],c?c.data:null);return l.info={error:i,payload:t},l}const o=JSON.stringify(sS(i));if(typeof i.message=="string"&&i.message.match(/user denied|ethers-user-denied/i))return Be("user rejected action","ACTION_REJECTED",{action:{eth_sign:"signMessage",personal_sign:"signMessage",eth_signTypedData_v4:"signTypedData",eth_signTransaction:"signTransaction",eth_sendTransaction:"sendTransaction",eth_requestAccounts:"requestAccess",wallet_requestAccounts:"requestAccess"}[s]||"unknown",reason:"rejected",info:{payload:t,error:i}});if(s==="eth_sendRawTransaction"||s==="eth_sendTransaction"){const c=t.params[0];if(o.match(/insufficient funds|base fee exceeds gas limit/i))return Be("insufficient funds for intrinsic transaction cost","INSUFFICIENT_FUNDS",{transaction:c,info:{error:i}});if(o.match(/nonce/i)&&o.match(/too low/i))return Be("nonce has already been used","NONCE_EXPIRED",{transaction:c,info:{error:i}});if(o.match(/replacement transaction/i)&&o.match(/underpriced/i))return Be("replacement fee too low","REPLACEMENT_UNDERPRICED",{transaction:c,info:{error:i}});if(o.match(/only replay-protected/i))return Be("legacy pre-eip-155 transactions not supported","UNSUPPORTED_OPERATION",{operation:s,info:{transaction:c,info:{error:i}}})}let a=!!o.match(/the method .* does not exist/i);return a||i&&i.details&&i.details.startsWith("Unauthorized method:")&&(a=!0),a?Be("unsupported operation","UNSUPPORTED_OPERATION",{operation:t.method,info:{error:i,payload:t}}):Be("could not coalesce error","UNKNOWN_ERROR",{error:i,payload:t})}send(t,n){if(this.destroyed)return Promise.reject(Be("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:t}));const s=ma(this,jc)._++,i=new Promise((o,a)=>{b(this,Ps).push({resolve:o,reject:a,payload:{method:t,params:n,id:s,jsonrpc:"2.0"}})});return q(this,Yu,pg).call(this),i}async getSigner(t){t==null&&(t=0);const n=this.send("eth_accounts",[]);if(typeof t=="number"){const i=await n;if(t>=i.length)throw new Error("no such account");return new Th(this,i[t])}const{accounts:s}=await ct({network:this.getNetwork(),accounts:n});t=ce(t);for(const i of s)if(ce(i)===t)return new Th(this,t);throw new Error("invalid account")}async listAccounts(){return(await this.send("eth_accounts",[])).map(n=>new Th(this,n))}destroy(){b(this,Mn)&&(clearTimeout(b(this,Mn)),S(this,Mn,null));for(const{payload:t,reject:n}of b(this,Ps))n(Be("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:t.method}));S(this,Ps,[]),super.destroy()}}Vo=new WeakMap,jc=new WeakMap,Ps=new WeakMap,Mn=new WeakMap,ln=new WeakMap,Lr=new WeakMap,Zt=new WeakMap,Yu=new WeakSet,pg=function(){if(b(this,Mn))return;const t=this._getOption("batchMaxCount")===1?0:this._getOption("batchStallTime");S(this,Mn,setTimeout(()=>{S(this,Mn,null);const n=b(this,Ps);for(S(this,Ps,[]);n.length;){const s=[n.shift()];for(;n.length&&s.length!==b(this,Vo).batchMaxCount;)if(s.push(n.shift()),JSON.stringify(s.map(o=>o.payload)).length>b(this,Vo).batchMaxSize){n.unshift(s.pop());break}(async()=>{const i=s.length===1?s[0].payload:s.map(o=>o.payload);this.emit("debug",{action:"sendRpcPayload",payload:i});try{const o=await this._send(i);this.emit("debug",{action:"receiveRpcResult",result:o});for(const{resolve:a,reject:c,payload:l}of s){if(this.destroyed){c(Be("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:l.method}));continue}const u=o.filter(f=>f.id===l.id)[0];if(u==null){const f=Be("missing response for request","BAD_DATA",{value:o,info:{payload:l}});this.emit("error",f),c(f);continue}if("error"in u){c(this.getRpcError(l,u));continue}a(u.result)}}catch(o){this.emit("debug",{action:"receiveRpcError",error:o});for(const{reject:a}of s)a(o)}})()}},t))};var Oi;class OE extends ay{constructor(t,n){super(t,n);M(this,Oi);let s=this._getOption("pollingInterval");s==null&&(s=SE.pollingInterval),S(this,Oi,s)}_getSubscriber(t){const n=super._getSubscriber(t);return vx(n)&&(n.pollingInterval=b(this,Oi)),n}get pollingInterval(){return b(this,Oi)}set pollingInterval(t){if(!Number.isInteger(t)||t<0)throw new Error("invalid interval");S(this,Oi,t),this._forEachSubscriber(n=>{vx(n)&&(n.pollingInterval=b(this,Oi))})}}Oi=new WeakMap;var zc;class Vr extends OE{constructor(t,n,s){t==null&&(t="http://localhost:8545");super(n,s);M(this,zc);typeof t=="string"?S(this,zc,new pt(t)):S(this,zc,t.clone())}_getConnection(){return b(this,zc).clone()}async send(t,n){return await this._start(),await super.send(t,n)}async _send(t){const n=this._getConnection();n.body=JSON.stringify(t),n.setHeader("content-type","application/json");const s=await n.send();s.assertOk();let i=s.bodyJson;return Array.isArray(i)||(i=[i]),i}}zc=new WeakMap;function gg(r){if(r==null)return null;if(typeof r.message=="string"&&r.message.match(/revert/i)&&De(r.data))return{message:r.message,data:r.data};if(typeof r=="object"){for(const e in r){const t=gg(r[e]);if(t)return t}return null}if(typeof r=="string")try{return gg(JSON.parse(r))}catch{}return null}function bg(r,e){if(r!=null){if(typeof r.message=="string"&&e.push(r.message),typeof r=="object")for(const t in r)bg(r[t],e);if(typeof r=="string")try{return bg(JSON.parse(r),e)}catch{}}}function sS(r){const e=[];return bg(r,e),e}const Hf="9f7d929b018cdffb338517efa06f58359e86ff1ffd350bc889738523659e7972";function iS(r){switch(r){case"mainnet":return"rpc.ankr.com/eth";case"goerli":return"rpc.ankr.com/eth_goerli";case"sepolia":return"rpc.ankr.com/eth_sepolia";case"arbitrum":return"rpc.ankr.com/arbitrum";case"base":return"rpc.ankr.com/base";case"base-goerli":return"rpc.ankr.com/base_goerli";case"base-sepolia":return"rpc.ankr.com/base_sepolia";case"bnb":return"rpc.ankr.com/bsc";case"bnbt":return"rpc.ankr.com/bsc_testnet_chapel";case"matic":return"rpc.ankr.com/polygon";case"matic-mumbai":return"rpc.ankr.com/polygon_mumbai";case"optimism":return"rpc.ankr.com/optimism";case"optimism-goerli":return"rpc.ankr.com/optimism_testnet";case"optimism-sepolia":return"rpc.ankr.com/optimism_sepolia"}C(!1,"unsupported network","network",r)}class Cu extends Vr{constructor(t,n){t==null&&(t="mainnet");const s=He.from(t);n==null&&(n=Hf);const i={polling:!0,staticNetwork:s},o=Cu.getRequest(s,n);super(o,s,i);k(this,"apiKey");te(this,{apiKey:n})}_getProvider(t){try{return new Cu(t,this.apiKey)}catch{}return super._getProvider(t)}static getRequest(t,n){n==null&&(n=Hf);const s=new pt(`https://${iS(t.name)}/${n}`);return s.allowGzip=!0,n===Hf&&(s.retryFunc=async(i,o,a)=>(Wi("AnkrProvider"),!0)),s}getRpcError(t,n){return t.method==="eth_sendRawTransaction"&&n&&n.error&&n.error.message==="INTERNAL_ERROR: could not replace existing tx"&&(n.error.message="replacement transaction underpriced"),super.getRpcError(t,n)}isCommunityResource(){return this.apiKey===Hf}}const qf="_gg7wSSi0KMBsdKnGVfHDueq6xMB9EkC";function oS(r){switch(r){case"mainnet":return"eth-mainnet.alchemyapi.io";case"goerli":return"eth-goerli.g.alchemy.com";case"sepolia":return"eth-sepolia.g.alchemy.com";case"arbitrum":return"arb-mainnet.g.alchemy.com";case"arbitrum-goerli":return"arb-goerli.g.alchemy.com";case"arbitrum-sepolia":return"arb-sepolia.g.alchemy.com";case"base":return"base-mainnet.g.alchemy.com";case"base-goerli":return"base-goerli.g.alchemy.com";case"base-sepolia":return"base-sepolia.g.alchemy.com";case"matic":return"polygon-mainnet.g.alchemy.com";case"matic-amoy":return"polygon-amoy.g.alchemy.com";case"matic-mumbai":return"polygon-mumbai.g.alchemy.com";case"optimism":return"opt-mainnet.g.alchemy.com";case"optimism-goerli":return"opt-goerli.g.alchemy.com";case"optimism-sepolia":return"opt-sepolia.g.alchemy.com"}C(!1,"unsupported network","network",r)}class Tu extends Vr{constructor(t,n){t==null&&(t="mainnet");const s=He.from(t);n==null&&(n=qf);const i=Tu.getRequest(s,n);super(i,s,{staticNetwork:s});k(this,"apiKey");te(this,{apiKey:n})}_getProvider(t){try{return new Tu(t,this.apiKey)}catch{}return super._getProvider(t)}async _perform(t){if(t.method==="getTransactionResult"){const{trace:n,tx:s}=await ct({trace:this.send("trace_transaction",[t.hash]),tx:this.getTransaction(t.hash)});if(n==null||s==null)return null;let i,o=!1;try{i=n[0].result.output,o=n[0].error==="Reverted"}catch{}if(i)return z(!o,"an error occurred during transaction executions","CALL_EXCEPTION",{action:"getTransactionResult",data:i,reason:null,transaction:s,invocation:null,revert:null}),i;z(!1,"could not parse trace result","BAD_DATA",{value:n})}return await super._perform(t)}isCommunityResource(){return this.apiKey===qf}static getRequest(t,n){n==null&&(n=qf);const s=new pt(`https://${oS(t.name)}/v2/${n}`);return s.allowGzip=!0,n===qf&&(s.retryFunc=async(i,o,a)=>(Wi("alchemy"),!0)),s}}function Vf(r){switch(r){case"mainnet":return"39f1d67cedf8b7831010a665328c9197";case"arbitrum":return"0550c209db33c3abf4cc927e1e18cea1";case"bnb":return"98b5a77e531614387366f6fc5da097f8";case"matic":return"cd9d4d70377471aa7c142ec4a4205249"}C(!1,"unsupported network","network",r)}function aS(r){switch(r){case"mainnet":return"ethereum-mainnet.core.chainstack.com";case"arbitrum":return"arbitrum-mainnet.core.chainstack.com";case"bnb":return"bsc-mainnet.core.chainstack.com";case"matic":return"polygon-mainnet.core.chainstack.com"}C(!1,"unsupported network","network",r)}class Nu extends Vr{constructor(t,n){t==null&&(t="mainnet");const s=He.from(t);n==null&&(n=Vf(s.name));const i=Nu.getRequest(s,n);super(i,s,{staticNetwork:s});k(this,"apiKey");te(this,{apiKey:n})}_getProvider(t){try{return new Nu(t,this.apiKey)}catch{}return super._getProvider(t)}isCommunityResource(){return this.apiKey===Vf(this._network.name)}static getRequest(t,n){n==null&&(n=Vf(t.name));const s=new pt(`https://${aS(t.name)}/${n}`);return s.allowGzip=!0,n===Vf(t.name)&&(s.retryFunc=async(i,o,a)=>(Wi("ChainstackProvider"),!0)),s}}class PE extends Vr{constructor(e){e==null&&(e="mainnet");const t=He.from(e);C(t.name==="mainnet","unsupported network","network",e),super("https://cloudflare-eth.com/",t,{staticNetwork:t})}}const Ax=2e3;function cS(r){return r&&typeof r.then=="function"}const CE="org.ethers.plugins.provider.Etherscan";class cy extends Gi{constructor(t){super(CE);k(this,"baseUrl");te(this,{baseUrl:t})}clone(){return new cy(this.baseUrl)}}const lS=["enableCcipRead"];let uS=1;var Hc;class TE extends Pu{constructor(t,n){const s=n??null;super();k(this,"network");k(this,"apiKey");M(this,Hc);const i=He.from(t);S(this,Hc,i.getPlugin(CE)),te(this,{apiKey:s,network:i})}getBaseUrl(){if(b(this,Hc))return b(this,Hc).baseUrl;switch(this.network.name){case"mainnet":return"https://api.etherscan.io";case"goerli":return"https://api-goerli.etherscan.io";case"sepolia":return"https://api-sepolia.etherscan.io";case"holesky":return"https://api-holesky.etherscan.io";case"arbitrum":return"https://api.arbiscan.io";case"arbitrum-goerli":return"https://api-goerli.arbiscan.io";case"base":return"https://api.basescan.org";case"base-sepolia":return"https://api-sepolia.basescan.org";case"bnb":return"https://api.bscscan.com";case"bnbt":return"https://api-testnet.bscscan.com";case"matic":return"https://api.polygonscan.com";case"matic-amoy":return"https://api-amoy.polygonscan.com";case"matic-mumbai":return"https://api-testnet.polygonscan.com";case"optimism":return"https://api-optimistic.etherscan.io";case"optimism-goerli":return"https://api-goerli-optimistic.etherscan.io"}C(!1,"unsupported network","network",this.network)}getUrl(t,n){let s=Object.keys(n).reduce((i,o)=>{const a=n[o];return a!=null&&(i+=`&${o}=${a}`),i},"");return this.apiKey&&(s+=`&apikey=${this.apiKey}`),`https://api.etherscan.io/v2/api?chainid=${this.network.chainId}&module=${t}${s}`}getPostUrl(){return`https://api.etherscan.io/v2/api?chainid=${this.network.chainId}`}getPostData(t,n){return n.module=t,n.apikey=this.apiKey,n.chainid=this.network.chainId,n}async detectNetwork(){return this.network}async fetch(t,n,s){const i=uS++,o=s?this.getPostUrl():this.getUrl(t,n),a=s?this.getPostData(t,n):null;this.emit("debug",{action:"sendRequest",id:i,url:o,payload:a});const c=new pt(o);c.setThrottleParams({slotInterval:1e3}),c.retryFunc=(f,h,d)=>(this.isCommunityResource()&&Wi("Etherscan"),Promise.resolve(!0)),c.processFunc=async(f,h)=>{const d=h.hasBody()?JSON.parse($i(h.body)):{},p=(typeof d.result=="string"?d.result:"").toLowerCase().indexOf("rate limit")>=0;return t==="proxy"?d&&d.status==0&&d.message=="NOTOK"&&p&&(this.emit("debug",{action:"receiveError",id:i,reason:"proxy-NOTOK",error:d}),h.throwThrottleError(d.result,Ax)):p&&(this.emit("debug",{action:"receiveError",id:i,reason:"null result",error:d.result}),h.throwThrottleError(d.result,Ax)),h},a&&(c.setHeader("content-type","application/x-www-form-urlencoded; charset=UTF-8"),c.body=Object.keys(a).map(f=>`${f}=${a[f]}`).join("&"));const l=await c.send();try{l.assertOk()}catch(f){this.emit("debug",{action:"receiveError",id:i,error:f,reason:"assertOk"}),z(!1,"response error","SERVER_ERROR",{request:c,response:l})}l.hasBody()||(this.emit("debug",{action:"receiveError",id:i,error:"missing body",reason:"null body"}),z(!1,"missing response","SERVER_ERROR",{request:c,response:l}));const u=JSON.parse($i(l.body));return t==="proxy"?(u.jsonrpc!="2.0"&&(this.emit("debug",{action:"receiveError",id:i,result:u,reason:"invalid JSON-RPC"}),z(!1,"invalid JSON-RPC response (missing jsonrpc='2.0')","SERVER_ERROR",{request:c,response:l,info:{result:u}})),u.error&&(this.emit("debug",{action:"receiveError",id:i,result:u,reason:"JSON-RPC error"}),z(!1,"error response","SERVER_ERROR",{request:c,response:l,info:{result:u}})),this.emit("debug",{action:"receiveRequest",id:i,result:u}),u.result):u.status==0&&(u.message==="No records found"||u.message==="No transactions found")?(this.emit("debug",{action:"receiveRequest",id:i,result:u}),u.result):((u.status!=1||typeof u.message=="string"&&!u.message.match(/^OK/))&&(this.emit("debug",{action:"receiveError",id:i,result:u}),z(!1,"error response","SERVER_ERROR",{request:c,response:l,info:{result:u}})),this.emit("debug",{action:"receiveRequest",id:i,result:u}),u.result)}_getTransactionPostData(t){const n={};for(let s in t){if(lS.indexOf(s)>=0||t[s]==null)continue;let i=t[s];if(!(s==="type"&&i===0)&&!(s==="blockTag"&&i==="latest")){if({type:!0,gasLimit:!0,gasPrice:!0,maxFeePerGs:!0,maxPriorityFeePerGas:!0,nonce:!0,value:!0}[s])i=xr(i);else if(s==="accessList")i="["+Hs(i).map(o=>`{address:"${o.address}",storageKeys:["${o.storageKeys.join('","')}"]}`).join(",")+"]";else if(s==="blobVersionedHashes"){if(i.length===0)continue;z(!1,"Etherscan API does not support blobVersionedHashes","UNSUPPORTED_OPERATION",{operation:"_getTransactionPostData",info:{transaction:t}})}else i=K(i);n[s]=i}}return n}_checkError(t,n,s){let i="";if(Qe(n,"SERVER_ERROR")){try{i=n.info.result.error.message}catch{}if(!i)try{i=n.info.message}catch{}}if(t.method==="estimateGas"&&!i.match(/revert/i)&&i.match(/insufficient funds/i)&&z(!1,"insufficient funds","INSUFFICIENT_FUNDS",{transaction:t.transaction}),(t.method==="call"||t.method==="estimateGas")&&i.match(/execution reverted/i)){let o="";try{o=n.info.result.error.data}catch{}const a=ra.getBuiltinCallException(t.method,t.transaction,o);throw a.info={request:t,error:n},a}if(i&&t.method==="broadcastTransaction"){const o=ea.from(t.signedTransaction);i.match(/replacement/i)&&i.match(/underpriced/i)&&z(!1,"replacement fee too low","REPLACEMENT_UNDERPRICED",{transaction:o}),i.match(/insufficient funds/)&&z(!1,"insufficient funds for intrinsic transaction cost","INSUFFICIENT_FUNDS",{transaction:o}),i.match(/same hash was already imported|transaction nonce is too low|nonce too low/)&&z(!1,"nonce has already been used","NONCE_EXPIRED",{transaction:o})}throw n}async _detectNetwork(){return this.network}async _perform(t){switch(t.method){case"chainId":return this.network.chainId;case"getBlockNumber":return this.fetch("proxy",{action:"eth_blockNumber"});case"getGasPrice":return this.fetch("proxy",{action:"eth_gasPrice"});case"getPriorityFee":if(this.network.name==="mainnet")return"1000000000";if(this.network.name==="optimism")return"1000000";throw new Error("fallback onto the AbstractProvider default");case"getBalance":return this.fetch("account",{action:"balance",address:t.address,tag:t.blockTag});case"getTransactionCount":return this.fetch("proxy",{action:"eth_getTransactionCount",address:t.address,tag:t.blockTag});case"getCode":return this.fetch("proxy",{action:"eth_getCode",address:t.address,tag:t.blockTag});case"getStorage":return this.fetch("proxy",{action:"eth_getStorageAt",address:t.address,position:t.position,tag:t.blockTag});case"broadcastTransaction":return this.fetch("proxy",{action:"eth_sendRawTransaction",hex:t.signedTransaction},!0).catch(n=>this._checkError(t,n,t.signedTransaction));case"getBlock":if("blockTag"in t)return this.fetch("proxy",{action:"eth_getBlockByNumber",tag:t.blockTag,boolean:t.includeTransactions?"true":"false"});z(!1,"getBlock by blockHash not supported by Etherscan","UNSUPPORTED_OPERATION",{operation:"getBlock(blockHash)"});case"getTransaction":return this.fetch("proxy",{action:"eth_getTransactionByHash",txhash:t.hash});case"getTransactionReceipt":return this.fetch("proxy",{action:"eth_getTransactionReceipt",txhash:t.hash});case"call":{if(t.blockTag!=="latest")throw new Error("EtherscanProvider does not support blockTag for call");const n=this._getTransactionPostData(t.transaction);n.module="proxy",n.action="eth_call";try{return await this.fetch("proxy",n,!0)}catch(s){return this._checkError(t,s,t.transaction)}}case"estimateGas":{const n=this._getTransactionPostData(t.transaction);n.module="proxy",n.action="eth_estimateGas";try{return await this.fetch("proxy",n,!0)}catch(s){return this._checkError(t,s,t.transaction)}}}return super._perform(t)}async getNetwork(){return this.network}async getEtherPrice(){return this.network.name!=="mainnet"?0:parseFloat((await this.fetch("stats",{action:"ethprice"})).ethusd)}async getContract(t){let n=this._getAddress(t);cS(n)&&(n=await n);try{const s=await this.fetch("contract",{action:"getabi",address:n}),i=JSON.parse(s);return new ki(n,i,this)}catch{return null}}isCommunityResource(){return this.apiKey==null}}Hc=new WeakMap;function fS(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}const hS=fS().WebSocket;var jn,Zu,Pi,Ko,Ci;class Hd{constructor(e,t){M(this,jn);M(this,Zu);M(this,Pi);M(this,Ko);M(this,Ci);S(this,jn,e),S(this,Zu,JSON.stringify(t)),S(this,Pi,null),S(this,Ko,null),S(this,Ci,null)}get filter(){return JSON.parse(b(this,Zu))}start(){S(this,Pi,b(this,jn).send("eth_subscribe",this.filter).then(e=>(b(this,jn)._register(e,this),e)))}stop(){b(this,Pi).then(e=>{b(this,jn).destroyed||b(this,jn).send("eth_unsubscribe",[e])}),S(this,Pi,null)}pause(e){z(e,"preserve logs while paused not supported by SocketSubscriber yet","UNSUPPORTED_OPERATION",{operation:"pause(false)"}),S(this,Ko,!!e)}resume(){S(this,Ko,null)}_handleMessage(e){if(b(this,Pi)!=null&&b(this,Ko)===null){let t=b(this,Ci);t==null?t=this._emit(b(this,jn),e):t=t.then(async()=>{await this._emit(b(this,jn),e)}),S(this,Ci,t.then(()=>{b(this,Ci)===t&&S(this,Ci,null)}))}}async _emit(e,t){throw new Error("sub-classes must implemente this; _emit")}}jn=new WeakMap,Zu=new WeakMap,Pi=new WeakMap,Ko=new WeakMap,Ci=new WeakMap;class NE extends Hd{constructor(e){super(e,["newHeads"])}async _emit(e,t){e.emit("block",parseInt(t.number))}}class DE extends Hd{constructor(e){super(e,["newPendingTransactions"])}async _emit(e,t){e.emit("pending",t)}}var Xu;class RE extends Hd{constructor(t,n){super(t,["logs",n]);M(this,Xu);S(this,Xu,JSON.stringify(n))}get logFilter(){return JSON.parse(b(this,Xu))}async _emit(t,n){t.emit(this.logFilter,t._wrapLog(n,t._network))}}Xu=new WeakMap;var Go,qc,Ti;class _E extends ay{constructor(t,n){const s=Object.assign({},n??{});C(s.batchMaxCount==null||s.batchMaxCount===1,"sockets-based providers do not support batches","options.batchMaxCount",n),s.batchMaxCount=1,s.staticNetwork==null&&(s.staticNetwork=!0);super(t,s);M(this,Go);M(this,qc);M(this,Ti);S(this,Go,new Map),S(this,qc,new Map),S(this,Ti,new Map)}_getSubscriber(t){switch(t.type){case"close":return new Ou("close");case"block":return new NE(this);case"pending":return new DE(this);case"event":return new RE(this,t.filter);case"orphan":if(t.filter.orphan==="drop-log")return new Ou("drop-log")}return super._getSubscriber(t)}_register(t,n){b(this,qc).set(t,n);const s=b(this,Ti).get(t);if(s){for(const i of s)n._handleMessage(i);b(this,Ti).delete(t)}}async _send(t){C(!Array.isArray(t),"WebSocket does not support batch send","payload",t);const n=new Promise((s,i)=>{b(this,Go).set(t.id,{payload:t,resolve:s,reject:i})});return await this._waitUntilReady(),await this._write(JSON.stringify(t)),[await n]}async _processMessage(t){const n=JSON.parse(t);if(n&&typeof n=="object"&&"id"in n){const s=b(this,Go).get(n.id);if(s==null){this.emit("error",Be("received result for unknown id","UNKNOWN_ERROR",{reasonCode:"UNKNOWN_ID",result:n}));return}b(this,Go).delete(n.id),s.resolve(n)}else if(n&&n.method==="eth_subscription"){const s=n.params.subscription,i=b(this,qc).get(s);if(i)i._handleMessage(n.params.result);else{let o=b(this,Ti).get(s);o==null&&(o=[],b(this,Ti).set(s,o)),o.push(n.params.result)}}else{this.emit("error",Be("received unexpected message","UNKNOWN_ERROR",{reasonCode:"UNEXPECTED_MESSAGE",result:n}));return}}async _write(t){throw new Error("sub-classes must override this")}}Go=new WeakMap,qc=new WeakMap,Ti=new WeakMap;var Wo,un;class ly extends _E{constructor(t,n,s){super(n,s);M(this,Wo);M(this,un);typeof t=="string"?(S(this,Wo,()=>new hS(t)),S(this,un,b(this,Wo).call(this))):typeof t=="function"?(S(this,Wo,t),S(this,un,t())):(S(this,Wo,null),S(this,un,t)),this.websocket.onopen=async()=>{try{await this._start(),this.resume()}catch(i){console.log("failed to start WebsocketProvider",i)}},this.websocket.onmessage=i=>{this._processMessage(i.data)}}get websocket(){if(b(this,un)==null)throw new Error("websocket closed");return b(this,un)}async _write(t){this.websocket.send(t)}async destroy(){b(this,un)!=null&&(b(this,un).close(),S(this,un,null)),super.destroy()}}Wo=new WeakMap,un=new WeakMap;const Zl="84842078b09946638c03157f83405213";function dS(r){switch(r){case"mainnet":return"mainnet.infura.io";case"goerli":return"goerli.infura.io";case"sepolia":return"sepolia.infura.io";case"arbitrum":return"arbitrum-mainnet.infura.io";case"arbitrum-goerli":return"arbitrum-goerli.infura.io";case"arbitrum-sepolia":return"arbitrum-sepolia.infura.io";case"base":return"base-mainnet.infura.io";case"base-goerlia":case"base-goerli":return"base-goerli.infura.io";case"base-sepolia":return"base-sepolia.infura.io";case"bnb":return"bsc-mainnet.infura.io";case"bnbt":return"bsc-testnet.infura.io";case"linea":return"linea-mainnet.infura.io";case"linea-goerli":return"linea-goerli.infura.io";case"linea-sepolia":return"linea-sepolia.infura.io";case"matic":return"polygon-mainnet.infura.io";case"matic-amoy":return"polygon-amoy.infura.io";case"matic-mumbai":return"polygon-mumbai.infura.io";case"optimism":return"optimism-mainnet.infura.io";case"optimism-goerli":return"optimism-goerli.infura.io";case"optimism-sepolia":return"optimism-sepolia.infura.io"}C(!1,"unsupported network","network",r)}class BE extends ly{constructor(t,n){const s=new cl(t,n),i=s._getConnection();z(!i.credentials,"INFURA WebSocket project secrets unsupported","UNSUPPORTED_OPERATION",{operation:"InfuraProvider.getWebSocketProvider()"});const o=i.url.replace(/^http/i,"ws").replace("/v3/","/ws/v3/");super(o,s._network);k(this,"projectId");k(this,"projectSecret");te(this,{projectId:s.projectId,projectSecret:s.projectSecret})}isCommunityResource(){return this.projectId===Zl}}class cl extends Vr{constructor(t,n,s){t==null&&(t="mainnet");const i=He.from(t);n==null&&(n=Zl),s==null&&(s=null);const o=cl.getRequest(i,n,s);super(o,i,{staticNetwork:i});k(this,"projectId");k(this,"projectSecret");te(this,{projectId:n,projectSecret:s})}_getProvider(t){try{return new cl(t,this.projectId,this.projectSecret)}catch{}return super._getProvider(t)}isCommunityResource(){return this.projectId===Zl}static getWebSocketProvider(t,n){return new BE(t,n)}static getRequest(t,n,s){n==null&&(n=Zl),s==null&&(s=null);const i=new pt(`https://${dS(t.name)}/v3/${n}`);return i.allowGzip=!0,s&&i.setCredentials("",s),n===Zl&&(i.retryFunc=async(o,a,c)=>(Wi("InfuraProvider"),!0)),i}}const Kf="919b412a057b5e9c9b6dce193c5a60242d6efadb";function pS(r){switch(r){case"mainnet":return"ethers.quiknode.pro";case"goerli":return"ethers.ethereum-goerli.quiknode.pro";case"sepolia":return"ethers.ethereum-sepolia.quiknode.pro";case"holesky":return"ethers.ethereum-holesky.quiknode.pro";case"arbitrum":return"ethers.arbitrum-mainnet.quiknode.pro";case"arbitrum-goerli":return"ethers.arbitrum-goerli.quiknode.pro";case"arbitrum-sepolia":return"ethers.arbitrum-sepolia.quiknode.pro";case"base":return"ethers.base-mainnet.quiknode.pro";case"base-goerli":return"ethers.base-goerli.quiknode.pro";case"base-spolia":return"ethers.base-sepolia.quiknode.pro";case"bnb":return"ethers.bsc.quiknode.pro";case"bnbt":return"ethers.bsc-testnet.quiknode.pro";case"matic":return"ethers.matic.quiknode.pro";case"matic-mumbai":return"ethers.matic-testnet.quiknode.pro";case"optimism":return"ethers.optimism.quiknode.pro";case"optimism-goerli":return"ethers.optimism-goerli.quiknode.pro";case"optimism-sepolia":return"ethers.optimism-sepolia.quiknode.pro";case"xdai":return"ethers.xdai.quiknode.pro"}C(!1,"unsupported network","network",r)}class Du extends Vr{constructor(t,n){t==null&&(t="mainnet");const s=He.from(t);n==null&&(n=Kf);const i=Du.getRequest(s,n);super(i,s,{staticNetwork:s});k(this,"token");te(this,{token:n})}_getProvider(t){try{return new Du(t,this.token)}catch{}return super._getProvider(t)}isCommunityResource(){return this.token===Kf}static getRequest(t,n){n==null&&(n=Kf);const s=new pt(`https://${pS(t.name)}/${n}`);return s.allowGzip=!0,n===Kf&&(s.retryFunc=async(i,o,a)=>(Wi("QuickNodeProvider"),!0)),s}}const gS=BigInt("1"),bS=BigInt("2");function yS(r){for(let e=r.length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1)),n=r[e];r[e]=r[t],r[t]=n}}function mS(r){return new Promise(e=>{setTimeout(e,r)})}function yg(){return new Date().getTime()}function O0(r){return JSON.stringify(r,(e,t)=>typeof t=="bigint"?{type:"bigint",value:t.toString()}:t)}const Ix={stallTimeout:400,priority:1,weight:1},Sx={blockNumber:-2,requests:0,lateResponses:0,errorResponses:0,outOfSync:-1,unsupportedEvents:0,rollingDuration:0,score:0,_network:null,_updateNumber:null,_totalTime:0,_lastFatalError:null,_lastFatalErrorTimestamp:0};async function xS(r,e){for(;(r.blockNumber<0||r.blockNumber<e)&&(r._updateNumber||(r._updateNumber=(async()=>{try{const t=await r.provider.getBlockNumber();t>r.blockNumber&&(r.blockNumber=t)}catch(t){r.blockNumber=-2,r._lastFatalError=t,r._lastFatalErrorTimestamp=yg()}r._updateNumber=null})()),await r._updateNumber,r.outOfSync++,!r._lastFatalError););}function Ya(r){if(r==null)return"null";if(Array.isArray(r))return"["+r.map(Ya).join(",")+"]";if(typeof r=="object"&&typeof r.toJSON=="function")return Ya(r.toJSON());switch(typeof r){case"boolean":case"symbol":return r.toString();case"bigint":case"number":return BigInt(r).toString();case"string":return JSON.stringify(r);case"object":{const e=Object.keys(r);return e.sort(),"{"+e.map(t=>`${JSON.stringify(t)}:${Ya(r[t])}`).join(",")+"}"}}throw console.log("Could not serialize",r),new Error("Hmm...")}function P0(r,e){if("error"in e){const n=e.error;let s;return Qe(n,"CALL_EXCEPTION")?s=Ya(Object.assign({},n,{shortMessage:void 0,reason:void 0,info:void 0})):s=Ya(n),{tag:s,value:n}}const t=e.result;return{tag:Ya(t),value:t}}function Nh(r,e){const t=new Map;for(const{value:s,tag:i,weight:o}of e){const a=t.get(i)||{value:s,weight:0};a.weight+=o,t.set(i,a)}let n=null;for(const s of t.values())s.weight>=r&&(!n||s.weight>n.weight)&&(n=s);if(n)return n.value}function mg(r,e){let t=0;const n=new Map;let s=null;const i=[];for(const{value:a,tag:c,weight:l}of e)if(a instanceof Error){const u=n.get(c)||{value:a,weight:0};u.weight+=l,n.set(c,u),(s==null||u.weight>s.weight)&&(s=u)}else i.push(BigInt(a)),t+=l;if(t<r)return s&&s.weight>=r?s.value:void 0;i.sort((a,c)=>a<c?-1:c>a?1:0);const o=Math.floor(i.length/2);return i.length%2?i[o]:(i[o-1]+i[o]+gS)/bS}function C0(r,e){const t=Nh(r,e);if(t!==void 0)return t;for(const n of e)if(n.value)return n.value}function wS(r,e){if(r===1)return ae(mg(r,e),"%internal");const t=new Map,n=(o,a)=>{const c=t.get(o)||{result:o,weight:0};c.weight+=a,t.set(o,c)};for(const{weight:o,value:a}of e){const c=ae(a);n(c-1,o),n(c,o),n(c+1,o)}let s=0,i;for(const{weight:o,result:a}of t.values())o>=r&&(o>s||i!=null&&o===s&&a>i)&&(s=o,i=a);return i}var Xt,Cs,Vc,or,UE,xg,$E,LE,wg;class kE extends Pu{constructor(t,n,s){super(n,s);M(this,or);k(this,"quorum");k(this,"eventQuorum");k(this,"eventWorkers");M(this,Xt);M(this,Cs);M(this,Vc);S(this,Xt,t.map(i=>i instanceof Pu?Object.assign({provider:i},Ix,Sx):Object.assign({},Ix,i,Sx))),S(this,Cs,-2),S(this,Vc,null),s&&s.quorum!=null?this.quorum=s.quorum:this.quorum=Math.ceil(b(this,Xt).reduce((i,o)=>(i+=o.weight,i),0)/2),this.eventQuorum=1,this.eventWorkers=1,C(this.quorum<=b(this,Xt).reduce((i,o)=>i+o.weight,0),"quorum exceed provider weight","quorum",this.quorum)}get providerConfigs(){return b(this,Xt).map(t=>{const n=Object.assign({},t);for(const s in n)s[0]==="_"&&delete n[s];return n})}async _detectNetwork(){return He.from(re(await this._perform({method:"chainId"})))}async _translatePerform(t,n){switch(n.method){case"broadcastTransaction":return await t.broadcastTransaction(n.signedTransaction);case"call":return await t.call(Object.assign({},n.transaction,{blockTag:n.blockTag}));case"chainId":return(await t.getNetwork()).chainId;case"estimateGas":return await t.estimateGas(n.transaction);case"getBalance":return await t.getBalance(n.address,n.blockTag);case"getBlock":{const s="blockHash"in n?n.blockHash:n.blockTag;return await t.getBlock(s,n.includeTransactions)}case"getBlockNumber":return await t.getBlockNumber();case"getCode":return await t.getCode(n.address,n.blockTag);case"getGasPrice":return(await t.getFeeData()).gasPrice;case"getPriorityFee":return(await t.getFeeData()).maxPriorityFeePerGas;case"getLogs":return await t.getLogs(n.filter);case"getStorage":return await t.getStorage(n.address,n.position,n.blockTag);case"getTransaction":return await t.getTransaction(n.hash);case"getTransactionCount":return await t.getTransactionCount(n.address,n.blockTag);case"getTransactionReceipt":return await t.getTransactionReceipt(n.hash);case"getTransactionResult":return await t.getTransactionResult(n.hash)}}async _perform(t){if(t.method==="broadcastTransaction"){const o=b(this,Xt).map(l=>null),a=b(this,Xt).map(async({provider:l,weight:u},f)=>{try{const h=await l._perform(t);o[f]=Object.assign(P0(t.method,{result:h}),{weight:u})}catch(h){o[f]=Object.assign(P0(t.method,{error:h}),{weight:u})}});for(;;){const l=o.filter(h=>h!=null);for(const{value:h}of l)if(!(h instanceof Error))return h;const u=Nh(this.quorum,o.filter(h=>h!=null));if(Qe(u,"INSUFFICIENT_FUNDS"))throw u;const f=a.filter((h,d)=>o[d]==null);if(f.length===0)break;await Promise.race(f)}const c=C0(this.quorum,o);if(z(c!==void 0,"problem multi-broadcasting","SERVER_ERROR",{request:"%sub-requests",info:{request:t,results:o.map(O0)}}),c instanceof Error)throw c;return c}await q(this,or,$E).call(this);const n=new Set;let s=0;for(;;){const o=q(this,or,xg).call(this,n,t);if(o==null||(s+=o.config.weight,s>=this.quorum))break}const i=await q(this,or,wg).call(this,n,t);for(const o of n)o.perform&&o.result==null&&o.config.lateResponses++;return i}async destroy(){for(const{provider:t}of b(this,Xt))t.destroy();super.destroy()}}Xt=new WeakMap,Cs=new WeakMap,Vc=new WeakMap,or=new WeakSet,UE=function(t){const n=Array.from(t).map(i=>i.config),s=b(this,Xt).slice();yS(s),s.sort((i,o)=>i.priority-o.priority);for(const i of s)if(!i._lastFatalError&&n.indexOf(i)===-1)return i;return null},xg=function(t,n){const s=q(this,or,UE).call(this,t);if(s==null)return null;const i={config:s,result:null,didBump:!1,perform:null,staller:null},o=yg();return i.perform=(async()=>{try{s.requests++;const c=await this._translatePerform(s.provider,n);i.result={result:c}}catch(c){s.errorResponses++,i.result={error:c}}const a=yg()-o;s._totalTime+=a,s.rollingDuration=.95*s.rollingDuration+.05*a,i.perform=null})(),i.staller=(async()=>{await mS(s.stallTimeout),i.staller=null})(),t.add(i),i},$E=async function(){let t=b(this,Vc);if(!t){const n=[];b(this,Xt).forEach(s=>{n.push((async()=>{await xS(s,0),s._lastFatalError||(s._network=await s.provider.getNetwork())})())}),S(this,Vc,t=(async()=>{await Promise.all(n);let s=null;for(const i of b(this,Xt)){if(i._lastFatalError)continue;const o=i._network;s==null?s=o.chainId:o.chainId!==s&&z(!1,"cannot mix providers on different networks","UNSUPPORTED_OPERATION",{operation:"new FallbackProvider"})}})())}await t},LE=async function(t,n){const s=[];for(const i of t)if(i.result!=null){const{tag:o,value:a}=P0(n.method,i.result);s.push({tag:o,value:a,weight:i.config.weight})}if(!(s.reduce((i,o)=>i+o.weight,0)<this.quorum)){switch(n.method){case"getBlockNumber":{b(this,Cs)===-2&&S(this,Cs,Math.ceil(ae(mg(this.quorum,b(this,Xt).filter(o=>!o._lastFatalError).map(o=>({value:o.blockNumber,tag:ae(o.blockNumber).toString(),weight:o.weight}))))));const i=wS(this.quorum,s);return i===void 0?void 0:(i>b(this,Cs)&&S(this,Cs,i),b(this,Cs))}case"getGasPrice":case"getPriorityFee":case"estimateGas":return mg(this.quorum,s);case"getBlock":return"blockTag"in n&&n.blockTag==="pending"?C0(this.quorum,s):Nh(this.quorum,s);case"call":case"chainId":case"getBalance":case"getTransactionCount":case"getCode":case"getStorage":case"getTransaction":case"getTransactionReceipt":case"getLogs":return Nh(this.quorum,s);case"broadcastTransaction":return C0(this.quorum,s)}z(!1,"unsupported method","UNSUPPORTED_OPERATION",{operation:`_perform(${O0(n.method)})`})}},wg=async function(t,n){if(t.size===0)throw new Error("no runners?!");const s=[];let i=0;for(const a of t){if(a.perform&&s.push(a.perform),a.staller){s.push(a.staller);continue}a.didBump||(a.didBump=!0,i++)}const o=await q(this,or,LE).call(this,t,n);if(o!==void 0){if(o instanceof Error)throw o;return o}for(let a=0;a<i;a++)q(this,or,xg).call(this,t,n);return z(s.length>0,"quorum not met","SERVER_ERROR",{request:"%sub-requests",info:{request:n,results:Array.from(t).map(a=>O0(a.result))}}),await Promise.race(s),await q(this,or,wg).call(this,t,n)};function ES(r){return r&&typeof r.send=="function"&&typeof r.close=="function"}const vS="goerli kovan sepolia classicKotti optimism-goerli arbitrum-goerli matic-mumbai bnbt".split(" ");function AS(r,e){e==null&&(e={});const t=o=>e[o]==="-"?!1:typeof e.exclusive=="string"?o===e.exclusive:Array.isArray(e.exclusive)?e.exclusive.indexOf(o)!==-1:!0;if(typeof r=="string"&&r.match(/^https?:/))return new Vr(r);if(typeof r=="string"&&r.match(/^wss?:/)||ES(r))return new ly(r);let n=null;try{n=He.from(r)}catch{}const s=[];if(t("publicPolygon")&&n&&(n.name==="matic"?s.push(new Vr("https://polygon-rpc.com/",n,{staticNetwork:n})):n.name==="matic-amoy"&&s.push(new Vr("https://rpc-amoy.polygon.technology/",n,{staticNetwork:n}))),t("alchemy"))try{s.push(new Tu(r,e.alchemy))}catch{}if(t("ankr")&&e.ankr!=null)try{s.push(new Cu(r,e.ankr))}catch{}if(t("chainstack"))try{s.push(new Nu(r,e.chainstack))}catch{}if(t("cloudflare"))try{s.push(new PE(r))}catch{}if(t("etherscan"))try{s.push(new TE(r,e.etherscan))}catch{}if(t("infura"))try{let o=e.infura,a;typeof o=="object"&&(a=o.projectSecret,o=o.projectId),s.push(new cl(r,o,a))}catch{}if(t("quicknode"))try{let o=e.quicknode;s.push(new Du(r,o))}catch{}if(z(s.length,"unsupported default network","UNSUPPORTED_OPERATION",{operation:"getDefaultProvider"}),s.length===1)return s[0];let i=Math.floor(s.length/2);return i>2&&(i=2),n&&vS.indexOf(n.name)!==-1&&(i=1),e&&e.quorum&&(i=e.quorum),new kE(s,void 0,{quorum:i})}var Ni,Qo;const tm=class tm extends gf{constructor(t){super(t.provider);k(this,"signer");M(this,Ni);M(this,Qo);te(this,{signer:t}),S(this,Ni,null),S(this,Qo,0)}async getAddress(){return this.signer.getAddress()}connect(t){return new tm(this.signer.connect(t))}async getNonce(t){if(t==="pending"){b(this,Ni)==null&&S(this,Ni,super.getNonce("pending"));const n=b(this,Qo);return await b(this,Ni)+n}return super.getNonce(t)}increment(){ma(this,Qo)._++}reset(){S(this,Qo,0),S(this,Ni,null)}async sendTransaction(t){const n=this.getNonce("pending");return this.increment(),t=await this.signer.populateTransaction(t),t.nonce=await n,await this.signer.sendTransaction(t)}signTransaction(t){return this.signer.signTransaction(t)}signMessage(t){return this.signer.signMessage(t)}signTypedData(t,n,s){return this.signer.signTypedData(t,n,s)}};Ni=new WeakMap,Qo=new WeakMap;let Eg=tm;var Kc,Gc;const bo=class bo extends OE{constructor(t,n,s){const i=Object.assign({},s??{},{batchMaxCount:1});C(t&&t.request,"invalid EIP-1193 provider","ethereum",t);super(n,i);M(this,Kc);M(this,Gc);S(this,Gc,null),s&&s.providerInfo&&S(this,Gc,s.providerInfo),S(this,Kc,async(o,a)=>{const c={method:o,params:a};this.emit("debug",{action:"sendEip1193Request",payload:c});try{const l=await t.request(c);return this.emit("debug",{action:"receiveEip1193Result",result:l}),l}catch(l){const u=new Error(l.message);throw u.code=l.code,u.data=l.data,u.payload=c,this.emit("debug",{action:"receiveEip1193Error",error:u}),u}})}get providerInfo(){return b(this,Gc)}async send(t,n){return await this._start(),await super.send(t,n)}async _send(t){C(!Array.isArray(t),"EIP-1193 does not support batch request","payload",t);try{const n=await b(this,Kc).call(this,t.method,t.params||[]);return[{id:t.id,result:n}]}catch(n){return[{id:t.id,error:{code:n.code,data:n.data,message:n.message}}]}}getRpcError(t,n){switch(n=JSON.parse(JSON.stringify(n)),n.error.code||-1){case 4001:n.error.message=`ethers-user-denied: ${n.error.message}`;break;case 4200:n.error.message=`ethers-unsupported: ${n.error.message}`;break}return super.getRpcError(t,n)}async hasSigner(t){t==null&&(t=0);const n=await this.send("eth_accounts",[]);return typeof t=="number"?n.length>t:(t=t.toLowerCase(),n.filter(s=>s.toLowerCase()===t).length!==0)}async getSigner(t){if(t==null&&(t=0),!await this.hasSigner(t))try{await b(this,Kc).call(this,"eth_requestAccounts",[])}catch(n){const s=n.payload;throw this.getRpcError(s,{id:s.id,error:n})}return await super.getSigner(t)}static async discover(t){if(t==null&&(t={}),t.provider)return new bo(t.provider);const n=t.window?t.window:typeof window<"u"?window:null;if(n==null)return null;const s=t.anyProvider;if(s&&n.ethereum)return new bo(n.ethereum);if(!("addEventListener"in n&&"dispatchEvent"in n&&"removeEventListener"in n))return null;const i=t.timeout?t.timeout:300;return i===0?null:await new Promise((o,a)=>{let c=[];const l=h=>{c.push(h.detail),s&&u()},u=()=>{if(clearTimeout(f),c.length)if(t&&t.filter){const h=t.filter(c.map(d=>Object.assign({},d.info)));if(h==null)o(null);else if(h instanceof bo)o(h);else{let d=null;if(h.uuid&&(d=c.filter(g=>h.uuid===g.info.uuid)[0]),d){const{provider:p,info:g}=d;o(new bo(p,void 0,{providerInfo:g}))}else a(Be("filter returned unknown info","UNSUPPORTED_OPERATION",{value:h}))}}else{const{provider:h,info:d}=c[0];o(new bo(h,void 0,{providerInfo:d}))}else o(null);n.removeEventListener("eip6963:announceProvider",l)},f=setTimeout(()=>{u()},i);n.addEventListener("eip6963:announceProvider",l),n.dispatchEvent(new Event("eip6963:requestProvider"))})}};Kc=new WeakMap,Gc=new WeakMap;let Ru=bo;function IS(r){switch(r){case"mainnet":return"https://eth.blockscout.com/api/eth-rpc";case"sepolia":return"https://eth-sepolia.blockscout.com/api/eth-rpc";case"holesky":return"https://eth-holesky.blockscout.com/api/eth-rpc";case"classic":return"https://etc.blockscout.com/api/eth-rpc";case"arbitrum":return"https://arbitrum.blockscout.com/api/eth-rpc";case"base":return"https://base.blockscout.com/api/eth-rpc";case"base-sepolia":return"https://base-sepolia.blockscout.com/api/eth-rpc";case"matic":return"https://polygon.blockscout.com/api/eth-rpc";case"optimism":return"https://optimism.blockscout.com/api/eth-rpc";case"optimism-sepolia":return"https://optimism-sepolia.blockscout.com/api/eth-rpc";case"xdai":return"https://gnosis.blockscout.com/api/eth-rpc"}C(!1,"unsupported network","network",r)}class Jh extends Vr{constructor(t,n){t==null&&(t="mainnet");const s=He.from(t);n==null&&(n=null);const i=Jh.getRequest(s);super(i,s,{staticNetwork:s});k(this,"apiKey");te(this,{apiKey:n})}_getProvider(t){try{return new Jh(t,this.apiKey)}catch{}return super._getProvider(t)}isCommunityResource(){return this.apiKey===null}getRpcRequest(t){const n=super.getRpcRequest(t);return n&&n.method==="eth_estimateGas"&&n.args.length==1&&(n.args=n.args.slice(),n.args.push("latest")),n}getRpcError(t,n){const s=n?n.error:null;if(s&&s.code===-32015&&!De(s.data||"",!0)){const i={"assert(false)":"01","arithmetic underflow or overflow":"11","division or modulo by zero":"12","out-of-bounds array access; popping on an empty array":"31","out-of-bounds access of an array or bytesN":"32"};let o="";s.message==="VM execution error."?o=i[s.data]||"":i[s.message||""]&&(o=i[s.message||""]),o&&(s.message+=` (reverted: ${s.data})`,s.data="0x4e487b7100000000000000000000000000000000000000000000000000000000000000"+o)}else s&&s.code===-32e3&&s.message==="wrong transaction nonce"&&(s.message+=" (nonce too low)");return super.getRpcError(t,n)}static getRequest(t){const n=new pt(IS(t.name));return n.allowGzip=!0,n}}const Gf="62e1ad51b37b8e00394bda3b";function SS(r){switch(r){case"mainnet":return"eth-mainnet.gateway.pokt.network";case"goerli":return"eth-goerli.gateway.pokt.network";case"matic":return"poly-mainnet.gateway.pokt.network";case"matic-mumbai":return"polygon-mumbai-rpc.gateway.pokt.network"}C(!1,"unsupported network","network",r)}class Yh extends Vr{constructor(t,n,s){t==null&&(t="mainnet");const i=He.from(t);n==null&&(n=Gf),s==null&&(s=null);const o={staticNetwork:i},a=Yh.getRequest(i,n,s);super(a,i,o);k(this,"applicationId");k(this,"applicationSecret");te(this,{applicationId:n,applicationSecret:s})}_getProvider(t){try{return new Yh(t,this.applicationId,this.applicationSecret)}catch{}return super._getProvider(t)}static getRequest(t,n,s){n==null&&(n=Gf);const i=new pt(`https://${SS(t.name)}/v1/lb/${n}`);return i.allowGzip=!0,s&&i.setCredentials("",s),n===Gf&&(i.retryFunc=async(o,a,c)=>(Wi("PocketProvider"),!0)),i}isCommunityResource(){return this.applicationId===Gf}}const OS=void 0;var Wc;const rm=class rm extends gf{constructor(t,n){super(n);k(this,"address");M(this,Wc);C(t&&typeof t.sign=="function","invalid private key","privateKey","[ REDACTED ]"),S(this,Wc,t);const s=yl(this.signingKey.publicKey);te(this,{address:s})}get signingKey(){return b(this,Wc)}get privateKey(){return this.signingKey.privateKey}async getAddress(){return this.address}connect(t){return new rm(b(this,Wc),t)}async signTransaction(t){t=sl(t);const{to:n,from:s}=await ct({to:t.to?nt(t.to,this):void 0,from:t.from?nt(t.from,this):void 0});n!=null&&(t.to=n),s!=null&&(t.from=s),t.from!=null&&(C(ce(t.from)===this.address,"transaction from address mismatch","tx.from",t.from),delete t.from);const i=ea.from(t);return i.signature=this.signingKey.sign(i.unsignedHash),i.serialized}async signMessage(t){return this.signMessageSync(t)}signMessageSync(t){return this.signingKey.sign(Yb(t)).serialized}authorizeSync(t){C(typeof t.address=="string","invalid address for authorizeSync","auth.address",t);const n=this.signingKey.sign(Kb(t));return Object.assign({},{address:ce(t.address),nonce:re(t.nonce||0),chainId:re(t.chainId||0)},{signature:n})}async authorize(t){return t=Object.assign({},t,{address:await nt(t.address,this)}),this.authorizeSync(await this.populateAuthorization(t))}async signTypedData(t,n,s){const i=await Li.resolveNames(t,n,s,async o=>{z(this.provider!=null,"cannot resolve ENS names without a provider","UNSUPPORTED_OPERATION",{operation:"resolveName",info:{name:o}});const a=await this.provider.resolveName(o);return z(a!=null,"unconfigured ENS name","UNCONFIGURED_NAME",{value:o}),a});return this.signingKey.sign(Li.hash(i.domain,n,i.value)).serialized}};Wc=new WeakMap;let _u=rm;const Zh=" !#$%&'()*+,-./<=>?@[]^_`{|}~",PS=/^[a-z]*$/i;function Ox(r,e){let t=97;return r.reduce((n,s)=>(s===e?t++:s.match(PS)?n.push(String.fromCharCode(t)+s):(t=97,n.push(s)),n),[])}function CS(r,e){for(let s=Zh.length-1;s>=0;s--)r=r.split(Zh[s]).join(e.substring(2*s,2*s+2));const t=[],n=r.replace(/(:|([0-9])|([A-Z][a-z]*))/g,(s,i,o,a)=>{if(o)for(let c=parseInt(o);c>=0;c--)t.push(";");else t.push(i.toLowerCase());return""});if(n)throw new Error(`leftovers: ${JSON.stringify(n)}`);return Ox(Ox(t,";"),":")}function FE(r){return C(r[0]==="0","unsupported auwl data","data",r),CS(r.substring(1+2*Zh.length),r.substring(1,1+2*Zh.length))}class ME{constructor(e){k(this,"locale");te(this,{locale:e})}split(e){return e.toLowerCase().split(/\s+/g)}join(e){return e.join(" ")}}var Qc,ef,Jo,tf,vg;class uy extends ME{constructor(t,n,s){super(t);M(this,tf);M(this,Qc);M(this,ef);M(this,Jo);S(this,Qc,n),S(this,ef,s),S(this,Jo,null)}get _data(){return b(this,Qc)}_decodeWords(){return FE(b(this,Qc))}getWord(t){const n=q(this,tf,vg).call(this);return C(t>=0&&t<n.length,`invalid word index: ${t}`,"index",t),n[t]}getWordIndex(t){return q(this,tf,vg).call(this).indexOf(t)}}Qc=new WeakMap,ef=new WeakMap,Jo=new WeakMap,tf=new WeakSet,vg=function(){if(b(this,Jo)==null){const t=this._decodeWords();if(es(t.join(`
`)+`
`)!==b(this,ef))throw new Error(`BIP39 Wordlist for ${this.locale} FAILED`);S(this,Jo,t)}return b(this,Jo)};const TS="0erleonalorenseinceregesticitStanvetearctssi#ch2Athck&tneLl0And#Il.yLeOutO=S|S%b/ra@SurdU'0Ce[Cid|CountCu'Hie=IdOu,-Qui*Ro[TT]T%T*[Tu$0AptDD-tD*[Ju,M.UltV<)Vi)0Rob-0FairF%dRaid0A(EEntRee0Ead0MRRp%tS!_rmBumCoholErtI&LLeyLowMo,O}PhaReadySoT Ways0A>urAz(gOngOuntU'd0Aly,Ch%Ci|G G!GryIm$K!Noun)Nu$O` Sw T&naTiqueXietyY1ArtOlogyPe?P!Pro=Ril1ChCt-EaEnaGueMMedM%MyOundR<+Re,Ri=RowTTefa@Ti,Tw%k0KPe@SaultSetSi,SumeThma0H!>OmTa{T&dT.udeTra@0Ct]D.Gu,NtTh%ToTumn0Era+OcadoOid0AkeA*AyEsomeFulKw?d0Is:ByChel%C#D+GL<)Lc#y~MbooN<aNn RRelyRga(R*lSeS-SketTt!3A^AnAutyCau'ComeEfF%eG(Ha=H(dLie=LowLtN^Nef./TrayTt Twe&Y#d3Cyc!DKeNdOlogyRdR`Tt _{AdeAmeAnketA,EakE[IndOodO[omOu'UeUrUsh_rdAtDyIlMbNeNusOkO,Rd R(gRrowSsTtomUn)XY_{etA(AndA[A=EadEezeI{Id+IefIghtIngIskOccoliOk&OnzeOomO` OwnUsh2Bb!DdyD+tFf$oIldLbLkL!tNd!Nk Rd&Rg R,SS(e[SyTt Y Zz:Bba+B(B!CtusGeKe~LmM aMpNN$N)lNdyNn#NoeNvasNy#Pab!P.$Pta(RRb#RdRgoRpetRryRtSeShS(o/!Su$TT$ogT^Teg%yTt!UghtU'Ut]Ve3Il(gL yM|NsusNturyRe$Rta(_irAlkAmp]An+AosApt Ar+A'AtEapE{Ee'EfErryE,I{&IefIldIm}yOi)Oo'R#-U{!UnkUrn0G?Nnam#Rc!Tiz&TyVil_imApArifyAwAyE<ErkEv I{I|IffImbIn-IpO{OgO'O`OudOwnUbUmpU, Ut^_^A,C#utDeFfeeIlInL!@L%LumnMb(eMeMf%tM-Mm#Mp<yNc tNdu@NfirmNg*[N}@Nsid NtrolNv()OkOlPp PyR$ReRnR*@/Tt#U^UntryUp!Ur'Us(V Yo>_{Ad!AftAmA}AshAt AwlAzyEamEd.EekEwI{etImeIspIt-OpO[Ou^OwdUci$UelUi'Umb!Un^UshYY,$2BeLtu*PPbo?dRiousRr|Rta(R=Sh]/omTe3C!:DMa+MpN)Ng R(gShUght WnY3AlBa>BrisCadeCemb CideCl(eC%a>C*a'ErF&'F(eFyG*eLayLiv M<dMi'Ni$Nti,NyP?tP&dPos.P`PutyRi=ScribeS tSignSkSpair/royTailTe@VelopVi)Vo>3AgramAlAm#dAryCeE'lEtFf G.$Gn.yLemmaNn NosaurRe@RtSag*eScov Sea'ShSmi[S%d Splay/<)V tVideV%)Zzy5Ct%Cum|G~Lph(Ma(Na>NkeyN%OrSeUb!Ve_ftAg#AmaA,-AwEamE[IftIllInkIpI=OpUmY2CkMbNeR(g/T^Ty1Arf1Nam-:G G!RlyRnR`Sily/Sy1HoOlogyOnomy0GeItUca>1F%t0G1GhtTh 2BowD E@r-Eg<tEm|Eph<tEvat%I>Se0B?kBodyBra)Er+Ot]PloyPow Pty0Ab!A@DD![D%'EmyErgyF%)Ga+G(eH<)JoyLi,OughR-hRollSu*T Ti*TryVelope1Isode0U$Uip0AA'OdeOs]R%Upt0CapeSayS&)Ta>0Ern$H-s1Id&)IlOkeOl=1A@Amp!Ce[Ch<+C.eCludeCu'Ecu>Erci'Hau,Hib.I!I,ItOt-P<dPe@Pi*Pla(Po'P*[T&dTra0EEbrow:Br-CeCultyDeIntI`~L'MeMilyMousNNcyNtasyRmSh]TT$Th TigueUltV%.e3Atu*Bru?yD $EEdElMa!N)/iv$T^V W3B Ct]EldGu*LeLmLt N$NdNeNg NishReRmR,Sc$ShTT}[X_gAmeAshAtAv%EeIghtIpOatO{O%Ow UidUshY_mCusGIlLd~owOdOtR)Re,R+tRkRtu}RumRw?dSsil/ UndX_gi!AmeEqu|EshI&dIn+OgOntO,OwnOz&U.2ElNNnyRna)RyTu*:D+tInLaxy~ yMePRa+Rba+Rd&Rl-Rm|SSpTeTh U+Ze3N $NiusN*Nt!Nu(e/u*2O,0AntFtGg!Ng RaffeRlVe_dAn)A*A[IdeImp'ObeOomOryO=OwUe_tDde[LdOdO'RillaSpelSsipV nWn_bA)A(AntApeA[Av.yEatE&IdIefItOc yOupOwUnt_rdE[IdeIltIt?N3M:B.IrLfMm M, NdPpyRb%RdRshR=,TVeWkZ?d3AdAl`ArtAvyD+hogIght~oLmetLpNRo3Dd&Gh~NtPRe/%y5BbyCkeyLdLeLiday~owMeNeyOdPeRnRr%R'Sp.$/TelUrV 5BGeM<Mb!M%Nd*dNgryNtRd!RryRtSb<d3Brid:1EOn0EaEntifyLe2N%e4LLeg$L}[0A+Ita>M&'Mu}Pa@Po'Pro=Pul'0ChCludeComeC*a'DexD-a>Do%Du,ryF<tFl-tF%mHa!H .Iti$Je@JuryMa>N Noc|PutQuiryS<eSe@SideSpi*/$lTa@T e,ToVe,V.eVol=3On0L<dOla>Sue0Em1Ory:CketGu?RZz3AlousAns~yWel9BInKeUr}yY5D+I)MpNg!Ni%Nk/:Ng?oo3EnEpT^upY3CkDD}yNdNgdomSsTT^&TeTt&Wi4EeIfeO{Ow:BBelB%Dd DyKeMpNgua+PtopR+T T(UghUndryVaWWnWsu.Y Zy3Ad AfArnA=Ctu*FtGG$G&dIsu*M#NdNg`NsOp?dSs#Tt Vel3ArB tyBr?yC&'FeFtGhtKeMbM.NkOnQuid/Tt!VeZ?d5AdAnB, C$CkG-NelyNgOpTt yUdUn+VeY$5CkyGga+Mb N?N^Xury3R-s:Ch(eDG-G}tIdIlInJ%KeMm$NNa+Nda>NgoNs]Nu$P!Rb!R^Rg(R(eRketRria+SkSs/ T^T i$ThTrixTt XimumZe3AdowAnAsu*AtCh<-D$DiaLodyLtMb M%yNt]NuRcyR+R.RryShSsa+T$Thod3Dd!DnightLk~]M-NdNimumN%Nu>Rac!Rr%S ySs/akeXXedXtu*5Bi!DelDifyMM|N.%NkeyN, N`OnR$ReRn(gSqu.oTh T]T%Unta(U'VeVie5ChFf(LeLtiplySc!SeumShroomS-/Tu$3Self/ yTh:I=MePk(Rrow/yT]Tu*3ArCkEdGati=G!@I` PhewR=/TTw%kUtr$V WsXt3CeGht5B!I'M(eeOd!Rm$R`SeTab!TeTh(gTi)VelW5C!?Mb R'T:K0EyJe@Li+Scu*S =Ta(Vious0CurE<Tob 0Or1FF Fi)T&2L1Ay0DI=Ymp-0It0CeEI#L(eLy1EnEraIn]Po'T]1An+B.Ch?dD D(?yG<I|Ig($Ph<0Tr-h0H 0Tdo%T TputTside0AlEnEr0NN 0Yg&0/ 0O}:CtDd!GeIrLa)LmNdaNelN-N` P RadeR|RkRrotRtySsT^ThTi|TrolTt nU'VeYm|3A)AnutArAs<tL-<NN$tyNcilOp!Pp Rfe@Rm.Rs#T2O}OtoRa'Ys-$0AnoCn-Ctu*E)GGe#~LotNkO} Pe/olT^Zza_)A}tA,-A>AyEa'Ed+U{UgUn+2EmEtIntL?LeLi)NdNyOlPul?Rt]S.]Ssib!/TatoTt yV tyWd W _@i)Ai'Ed-tEf Epa*Es|EttyEv|I)IdeIm?yIntI%.yIs#Iva>IzeOb!mO)[Odu)Of.OgramOje@Omo>OofOp tyOsp O>@OudOvide2Bl-Dd(g~LpL'Mpk(N^PilPpyR^a'R.yRpo'R'ShTZz!3Ramid:99Al.yAntumArt E,]I{ItIzO>:Bb.Cco#CeCkD?DioIlInI'~yMpN^NdomN+PidReTeTh V&WZ%3AdyAlAs#BelBuildC$lCei=CipeC%dCyc!Du)F!@F%mFu'G]G*tGul?Je@LaxLea'LiefLyMa(Memb M(dMo=Nd NewNtOp&PairPeatPla)P%tQui*ScueSemb!Si,Sour)Sp#'SultTi*T*atTurnUn]Ve$ViewW?d2Y`m0BBb#CeChDeD+F!GhtGidNgOtPp!SkTu$V$V 5AdA,BotBu,CketM<)OfOkieOmSeTa>UghUndU>Y$5Bb DeGLeNNwayR$:DDd!D}[FeIlLadLm#L#LtLu>MeMp!NdTisfyToshiU)Usa+VeY1A!AnA*Att E}HemeHoolI&)I[%sOrp]OutRapRe&RiptRub1AAr^As#AtC#dC*tCt]Cur.yEdEkGm|Le@~M(?Ni%N'Nt&)RiesRvi)Ss]Tt!TupV&_dowAftAllowA*EdEllEriffIeldIftI}IpIv O{OeOotOpOrtOuld O=RimpRugUff!Y0Bl(gCkDeE+GhtGnL|Lk~yLv Mil?Mp!N)NgR&/ Tua>XZe1A>Et^IIllInIrtUll0AbAmEepEnd I)IdeIghtImOg<OtOwUsh0AllArtI!OkeOo`0A{AkeApIffOw0ApCc Ci$CkDaFtL?Ldi LidLut]L=Me#eNgOnRryRtUlUndUpUr)U`0A)A*Ati$AwnEakEci$EedEllEndH eI)Id IkeInIr.L.OilOns%O#OrtOtRayReadR(gY0Ua*UeezeUir*l_b!AdiumAffA+AirsAmpAndArtA>AyEakEelEmEpE*oI{IllIngO{Oma^O}OolOryO=Ra>gyReetRikeR#gRugg!Ud|UffUmb!Y!0Bje@Bm.BwayC)[ChDd&Ff G?G+,ItMm NNnyN'tP PplyP*meReRfa)R+Rpri'RroundR=ySpe@/a(1AllowAmpApArmE?EetIftImIngIt^Ord1MbolMptomRup/em:B!Ck!GIlL|LkNkPeR+tSk/eTtooXi3A^Am~NN<tNnisNtRm/Xt_nkAtEmeEnE%yE*EyIngIsOughtReeRi=RowUmbUnd 0CketDeG LtMb MeNyPRedSsueT!5A,BaccoDayDdl EGe` I!tK&MatoM%rowNeNgueNightOlO`PP-Pp!R^RnadoRtoi'SsT$Uri,W?dW WnY_{AdeAff-Ag-A(Ansf ApAshA=lAyEatEeEndI$IbeI{Igg ImIpOphyOub!U{UeUlyUmpetU,U`Y2BeIt]Mb!NaN}lRkeyRnRt!1El=EntyI)InI,O1PeP-$:5Ly5B*lla0Ab!Awa*C!Cov D DoFairFoldHappyIf%mIqueItIv 'KnownLo{TilUsu$Veil1Da>GradeHoldOnP Set1B<Ge0A+EEdEfulE![U$0Il.y:C<tCuumGueLidL!yL=NNishP%Rious/Ult3H-!L=tNd%Ntu*NueRbRifyRs]RyS'lT <3Ab!Br<tCiousCt%yDeoEw~a+Nta+Ol(Rtu$RusSaS.Su$T$Vid5C$I)IdLc<oLumeTeYa+:GeG#ItLk~LnutNtRfa*RmRri%ShSp/eT VeY3Al`Ap#ArA'lA` BDd(gEk&dIrdLcome/T_!AtEatEelEnE*IpIsp 0DeD`FeLd~NNdowNeNgNkNn Nt ReSdomSeShT}[5LfM<Nd OdOlRdRkRldRryR`_pE{E,!I,I>Ong::Rd3Ar~ow9UUngU`:3BraRo9NeO",NS="0x3c8acc1e7b08d8e76f9fda015ef48dc8c710a73cb7e0f77b2c18a9b5a7adde60";let T0=null;class $s extends uy{constructor(){super("en",TS,NS)}static wordlist(){return T0==null&&(T0=new $s),T0}}function jE(r){return(1<<r)-1<<8-r&255}function DS(r){return(1<<r)-1&255}function N0(r,e){Pb("NFKD"),e==null&&(e=$s.wordlist());const t=e.split(r);C(t.length%3===0&&t.length>=12&&t.length<=24,"invalid mnemonic length","mnemonic","[ REDACTED ]");const n=new Uint8Array(Math.ceil(11*t.length/8));let s=0;for(let l=0;l<t.length;l++){let u=e.getWordIndex(t[l].normalize("NFKD"));C(u>=0,`invalid mnemonic word at index ${l}`,"mnemonic","[ REDACTED ]");for(let f=0;f<11;f++)u&1<<10-f&&(n[s>>3]|=1<<7-s%8),s++}const i=32*t.length/3,o=t.length/3,a=jE(o),c=Q(Vt(n.slice(0,i/8)))[0]&a;return C(c===(n[n.length-1]&a),"invalid mnemonic checksum","mnemonic","[ REDACTED ]"),K(n.slice(0,i/8))}function D0(r,e){C(r.length%4===0&&r.length>=16&&r.length<=32,"invalid entropy size","entropy","[ REDACTED ]"),e==null&&(e=$s.wordlist());const t=[0];let n=11;for(let o=0;o<r.length;o++)n>8?(t[t.length-1]<<=8,t[t.length-1]|=r[o],n-=8):(t[t.length-1]<<=n,t[t.length-1]|=r[o]>>8-n,t.push(r[o]&DS(8-n)),n+=3);const s=r.length/4,i=parseInt(Vt(r).substring(2,4),16)&jE(s);return t[t.length-1]<<=s,t[t.length-1]|=i>>8-s,e.join(t.map(o=>e.getWord(o)))}const R0={};class sa{constructor(e,t,n,s,i){k(this,"phrase");k(this,"password");k(this,"wordlist");k(this,"entropy");s==null&&(s=""),i==null&&(i=$s.wordlist()),js(e,R0,"Mnemonic"),te(this,{phrase:n,password:s,wordlist:i,entropy:t})}computeSeed(){const e=st("mnemonic"+this.password,"NFKD");return rs(st(this.phrase,"NFKD"),e,2048,64,"sha512")}static fromPhrase(e,t,n){const s=N0(e,n);return e=D0(Q(s),n),new sa(R0,s,e,t,n)}static fromEntropy(e,t,n){const s=Q(e,"entropy"),i=D0(s,n);return new sa(R0,K(s),i,t,n)}static entropyToPhrase(e,t){const n=Q(e,"entropy");return D0(n,t)}static phraseToEntropy(e,t){return N0(e,t)}static isValidMnemonic(e,t){try{return N0(e,t),!0}catch{}return!1}}/*! MIT License. Copyright 2015-2022 Richard Moore <me@ricmoo.com>. See LICENSE.txt. */var gt=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},_0=function(r,e,t,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},Dh,Nr,On;const RS={16:10,24:12,32:14},_S=[1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145],Sr=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],Wf=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125],BS=[3328402341,4168907908,4000806809,4135287693,4294111757,3597364157,3731845041,2445657428,1613770832,33620227,3462883241,1445669757,3892248089,3050821474,1303096294,3967186586,2412431941,528646813,2311702848,4202528135,4026202645,2992200171,2387036105,4226871307,1101901292,3017069671,1604494077,1169141738,597466303,1403299063,3832705686,2613100635,1974974402,3791519004,1033081774,1277568618,1815492186,2118074177,4126668546,2211236943,1748251740,1369810420,3521504564,4193382664,3799085459,2883115123,1647391059,706024767,134480908,2512897874,1176707941,2646852446,806885416,932615841,168101135,798661301,235341577,605164086,461406363,3756188221,3454790438,1311188841,2142417613,3933566367,302582043,495158174,1479289972,874125870,907746093,3698224818,3025820398,1537253627,2756858614,1983593293,3084310113,2108928974,1378429307,3722699582,1580150641,327451799,2790478837,3117535592,0,3253595436,1075847264,3825007647,2041688520,3059440621,3563743934,2378943302,1740553945,1916352843,2487896798,2555137236,2958579944,2244988746,3151024235,3320835882,1336584933,3992714006,2252555205,2588757463,1714631509,293963156,2319795663,3925473552,67240454,4269768577,2689618160,2017213508,631218106,1269344483,2723238387,1571005438,2151694528,93294474,1066570413,563977660,1882732616,4059428100,1673313503,2008463041,2950355573,1109467491,537923632,3858759450,4260623118,3218264685,2177748300,403442708,638784309,3287084079,3193921505,899127202,2286175436,773265209,2479146071,1437050866,4236148354,2050833735,3362022572,3126681063,840505643,3866325909,3227541664,427917720,2655997905,2749160575,1143087718,1412049534,999329963,193497219,2353415882,3354324521,1807268051,672404540,2816401017,3160301282,369822493,2916866934,3688947771,1681011286,1949973070,336202270,2454276571,201721354,1210328172,3093060836,2680341085,3184776046,1135389935,3294782118,965841320,831886756,3554993207,4068047243,3588745010,2345191491,1849112409,3664604599,26054028,2983581028,2622377682,1235855840,3630984372,2891339514,4092916743,3488279077,3395642799,4101667470,1202630377,268961816,1874508501,4034427016,1243948399,1546530418,941366308,1470539505,1941222599,2546386513,3421038627,2715671932,3899946140,1042226977,2521517021,1639824860,227249030,260737669,3765465232,2084453954,1907733956,3429263018,2420656344,100860677,4160157185,470683154,3261161891,1781871967,2924959737,1773779408,394692241,2579611992,974986535,664706745,3655459128,3958962195,731420851,571543859,3530123707,2849626480,126783113,865375399,765172662,1008606754,361203602,3387549984,2278477385,2857719295,1344809080,2782912378,59542671,1503764984,160008576,437062935,1707065306,3622233649,2218934982,3496503480,2185314755,697932208,1512910199,504303377,2075177163,2824099068,1841019862,739644986],kS=[2781242211,2230877308,2582542199,2381740923,234877682,3184946027,2984144751,1418839493,1348481072,50462977,2848876391,2102799147,434634494,1656084439,3863849899,2599188086,1167051466,2636087938,1082771913,2281340285,368048890,3954334041,3381544775,201060592,3963727277,1739838676,4250903202,3930435503,3206782108,4149453988,2531553906,1536934080,3262494647,484572669,2923271059,1783375398,1517041206,1098792767,49674231,1334037708,1550332980,4098991525,886171109,150598129,2481090929,1940642008,1398944049,1059722517,201851908,1385547719,1699095331,1587397571,674240536,2704774806,252314885,3039795866,151914247,908333586,2602270848,1038082786,651029483,1766729511,3447698098,2682942837,454166793,2652734339,1951935532,775166490,758520603,3000790638,4004797018,4217086112,4137964114,1299594043,1639438038,3464344499,2068982057,1054729187,1901997871,2534638724,4121318227,1757008337,0,750906861,1614815264,535035132,3363418545,3988151131,3201591914,1183697867,3647454910,1265776953,3734260298,3566750796,3903871064,1250283471,1807470800,717615087,3847203498,384695291,3313910595,3617213773,1432761139,2484176261,3481945413,283769337,100925954,2180939647,4037038160,1148730428,3123027871,3813386408,4087501137,4267549603,3229630528,2315620239,2906624658,3156319645,1215313976,82966005,3747855548,3245848246,1974459098,1665278241,807407632,451280895,251524083,1841287890,1283575245,337120268,891687699,801369324,3787349855,2721421207,3431482436,959321879,1469301956,4065699751,2197585534,1199193405,2898814052,3887750493,724703513,2514908019,2696962144,2551808385,3516813135,2141445340,1715741218,2119445034,2872807568,2198571144,3398190662,700968686,3547052216,1009259540,2041044702,3803995742,487983883,1991105499,1004265696,1449407026,1316239930,504629770,3683797321,168560134,1816667172,3837287516,1570751170,1857934291,4014189740,2797888098,2822345105,2754712981,936633572,2347923833,852879335,1133234376,1500395319,3084545389,2348912013,1689376213,3533459022,3762923945,3034082412,4205598294,133428468,634383082,2949277029,2398386810,3913789102,403703816,3580869306,2297460856,1867130149,1918643758,607656988,4049053350,3346248884,1368901318,600565992,2090982877,2632479860,557719327,3717614411,3697393085,2249034635,2232388234,2430627952,1115438654,3295786421,2865522278,3633334344,84280067,33027830,303828494,2747425121,1600795957,4188952407,3496589753,2434238086,1486471617,658119965,3106381470,953803233,334231800,3005978776,857870609,3151128937,1890179545,2298973838,2805175444,3056442267,574365214,2450884487,550103529,1233637070,4289353045,2018519080,2057691103,2399374476,4166623649,2148108681,387583245,3664101311,836232934,3330556482,3100665960,3280093505,2955516313,2002398509,287182607,3413881008,4238890068,3597515707,975967766],US=[1671808611,2089089148,2006576759,2072901243,4061003762,1807603307,1873927791,3310653893,810573872,16974337,1739181671,729634347,4263110654,3613570519,2883997099,1989864566,3393556426,2191335298,3376449993,2106063485,4195741690,1508618841,1204391495,4027317232,2917941677,3563566036,2734514082,2951366063,2629772188,2767672228,1922491506,3227229120,3082974647,4246528509,2477669779,644500518,911895606,1061256767,4144166391,3427763148,878471220,2784252325,3845444069,4043897329,1905517169,3631459288,827548209,356461077,67897348,3344078279,593839651,3277757891,405286936,2527147926,84871685,2595565466,118033927,305538066,2157648768,3795705826,3945188843,661212711,2999812018,1973414517,152769033,2208177539,745822252,439235610,455947803,1857215598,1525593178,2700827552,1391895634,994932283,3596728278,3016654259,695947817,3812548067,795958831,2224493444,1408607827,3513301457,0,3979133421,543178784,4229948412,2982705585,1542305371,1790891114,3410398667,3201918910,961245753,1256100938,1289001036,1491644504,3477767631,3496721360,4012557807,2867154858,4212583931,1137018435,1305975373,861234739,2241073541,1171229253,4178635257,33948674,2139225727,1357946960,1011120188,2679776671,2833468328,1374921297,2751356323,1086357568,2408187279,2460827538,2646352285,944271416,4110742005,3168756668,3066132406,3665145818,560153121,271589392,4279952895,4077846003,3530407890,3444343245,202643468,322250259,3962553324,1608629855,2543990167,1154254916,389623319,3294073796,2817676711,2122513534,1028094525,1689045092,1575467613,422261273,1939203699,1621147744,2174228865,1339137615,3699352540,577127458,712922154,2427141008,2290289544,1187679302,3995715566,3100863416,339486740,3732514782,1591917662,186455563,3681988059,3762019296,844522546,978220090,169743370,1239126601,101321734,611076132,1558493276,3260915650,3547250131,2901361580,1655096418,2443721105,2510565781,3828863972,2039214713,3878868455,3359869896,928607799,1840765549,2374762893,3580146133,1322425422,2850048425,1823791212,1459268694,4094161908,3928346602,1706019429,2056189050,2934523822,135794696,3134549946,2022240376,628050469,779246638,472135708,2800834470,3032970164,3327236038,3894660072,3715932637,1956440180,522272287,1272813131,3185336765,2340818315,2323976074,1888542832,1044544574,3049550261,1722469478,1222152264,50660867,4127324150,236067854,1638122081,895445557,1475980887,3117443513,2257655686,3243809217,489110045,2662934430,3778599393,4162055160,2561878936,288563729,1773916777,3648039385,2391345038,2493985684,2612407707,505560094,2274497927,3911240169,3460925390,1442818645,678973480,3749357023,2358182796,2717407649,2306869641,219617805,3218761151,3862026214,1120306242,1756942440,1103331905,2578459033,762796589,252780047,2966125488,1425844308,3151392187,372911126],$S=[1667474886,2088535288,2004326894,2071694838,4075949567,1802223062,1869591006,3318043793,808472672,16843522,1734846926,724270422,4278065639,3621216949,2880169549,1987484396,3402253711,2189597983,3385409673,2105378810,4210693615,1499065266,1195886990,4042263547,2913856577,3570689971,2728590687,2947541573,2627518243,2762274643,1920112356,3233831835,3082273397,4261223649,2475929149,640051788,909531756,1061110142,4160160501,3435941763,875846760,2779116625,3857003729,4059105529,1903268834,3638064043,825316194,353713962,67374088,3351728789,589522246,3284360861,404236336,2526454071,84217610,2593830191,117901582,303183396,2155911963,3806477791,3958056653,656894286,2998062463,1970642922,151591698,2206440989,741110872,437923380,454765878,1852748508,1515908788,2694904667,1381168804,993742198,3604373943,3014905469,690584402,3823320797,791638366,2223281939,1398011302,3520161977,0,3991743681,538992704,4244381667,2981218425,1532751286,1785380564,3419096717,3200178535,960056178,1246420628,1280103576,1482221744,3486468741,3503319995,4025428677,2863326543,4227536621,1128514950,1296947098,859002214,2240123921,1162203018,4193849577,33687044,2139062782,1347481760,1010582648,2678045221,2829640523,1364325282,2745433693,1077985408,2408548869,2459086143,2644360225,943212656,4126475505,3166494563,3065430391,3671750063,555836226,269496352,4294908645,4092792573,3537006015,3452783745,202118168,320025894,3974901699,1600119230,2543297077,1145359496,387397934,3301201811,2812801621,2122220284,1027426170,1684319432,1566435258,421079858,1936954854,1616945344,2172753945,1330631070,3705438115,572679748,707427924,2425400123,2290647819,1179044492,4008585671,3099120491,336870440,3739122087,1583276732,185277718,3688593069,3772791771,842159716,976899700,168435220,1229577106,101059084,606366792,1549591736,3267517855,3553849021,2897014595,1650632388,2442242105,2509612081,3840161747,2038008818,3890688725,3368567691,926374254,1835907034,2374863873,3587531953,1313788572,2846482505,1819063512,1448540844,4109633523,3941213647,1701162954,2054852340,2930698567,134748176,3132806511,2021165296,623210314,774795868,471606328,2795958615,3031746419,3334885783,3907527627,3722280097,1953799400,522133822,1263263126,3183336545,2341176845,2324333839,1886425312,1044267644,3048588401,1718004428,1212733584,50529542,4143317495,235803164,1633788866,892690282,1465383342,3115962473,2256965911,3250673817,488449850,2661202215,3789633753,4177007595,2560144171,286339874,1768537042,3654906025,2391705863,2492770099,2610673197,505291324,2273808917,3924369609,3469625735,1431699370,673740880,3755965093,2358021891,2711746649,2307489801,218961690,3217021541,3873845719,1111672452,1751693520,1094828930,2576986153,757954394,252645662,2964376443,1414855848,3149649517,370555436],LS=[1374988112,2118214995,437757123,975658646,1001089995,530400753,2902087851,1273168787,540080725,2910219766,2295101073,4110568485,1340463100,3307916247,641025152,3043140495,3736164937,632953703,1172967064,1576976609,3274667266,2169303058,2370213795,1809054150,59727847,361929877,3211623147,2505202138,3569255213,1484005843,1239443753,2395588676,1975683434,4102977912,2572697195,666464733,3202437046,4035489047,3374361702,2110667444,1675577880,3843699074,2538681184,1649639237,2976151520,3144396420,4269907996,4178062228,1883793496,2403728665,2497604743,1383856311,2876494627,1917518562,3810496343,1716890410,3001755655,800440835,2261089178,3543599269,807962610,599762354,33778362,3977675356,2328828971,2809771154,4077384432,1315562145,1708848333,101039829,3509871135,3299278474,875451293,2733856160,92987698,2767645557,193195065,1080094634,1584504582,3178106961,1042385657,2531067453,3711829422,1306967366,2438237621,1908694277,67556463,1615861247,429456164,3602770327,2302690252,1742315127,2968011453,126454664,3877198648,2043211483,2709260871,2084704233,4169408201,0,159417987,841739592,504459436,1817866830,4245618683,260388950,1034867998,908933415,168810852,1750902305,2606453969,607530554,202008497,2472011535,3035535058,463180190,2160117071,1641816226,1517767529,470948374,3801332234,3231722213,1008918595,303765277,235474187,4069246893,766945465,337553864,1475418501,2943682380,4003061179,2743034109,4144047775,1551037884,1147550661,1543208500,2336434550,3408119516,3069049960,3102011747,3610369226,1113818384,328671808,2227573024,2236228733,3535486456,2935566865,3341394285,496906059,3702665459,226906860,2009195472,733156972,2842737049,294930682,1206477858,2835123396,2700099354,1451044056,573804783,2269728455,3644379585,2362090238,2564033334,2801107407,2776292904,3669462566,1068351396,742039012,1350078989,1784663195,1417561698,4136440770,2430122216,775550814,2193862645,2673705150,1775276924,1876241833,3475313331,3366754619,270040487,3902563182,3678124923,3441850377,1851332852,3969562369,2203032232,3868552805,2868897406,566021896,4011190502,3135740889,1248802510,3936291284,699432150,832877231,708780849,3332740144,899835584,1951317047,4236429990,3767586992,866637845,4043610186,1106041591,2144161806,395441711,1984812685,1139781709,3433712980,3835036895,2664543715,1282050075,3240894392,1181045119,2640243204,25965917,4203181171,4211818798,3009879386,2463879762,3910161971,1842759443,2597806476,933301370,1509430414,3943906441,3467192302,3076639029,3776767469,2051518780,2631065433,1441952575,404016761,1942435775,1408749034,1610459739,3745345300,2017778566,3400528769,3110650942,941896748,3265478751,371049330,3168937228,675039627,4279080257,967311729,135050206,3635733660,1683407248,2076935265,3576870512,1215061108,3501741890],FS=[1347548327,1400783205,3273267108,2520393566,3409685355,4045380933,2880240216,2471224067,1428173050,4138563181,2441661558,636813900,4233094615,3620022987,2149987652,2411029155,1239331162,1730525723,2554718734,3781033664,46346101,310463728,2743944855,3328955385,3875770207,2501218972,3955191162,3667219033,768917123,3545789473,692707433,1150208456,1786102409,2029293177,1805211710,3710368113,3065962831,401639597,1724457132,3028143674,409198410,2196052529,1620529459,1164071807,3769721975,2226875310,486441376,2499348523,1483753576,428819965,2274680428,3075636216,598438867,3799141122,1474502543,711349675,129166120,53458370,2592523643,2782082824,4063242375,2988687269,3120694122,1559041666,730517276,2460449204,4042459122,2706270690,3446004468,3573941694,533804130,2328143614,2637442643,2695033685,839224033,1973745387,957055980,2856345839,106852767,1371368976,4181598602,1033297158,2933734917,1179510461,3046200461,91341917,1862534868,4284502037,605657339,2547432937,3431546947,2003294622,3182487618,2282195339,954669403,3682191598,1201765386,3917234703,3388507166,0,2198438022,1211247597,2887651696,1315723890,4227665663,1443857720,507358933,657861945,1678381017,560487590,3516619604,975451694,2970356327,261314535,3535072918,2652609425,1333838021,2724322336,1767536459,370938394,182621114,3854606378,1128014560,487725847,185469197,2918353863,3106780840,3356761769,2237133081,1286567175,3152976349,4255350624,2683765030,3160175349,3309594171,878443390,1988838185,3704300486,1756818940,1673061617,3403100636,272786309,1075025698,545572369,2105887268,4174560061,296679730,1841768865,1260232239,4091327024,3960309330,3497509347,1814803222,2578018489,4195456072,575138148,3299409036,446754879,3629546796,4011996048,3347532110,3252238545,4270639778,915985419,3483825537,681933534,651868046,2755636671,3828103837,223377554,2607439820,1649704518,3270937875,3901806776,1580087799,4118987695,3198115200,2087309459,2842678573,3016697106,1003007129,2802849917,1860738147,2077965243,164439672,4100872472,32283319,2827177882,1709610350,2125135846,136428751,3874428392,3652904859,3460984630,3572145929,3593056380,2939266226,824852259,818324884,3224740454,930369212,2801566410,2967507152,355706840,1257309336,4148292826,243256656,790073846,2373340630,1296297904,1422699085,3756299780,3818836405,457992840,3099667487,2135319889,77422314,1560382517,1945798516,788204353,1521706781,1385356242,870912086,325965383,2358957921,2050466060,2388260884,2313884476,4006521127,901210569,3990953189,1014646705,1503449823,1062597235,2031621326,3212035895,3931371469,1533017514,350174575,2256028891,2177544179,1052338372,741876788,1606591296,1914052035,213705253,2334669897,1107234197,1899603969,3725069491,2631447780,2422494913,1635502980,1893020342,1950903388,1120974935],MS=[2807058932,1699970625,2764249623,1586903591,1808481195,1173430173,1487645946,59984867,4199882800,1844882806,1989249228,1277555970,3623636965,3419915562,1149249077,2744104290,1514790577,459744698,244860394,3235995134,1963115311,4027744588,2544078150,4190530515,1608975247,2627016082,2062270317,1507497298,2200818878,567498868,1764313568,3359936201,2305455554,2037970062,1047239e3,1910319033,1337376481,2904027272,2892417312,984907214,1243112415,830661914,861968209,2135253587,2011214180,2927934315,2686254721,731183368,1750626376,4246310725,1820824798,4172763771,3542330227,48394827,2404901663,2871682645,671593195,3254988725,2073724613,145085239,2280796200,2779915199,1790575107,2187128086,472615631,3029510009,4075877127,3802222185,4107101658,3201631749,1646252340,4270507174,1402811438,1436590835,3778151818,3950355702,3963161475,4020912224,2667994737,273792366,2331590177,104699613,95345982,3175501286,2377486676,1560637892,3564045318,369057872,4213447064,3919042237,1137477952,2658625497,1119727848,2340947849,1530455833,4007360968,172466556,266959938,516552836,0,2256734592,3980931627,1890328081,1917742170,4294704398,945164165,3575528878,958871085,3647212047,2787207260,1423022939,775562294,1739656202,3876557655,2530391278,2443058075,3310321856,547512796,1265195639,437656594,3121275539,719700128,3762502690,387781147,218828297,3350065803,2830708150,2848461854,428169201,122466165,3720081049,1627235199,648017665,4122762354,1002783846,2117360635,695634755,3336358691,4234721005,4049844452,3704280881,2232435299,574624663,287343814,612205898,1039717051,840019705,2708326185,793451934,821288114,1391201670,3822090177,376187827,3113855344,1224348052,1679968233,2361698556,1058709744,752375421,2431590963,1321699145,3519142200,2734591178,188127444,2177869557,3727205754,2384911031,3215212461,2648976442,2450346104,3432737375,1180849278,331544205,3102249176,4150144569,2952102595,2159976285,2474404304,766078933,313773861,2570832044,2108100632,1668212892,3145456443,2013908262,418672217,3070356634,2594734927,1852171925,3867060991,3473416636,3907448597,2614737639,919489135,164948639,2094410160,2997825956,590424639,2486224549,1723872674,3157750862,3399941250,3501252752,3625268135,2555048196,3673637356,1343127501,4130281361,3599595085,2957853679,1297403050,81781910,3051593425,2283490410,532201772,1367295589,3926170974,895287692,1953757831,1093597963,492483431,3528626907,1446242576,1192455638,1636604631,209336225,344873464,1015671571,669961897,3375740769,3857572124,2973530695,3747192018,1933530610,3464042516,935293895,3454686199,2858115069,1863638845,3683022916,4085369519,3292445032,875313188,1080017571,3279033885,621591778,1233856572,2504130317,24197544,3017672716,3835484340,3247465558,2220981195,3060847922,1551124588,1463996600],jS=[4104605777,1097159550,396673818,660510266,2875968315,2638606623,4200115116,3808662347,821712160,1986918061,3430322568,38544885,3856137295,718002117,893681702,1654886325,2975484382,3122358053,3926825029,4274053469,796197571,1290801793,1184342925,3556361835,2405426947,2459735317,1836772287,1381620373,3196267988,1948373848,3764988233,3385345166,3263785589,2390325492,1480485785,3111247143,3780097726,2293045232,548169417,3459953789,3746175075,439452389,1362321559,1400849762,1685577905,1806599355,2174754046,137073913,1214797936,1174215055,3731654548,2079897426,1943217067,1258480242,529487843,1437280870,3945269170,3049390895,3313212038,923313619,679998e3,3215307299,57326082,377642221,3474729866,2041877159,133361907,1776460110,3673476453,96392454,878845905,2801699524,777231668,4082475170,2330014213,4142626212,2213296395,1626319424,1906247262,1846563261,562755902,3708173718,1040559837,3871163981,1418573201,3294430577,114585348,1343618912,2566595609,3186202582,1078185097,3651041127,3896688048,2307622919,425408743,3371096953,2081048481,1108339068,2216610296,0,2156299017,736970802,292596766,1517440620,251657213,2235061775,2933202493,758720310,265905162,1554391400,1532285339,908999204,174567692,1474760595,4002861748,2610011675,3234156416,3693126241,2001430874,303699484,2478443234,2687165888,585122620,454499602,151849742,2345119218,3064510765,514443284,4044981591,1963412655,2581445614,2137062819,19308535,1928707164,1715193156,4219352155,1126790795,600235211,3992742070,3841024952,836553431,1669664834,2535604243,3323011204,1243905413,3141400786,4180808110,698445255,2653899549,2989552604,2253581325,3252932727,3004591147,1891211689,2487810577,3915653703,4237083816,4030667424,2100090966,865136418,1229899655,953270745,3399679628,3557504664,4118925222,2061379749,3079546586,2915017791,983426092,2022837584,1607244650,2118541908,2366882550,3635996816,972512814,3283088770,1568718495,3499326569,3576539503,621982671,2895723464,410887952,2623762152,1002142683,645401037,1494807662,2595684844,1335535747,2507040230,4293295786,3167684641,367585007,3885750714,1865862730,2668221674,2960971305,2763173681,1059270954,2777952454,2724642869,1320957812,2194319100,2429595872,2815956275,77089521,3973773121,3444575871,2448830231,1305906550,4021308739,2857194700,2516901860,3518358430,1787304780,740276417,1699839814,1592394909,2352307457,2272556026,188821243,1729977011,3687994002,274084841,3594982253,3613494426,2701949495,4162096729,322734571,2837966542,1640576439,484830689,1202797690,3537852828,4067639125,349075736,3342319475,4157467219,4255800159,1030690015,1155237496,2951971274,1757691577,607398968,2738905026,499347990,3794078908,1011452712,227885567,2818666809,213114376,3034881240,1455525988,3414450555,850817237,1817998408,3092726480],zS=[0,235474187,470948374,303765277,941896748,908933415,607530554,708780849,1883793496,2118214995,1817866830,1649639237,1215061108,1181045119,1417561698,1517767529,3767586992,4003061179,4236429990,4069246893,3635733660,3602770327,3299278474,3400528769,2430122216,2664543715,2362090238,2193862645,2835123396,2801107407,3035535058,3135740889,3678124923,3576870512,3341394285,3374361702,3810496343,3977675356,4279080257,4043610186,2876494627,2776292904,3076639029,3110650942,2472011535,2640243204,2403728665,2169303058,1001089995,899835584,666464733,699432150,59727847,226906860,530400753,294930682,1273168787,1172967064,1475418501,1509430414,1942435775,2110667444,1876241833,1641816226,2910219766,2743034109,2976151520,3211623147,2505202138,2606453969,2302690252,2269728455,3711829422,3543599269,3240894392,3475313331,3843699074,3943906441,4178062228,4144047775,1306967366,1139781709,1374988112,1610459739,1975683434,2076935265,1775276924,1742315127,1034867998,866637845,566021896,800440835,92987698,193195065,429456164,395441711,1984812685,2017778566,1784663195,1683407248,1315562145,1080094634,1383856311,1551037884,101039829,135050206,437757123,337553864,1042385657,807962610,573804783,742039012,2531067453,2564033334,2328828971,2227573024,2935566865,2700099354,3001755655,3168937228,3868552805,3902563182,4203181171,4102977912,3736164937,3501741890,3265478751,3433712980,1106041591,1340463100,1576976609,1408749034,2043211483,2009195472,1708848333,1809054150,832877231,1068351396,766945465,599762354,159417987,126454664,361929877,463180190,2709260871,2943682380,3178106961,3009879386,2572697195,2538681184,2236228733,2336434550,3509871135,3745345300,3441850377,3274667266,3910161971,3877198648,4110568485,4211818798,2597806476,2497604743,2261089178,2295101073,2733856160,2902087851,3202437046,2968011453,3936291284,3835036895,4136440770,4169408201,3535486456,3702665459,3467192302,3231722213,2051518780,1951317047,1716890410,1750902305,1113818384,1282050075,1584504582,1350078989,168810852,67556463,371049330,404016761,841739592,1008918595,775550814,540080725,3969562369,3801332234,4035489047,4269907996,3569255213,3669462566,3366754619,3332740144,2631065433,2463879762,2160117071,2395588676,2767645557,2868897406,3102011747,3069049960,202008497,33778362,270040487,504459436,875451293,975658646,675039627,641025152,2084704233,1917518562,1615861247,1851332852,1147550661,1248802510,1484005843,1451044056,933301370,967311729,733156972,632953703,260388950,25965917,328671808,496906059,1206477858,1239443753,1543208500,1441952575,2144161806,1908694277,1675577880,1842759443,3610369226,3644379585,3408119516,3307916247,4011190502,3776767469,4077384432,4245618683,2809771154,2842737049,3144396420,3043140495,2673705150,2438237621,2203032232,2370213795],HS=[0,185469197,370938394,487725847,741876788,657861945,975451694,824852259,1483753576,1400783205,1315723890,1164071807,1950903388,2135319889,1649704518,1767536459,2967507152,3152976349,2801566410,2918353863,2631447780,2547432937,2328143614,2177544179,3901806776,3818836405,4270639778,4118987695,3299409036,3483825537,3535072918,3652904859,2077965243,1893020342,1841768865,1724457132,1474502543,1559041666,1107234197,1257309336,598438867,681933534,901210569,1052338372,261314535,77422314,428819965,310463728,3409685355,3224740454,3710368113,3593056380,3875770207,3960309330,4045380933,4195456072,2471224067,2554718734,2237133081,2388260884,3212035895,3028143674,2842678573,2724322336,4138563181,4255350624,3769721975,3955191162,3667219033,3516619604,3431546947,3347532110,2933734917,2782082824,3099667487,3016697106,2196052529,2313884476,2499348523,2683765030,1179510461,1296297904,1347548327,1533017514,1786102409,1635502980,2087309459,2003294622,507358933,355706840,136428751,53458370,839224033,957055980,605657339,790073846,2373340630,2256028891,2607439820,2422494913,2706270690,2856345839,3075636216,3160175349,3573941694,3725069491,3273267108,3356761769,4181598602,4063242375,4011996048,3828103837,1033297158,915985419,730517276,545572369,296679730,446754879,129166120,213705253,1709610350,1860738147,1945798516,2029293177,1239331162,1120974935,1606591296,1422699085,4148292826,4233094615,3781033664,3931371469,3682191598,3497509347,3446004468,3328955385,2939266226,2755636671,3106780840,2988687269,2198438022,2282195339,2501218972,2652609425,1201765386,1286567175,1371368976,1521706781,1805211710,1620529459,2105887268,1988838185,533804130,350174575,164439672,46346101,870912086,954669403,636813900,788204353,2358957921,2274680428,2592523643,2441661558,2695033685,2880240216,3065962831,3182487618,3572145929,3756299780,3270937875,3388507166,4174560061,4091327024,4006521127,3854606378,1014646705,930369212,711349675,560487590,272786309,457992840,106852767,223377554,1678381017,1862534868,1914052035,2031621326,1211247597,1128014560,1580087799,1428173050,32283319,182621114,401639597,486441376,768917123,651868046,1003007129,818324884,1503449823,1385356242,1333838021,1150208456,1973745387,2125135846,1673061617,1756818940,2970356327,3120694122,2802849917,2887651696,2637442643,2520393566,2334669897,2149987652,3917234703,3799141122,4284502037,4100872472,3309594171,3460984630,3545789473,3629546796,2050466060,1899603969,1814803222,1730525723,1443857720,1560382517,1075025698,1260232239,575138148,692707433,878443390,1062597235,243256656,91341917,409198410,325965383,3403100636,3252238545,3704300486,3620022987,3874428392,3990953189,4042459122,4227665663,2460449204,2578018489,2226875310,2411029155,3198115200,3046200461,2827177882,2743944855],qS=[0,218828297,437656594,387781147,875313188,958871085,775562294,590424639,1750626376,1699970625,1917742170,2135253587,1551124588,1367295589,1180849278,1265195639,3501252752,3720081049,3399941250,3350065803,3835484340,3919042237,4270507174,4085369519,3102249176,3051593425,2734591178,2952102595,2361698556,2177869557,2530391278,2614737639,3145456443,3060847922,2708326185,2892417312,2404901663,2187128086,2504130317,2555048196,3542330227,3727205754,3375740769,3292445032,3876557655,3926170974,4246310725,4027744588,1808481195,1723872674,1910319033,2094410160,1608975247,1391201670,1173430173,1224348052,59984867,244860394,428169201,344873464,935293895,984907214,766078933,547512796,1844882806,1627235199,2011214180,2062270317,1507497298,1423022939,1137477952,1321699145,95345982,145085239,532201772,313773861,830661914,1015671571,731183368,648017665,3175501286,2957853679,2807058932,2858115069,2305455554,2220981195,2474404304,2658625497,3575528878,3625268135,3473416636,3254988725,3778151818,3963161475,4213447064,4130281361,3599595085,3683022916,3432737375,3247465558,3802222185,4020912224,4172763771,4122762354,3201631749,3017672716,2764249623,2848461854,2331590177,2280796200,2431590963,2648976442,104699613,188127444,472615631,287343814,840019705,1058709744,671593195,621591778,1852171925,1668212892,1953757831,2037970062,1514790577,1463996600,1080017571,1297403050,3673637356,3623636965,3235995134,3454686199,4007360968,3822090177,4107101658,4190530515,2997825956,3215212461,2830708150,2779915199,2256734592,2340947849,2627016082,2443058075,172466556,122466165,273792366,492483431,1047239e3,861968209,612205898,695634755,1646252340,1863638845,2013908262,1963115311,1446242576,1530455833,1277555970,1093597963,1636604631,1820824798,2073724613,1989249228,1436590835,1487645946,1337376481,1119727848,164948639,81781910,331544205,516552836,1039717051,821288114,669961897,719700128,2973530695,3157750862,2871682645,2787207260,2232435299,2283490410,2667994737,2450346104,3647212047,3564045318,3279033885,3464042516,3980931627,3762502690,4150144569,4199882800,3070356634,3121275539,2904027272,2686254721,2200818878,2384911031,2570832044,2486224549,3747192018,3528626907,3310321856,3359936201,3950355702,3867060991,4049844452,4234721005,1739656202,1790575107,2108100632,1890328081,1402811438,1586903591,1233856572,1149249077,266959938,48394827,369057872,418672217,1002783846,919489135,567498868,752375421,209336225,24197544,376187827,459744698,945164165,895287692,574624663,793451934,1679968233,1764313568,2117360635,1933530610,1343127501,1560637892,1243112415,1192455638,3704280881,3519142200,3336358691,3419915562,3907448597,3857572124,4075877127,4294704398,3029510009,3113855344,2927934315,2744104290,2159976285,2377486676,2594734927,2544078150],VS=[0,151849742,303699484,454499602,607398968,758720310,908999204,1059270954,1214797936,1097159550,1517440620,1400849762,1817998408,1699839814,2118541908,2001430874,2429595872,2581445614,2194319100,2345119218,3034881240,3186202582,2801699524,2951971274,3635996816,3518358430,3399679628,3283088770,4237083816,4118925222,4002861748,3885750714,1002142683,850817237,698445255,548169417,529487843,377642221,227885567,77089521,1943217067,2061379749,1640576439,1757691577,1474760595,1592394909,1174215055,1290801793,2875968315,2724642869,3111247143,2960971305,2405426947,2253581325,2638606623,2487810577,3808662347,3926825029,4044981591,4162096729,3342319475,3459953789,3576539503,3693126241,1986918061,2137062819,1685577905,1836772287,1381620373,1532285339,1078185097,1229899655,1040559837,923313619,740276417,621982671,439452389,322734571,137073913,19308535,3871163981,4021308739,4104605777,4255800159,3263785589,3414450555,3499326569,3651041127,2933202493,2815956275,3167684641,3049390895,2330014213,2213296395,2566595609,2448830231,1305906550,1155237496,1607244650,1455525988,1776460110,1626319424,2079897426,1928707164,96392454,213114376,396673818,514443284,562755902,679998e3,865136418,983426092,3708173718,3557504664,3474729866,3323011204,4180808110,4030667424,3945269170,3794078908,2507040230,2623762152,2272556026,2390325492,2975484382,3092726480,2738905026,2857194700,3973773121,3856137295,4274053469,4157467219,3371096953,3252932727,3673476453,3556361835,2763173681,2915017791,3064510765,3215307299,2156299017,2307622919,2459735317,2610011675,2081048481,1963412655,1846563261,1729977011,1480485785,1362321559,1243905413,1126790795,878845905,1030690015,645401037,796197571,274084841,425408743,38544885,188821243,3613494426,3731654548,3313212038,3430322568,4082475170,4200115116,3780097726,3896688048,2668221674,2516901860,2366882550,2216610296,3141400786,2989552604,2837966542,2687165888,1202797690,1320957812,1437280870,1554391400,1669664834,1787304780,1906247262,2022837584,265905162,114585348,499347990,349075736,736970802,585122620,972512814,821712160,2595684844,2478443234,2293045232,2174754046,3196267988,3079546586,2895723464,2777952454,3537852828,3687994002,3234156416,3385345166,4142626212,4293295786,3841024952,3992742070,174567692,57326082,410887952,292596766,777231668,660510266,1011452712,893681702,1108339068,1258480242,1343618912,1494807662,1715193156,1865862730,1948373848,2100090966,2701949495,2818666809,3004591147,3122358053,2235061775,2352307457,2535604243,2653899549,3915653703,3764988233,4219352155,4067639125,3444575871,3294430577,3746175075,3594982253,836553431,953270745,600235211,718002117,367585007,484830689,133361907,251657213,2041877159,1891211689,1806599355,1654886325,1568718495,1418573201,1335535747,1184342925];function B0(r){const e=[];for(let t=0;t<r.length;t+=4)e.push(r[t]<<24|r[t+1]<<16|r[t+2]<<8|r[t+3]);return e}class fy{get key(){return gt(this,Dh,"f").slice()}constructor(e){if(Dh.set(this,void 0),Nr.set(this,void 0),On.set(this,void 0),!(this instanceof fy))throw Error("AES must be instanitated with `new`");_0(this,Dh,new Uint8Array(e),"f");const t=RS[this.key.length];if(t==null)throw new TypeError("invalid key size (must be 16, 24 or 32 bytes)");_0(this,On,[],"f"),_0(this,Nr,[],"f");for(let u=0;u<=t;u++)gt(this,On,"f").push([0,0,0,0]),gt(this,Nr,"f").push([0,0,0,0]);const n=(t+1)*4,s=this.key.length/4,i=B0(this.key);let o;for(let u=0;u<s;u++)o=u>>2,gt(this,On,"f")[o][u%4]=i[u],gt(this,Nr,"f")[t-o][u%4]=i[u];let a=0,c=s,l;for(;c<n;){if(l=i[s-1],i[0]^=Sr[l>>16&255]<<24^Sr[l>>8&255]<<16^Sr[l&255]<<8^Sr[l>>24&255]^_S[a]<<24,a+=1,s!=8)for(let d=1;d<s;d++)i[d]^=i[d-1];else{for(let d=1;d<s/2;d++)i[d]^=i[d-1];l=i[s/2-1],i[s/2]^=Sr[l&255]^Sr[l>>8&255]<<8^Sr[l>>16&255]<<16^Sr[l>>24&255]<<24;for(let d=s/2+1;d<s;d++)i[d]^=i[d-1]}let u=0,f,h;for(;u<s&&c<n;)f=c>>2,h=c%4,gt(this,On,"f")[f][h]=i[u],gt(this,Nr,"f")[t-f][h]=i[u++],c++}for(let u=1;u<t;u++)for(let f=0;f<4;f++)l=gt(this,Nr,"f")[u][f],gt(this,Nr,"f")[u][f]=zS[l>>24&255]^HS[l>>16&255]^qS[l>>8&255]^VS[l&255]}encrypt(e){if(e.length!=16)throw new TypeError("invalid plaintext size (must be 16 bytes)");const t=gt(this,On,"f").length-1,n=[0,0,0,0];let s=B0(e);for(let a=0;a<4;a++)s[a]^=gt(this,On,"f")[0][a];for(let a=1;a<t;a++){for(let c=0;c<4;c++)n[c]=BS[s[c]>>24&255]^kS[s[(c+1)%4]>>16&255]^US[s[(c+2)%4]>>8&255]^$S[s[(c+3)%4]&255]^gt(this,On,"f")[a][c];s=n.slice()}const i=new Uint8Array(16);let o=0;for(let a=0;a<4;a++)o=gt(this,On,"f")[t][a],i[4*a]=(Sr[s[a]>>24&255]^o>>24)&255,i[4*a+1]=(Sr[s[(a+1)%4]>>16&255]^o>>16)&255,i[4*a+2]=(Sr[s[(a+2)%4]>>8&255]^o>>8)&255,i[4*a+3]=(Sr[s[(a+3)%4]&255]^o)&255;return i}decrypt(e){if(e.length!=16)throw new TypeError("invalid ciphertext size (must be 16 bytes)");const t=gt(this,Nr,"f").length-1,n=[0,0,0,0];let s=B0(e);for(let a=0;a<4;a++)s[a]^=gt(this,Nr,"f")[0][a];for(let a=1;a<t;a++){for(let c=0;c<4;c++)n[c]=LS[s[c]>>24&255]^FS[s[(c+3)%4]>>16&255]^MS[s[(c+2)%4]>>8&255]^jS[s[(c+1)%4]&255]^gt(this,Nr,"f")[a][c];s=n.slice()}const i=new Uint8Array(16);let o=0;for(let a=0;a<4;a++)o=gt(this,Nr,"f")[t][a],i[4*a]=(Wf[s[a]>>24&255]^o>>24)&255,i[4*a+1]=(Wf[s[(a+3)%4]>>16&255]^o>>16)&255,i[4*a+2]=(Wf[s[(a+2)%4]>>8&255]^o>>8)&255,i[4*a+3]=(Wf[s[(a+1)%4]&255]^o)&255;return i}}Dh=new WeakMap,Nr=new WeakMap,On=new WeakMap;class zE{constructor(e,t,n){if(n&&!(this instanceof n))throw new Error(`${e} must be instantiated with "new"`);Object.defineProperties(this,{aes:{enumerable:!0,value:new fy(t)},name:{enumerable:!0,value:e}})}}var Qf=function(r,e,t,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},va=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Xl,fs;class hy extends zE{constructor(e,t){if(super("ECC",e,hy),Xl.set(this,void 0),fs.set(this,void 0),t){if(t.length%16)throw new TypeError("invalid iv size (must be 16 bytes)");Qf(this,Xl,new Uint8Array(t),"f")}else Qf(this,Xl,new Uint8Array(16),"f");Qf(this,fs,this.iv,"f")}get iv(){return new Uint8Array(va(this,Xl,"f"))}encrypt(e){if(e.length%16)throw new TypeError("invalid plaintext size (must be multiple of 16 bytes)");const t=new Uint8Array(e.length);for(let n=0;n<e.length;n+=16){for(let s=0;s<16;s++)va(this,fs,"f")[s]^=e[n+s];Qf(this,fs,this.aes.encrypt(va(this,fs,"f")),"f"),t.set(va(this,fs,"f"),n)}return t}decrypt(e){if(e.length%16)throw new TypeError("invalid ciphertext size (must be multiple of 16 bytes)");const t=new Uint8Array(e.length);for(let n=0;n<e.length;n+=16){const s=this.aes.decrypt(e.subarray(n,n+16));for(let i=0;i<16;i++)t[n+i]=s[i]^va(this,fs,"f")[i],va(this,fs,"f")[i]=e[n+i]}return t}}Xl=new WeakMap,fs=new WeakMap;var Aa=function(r,e,t,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},Or=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},eu,io,Dr;class ll extends zE{constructor(e,t){super("CTR",e,ll),eu.set(this,void 0),io.set(this,void 0),Dr.set(this,void 0),Aa(this,Dr,new Uint8Array(16),"f"),Or(this,Dr,"f").fill(0),Aa(this,eu,Or(this,Dr,"f"),"f"),Aa(this,io,16,"f"),t==null&&(t=1),typeof t=="number"?this.setCounterValue(t):this.setCounterBytes(t)}get counter(){return new Uint8Array(Or(this,Dr,"f"))}setCounterValue(e){if(!Number.isInteger(e)||e<0||e>Number.MAX_SAFE_INTEGER)throw new TypeError("invalid counter initial integer value");for(let t=15;t>=0;--t)Or(this,Dr,"f")[t]=e%256,e=Math.floor(e/256)}setCounterBytes(e){if(e.length!==16)throw new TypeError("invalid counter initial Uint8Array value length");Or(this,Dr,"f").set(e)}increment(){for(let e=15;e>=0;e--)if(Or(this,Dr,"f")[e]===255)Or(this,Dr,"f")[e]=0;else{Or(this,Dr,"f")[e]++;break}}encrypt(e){var t,n;const s=new Uint8Array(e);for(let i=0;i<s.length;i++)Or(this,io,"f")===16&&(Aa(this,eu,this.aes.encrypt(Or(this,Dr,"f")),"f"),Aa(this,io,0,"f"),this.increment()),s[i]^=Or(this,eu,"f")[Aa(this,io,(n=Or(this,io,"f"),t=n++,n),"f"),t];return s}decrypt(e){return this.encrypt(e)}}eu=new WeakMap,io=new WeakMap,Dr=new WeakMap;function KS(r){if(r.length<16)throw new TypeError("PKCS#7 invalid length");const e=r[r.length-1];if(e>16)throw new TypeError("PKCS#7 padding byte out of range");const t=r.length-e;for(let n=0;n<e;n++)if(r[t+n]!==e)throw new TypeError("PKCS#7 invalid padding byte");return new Uint8Array(r.subarray(0,t))}function HE(r){return typeof r=="string"&&!r.startsWith("0x")&&(r="0x"+r),ut(r)}function Cl(r,e){for(r=String(r);r.length<e;)r="0"+r;return r}function bf(r){return typeof r=="string"?st(r,"NFKC"):ut(r)}function qe(r,e){const t=e.match(/^([a-z0-9$_.-]*)(:([a-z]+))?(!)?$/i);C(t!=null,"invalid path","path",e);const n=t[1],s=t[3],i=t[4]==="!";let o=r;for(const a of n.toLowerCase().split(".")){if(Array.isArray(o)){if(!a.match(/^[0-9]+$/))break;o=o[parseInt(a)]}else if(typeof o=="object"){let c=null;for(const l in o)if(l.toLowerCase()===a){c=o[l];break}o=c}else o=null;if(o==null)break}if(C(!i||o!=null,"missing required value","path",n),s&&o!=null){if(s==="int"){if(typeof o=="string"&&o.match(/^-?[0-9]+$/))return parseInt(o);if(Number.isSafeInteger(o))return o}if(s==="number"&&typeof o=="string"&&o.match(/^-?[0-9.]*$/))return parseFloat(o);if(s==="data"&&typeof o=="string")return HE(o);if(s==="array"&&Array.isArray(o)||s===typeof o)return o;C(!1,`wrong type found for ${s} `,"path",n)}return o}const qE="m/44'/60'/0'/0/0";function Ag(r){try{const e=JSON.parse(r);if((e.version!=null?parseInt(e.version):0)===3)return!0}catch{}return!1}function GS(r,e,t){if(qe(r,"crypto.cipher:string")==="aes-128-ctr"){const s=qe(r,"crypto.cipherparams.iv:data!"),i=new ll(e,s);return K(i.decrypt(t))}z(!1,"unsupported cipher","UNSUPPORTED_OPERATION",{operation:"decrypt"})}function Xh(r,e){const t=Q(e),n=qe(r,"crypto.ciphertext:data!"),s=K(Ne(me([t.slice(16,32),n]))).substring(2);C(s===qe(r,"crypto.mac:string!").toLowerCase(),"incorrect password","password","[ REDACTED ]");const i=GS(r,t.slice(0,16),n),o=yl(i);if(r.address){let l=r.address.toLowerCase();l.startsWith("0x")||(l="0x"+l),C(ce(l)===o,"keystore address/privateKey mismatch","address",r.address)}const a={address:o,privateKey:i};if(qe(r,"x-ethers.version:string")==="0.1"){const l=t.slice(32,64),u=qe(r,"x-ethers.mnemonicCiphertext:data!"),f=qe(r,"x-ethers.mnemonicCounter:data!"),h=new ll(l,f);a.mnemonic={path:qe(r,"x-ethers.path:string")||qE,locale:qe(r,"x-ethers.locale:string")||"en",entropy:K(Q(h.decrypt(u)))}}return a}function VE(r){const e=qe(r,"crypto.kdf:string");if(e&&typeof e=="string"){if(e.toLowerCase()==="scrypt"){const t=qe(r,"crypto.kdfparams.salt:data!"),n=qe(r,"crypto.kdfparams.n:int!"),s=qe(r,"crypto.kdfparams.r:int!"),i=qe(r,"crypto.kdfparams.p:int!");C(n>0&&(n&n-1)===0,"invalid kdf.N","kdf.N",n),C(s>0&&i>0,"invalid kdf","kdf",e);const o=qe(r,"crypto.kdfparams.dklen:int!");return C(o===32,"invalid kdf.dklen","kdf.dflen",o),{name:"scrypt",salt:t,N:n,r:s,p:i,dkLen:64}}else if(e.toLowerCase()==="pbkdf2"){const t=qe(r,"crypto.kdfparams.salt:data!"),n=qe(r,"crypto.kdfparams.prf:string!"),s=n.split("-").pop();C(s==="sha256"||s==="sha512","invalid kdf.pdf","kdf.pdf",n);const i=qe(r,"crypto.kdfparams.c:int!"),o=qe(r,"crypto.kdfparams.dklen:int!");return C(o===32,"invalid kdf.dklen","kdf.dklen",o),{name:"pbkdf2",salt:t,count:i,dkLen:o,algorithm:s}}}C(!1,"unsupported key-derivation function","kdf",e)}function KE(r,e){const t=JSON.parse(r),n=bf(e),s=VE(t);if(s.name==="pbkdf2"){const{salt:f,count:h,dkLen:d,algorithm:p}=s,g=rs(n,f,h,d,p);return Xh(t,g)}z(s.name==="scrypt","cannot be reached","UNKNOWN_ERROR",{params:s});const{salt:i,N:o,r:a,p:c,dkLen:l}=s,u=Vi(n,i,o,a,c,l);return Xh(t,u)}function Px(r){return new Promise(e=>{setTimeout(()=>{e()},r)})}async function GE(r,e,t){const n=JSON.parse(r),s=bf(e),i=VE(n);if(i.name==="pbkdf2"){t&&(t(0),await Px(0));const{salt:h,count:d,dkLen:p,algorithm:g}=i,y=rs(s,h,d,p,g);return t&&(t(1),await Px(0)),Xh(n,y)}z(i.name==="scrypt","cannot be reached","UNKNOWN_ERROR",{params:i});const{salt:o,N:a,r:c,p:l,dkLen:u}=i,f=await qi(s,o,a,c,l,u,t);return Xh(n,f)}function WE(r){const e=r.salt!=null?Q(r.salt,"options.salt"):qr(32);let t=1<<17,n=8,s=1;return r.scrypt&&(r.scrypt.N&&(t=r.scrypt.N),r.scrypt.r&&(n=r.scrypt.r),r.scrypt.p&&(s=r.scrypt.p)),C(typeof t=="number"&&t>0&&Number.isSafeInteger(t)&&(BigInt(t)&BigInt(t-1))===BigInt(0),"invalid scrypt N parameter","options.N",t),C(typeof n=="number"&&n>0&&Number.isSafeInteger(n),"invalid scrypt r parameter","options.r",n),C(typeof s=="number"&&s>0&&Number.isSafeInteger(s),"invalid scrypt p parameter","options.p",s),{name:"scrypt",dkLen:32,salt:e,N:t,r:n,p:s}}function QE(r,e,t,n){const s=Q(t.privateKey,"privateKey"),i=n.iv!=null?Q(n.iv,"options.iv"):qr(16);C(i.length===16,"invalid options.iv length","options.iv",n.iv);const o=n.uuid!=null?Q(n.uuid,"options.uuid"):qr(16);C(o.length===16,"invalid options.uuid length","options.uuid",n.iv);const a=r.slice(0,16),c=r.slice(16,32),l=new ll(a,i),u=Q(l.encrypt(s)),f=Ne(me([c,u])),h={address:t.address.substring(2).toLowerCase(),id:d3(o),version:3,Crypto:{cipher:"aes-128-ctr",cipherparams:{iv:K(i).substring(2)},ciphertext:K(u).substring(2),kdf:"scrypt",kdfparams:{salt:K(e.salt).substring(2),n:e.N,dklen:32,p:e.p,r:e.r},mac:f.substring(2)}};if(t.mnemonic){const d=n.client!=null?n.client:`ethers/${Sb}`,p=t.mnemonic.path||qE,g=t.mnemonic.locale||"en",y=r.slice(32,64),x=Q(t.mnemonic.entropy,"account.mnemonic.entropy"),A=qr(16),w=new ll(y,A),O=Q(w.encrypt(x)),I=new Date,P="UTC--"+(I.getUTCFullYear()+"-"+Cl(I.getUTCMonth()+1,2)+"-"+Cl(I.getUTCDate(),2)+"T"+Cl(I.getUTCHours(),2)+"-"+Cl(I.getUTCMinutes(),2)+"-"+Cl(I.getUTCSeconds(),2)+".0Z")+"--"+h.address;h["x-ethers"]={client:d,gethFilename:P,path:p,locale:g,mnemonicCounter:K(A).substring(2),mnemonicCiphertext:K(O).substring(2),version:"0.1"}}return JSON.stringify(h)}function dy(r,e,t){t==null&&(t={});const n=bf(e),s=WE(t),i=Vi(n,s.salt,s.N,s.r,s.p,64);return QE(Q(i),s,r,t)}async function py(r,e,t){t==null&&(t={});const n=bf(e),s=WE(t),i=await qi(n,s.salt,s.N,s.r,s.p,64,t.progressCallback);return QE(Q(i),s,r,t)}const Rh="m/44'/60'/0'/0/0",WS=new Uint8Array([66,105,116,99,111,105,110,32,115,101,101,100]),Wn=2147483648,QS=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),JS="0123456789abcdef";function ed(r,e){let t="";for(;r;)t=JS[r%16]+t,r=Math.trunc(r/16);for(;t.length<e*2;)t="0"+t;return"0x"+t}function Ig(r){const e=Q(r),t=ke(Vt(Vt(e)),0,4),n=me([e,t]);return Cb(n)}const Dn={};function JE(r,e,t,n){const s=new Uint8Array(37);r&Wn?(z(n!=null,"cannot derive child of neutered node","UNSUPPORTED_OPERATION",{operation:"deriveChild"}),s.set(Q(n),1)):s.set(Q(t));for(let o=24;o>=0;o-=8)s[33+(o>>3)]=r>>24-o&255;const i=Q(zi("sha512",e,s));return{IL:i.slice(0,32),IR:i.slice(32)}}function YE(r,e){const t=e.split("/");C(t.length>0,"invalid path","path",e),t[0]==="m"&&(C(r.depth===0,`cannot derive root path (i.e. path starting with "m/") for a node at non-zero depth ${r.depth}`,"path",e),t.shift());let n=r;for(let s=0;s<t.length;s++){const i=t[s];if(i.match(/^[0-9]+'$/)){const o=parseInt(i.substring(0,i.length-1));C(o<Wn,"invalid path index",`path[${s}]`,i),n=n.deriveChild(Wn+o)}else if(i.match(/^[0-9]+$/)){const o=parseInt(i);C(o<Wn,"invalid path index",`path[${s}]`,i),n=n.deriveChild(o)}else C(!1,"invalid path component",`path[${s}]`,i)}return n}var rf,Sg,Yo,tu;const tn=class tn extends _u{constructor(t,n,s,i,o,a,c,l,u){super(n,u);M(this,rf);k(this,"publicKey");k(this,"fingerprint");k(this,"parentFingerprint");k(this,"mnemonic");k(this,"chainCode");k(this,"path");k(this,"index");k(this,"depth");js(t,Dn,"HDNodeWallet"),te(this,{publicKey:n.compressedPublicKey});const f=ke(Hi(Vt(this.publicKey)),0,4);te(this,{parentFingerprint:s,fingerprint:f,chainCode:i,path:o,index:a,depth:c}),te(this,{mnemonic:l})}connect(t){return new tn(Dn,this.signingKey,this.parentFingerprint,this.chainCode,this.path,this.index,this.depth,this.mnemonic,t)}async encrypt(t,n){return await py(q(this,rf,Sg).call(this),t,{progressCallback:n})}encryptSync(t){return dy(q(this,rf,Sg).call(this),t)}get extendedKey(){return z(this.depth<256,"Depth too deep","UNSUPPORTED_OPERATION",{operation:"extendedKey"}),Ig(me(["0x0488ADE4",ed(this.depth,1),this.parentFingerprint,ed(this.index,4),this.chainCode,me(["0x00",this.privateKey])]))}hasPath(){return this.path!=null}neuter(){return new ul(Dn,this.address,this.publicKey,this.parentFingerprint,this.chainCode,this.path,this.index,this.depth,this.provider)}deriveChild(t){const n=ae(t,"index");C(n<=4294967295,"invalid index","index",n);let s=this.path;s&&(s+="/"+(n&~Wn),n&Wn&&(s+="'"));const{IR:i,IL:o}=JE(n,this.chainCode,this.publicKey,this.privateKey),a=new bn(Zn((pl(o)+BigInt(this.privateKey))%QS,32));return new tn(Dn,a,this.fingerprint,K(i),s,n,this.depth+1,this.mnemonic,this.provider)}derivePath(t){return YE(this,t)}static fromExtendedKey(t){const n=Fe(X2(t));C(n.length===82||Ig(n.slice(0,78))===t,"invalid extended key","extendedKey","[ REDACTED ]");const s=n[4],i=K(n.slice(5,9)),o=parseInt(K(n.slice(9,13)).substring(2),16),a=K(n.slice(13,45)),c=n.slice(45,78);switch(K(n.slice(0,4))){case"0x0488b21e":case"0x043587cf":{const l=K(c);return new ul(Dn,yl(l),l,i,a,null,o,s,null)}case"0x0488ade4":case"0x04358394 ":if(c[0]!==0)break;return new tn(Dn,new bn(c.slice(1)),i,a,null,o,s,null,null)}C(!1,"invalid extended key prefix","extendedKey","[ REDACTED ]")}static createRandom(t,n,s){var o;t==null&&(t=""),n==null&&(n=Rh),s==null&&(s=$s.wordlist());const i=sa.fromEntropy(qr(16),t,s);return q(o=tn,Yo,tu).call(o,i.computeSeed(),i).derivePath(n)}static fromMnemonic(t,n){var s;return n||(n=Rh),q(s=tn,Yo,tu).call(s,t.computeSeed(),t).derivePath(n)}static fromPhrase(t,n,s,i){var a;n==null&&(n=""),s==null&&(s=Rh),i==null&&(i=$s.wordlist());const o=sa.fromPhrase(t,n,i);return q(a=tn,Yo,tu).call(a,o.computeSeed(),o).derivePath(s)}static fromSeed(t){var n;return q(n=tn,Yo,tu).call(n,t,null)}};rf=new WeakSet,Sg=function(){const t={address:this.address,privateKey:this.privateKey},n=this.mnemonic;return this.path&&n&&n.wordlist.locale==="en"&&n.password===""&&(t.mnemonic={path:this.path,locale:"en",entropy:n.entropy}),t},Yo=new WeakSet,tu=function(t,n){C(of(t),"invalid seed","seed","[REDACTED]");const s=Q(t,"seed");C(s.length>=16&&s.length<=64,"invalid seed","seed","[REDACTED]");const i=Q(zi("sha512",WS,s)),o=new bn(K(i.slice(0,32)));return new tn(Dn,o,"0x00000000",K(i.slice(32)),"m",0,0,n,null)},M(tn,Yo);let Za=tn;class ul extends Qh{constructor(t,n,s,i,o,a,c,l,u){super(n,u);k(this,"publicKey");k(this,"fingerprint");k(this,"parentFingerprint");k(this,"chainCode");k(this,"path");k(this,"index");k(this,"depth");js(t,Dn,"HDNodeVoidWallet"),te(this,{publicKey:s});const f=ke(Hi(Vt(s)),0,4);te(this,{publicKey:s,fingerprint:f,parentFingerprint:i,chainCode:o,path:a,index:c,depth:l})}connect(t){return new ul(Dn,this.address,this.publicKey,this.parentFingerprint,this.chainCode,this.path,this.index,this.depth,t)}get extendedKey(){return z(this.depth<256,"Depth too deep","UNSUPPORTED_OPERATION",{operation:"extendedKey"}),Ig(me(["0x0488B21E",ed(this.depth,1),this.parentFingerprint,ed(this.index,4),this.chainCode,this.publicKey]))}hasPath(){return this.path!=null}deriveChild(t){const n=ae(t,"index");C(n<=4294967295,"invalid index","index",n);let s=this.path;s&&(s+="/"+(n&~Wn),n&Wn&&(s+="'"));const{IR:i,IL:o}=JE(n,this.chainCode,this.publicKey,null),a=bn.addPoints(o,this.publicKey,!0),c=yl(a);return new ul(Dn,c,a,this.fingerprint,K(i),s,n,this.depth+1,this.provider)}derivePath(t){return YE(this,t)}}function YS(r){const e=ae(r,"index");return C(e>=0&&e<Wn,"invalid account index","index",e),`m/44'/60'/${e}'/0/0`}function ZS(r){const e=ae(r,"index");return C(e>=0&&e<Wn,"invalid account index","index",e),`m/44'/60'/0'/0/${e}`}function Og(r){try{if(JSON.parse(r).encseed)return!0}catch{}return!1}function Pg(r,e){const t=JSON.parse(r),n=bf(e),s=ce(qe(t,"ethaddr:string!")),i=HE(qe(t,"encseed:string!"));C(i&&i.length%16===0,"invalid encseed","json",r);const o=Q(rs(n,n,2e3,32,"sha256")).slice(0,16),a=i.slice(0,16),c=i.slice(16),l=new hy(o,a),u=KS(Q(l.decrypt(c)));let f="";for(let h=0;h<u.length;h++)f+=String.fromCharCode(u[h]);return{address:s,privateKey:es(f)}}function Cx(r){return new Promise(e=>{setTimeout(()=>{e()},r)})}var nf,Tg;const yo=class yo extends _u{constructor(e,t){typeof e=="string"&&!e.startsWith("0x")&&(e="0x"+e);let n=typeof e=="string"?new bn(e):e;super(n,t)}connect(e){return new yo(this.signingKey,e)}async encrypt(e,t){const n={address:this.address,privateKey:this.privateKey};return await py(n,e,{progressCallback:t})}encryptSync(e){const t={address:this.address,privateKey:this.privateKey};return dy(t,e)}static async fromEncryptedJson(e,t,n){var i;let s=null;return Ag(e)?s=await GE(e,t,n):Og(e)&&(n&&(n(0),await Cx(0)),s=Pg(e,t),n&&(n(1),await Cx(0))),q(i=yo,nf,Tg).call(i,s)}static fromEncryptedJsonSync(e,t){var s;let n=null;return Ag(e)?n=KE(e,t):Og(e)?n=Pg(e,t):C(!1,"invalid JSON wallet","json","[ REDACTED ]"),q(s=yo,nf,Tg).call(s,n)}static createRandom(e){const t=Za.createRandom();return e?t.connect(e):t}static fromPhrase(e,t){const n=Za.fromPhrase(e);return t?n.connect(t):n}};nf=new WeakSet,Tg=function(e){if(C(e,"invalid JSON wallet","json","[ REDACTED ]"),"mnemonic"in e&&e.mnemonic&&e.mnemonic.locale==="en"){const n=sa.fromEntropy(e.mnemonic.entropy),s=Za.fromMnemonic(n,e.mnemonic.path);if(s.address===e.address&&s.privateKey===e.privateKey)return s;console.log("WARNING: JSON mismatch address/privateKey != mnemonic; fallback onto private key")}const t=new yo(e.privateKey);return C(t.address===e.address,"address/privateKey mismatch","json","[ REDACTED ]"),t},M(yo,nf);let Cg=yo;const XS=")!@#$%^&*(ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_";function eO(r,e){const t=(1<<r)-1,n=[];let s=0,i=0,o=0;for(let a=0;a<e.length;a++)for(s=s<<6|XS.indexOf(e[a]),i+=6;i>=r;){const c=s>>i-r;s&=(1<<i-r)-1,i-=r,c===0?o+=t:(n.push(c+o),o=0)}return n}function tO(r,e){let t=FE(r).join(",");return e.split(/,/g).forEach(n=>{const s=n.match(/^([a-z]*)([0-9]+)([0-9])(.*)$/);C(s!==null,"internal error parsing accents","accents",e);let i=0;const o=eO(parseInt(s[3]),s[4]),a=parseInt(s[2]),c=new RegExp(`([${s[1]}])`,"g");t=t.replace(c,(l,u)=>(--o[i]===0&&(u=String.fromCharCode(u.charCodeAt(0),a),i++),u))}),t.split(",")}var sf;class rO extends uy{constructor(t,n,s,i){super(t,n,i);M(this,sf);S(this,sf,s)}get _accent(){return b(this,sf)}_decodeWords(){return tO(this._data,this._accent)}}sf=new WeakMap;const nO={en:$s.wordlist()},sO=Object.freeze(Object.defineProperty({__proto__:null,AbiCoder:ra,AbstractProvider:Pu,AbstractSigner:gf,AlchemyProvider:Tu,AnkrProvider:Cu,BaseContract:ol,BaseWallet:_u,Block:aE,BlockscoutProvider:Jh,BrowserProvider:Ru,ChainstackProvider:Nu,CloudflareProvider:PE,ConstructorFragment:Vn,Contract:ki,ContractEventPayload:fE,ContractFactory:sy,ContractTransactionReceipt:uE,ContractTransactionResponse:jd,ContractUnknownEventPayload:ty,EnsPlugin:pf,EnsResolver:Iu,ErrorDescription:iE,ErrorFragment:Ft,EtherSymbol:m9,EtherscanPlugin:cy,EtherscanProvider:TE,EventFragment:dn,EventLog:Md,EventPayload:Tb,FallbackFragment:zn,FallbackProvider:kE,FeeData:rg,FeeDataNetworkPlugin:ig,FetchCancelSignal:l3,FetchRequest:pt,FetchResponse:Ds,FetchUrlFeeDataNetworkPlugin:vE,FixedNumber:bu,Fragment:Fi,FunctionFragment:pn,GasCostPlugin:df,HDNodeVoidWallet:ul,HDNodeWallet:Za,Indexed:tg,InfuraProvider:cl,InfuraWebSocketProvider:BE,Interface:Au,IpcSocketProvider:OS,JsonRpcApiProvider:ay,JsonRpcProvider:Vr,JsonRpcSigner:Th,LangEn:$s,Log:xl,LogDescription:nE,MaxInt256:y9,MaxUint256:g9,MessagePrefix:y8,MinInt256:b9,Mnemonic:sa,MulticoinProviderPlugin:mE,N:d9,NamedFragment:ff,Network:He,NetworkPlugin:Gi,NonceManager:Eg,ParamType:dt,PocketProvider:Yh,QuickNodeProvider:Du,Result:Xo,Signature:zt,SigningKey:bn,SocketBlockSubscriber:NE,SocketEventSubscriber:RE,SocketPendingSubscriber:DE,SocketProvider:_E,SocketSubscriber:Hd,StructFragment:Bi,Transaction:ea,TransactionDescription:sE,TransactionReceipt:Xb,TransactionResponse:il,Typed:At,TypedDataEncoder:Li,UndecodedEventLog:ey,UnmanagedSubscriber:Ou,Utf8ErrorFuncs:n3,VoidSigner:Qh,Wallet:Cg,WebSocketProvider:ly,WeiPerEther:p9,Wordlist:ME,WordlistOwl:uy,WordlistOwlA:rO,ZeroAddress:tl,ZeroHash:Wp,accessListify:Hs,assert:z,assertArgument:C,assertArgumentCount:Ob,assertNormalize:Pb,assertPrivate:js,authorizationify:Vb,checkResultErrors:DA,computeAddress:yl,computeHmac:zi,concat:me,copyRequest:sl,dataLength:_i,dataSlice:ke,decodeBase58:X2,decodeBase64:e3,decodeBytes32String:mI,decodeRlp:gl,decryptCrowdsaleJson:Pg,decryptKeystoreJson:GE,decryptKeystoreJsonSync:KE,defaultPath:Rh,defineProperties:te,dnsEncode:H8,encodeBase58:Cb,encodeBase64:t3,encodeBytes32String:yI,encodeRlp:Xn,encryptKeystoreJson:py,encryptKeystoreJsonSync:dy,ensNormalize:z8,formatEther:$p,formatUnits:Nb,fromTwos:gu,getAccountPath:YS,getAddress:ce,getBigInt:re,getBytes:Q,getBytesCopy:ut,getCreate2Address:S9,getCreateAddress:Hb,getDefaultProvider:AS,getIcapAddress:I9,getIndexedAccountPath:ZS,getNumber:ae,getUint:af,hashAuthorization:Kb,hashMessage:Yb,hexlify:K,id:es,isAddress:O9,isAddressable:qb,isBytesLike:of,isCallException:Pd,isCrowdsaleJson:Og,isError:Qe,isHexString:De,isKeystoreJson:Ag,isValidName:z7,keccak256:Ne,lock:x9,makeError:Be,mask:Di,namehash:Gh,parseEther:TA,parseUnits:iu,pbkdf2:rs,randomBytes:qr,recoverAddress:uf,resolveAddress:nt,resolveProperties:ct,ripemd160:Hi,scrypt:qi,scryptSync:Vi,sha256:Vt,sha512:cf,showThrottleMessage:Wi,solidityPacked:Zb,solidityPackedKeccak256:G7,solidityPackedSha256:W7,stripZerosLeft:hA,toBeArray:Fe,toBeHex:Zn,toBigInt:pl,toNumber:Z2,toQuantity:xr,toTwos:Nd,toUtf8Bytes:st,toUtf8CodePoints:mA,toUtf8String:$i,uuidV4:d3,verifyAuthorization:i7,verifyMessage:H7,verifyTypedData:tI,version:Sb,wordlists:nO,zeroPadBytes:Cd,zeroPadValue:vr},Symbol.toStringTag,{value:"Module"})),iO="modulepreload",oO=function(r){return"/build/"+r},Tx={},ZE=function(e,t,n){let s=Promise.resolve();if(t&&t.length>0){let o=function(l){return Promise.all(l.map(u=>Promise.resolve(u).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),c=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=o(t.map(l=>{if(l=oO(l),l in Tx)return;Tx[l]=!0;const u=l.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${f}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":iO,u||(h.as="script"),h.crossOrigin="",h.href=l,c&&h.setAttribute("nonce",c),document.head.appendChild(h),u)return new Promise((d,p)=>{h.addEventListener("load",d),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})};var Hn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function gy(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function aO(r){if(Object.prototype.hasOwnProperty.call(r,"__esModule"))return r;var e=r.default;if(typeof e=="function"){var t=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var s=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(t,n,s.get?s:{enumerable:!0,get:function(){return r[n]}})}),t}var Jf={exports:{}},Nx;function cO(){if(Nx)return Jf.exports;Nx=1;var r=typeof Reflect=="object"?Reflect:null,e=r&&typeof r.apply=="function"?r.apply:function(I,E,P){return Function.prototype.apply.call(I,E,P)},t;r&&typeof r.ownKeys=="function"?t=r.ownKeys:Object.getOwnPropertySymbols?t=function(I){return Object.getOwnPropertyNames(I).concat(Object.getOwnPropertySymbols(I))}:t=function(I){return Object.getOwnPropertyNames(I)};function n(O){console&&console.warn&&console.warn(O)}var s=Number.isNaN||function(I){return I!==I};function i(){i.init.call(this)}Jf.exports=i,Jf.exports.once=x,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var o=10;function a(O){if(typeof O!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof O)}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(O){if(typeof O!="number"||O<0||s(O))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+O+".");o=O}}),i.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(I){if(typeof I!="number"||I<0||s(I))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+I+".");return this._maxListeners=I,this};function c(O){return O._maxListeners===void 0?i.defaultMaxListeners:O._maxListeners}i.prototype.getMaxListeners=function(){return c(this)},i.prototype.emit=function(I){for(var E=[],P=1;P<arguments.length;P++)E.push(arguments[P]);var T=I==="error",D=this._events;if(D!==void 0)T=T&&D.error===void 0;else if(!T)return!1;if(T){var F;if(E.length>0&&(F=E[0]),F instanceof Error)throw F;var j=new Error("Unhandled error."+(F?" ("+F.message+")":""));throw j.context=F,j}var L=D[I];if(L===void 0)return!1;if(typeof L=="function")e(L,this,E);else for(var U=L.length,_=p(L,U),P=0;P<U;++P)e(_[P],this,E);return!0};function l(O,I,E,P){var T,D,F;if(a(E),D=O._events,D===void 0?(D=O._events=Object.create(null),O._eventsCount=0):(D.newListener!==void 0&&(O.emit("newListener",I,E.listener?E.listener:E),D=O._events),F=D[I]),F===void 0)F=D[I]=E,++O._eventsCount;else if(typeof F=="function"?F=D[I]=P?[E,F]:[F,E]:P?F.unshift(E):F.push(E),T=c(O),T>0&&F.length>T&&!F.warned){F.warned=!0;var j=new Error("Possible EventEmitter memory leak detected. "+F.length+" "+String(I)+" listeners added. Use emitter.setMaxListeners() to increase limit");j.name="MaxListenersExceededWarning",j.emitter=O,j.type=I,j.count=F.length,n(j)}return O}i.prototype.addListener=function(I,E){return l(this,I,E,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(I,E){return l(this,I,E,!0)};function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(O,I,E){var P={fired:!1,wrapFn:void 0,target:O,type:I,listener:E},T=u.bind(P);return T.listener=E,P.wrapFn=T,T}i.prototype.once=function(I,E){return a(E),this.on(I,f(this,I,E)),this},i.prototype.prependOnceListener=function(I,E){return a(E),this.prependListener(I,f(this,I,E)),this},i.prototype.removeListener=function(I,E){var P,T,D,F,j;if(a(E),T=this._events,T===void 0)return this;if(P=T[I],P===void 0)return this;if(P===E||P.listener===E)--this._eventsCount===0?this._events=Object.create(null):(delete T[I],T.removeListener&&this.emit("removeListener",I,P.listener||E));else if(typeof P!="function"){for(D=-1,F=P.length-1;F>=0;F--)if(P[F]===E||P[F].listener===E){j=P[F].listener,D=F;break}if(D<0)return this;D===0?P.shift():g(P,D),P.length===1&&(T[I]=P[0]),T.removeListener!==void 0&&this.emit("removeListener",I,j||E)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(I){var E,P,T;if(P=this._events,P===void 0)return this;if(P.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):P[I]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete P[I]),this;if(arguments.length===0){var D=Object.keys(P),F;for(T=0;T<D.length;++T)F=D[T],F!=="removeListener"&&this.removeAllListeners(F);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(E=P[I],typeof E=="function")this.removeListener(I,E);else if(E!==void 0)for(T=E.length-1;T>=0;T--)this.removeListener(I,E[T]);return this};function h(O,I,E){var P=O._events;if(P===void 0)return[];var T=P[I];return T===void 0?[]:typeof T=="function"?E?[T.listener||T]:[T]:E?y(T):p(T,T.length)}i.prototype.listeners=function(I){return h(this,I,!0)},i.prototype.rawListeners=function(I){return h(this,I,!1)},i.listenerCount=function(O,I){return typeof O.listenerCount=="function"?O.listenerCount(I):d.call(O,I)},i.prototype.listenerCount=d;function d(O){var I=this._events;if(I!==void 0){var E=I[O];if(typeof E=="function")return 1;if(E!==void 0)return E.length}return 0}i.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]};function p(O,I){for(var E=new Array(I),P=0;P<I;++P)E[P]=O[P];return E}function g(O,I){for(;I+1<O.length;I++)O[I]=O[I+1];O.pop()}function y(O){for(var I=new Array(O.length),E=0;E<I.length;++E)I[E]=O[E].listener||O[E];return I}function x(O,I){return new Promise(function(E,P){function T(F){O.removeListener(I,D),P(F)}function D(){typeof O.removeListener=="function"&&O.removeListener("error",T),E([].slice.call(arguments))}w(O,I,D,{once:!0}),I!=="error"&&A(O,T,{once:!0})})}function A(O,I,E){typeof O.on=="function"&&w(O,"error",I,E)}function w(O,I,E,P){if(typeof O.on=="function")P.once?O.once(I,E):O.on(I,E);else if(typeof O.addEventListener=="function")O.addEventListener(I,function T(D){P.once&&O.removeEventListener(I,T),E(D)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof O)}return Jf.exports}var Ar=cO();const by=gy(Ar);var Dx=function(r,e,t){if(t||arguments.length===2)for(var n=0,s=e.length,i;n<s;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return r.concat(i||Array.prototype.slice.call(e))},lO=(function(){function r(e,t,n){this.name=e,this.version=t,this.os=n,this.type="browser"}return r})(),uO=(function(){function r(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return r})(),fO=(function(){function r(e,t,n,s){this.name=e,this.version=t,this.os=n,this.bot=s,this.type="bot-device"}return r})(),hO=(function(){function r(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return r})(),dO=(function(){function r(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return r})(),pO=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,gO=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Rx=3,bO=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",pO]],_x=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function yO(r){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new dO:typeof navigator<"u"?xO(navigator.userAgent):EO()}function mO(r){return r!==""&&bO.reduce(function(e,t){var n=t[0],s=t[1];if(e)return e;var i=s.exec(r);return!!i&&[n,i]},!1)}function xO(r){var e=mO(r);if(!e)return null;var t=e[0],n=e[1];if(t==="searchbot")return new hO;var s=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);s?s.length<Rx&&(s=Dx(Dx([],s,!0),vO(Rx-s.length),!0)):s=[];var i=s.join("."),o=wO(r),a=gO.exec(r);return a&&a[1]?new fO(t,i,o,a[1]):new lO(t,i,o)}function wO(r){for(var e=0,t=_x.length;e<t;e++){var n=_x[e],s=n[0],i=n[1],o=i.exec(r);if(o)return s}return null}function EO(){var r=typeof process<"u"&&process.version;return r?new uO(process.version.slice(1)):null}function vO(r){for(var e=[],t=0;t<r;t++)e.push("0");return e}var k0={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ng=function(r,e){return Ng=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)n.hasOwnProperty(s)&&(t[s]=n[s])},Ng(r,e)};function AO(r,e){Ng(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Dg=function(){return Dg=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Dg.apply(this,arguments)};function IO(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t}function SO(r,e,t,n){var s=arguments.length,i=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}function OO(r,e){return function(t,n){e(t,n,r)}}function PO(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function CO(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})}function TO(r,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,s&&(i=l[0]&2?s.return:l[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,l[1])).done)return i;switch(s=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,s=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){t.label=l[1];break}if(l[0]===6&&t.label<i[1]){t.label=i[1],i=l;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(l);break}i[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(r,t)}catch(u){l=[6,u],s=0}finally{n=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function NO(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}function DO(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=r[t])}function Rg(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function XE(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(t=n.return)&&t.call(n)}finally{if(o)throw o.error}}return i}function RO(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(XE(arguments[e]));return r}function _O(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),s=0,e=0;e<t;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,s++)n[s]=i[o];return n}function Bu(r){return this instanceof Bu?(this.v=r,this):new Bu(r)}function BO(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(h){n[h]&&(s[h]=function(d){return new Promise(function(p,g){i.push([h,d,p,g])>1||a(h,d)})})}function a(h,d){try{c(n[h](d))}catch(p){f(i[0][3],p)}}function c(h){h.value instanceof Bu?Promise.resolve(h.value.v).then(l,u):f(i[0][2],h)}function l(h){a("next",h)}function u(h){a("throw",h)}function f(h,d){h(d),i.shift(),i.length&&a(i[0][0],i[0][1])}}function kO(r){var e,t;return e={},n("next"),n("throw",function(s){throw s}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(s,i){e[s]=r[s]?function(o){return(t=!t)?{value:Bu(r[s](o)),done:s==="return"}:i?i(o):o}:i}}function UO(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof Rg=="function"?Rg(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=r[i]&&function(o){return new Promise(function(a,c){o=r[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}}function $O(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}function LO(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function FO(r){return r&&r.__esModule?r:{default:r}}function MO(r,e){if(!e.has(r))throw new TypeError("attempted to get private field on non-instance");return e.get(r)}function jO(r,e,t){if(!e.has(r))throw new TypeError("attempted to set private field on non-instance");return e.set(r,t),t}const zO=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Dg},__asyncDelegator:kO,__asyncGenerator:BO,__asyncValues:UO,__await:Bu,__awaiter:CO,__classPrivateFieldGet:MO,__classPrivateFieldSet:jO,__createBinding:NO,__decorate:SO,__exportStar:DO,__extends:AO,__generator:TO,__importDefault:FO,__importStar:LO,__makeTemplateObject:$O,__metadata:PO,__param:OO,__read:XE,__rest:IO,__spread:RO,__spreadArrays:_O,__values:Rg},Symbol.toStringTag,{value:"Module"})),yf=aO(zO);var U0={},Tl={},Bx;function HO(){if(Bx)return Tl;Bx=1,Object.defineProperty(Tl,"__esModule",{value:!0}),Tl.delay=void 0;function r(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return Tl.delay=r,Tl}var Xi={},$0={},eo={},kx;function qO(){return kx||(kx=1,Object.defineProperty(eo,"__esModule",{value:!0}),eo.ONE_THOUSAND=eo.ONE_HUNDRED=void 0,eo.ONE_HUNDRED=100,eo.ONE_THOUSAND=1e3),eo}var L0={},Ux;function VO(){return Ux||(Ux=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ONE_YEAR=r.FOUR_WEEKS=r.THREE_WEEKS=r.TWO_WEEKS=r.ONE_WEEK=r.THIRTY_DAYS=r.SEVEN_DAYS=r.FIVE_DAYS=r.THREE_DAYS=r.ONE_DAY=r.TWENTY_FOUR_HOURS=r.TWELVE_HOURS=r.SIX_HOURS=r.THREE_HOURS=r.ONE_HOUR=r.SIXTY_MINUTES=r.THIRTY_MINUTES=r.TEN_MINUTES=r.FIVE_MINUTES=r.ONE_MINUTE=r.SIXTY_SECONDS=r.THIRTY_SECONDS=r.TEN_SECONDS=r.FIVE_SECONDS=r.ONE_SECOND=void 0,r.ONE_SECOND=1,r.FIVE_SECONDS=5,r.TEN_SECONDS=10,r.THIRTY_SECONDS=30,r.SIXTY_SECONDS=60,r.ONE_MINUTE=r.SIXTY_SECONDS,r.FIVE_MINUTES=r.ONE_MINUTE*5,r.TEN_MINUTES=r.ONE_MINUTE*10,r.THIRTY_MINUTES=r.ONE_MINUTE*30,r.SIXTY_MINUTES=r.ONE_MINUTE*60,r.ONE_HOUR=r.SIXTY_MINUTES,r.THREE_HOURS=r.ONE_HOUR*3,r.SIX_HOURS=r.ONE_HOUR*6,r.TWELVE_HOURS=r.ONE_HOUR*12,r.TWENTY_FOUR_HOURS=r.ONE_HOUR*24,r.ONE_DAY=r.TWENTY_FOUR_HOURS,r.THREE_DAYS=r.ONE_DAY*3,r.FIVE_DAYS=r.ONE_DAY*5,r.SEVEN_DAYS=r.ONE_DAY*7,r.THIRTY_DAYS=r.ONE_DAY*30,r.ONE_WEEK=r.SEVEN_DAYS,r.TWO_WEEKS=r.ONE_WEEK*2,r.THREE_WEEKS=r.ONE_WEEK*3,r.FOUR_WEEKS=r.ONE_WEEK*4,r.ONE_YEAR=r.ONE_DAY*365})(L0)),L0}var $x;function ev(){return $x||($x=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=yf;e.__exportStar(qO(),r),e.__exportStar(VO(),r)})($0)),$0}var Lx;function KO(){if(Lx)return Xi;Lx=1,Object.defineProperty(Xi,"__esModule",{value:!0}),Xi.fromMiliseconds=Xi.toMiliseconds=void 0;const r=ev();function e(n){return n*r.ONE_THOUSAND}Xi.toMiliseconds=e;function t(n){return Math.floor(n/r.ONE_THOUSAND)}return Xi.fromMiliseconds=t,Xi}var Fx;function GO(){return Fx||(Fx=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=yf;e.__exportStar(HO(),r),e.__exportStar(KO(),r)})(U0)),U0}var Ia={},Mx;function WO(){if(Mx)return Ia;Mx=1,Object.defineProperty(Ia,"__esModule",{value:!0}),Ia.Watch=void 0;class r{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const n=this.get(t);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const s=Date.now()-n.started;this.timestamps.set(t,{started:n.started,elapsed:s})}get(t){const n=this.timestamps.get(t);if(typeof n>"u")throw new Error(`No timestamp found for label: ${t}`);return n}elapsed(t){const n=this.get(t);return n.elapsed||Date.now()-n.started}}return Ia.Watch=r,Ia.default=r,Ia}var F0={},Nl={},jx;function QO(){if(jx)return Nl;jx=1,Object.defineProperty(Nl,"__esModule",{value:!0}),Nl.IWatch=void 0;class r{}return Nl.IWatch=r,Nl}var zx;function JO(){return zx||(zx=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),yf.__exportStar(QO(),r)})(F0)),F0}var Hx;function YO(){return Hx||(Hx=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=yf;e.__exportStar(GO(),r),e.__exportStar(WO(),r),e.__exportStar(JO(),r),e.__exportStar(ev(),r)})(k0)),k0}var Z=YO(),Re={},qx;function tv(){if(qx)return Re;qx=1,Object.defineProperty(Re,"__esModule",{value:!0}),Re.getLocalStorage=Re.getLocalStorageOrThrow=Re.getCrypto=Re.getCryptoOrThrow=Re.getLocation=Re.getLocationOrThrow=Re.getNavigator=Re.getNavigatorOrThrow=Re.getDocument=Re.getDocumentOrThrow=Re.getFromWindowOrThrow=Re.getFromWindow=void 0;function r(h){let d;return typeof window<"u"&&typeof window[h]<"u"&&(d=window[h]),d}Re.getFromWindow=r;function e(h){const d=r(h);if(!d)throw new Error(`${h} is not defined in Window`);return d}Re.getFromWindowOrThrow=e;function t(){return e("document")}Re.getDocumentOrThrow=t;function n(){return r("document")}Re.getDocument=n;function s(){return e("navigator")}Re.getNavigatorOrThrow=s;function i(){return r("navigator")}Re.getNavigator=i;function o(){return e("location")}Re.getLocationOrThrow=o;function a(){return r("location")}Re.getLocation=a;function c(){return e("crypto")}Re.getCryptoOrThrow=c;function l(){return r("crypto")}Re.getCrypto=l;function u(){return e("localStorage")}Re.getLocalStorageOrThrow=u;function f(){return r("localStorage")}return Re.getLocalStorage=f,Re}var Ls=tv(),Dl={},Vx;function ZO(){if(Vx)return Dl;Vx=1,Object.defineProperty(Dl,"__esModule",{value:!0}),Dl.getWindowMetadata=void 0;const r=tv();function e(){let t,n;try{t=r.getDocumentOrThrow(),n=r.getLocationOrThrow()}catch{return null}function s(){const d=t.getElementsByTagName("link"),p=[];for(let g=0;g<d.length;g++){const y=d[g],x=y.getAttribute("rel");if(x&&x.toLowerCase().indexOf("icon")>-1){const A=y.getAttribute("href");if(A)if(A.toLowerCase().indexOf("https:")===-1&&A.toLowerCase().indexOf("http:")===-1&&A.indexOf("//")!==0){let w=n.protocol+"//"+n.host;if(A.indexOf("/")===0)w+=A;else{const O=n.pathname.split("/");O.pop();const I=O.join("/");w+=I+"/"+A}p.push(w)}else if(A.indexOf("//")===0){const w=n.protocol+A;p.push(w)}else p.push(A)}}return p}function i(...d){const p=t.getElementsByTagName("meta");for(let g=0;g<p.length;g++){const y=p[g],x=["itemprop","property","name"].map(A=>y.getAttribute(A)).filter(A=>A?d.includes(A):!1);if(x.length&&x){const A=y.getAttribute("content");if(A)return A}}return""}function o(){let d=i("name","og:site_name","og:title","twitter:title");return d||(d=t.title),d}function a(){return i("description","og:description","twitter:description","keywords")}const c=o(),l=a(),u=n.origin,f=s();return{description:l,url:u,icons:f,name:c}}return Dl.getWindowMetadata=e,Dl}var XO=ZO();function ku(r,{strict:e=!0}={}){return!r||typeof r!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(r):r.startsWith("0x")}function _g(r){return ku(r,{strict:!1})?Math.ceil((r.length-2)/2):r.length}const rv="2.36.0";let Rl={getDocsUrl:({docsBaseUrl:r,docsPath:e="",docsSlug:t})=>e?`${r??"https://viem.sh"}${e}${t?`#${t}`:""}`:void 0,version:`viem@${rv}`};class ia extends Error{constructor(e,t={}){var a;const n=(()=>{var c;return t.cause instanceof ia?t.cause.details:(c=t.cause)!=null&&c.message?t.cause.message:t.details})(),s=t.cause instanceof ia&&t.cause.docsPath||t.docsPath,i=(a=Rl.getDocsUrl)==null?void 0:a.call(Rl,{...t,docsPath:s}),o=[e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...n?[`Details: ${n}`]:[],...Rl.version?[`Version: ${Rl.version}`]:[]].join(`
`);super(o,t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=n,this.docsPath=s,this.metaMessages=t.metaMessages,this.name=t.name??this.name,this.shortMessage=e,this.version=rv}walk(e){return nv(this,e)}}function nv(r,e){return e!=null&&e(r)?r:r&&typeof r=="object"&&"cause"in r&&r.cause!==void 0?nv(r.cause,e):e?null:r}class sv extends ia{constructor({size:e,targetSize:t,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (${e}) exceeds padding size (${t}).`,{name:"SizeExceedsPaddingSizeError"})}}function wl(r,{dir:e,size:t=32}={}){return typeof r=="string"?eP(r,{dir:e,size:t}):tP(r,{dir:e,size:t})}function eP(r,{dir:e,size:t=32}={}){if(t===null)return r;const n=r.replace("0x","");if(n.length>t*2)throw new sv({size:Math.ceil(n.length/2),targetSize:t,type:"hex"});return`0x${n[e==="right"?"padEnd":"padStart"](t*2,"0")}`}function tP(r,{dir:e,size:t=32}={}){if(t===null)return r;if(r.length>t)throw new sv({size:r.length,targetSize:t,type:"bytes"});const n=new Uint8Array(t);for(let s=0;s<t;s++){const i=e==="right";n[i?s:t-s-1]=r[i?s:r.length-s-1]}return n}class rP extends ia{constructor({max:e,min:t,signed:n,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${n?"signed":"unsigned"} `:""}integer range ${e?`(${t} to ${e})`:`(above ${t})`}`,{name:"IntegerOutOfRangeError"})}}class nP extends ia{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed ${t} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}function El(r,{size:e}){if(_g(r)>e)throw new nP({givenSize:_g(r),maxSize:e})}function Bg(r,e={}){const{signed:t}=e;e.size&&El(r,{size:e.size});const n=BigInt(r);if(!t)return n;const s=(r.length-2)/2,i=(1n<<BigInt(s)*8n-1n)-1n;return n<=i?n:n-BigInt(`0x${"f".padStart(s*2,"f")}`)-1n}function sP(r,e={}){return Number(Bg(r,e))}const iP=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function kg(r,e={}){return typeof r=="number"||typeof r=="bigint"?ov(r,e):typeof r=="string"?cP(r,e):typeof r=="boolean"?oP(r,e):iv(r,e)}function oP(r,e={}){const t=`0x${Number(r)}`;return typeof e.size=="number"?(El(t,{size:e.size}),wl(t,{size:e.size})):t}function iv(r,e={}){let t="";for(let s=0;s<r.length;s++)t+=iP[r[s]];const n=`0x${t}`;return typeof e.size=="number"?(El(n,{size:e.size}),wl(n,{dir:"right",size:e.size})):n}function ov(r,e={}){const{signed:t,size:n}=e,s=BigInt(r);let i;n?t?i=(1n<<BigInt(n)*8n-1n)-1n:i=2n**(BigInt(n)*8n)-1n:typeof r=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&t?-i-1n:0;if(i&&s>i||s<o){const c=typeof r=="bigint"?"n":"";throw new rP({max:i?`${i}${c}`:void 0,min:`${o}${c}`,signed:t,size:n,value:`${r}${c}`})}const a=`0x${(t&&s<0?(1n<<BigInt(n*8))+BigInt(s):s).toString(16)}`;return n?wl(a,{size:n}):a}const aP=new TextEncoder;function cP(r,e={}){const t=aP.encode(r);return iv(t,e)}const lP=new TextEncoder;function uP(r,e={}){return typeof r=="number"||typeof r=="bigint"?hP(r,e):typeof r=="boolean"?fP(r,e):ku(r)?av(r,e):cv(r,e)}function fP(r,e={}){const t=new Uint8Array(1);return t[0]=Number(r),typeof e.size=="number"?(El(t,{size:e.size}),wl(t,{size:e.size})):t}const ns={zero:48,nine:57,A:65,F:70,a:97,f:102};function Kx(r){if(r>=ns.zero&&r<=ns.nine)return r-ns.zero;if(r>=ns.A&&r<=ns.F)return r-(ns.A-10);if(r>=ns.a&&r<=ns.f)return r-(ns.a-10)}function av(r,e={}){let t=r;e.size&&(El(t,{size:e.size}),t=wl(t,{dir:"right",size:e.size}));let n=t.slice(2);n.length%2&&(n=`0${n}`);const s=n.length/2,i=new Uint8Array(s);for(let o=0,a=0;o<s;o++){const c=Kx(n.charCodeAt(a++)),l=Kx(n.charCodeAt(a++));if(c===void 0||l===void 0)throw new ia(`Invalid byte sequence ("${n[a-2]}${n[a-1]}" in "${n}").`);i[o]=c*16+l}return i}function hP(r,e){const t=ov(r,e);return av(t)}function cv(r,e={}){const t=lP.encode(r);return typeof e.size=="number"?(El(t,{size:e.size}),wl(t,{dir:"right",size:e.size})):t}const Yf=BigInt(2**32-1),Gx=BigInt(32);function dP(r,e=!1){return e?{h:Number(r&Yf),l:Number(r>>Gx&Yf)}:{h:Number(r>>Gx&Yf)|0,l:Number(r&Yf)|0}}function pP(r,e=!1){const t=r.length;let n=new Uint32Array(t),s=new Uint32Array(t);for(let i=0;i<t;i++){const{h:o,l:a}=dP(r[i],e);[n[i],s[i]]=[o,a]}return[n,s]}const gP=(r,e,t)=>r<<t|e>>>32-t,bP=(r,e,t)=>e<<t|r>>>32-t,yP=(r,e,t)=>e<<t-32|r>>>64-t,mP=(r,e,t)=>r<<t-32|e>>>64-t,Sa=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function xP(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function td(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function fl(r,...e){if(!xP(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function uV(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");td(r.outputLen),td(r.blockLen)}function Wx(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function wP(r,e){fl(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}function EP(r){return new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4))}function lv(...r){for(let e=0;e<r.length;e++)r[e].fill(0)}function fV(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function hV(r,e){return r<<32-e|r>>>e}const vP=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function AP(r){return r<<24&4278190080|r<<8&16711680|r>>>8&65280|r>>>24&255}function IP(r){for(let e=0;e<r.length;e++)r[e]=AP(r[e]);return r}const Qx=vP?r=>r:IP,uv=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",SP=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function dV(r){if(fl(r),uv)return r.toHex();let e="";for(let t=0;t<r.length;t++)e+=SP[r[t]];return e}const ss={_0:48,_9:57,A:65,F:70,a:97,f:102};function Jx(r){if(r>=ss._0&&r<=ss._9)return r-ss._0;if(r>=ss.A&&r<=ss.F)return r-(ss.A-10);if(r>=ss.a&&r<=ss.f)return r-(ss.a-10)}function pV(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);if(uv)return Uint8Array.fromHex(r);const e=r.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(t);for(let s=0,i=0;s<t;s++,i+=2){const o=Jx(r.charCodeAt(i)),a=Jx(r.charCodeAt(i+1));if(o===void 0||a===void 0){const c=r[i]+r[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}n[s]=o*16+a}return n}function OP(r){if(typeof r!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(r))}function fv(r){return typeof r=="string"&&(r=OP(r)),fl(r),r}function gV(...r){let e=0;for(let n=0;n<r.length;n++){const s=r[n];fl(s),e+=s.length}const t=new Uint8Array(e);for(let n=0,s=0;n<r.length;n++){const i=r[n];t.set(i,s),s+=i.length}return t}class PP{}function CP(r){const e=n=>r().update(fv(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function bV(r=32){if(Sa&&typeof Sa.getRandomValues=="function")return Sa.getRandomValues(new Uint8Array(r));if(Sa&&typeof Sa.randomBytes=="function")return Uint8Array.from(Sa.randomBytes(r));throw new Error("crypto.getRandomValues must be defined")}const TP=BigInt(0),_l=BigInt(1),NP=BigInt(2),DP=BigInt(7),RP=BigInt(256),_P=BigInt(113),hv=[],dv=[],pv=[];for(let r=0,e=_l,t=1,n=0;r<24;r++){[t,n]=[n,(2*t+3*n)%5],hv.push(2*(5*n+t)),dv.push((r+1)*(r+2)/2%64);let s=TP;for(let i=0;i<7;i++)e=(e<<_l^(e>>DP)*_P)%RP,e&NP&&(s^=_l<<(_l<<BigInt(i))-_l);pv.push(s)}const gv=pP(pv,!0),BP=gv[0],kP=gv[1],Yx=(r,e,t)=>t>32?yP(r,e,t):gP(r,e,t),Zx=(r,e,t)=>t>32?mP(r,e,t):bP(r,e,t);function UP(r,e=24){const t=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)t[o]=r[o]^r[o+10]^r[o+20]^r[o+30]^r[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=t[c],u=t[c+1],f=Yx(l,u,1)^t[a],h=Zx(l,u,1)^t[a+1];for(let d=0;d<50;d+=10)r[o+d]^=f,r[o+d+1]^=h}let s=r[2],i=r[3];for(let o=0;o<24;o++){const a=dv[o],c=Yx(s,i,a),l=Zx(s,i,a),u=hv[o];s=r[u],i=r[u+1],r[u]=c,r[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=r[o+a];for(let a=0;a<10;a++)r[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}r[0]^=BP[n],r[1]^=kP[n]}lv(t)}class yy extends PP{constructor(e,t,n,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=s,this.rounds=i,td(n),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=EP(this.state)}clone(){return this._cloneInto()}keccak(){Qx(this.state32),UP(this.state32,this.rounds),Qx(this.state32),this.posOut=0,this.pos=0}update(e){Wx(this),e=fv(e),fl(e);const{blockLen:t,state:n}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(t-this.pos,s-i);for(let a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:s}=this;e[n]^=t,(t&128)!==0&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Wx(this,!1),fl(e),this.finish();const t=this.state,{blockLen:n}=this;for(let s=0,i=e.length;s<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-s);e.set(t.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return td(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(wP(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,lv(this.state)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new yy(t,n,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}}const $P=(r,e,t)=>CP(()=>new yy(e,r,t)),LP=$P(1,136,256/8);function bv(r,e){const t=e||"hex",n=LP(ku(r,{strict:!1})?uP(r):r);return t==="bytes"?n:kg(n)}class FP extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const t=super.get(e);return super.has(e)&&t!==void 0&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){const n=this.keys().next().value;n&&this.delete(n)}return this}}const M0=new FP(8192);function MP(r,e){if(M0.has(`${r}.${e}`))return M0.get(`${r}.${e}`);const t=r.substring(2).toLowerCase(),n=bv(cv(t),"bytes"),s=t.split("");for(let o=0;o<40;o+=2)n[o>>1]>>4>=8&&s[o]&&(s[o]=s[o].toUpperCase()),(n[o>>1]&15)>=8&&s[o+1]&&(s[o+1]=s[o+1].toUpperCase());const i=`0x${s.join("")}`;return M0.set(`${r}.${e}`,i),i}function jP(r){const e=bv(`0x${r.substring(4)}`).substring(26);return MP(`0x${e}`)}async function zP({hash:r,signature:e}){const t=ku(r)?r:kg(r),{secp256k1:n}=await ZE(async()=>{const{secp256k1:o}=await import("./secp256k1-DOub27A4.js");return{secp256k1:o}},[]);return`0x${(()=>{if(typeof e=="object"&&"r"in e&&"s"in e){const{r:l,s:u,v:f,yParity:h}=e,d=Number(h??f),p=Xx(d);return new n.Signature(Bg(l),Bg(u)).addRecoveryBit(p)}const o=ku(e)?e:kg(e);if(_g(o)!==65)throw new Error("invalid signature length");const a=sP(`0x${o.slice(130)}`),c=Xx(a);return n.Signature.fromCompact(o.substring(2,130)).addRecoveryBit(c)})().recoverPublicKey(t.substring(2)).toHex(!1)}`}function Xx(r){if(r===0||r===1)return r;if(r===27)return 0;if(r===28)return 1;throw new Error("Invalid yParityOrV value")}async function HP({hash:r,signature:e}){return jP(await zP({hash:r,signature:e}))}function qP(r){if(r.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let l=0;l<e.length;l++)e[l]=255;for(let l=0;l<r.length;l++){const u=r.charAt(l),f=u.charCodeAt(0);if(e[f]!==255)throw new TypeError(u+" is ambiguous");e[f]=l}const t=r.length,n=r.charAt(0),s=Math.log(t)/Math.log(256),i=Math.log(256)/Math.log(t);function o(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";let u=0,f=0,h=0;const d=l.length;for(;h!==d&&l[h]===0;)h++,u++;const p=(d-h)*i+1>>>0,g=new Uint8Array(p);for(;h!==d;){let A=l[h],w=0;for(let O=p-1;(A!==0||w<f)&&O!==-1;O--,w++)A+=256*g[O]>>>0,g[O]=A%t>>>0,A=A/t>>>0;if(A!==0)throw new Error("Non-zero carry");f=w,h++}let y=p-f;for(;y!==p&&g[y]===0;)y++;let x=n.repeat(u);for(;y<p;++y)x+=r.charAt(g[y]);return x}function a(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;let u=0,f=0,h=0;for(;l[u]===n;)f++,u++;const d=(l.length-u)*s+1>>>0,p=new Uint8Array(d);for(;u<l.length;){const A=l.charCodeAt(u);if(A>255)return;let w=e[A];if(w===255)return;let O=0;for(let I=d-1;(w!==0||O<h)&&I!==-1;I--,O++)w+=t*p[I]>>>0,p[I]=w%256>>>0,w=w/256>>>0;if(w!==0)throw new Error("Non-zero carry");h=O,u++}let g=d-h;for(;g!==d&&p[g]===0;)g++;const y=new Uint8Array(f+(d-g));let x=f;for(;g!==d;)y[x++]=p[g++];return y}function c(l){const u=a(l);if(u)return u;throw new Error("Non-base"+t+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var VP="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const mf=qP(VP);function KP(r){const e=r.length;let t=0,n=0;for(;n<e;){let s=r.charCodeAt(n++);if((s&4294967168)===0){t++;continue}else if((s&4294965248)===0)t+=2;else{if(s>=55296&&s<=56319&&n<e){const i=r.charCodeAt(n);(i&64512)===56320&&(++n,s=((s&1023)<<10)+(i&1023)+65536)}(s&4294901760)===0?t+=3:t+=4}}return t}function GP(r,e,t){const n=r.length;let s=t,i=0;for(;i<n;){let o=r.charCodeAt(i++);if((o&4294967168)===0){e[s++]=o;continue}else if((o&4294965248)===0)e[s++]=o>>6&31|192;else{if(o>=55296&&o<=56319&&i<n){const a=r.charCodeAt(i);(a&64512)===56320&&(++i,o=((o&1023)<<10)+(a&1023)+65536)}(o&4294901760)===0?(e[s++]=o>>12&15|224,e[s++]=o>>6&63|128):(e[s++]=o>>18&7|240,e[s++]=o>>12&63|128,e[s++]=o>>6&63|128)}e[s++]=o&63|128}}const WP=new TextEncoder,QP=50;function JP(r,e,t){WP.encodeInto(r,e.subarray(t))}function YP(r,e,t){r.length>QP?JP(r,e,t):GP(r,e,t)}const ZP=4096;function yv(r,e,t){let n=e;const s=n+t,i=[];let o="";for(;n<s;){const a=r[n++];if((a&128)===0)i.push(a);else if((a&224)===192){const c=r[n++]&63;i.push((a&31)<<6|c)}else if((a&240)===224){const c=r[n++]&63,l=r[n++]&63;i.push((a&31)<<12|c<<6|l)}else if((a&248)===240){const c=r[n++]&63,l=r[n++]&63,u=r[n++]&63;let f=(a&7)<<18|c<<12|l<<6|u;f>65535&&(f-=65536,i.push(f>>>10&1023|55296),f=56320|f&1023),i.push(f)}else i.push(a);i.length>=ZP&&(o+=String.fromCharCode(...i),i.length=0)}return i.length>0&&(o+=String.fromCharCode(...i)),o}const XP=new TextDecoder,eC=200;function tC(r,e,t){const n=r.subarray(e,e+t);return XP.decode(n)}function rC(r,e,t){return t>eC?tC(r,e,t):yv(r,e,t)}class Zf{constructor(e,t){this.type=e,this.data=t}}class yr extends Error{constructor(e){super(e);const t=Object.create(yr.prototype);Object.setPrototypeOf(this,t),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:yr.name})}}const Bl=4294967295;function nC(r,e,t){const n=t/4294967296,s=t;r.setUint32(e,n),r.setUint32(e+4,s)}function mv(r,e,t){const n=Math.floor(t/4294967296),s=t;r.setUint32(e,n),r.setUint32(e+4,s)}function xv(r,e){const t=r.getInt32(e),n=r.getUint32(e+4);return t*4294967296+n}function sC(r,e){const t=r.getUint32(e),n=r.getUint32(e+4);return t*4294967296+n}const iC=-1,oC=4294967296-1,aC=17179869184-1;function cC({sec:r,nsec:e}){if(r>=0&&e>=0&&r<=aC)if(e===0&&r<=oC){const t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,r),t}else{const t=r/4294967296,n=r&4294967295,s=new Uint8Array(8),i=new DataView(s.buffer);return i.setUint32(0,e<<2|t&3),i.setUint32(4,n),s}else{const t=new Uint8Array(12),n=new DataView(t.buffer);return n.setUint32(0,e),mv(n,4,r),t}}function lC(r){const e=r.getTime(),t=Math.floor(e/1e3),n=(e-t*1e3)*1e6,s=Math.floor(n/1e9);return{sec:t+s,nsec:n-s*1e9}}function uC(r){if(r instanceof Date){const e=lC(r);return cC(e)}else return null}function fC(r){const e=new DataView(r.buffer,r.byteOffset,r.byteLength);switch(r.byteLength){case 4:return{sec:e.getUint32(0),nsec:0};case 8:{const t=e.getUint32(0),n=e.getUint32(4),s=(t&3)*4294967296+n,i=t>>>2;return{sec:s,nsec:i}}case 12:{const t=xv(e,4),n=e.getUint32(0);return{sec:t,nsec:n}}default:throw new yr(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${r.length}`)}}function hC(r){const e=fC(r);return new Date(e.sec*1e3+e.nsec/1e6)}const dC={type:iC,encode:uC,decode:hC};class rd{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(dC)}register({type:e,encode:t,decode:n}){if(e>=0)this.encoders[e]=t,this.decoders[e]=n;else{const s=-1-e;this.builtInEncoders[s]=t,this.builtInDecoders[s]=n}}tryToEncode(e,t){for(let n=0;n<this.builtInEncoders.length;n++){const s=this.builtInEncoders[n];if(s!=null){const i=s(e,t);if(i!=null){const o=-1-n;return new Zf(o,i)}}}for(let n=0;n<this.encoders.length;n++){const s=this.encoders[n];if(s!=null){const i=s(e,t);if(i!=null){const o=n;return new Zf(o,i)}}}return e instanceof Zf?e:null}decode(e,t,n){const s=t<0?this.builtInDecoders[-1-t]:this.decoders[t];return s?s(e,t,n):new Zf(t,e)}}rd.defaultCodec=new rd;function pC(r){return r instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&r instanceof SharedArrayBuffer}function Ug(r){return r instanceof Uint8Array?r:ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):pC(r)?new Uint8Array(r):Uint8Array.from(r)}const gC=100,bC=2048;let yC=class wv{constructor(e){this.entered=!1,this.extensionCodec=(e==null?void 0:e.extensionCodec)??rd.defaultCodec,this.context=e==null?void 0:e.context,this.useBigInt64=(e==null?void 0:e.useBigInt64)??!1,this.maxDepth=(e==null?void 0:e.maxDepth)??gC,this.initialBufferSize=(e==null?void 0:e.initialBufferSize)??bC,this.sortKeys=(e==null?void 0:e.sortKeys)??!1,this.forceFloat32=(e==null?void 0:e.forceFloat32)??!1,this.ignoreUndefined=(e==null?void 0:e.ignoreUndefined)??!1,this.forceIntegerToFloat=(e==null?void 0:e.forceIntegerToFloat)??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new wv({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(e){if(this.entered)return this.clone().encodeSharedRef(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(e){if(this.entered)return this.clone().encode(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(e,t){if(t>this.maxDepth)throw new Error(`Too deep objects in depth ${t}`);e==null?this.encodeNil():typeof e=="boolean"?this.encodeBoolean(e):typeof e=="number"?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):typeof e=="string"?this.encodeString(e):this.useBigInt64&&typeof e=="bigint"?this.encodeBigInt64(e):this.encodeObject(e,t)}ensureBufferSizeToWrite(e){const t=this.pos+e;this.view.byteLength<t&&this.resizeBuffer(t*2)}resizeBuffer(e){const t=new ArrayBuffer(e),n=new Uint8Array(t),s=new DataView(t);n.set(this.bytes),this.view=s,this.bytes=n}encodeNil(){this.writeU8(192)}encodeBoolean(e){e===!1?this.writeU8(194):this.writeU8(195)}encodeNumber(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)}encodeNumberAsFloat(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}encodeBigInt64(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else if(e<4294967296)this.writeU8(219),this.writeU32(e);else throw new Error(`Too long string: ${e} bytes in UTF-8`)}encodeString(e){const n=KP(e);this.ensureBufferSizeToWrite(5+n),this.writeStringHeader(n),YP(e,this.bytes,this.pos),this.pos+=n}encodeObject(e,t){const n=this.extensionCodec.tryToEncode(e,this.context);if(n!=null)this.encodeExtension(n);else if(Array.isArray(e))this.encodeArray(e,t);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else if(typeof e=="object")this.encodeMap(e,t);else throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`)}encodeBinary(e){const t=e.byteLength;if(t<256)this.writeU8(196),this.writeU8(t);else if(t<65536)this.writeU8(197),this.writeU16(t);else if(t<4294967296)this.writeU8(198),this.writeU32(t);else throw new Error(`Too large binary: ${t}`);const n=Ug(e);this.writeU8a(n)}encodeArray(e,t){const n=e.length;if(n<16)this.writeU8(144+n);else if(n<65536)this.writeU8(220),this.writeU16(n);else if(n<4294967296)this.writeU8(221),this.writeU32(n);else throw new Error(`Too large array: ${n}`);for(const s of e)this.doEncode(s,t+1)}countWithoutUndefined(e,t){let n=0;for(const s of t)e[s]!==void 0&&n++;return n}encodeMap(e,t){const n=Object.keys(e);this.sortKeys&&n.sort();const s=this.ignoreUndefined?this.countWithoutUndefined(e,n):n.length;if(s<16)this.writeU8(128+s);else if(s<65536)this.writeU8(222),this.writeU16(s);else if(s<4294967296)this.writeU8(223),this.writeU32(s);else throw new Error(`Too large map object: ${s}`);for(const i of n){const o=e[i];this.ignoreUndefined&&o===void 0||(this.encodeString(i),this.doEncode(o,t+1))}}encodeExtension(e){if(typeof e.data=="function"){const n=e.data(this.pos+6),s=n.length;if(s>=4294967296)throw new Error(`Too large extension object: ${s}`);this.writeU8(201),this.writeU32(s),this.writeI8(e.type),this.writeU8a(n);return}const t=e.data.length;if(t===1)this.writeU8(212);else if(t===2)this.writeU8(213);else if(t===4)this.writeU8(214);else if(t===8)this.writeU8(215);else if(t===16)this.writeU8(216);else if(t<256)this.writeU8(199),this.writeU8(t);else if(t<65536)this.writeU8(200),this.writeU16(t);else if(t<4294967296)this.writeU8(201),this.writeU32(t);else throw new Error(`Too large extension object: ${t}`);this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){const t=e.length;this.ensureBufferSizeToWrite(t),this.bytes.set(e,this.pos),this.pos+=t}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){this.ensureBufferSizeToWrite(8),nC(this.view,this.pos,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),mv(this.view,this.pos,e),this.pos+=8}writeBigUint64(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8}writeBigInt64(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8}};function mC(r,e){return new yC(e).encodeSharedRef(r)}function j0(r){return`${r<0?"-":""}0x${Math.abs(r).toString(16).padStart(2,"0")}`}const xC=16,wC=16;class EC{constructor(e=xC,t=wC){this.hit=0,this.miss=0,this.maxKeyLength=e,this.maxLengthPerKey=t,this.caches=[];for(let n=0;n<this.maxKeyLength;n++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,t,n){const s=this.caches[n-1];e:for(const i of s){const o=i.bytes;for(let a=0;a<n;a++)if(o[a]!==e[t+a])continue e;return i.str}return null}store(e,t){const n=this.caches[e.length-1],s={bytes:e,str:t};n.length>=this.maxLengthPerKey?n[Math.random()*n.length|0]=s:n.push(s)}decode(e,t,n){const s=this.find(e,t,n);if(s!=null)return this.hit++,s;this.miss++;const i=yv(e,t,n),o=Uint8Array.prototype.slice.call(e,t,t+n);return this.store(o,i),i}}const $g="array",au="map_key",Ev="map_value",vC=r=>{if(typeof r=="string"||typeof r=="number")return r;throw new yr("The type of key must be string or number but "+typeof r)};class AC{constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){const t=this.getUninitializedStateFromPool();t.type=$g,t.position=0,t.size=e,t.array=new Array(e)}pushMapState(e){const t=this.getUninitializedStateFromPool();t.type=au,t.readCount=0,t.size=e,t.map={}}getUninitializedStateFromPool(){if(this.stackHeadPosition++,this.stackHeadPosition===this.stack.length){const e={type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null};this.stack.push(e)}return this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(e.type===$g){const n=e;n.size=0,n.array=void 0,n.position=0,n.type=void 0}if(e.type===au||e.type===Ev){const n=e;n.size=0,n.map=void 0,n.readCount=0,n.type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const kl=-1,my=new DataView(new ArrayBuffer(0)),IC=new Uint8Array(my.buffer);try{my.getInt8(0)}catch(r){if(!(r instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const ew=new RangeError("Insufficient data"),SC=new EC;let OC=class vv{constructor(e){this.totalPos=0,this.pos=0,this.view=my,this.bytes=IC,this.headByte=kl,this.stack=new AC,this.entered=!1,this.extensionCodec=(e==null?void 0:e.extensionCodec)??rd.defaultCodec,this.context=e==null?void 0:e.context,this.useBigInt64=(e==null?void 0:e.useBigInt64)??!1,this.rawStrings=(e==null?void 0:e.rawStrings)??!1,this.maxStrLength=(e==null?void 0:e.maxStrLength)??Bl,this.maxBinLength=(e==null?void 0:e.maxBinLength)??Bl,this.maxArrayLength=(e==null?void 0:e.maxArrayLength)??Bl,this.maxMapLength=(e==null?void 0:e.maxMapLength)??Bl,this.maxExtLength=(e==null?void 0:e.maxExtLength)??Bl,this.keyDecoder=(e==null?void 0:e.keyDecoder)!==void 0?e.keyDecoder:SC,this.mapKeyConverter=(e==null?void 0:e.mapKeyConverter)??vC}clone(){return new vv({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=kl,this.stack.reset()}setBuffer(e){const t=Ug(e);this.bytes=t,this.view=new DataView(t.buffer,t.byteOffset,t.byteLength),this.pos=0}appendBuffer(e){if(this.headByte===kl&&!this.hasRemaining(1))this.setBuffer(e);else{const t=this.bytes.subarray(this.pos),n=Ug(e),s=new Uint8Array(t.length+n.length);s.set(t),s.set(n,t.length),this.setBuffer(s)}}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){const{view:t,pos:n}=this;return new RangeError(`Extra ${t.byteLength-n} of ${t.byteLength} byte(s) found at buffer[${e}]`)}decode(e){if(this.entered)return this.clone().decode(e);try{this.entered=!0,this.reinitializeState(),this.setBuffer(e);const t=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return t}finally{this.entered=!1}}*decodeMulti(e){if(this.entered){yield*this.clone().decodeMulti(e);return}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(e){if(this.entered)return this.clone().decodeAsync(e);try{this.entered=!0;let t=!1,n;for await(const a of e){if(t)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(a);try{n=this.doDecodeSync(),t=!0}catch(c){if(!(c instanceof RangeError))throw c}this.totalPos+=this.pos}if(t){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return n}const{headByte:s,pos:i,totalPos:o}=this;throw new RangeError(`Insufficient data in parsing ${j0(s)} at ${o} (${i} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}async*decodeMultiAsync(e,t){if(this.entered){yield*this.clone().decodeMultiAsync(e,t);return}try{this.entered=!0;let n=t,s=-1;for await(const i of e){if(t&&s===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(i),n&&(s=this.readArraySize(),n=!1,this.complete());try{for(;yield this.doDecodeSync(),--s!==0;);}catch(o){if(!(o instanceof RangeError))throw o}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){e:for(;;){const e=this.readHeadByte();let t;if(e>=224)t=e-256;else if(e<192)if(e<128)t=e;else if(e<144){const s=e-128;if(s!==0){this.pushMapState(s),this.complete();continue e}else t={}}else if(e<160){const s=e-144;if(s!==0){this.pushArrayState(s),this.complete();continue e}else t=[]}else{const s=e-160;t=this.decodeString(s,0)}else if(e===192)t=null;else if(e===194)t=!1;else if(e===195)t=!0;else if(e===202)t=this.readF32();else if(e===203)t=this.readF64();else if(e===204)t=this.readU8();else if(e===205)t=this.readU16();else if(e===206)t=this.readU32();else if(e===207)this.useBigInt64?t=this.readU64AsBigInt():t=this.readU64();else if(e===208)t=this.readI8();else if(e===209)t=this.readI16();else if(e===210)t=this.readI32();else if(e===211)this.useBigInt64?t=this.readI64AsBigInt():t=this.readI64();else if(e===217){const s=this.lookU8();t=this.decodeString(s,1)}else if(e===218){const s=this.lookU16();t=this.decodeString(s,2)}else if(e===219){const s=this.lookU32();t=this.decodeString(s,4)}else if(e===220){const s=this.readU16();if(s!==0){this.pushArrayState(s),this.complete();continue e}else t=[]}else if(e===221){const s=this.readU32();if(s!==0){this.pushArrayState(s),this.complete();continue e}else t=[]}else if(e===222){const s=this.readU16();if(s!==0){this.pushMapState(s),this.complete();continue e}else t={}}else if(e===223){const s=this.readU32();if(s!==0){this.pushMapState(s),this.complete();continue e}else t={}}else if(e===196){const s=this.lookU8();t=this.decodeBinary(s,1)}else if(e===197){const s=this.lookU16();t=this.decodeBinary(s,2)}else if(e===198){const s=this.lookU32();t=this.decodeBinary(s,4)}else if(e===212)t=this.decodeExtension(1,0);else if(e===213)t=this.decodeExtension(2,0);else if(e===214)t=this.decodeExtension(4,0);else if(e===215)t=this.decodeExtension(8,0);else if(e===216)t=this.decodeExtension(16,0);else if(e===199){const s=this.lookU8();t=this.decodeExtension(s,1)}else if(e===200){const s=this.lookU16();t=this.decodeExtension(s,2)}else if(e===201){const s=this.lookU32();t=this.decodeExtension(s,4)}else throw new yr(`Unrecognized type byte: ${j0(e)}`);this.complete();const n=this.stack;for(;n.length>0;){const s=n.top();if(s.type===$g)if(s.array[s.position]=t,s.position++,s.position===s.size)t=s.array,n.release(s);else continue e;else if(s.type===au){if(t==="__proto__")throw new yr("The key __proto__ is not allowed");s.key=this.mapKeyConverter(t),s.type=Ev;continue e}else if(s.map[s.key]=t,s.readCount++,s.readCount===s.size)t=s.map,n.release(s);else{s.key=null,s.type=au;continue e}}return t}}readHeadByte(){return this.headByte===kl&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=kl}readArraySize(){const e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:{if(e<160)return e-144;throw new yr(`Unrecognized array type byte: ${j0(e)}`)}}}pushMapState(e){if(e>this.maxMapLength)throw new yr(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new yr(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,t){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,t):this.decodeBinary(e,t)}decodeUtf8String(e,t){var i;if(e>this.maxStrLength)throw new yr(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+t+e)throw ew;const n=this.pos+t;let s;return this.stateIsMapKey()&&((i=this.keyDecoder)!=null&&i.canBeCached(e))?s=this.keyDecoder.decode(this.bytes,n,e):s=rC(this.bytes,n,e),this.pos+=t+e,s}stateIsMapKey(){return this.stack.length>0?this.stack.top().type===au:!1}decodeBinary(e,t){if(e>this.maxBinLength)throw new yr(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+t))throw ew;const n=this.pos+t,s=this.bytes.subarray(n,n+e);return this.pos+=t+e,s}decodeExtension(e,t){if(e>this.maxExtLength)throw new yr(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);const n=this.view.getInt8(this.pos+t),s=this.decodeBinary(e,t+1);return this.extensionCodec.decode(s,n,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){const e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){const e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){const e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){const e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){const e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){const e=sC(this.view,this.pos);return this.pos+=8,e}readI64(){const e=xv(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){const e=this.view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){const e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){const e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){const e=this.view.getFloat64(this.pos);return this.pos+=8,e}};function PC(r,e){return new OC(e).decode(r)}/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function CC(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function Av(r,e){return Array.isArray(e)?e.length===0?!0:r?e.every(t=>typeof t=="string"):e.every(t=>Number.isSafeInteger(t)):!1}function nd(r,e){if(typeof e!="string")throw new Error(`${r}: string expected`);return!0}function xy(r){if(!Number.isSafeInteger(r))throw new Error(`invalid integer: ${r}`)}function Lg(r){if(!Array.isArray(r))throw new Error("array expected")}function sd(r,e){if(!Av(!0,e))throw new Error(`${r}: array of strings expected`)}function TC(r,e){if(!Av(!1,e))throw new Error(`${r}: array of numbers expected`)}function NC(...r){const e=i=>i,t=(i,o)=>a=>i(o(a)),n=r.map(i=>i.encode).reduceRight(t,e),s=r.map(i=>i.decode).reduce(t,e);return{encode:n,decode:s}}function DC(r){const e=typeof r=="string"?r.split(""):r,t=e.length;sd("alphabet",e);const n=new Map(e.map((s,i)=>[s,i]));return{encode:s=>(Lg(s),s.map(i=>{if(!Number.isSafeInteger(i)||i<0||i>=t)throw new Error(`alphabet.encode: digit index outside alphabet "${i}". Allowed: ${r}`);return e[i]})),decode:s=>(Lg(s),s.map(i=>{nd("alphabet.decode",i);const o=n.get(i);if(o===void 0)throw new Error(`Unknown letter: "${i}". Allowed: ${r}`);return o}))}}function RC(r=""){return nd("join",r),{encode:e=>(sd("join.decode",e),e.join(r)),decode:e=>(nd("join.decode",e),e.split(r))}}function _C(r,e="="){return xy(r),nd("padding",e),{encode(t){for(sd("padding.encode",t);t.length*r%8;)t.push(e);return t},decode(t){sd("padding.decode",t);let n=t.length;if(n*r%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;n>0&&t[n-1]===e;n--)if((n-1)*r%8===0)throw new Error("padding: invalid, string has too much padding");return t.slice(0,n)}}}const Iv=(r,e)=>e===0?r:Iv(e,r%e),id=(r,e)=>r+(e-Iv(r,e)),z0=(()=>{let r=[];for(let e=0;e<40;e++)r.push(2**e);return r})();function tw(r,e,t,n){if(Lg(r),e<=0||e>32)throw new Error(`convertRadix2: wrong from=${e}`);if(t<=0||t>32)throw new Error(`convertRadix2: wrong to=${t}`);if(id(e,t)>32)throw new Error(`convertRadix2: carry overflow from=${e} to=${t} carryBits=${id(e,t)}`);let s=0,i=0;const o=z0[e],a=z0[t]-1,c=[];for(const l of r){if(xy(l),l>=o)throw new Error(`convertRadix2: invalid data word=${l} from=${e}`);if(s=s<<e|l,i+e>32)throw new Error(`convertRadix2: carry overflow pos=${i} from=${e}`);for(i+=e;i>=t;i-=t)c.push((s>>i-t&a)>>>0);const u=z0[i];if(u===void 0)throw new Error("invalid carry");s&=u-1}if(s=s<<t-i&a,!n&&i>=e)throw new Error("Excess padding");if(!n&&s>0)throw new Error(`Non-zero padding: ${s}`);return n&&i>0&&c.push(s>>>0),c}function BC(r,e=!1){if(xy(r),r<=0||r>32)throw new Error("radix2: bits should be in (0..32]");if(id(8,r)>32||id(r,8)>32)throw new Error("radix2: carry overflow");return{encode:t=>{if(!CC(t))throw new Error("radix2.encode input should be Uint8Array");return tw(Array.from(t),8,r,!e)},decode:t=>(TC("radix2.decode",t),Uint8Array.from(tw(t,r,8,e)))}}const kC=NC(BC(5),DC("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),_C(5),RC("")),UC=r=>JSON.stringify(r,(e,t)=>typeof t=="bigint"?t.toString()+"n":t),$C=r=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=r.replace(e,'$1"$2n"$3');return JSON.parse(t,(n,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function oa(r){if(typeof r!="string")throw new Error(`Cannot safe json parse value of type ${typeof r}`);try{return $C(r)}catch{return r}}function Fs(r){return typeof r=="string"?r:UC(r)||""}function LC(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function Sv(r,...e){if(!LC(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function rw(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function FC(r,e){Sv(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}const Oa=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const H0=r=>new DataView(r.buffer,r.byteOffset,r.byteLength);function MC(r){if(typeof r!="string")throw new Error("utf8ToBytes expected string, got "+typeof r);return new Uint8Array(new TextEncoder().encode(r))}function Ov(r){return typeof r=="string"&&(r=MC(r)),Sv(r),r}let jC=class{clone(){return this._cloneInto()}};function zC(r){const e=n=>r().update(Ov(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function Pv(r=32){if(Oa&&typeof Oa.getRandomValues=="function")return Oa.getRandomValues(new Uint8Array(r));if(Oa&&typeof Oa.randomBytes=="function")return Oa.randomBytes(r);throw new Error("crypto.getRandomValues must be defined")}function HC(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i),c=n?4:0,l=n?0:4;r.setUint32(e+c,o,n),r.setUint32(e+l,a,n)}let qC=class extends jC{constructor(e,t,n,s){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=H0(this.buffer)}update(e){rw(this);const{view:t,buffer:n,blockLen:s}=this;e=Ov(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=H0(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){rw(this),FC(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let f=o;f<s;f++)t[f]=0;HC(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=H0(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let f=0;f<l;f++)a.setUint32(4*f,u[f],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%t&&e.buffer.set(n),e}};const Xf=BigInt(2**32-1),Fg=BigInt(32);function Cv(r,e=!1){return e?{h:Number(r&Xf),l:Number(r>>Fg&Xf)}:{h:Number(r>>Fg&Xf)|0,l:Number(r&Xf)|0}}function VC(r,e=!1){let t=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let s=0;s<r.length;s++){const{h:i,l:o}=Cv(r[s],e);[t[s],n[s]]=[i,o]}return[t,n]}const KC=(r,e)=>BigInt(r>>>0)<<Fg|BigInt(e>>>0),GC=(r,e,t)=>r>>>t,WC=(r,e,t)=>r<<32-t|e>>>t,QC=(r,e,t)=>r>>>t|e<<32-t,JC=(r,e,t)=>r<<32-t|e>>>t,YC=(r,e,t)=>r<<64-t|e>>>t-32,ZC=(r,e,t)=>r>>>t-32|e<<64-t,XC=(r,e)=>e,eT=(r,e)=>r,tT=(r,e,t)=>r<<t|e>>>32-t,rT=(r,e,t)=>e<<t|r>>>32-t,nT=(r,e,t)=>e<<t-32|r>>>64-t,sT=(r,e,t)=>r<<t-32|e>>>64-t;function iT(r,e,t,n){const s=(e>>>0)+(n>>>0);return{h:r+t+(s/2**32|0)|0,l:s|0}}const oT=(r,e,t)=>(r>>>0)+(e>>>0)+(t>>>0),aT=(r,e,t,n)=>e+t+n+(r/2**32|0)|0,cT=(r,e,t,n)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0),lT=(r,e,t,n,s)=>e+t+n+s+(r/2**32|0)|0,uT=(r,e,t,n,s)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0)+(s>>>0),fT=(r,e,t,n,s,i)=>e+t+n+s+i+(r/2**32|0)|0,ue={fromBig:Cv,split:VC,toBig:KC,shrSH:GC,shrSL:WC,rotrSH:QC,rotrSL:JC,rotrBH:YC,rotrBL:ZC,rotr32H:XC,rotr32L:eT,rotlSH:tT,rotlSL:rT,rotlBH:nT,rotlBL:sT,add:iT,add3L:oT,add3H:aT,add4L:cT,add4H:lT,add5H:fT,add5L:uT},[hT,dT]=ue.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))),Ws=new Uint32Array(80),Qs=new Uint32Array(80);let pT=class extends qC{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:f,Fl:h,Gh:d,Gl:p,Hh:g,Hl:y}=this;return[e,t,n,s,i,o,a,c,l,u,f,h,d,p,g,y]}set(e,t,n,s,i,o,a,c,l,u,f,h,d,p,g,y){this.Ah=e|0,this.Al=t|0,this.Bh=n|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=f|0,this.Fl=h|0,this.Gh=d|0,this.Gl=p|0,this.Hh=g|0,this.Hl=y|0}process(e,t){for(let w=0;w<16;w++,t+=4)Ws[w]=e.getUint32(t),Qs[w]=e.getUint32(t+=4);for(let w=16;w<80;w++){const O=Ws[w-15]|0,I=Qs[w-15]|0,E=ue.rotrSH(O,I,1)^ue.rotrSH(O,I,8)^ue.shrSH(O,I,7),P=ue.rotrSL(O,I,1)^ue.rotrSL(O,I,8)^ue.shrSL(O,I,7),T=Ws[w-2]|0,D=Qs[w-2]|0,F=ue.rotrSH(T,D,19)^ue.rotrBH(T,D,61)^ue.shrSH(T,D,6),j=ue.rotrSL(T,D,19)^ue.rotrBL(T,D,61)^ue.shrSL(T,D,6),L=ue.add4L(P,j,Qs[w-7],Qs[w-16]),U=ue.add4H(L,E,F,Ws[w-7],Ws[w-16]);Ws[w]=U|0,Qs[w]=L|0}let{Ah:n,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:f,El:h,Fh:d,Fl:p,Gh:g,Gl:y,Hh:x,Hl:A}=this;for(let w=0;w<80;w++){const O=ue.rotrSH(f,h,14)^ue.rotrSH(f,h,18)^ue.rotrBH(f,h,41),I=ue.rotrSL(f,h,14)^ue.rotrSL(f,h,18)^ue.rotrBL(f,h,41),E=f&d^~f&g,P=h&p^~h&y,T=ue.add5L(A,I,P,dT[w],Qs[w]),D=ue.add5H(T,x,O,E,hT[w],Ws[w]),F=T|0,j=ue.rotrSH(n,s,28)^ue.rotrBH(n,s,34)^ue.rotrBH(n,s,39),L=ue.rotrSL(n,s,28)^ue.rotrBL(n,s,34)^ue.rotrBL(n,s,39),U=n&i^n&a^i&a,_=s&o^s&c^o&c;x=g|0,A=y|0,g=d|0,y=p|0,d=f|0,p=h|0,{h:f,l:h}=ue.add(l|0,u|0,D|0,F|0),l=a|0,u=c|0,a=i|0,c=o|0,i=n|0,o=s|0;const m=ue.add3L(F,L,_);n=ue.add3H(m,D,j,U),s=m|0}({h:n,l:s}=ue.add(this.Ah|0,this.Al|0,n|0,s|0)),{h:i,l:o}=ue.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=ue.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=ue.add(this.Dh|0,this.Dl|0,l|0,u|0),{h:f,l:h}=ue.add(this.Eh|0,this.El|0,f|0,h|0),{h:d,l:p}=ue.add(this.Fh|0,this.Fl|0,d|0,p|0),{h:g,l:y}=ue.add(this.Gh|0,this.Gl|0,g|0,y|0),{h:x,l:A}=ue.add(this.Hh|0,this.Hl|0,x|0,A|0),this.set(n,s,i,o,a,c,l,u,f,h,d,p,g,y,x,A)}roundClean(){Ws.fill(0),Qs.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const gT=zC(()=>new pT);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const wy=BigInt(0),Tv=BigInt(1),bT=BigInt(2);function Ey(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function vy(r){if(!Ey(r))throw new Error("Uint8Array expected")}function q0(r,e){if(typeof e!="boolean")throw new Error(r+" boolean expected, got "+e)}const yT=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function Ay(r){vy(r);let e="";for(let t=0;t<r.length;t++)e+=yT[r[t]];return e}function Nv(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return r===""?wy:BigInt("0x"+r)}const is={_0:48,_9:57,A:65,F:70,a:97,f:102};function nw(r){if(r>=is._0&&r<=is._9)return r-is._0;if(r>=is.A&&r<=is.F)return r-(is.A-10);if(r>=is.a&&r<=is.f)return r-(is.a-10)}function Dv(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);const e=r.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(t);for(let s=0,i=0;s<t;s++,i+=2){const o=nw(r.charCodeAt(i)),a=nw(r.charCodeAt(i+1));if(o===void 0||a===void 0){const c=r[i]+r[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}n[s]=o*16+a}return n}function mT(r){return Nv(Ay(r))}function _h(r){return vy(r),Nv(Ay(Uint8Array.from(r).reverse()))}function Rv(r,e){return Dv(r.toString(16).padStart(e*2,"0"))}function Mg(r,e){return Rv(r,e).reverse()}function os(r,e,t){let n;if(typeof e=="string")try{n=Dv(e)}catch(i){throw new Error(r+" must be hex string or Uint8Array, cause: "+i)}else if(Ey(e))n=Uint8Array.from(e);else throw new Error(r+" must be hex string or Uint8Array");const s=n.length;if(typeof t=="number"&&s!==t)throw new Error(r+" of length "+t+" expected, got "+s);return n}function sw(...r){let e=0;for(let n=0;n<r.length;n++){const s=r[n];vy(s),e+=s.length}const t=new Uint8Array(e);for(let n=0,s=0;n<r.length;n++){const i=r[n];t.set(i,s),s+=i.length}return t}const V0=r=>typeof r=="bigint"&&wy<=r;function xT(r,e,t){return V0(r)&&V0(e)&&V0(t)&&e<=r&&r<t}function Ul(r,e,t,n){if(!xT(e,t,n))throw new Error("expected valid "+r+": "+t+" <= n < "+n+", got "+e)}function wT(r){let e;for(e=0;r>wy;r>>=Tv,e+=1);return e}const ET=r=>(bT<<BigInt(r-1))-Tv,vT={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||Ey(r),isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,e)=>e.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function Iy(r,e,t={}){const n=(s,i,o)=>{const a=vT[i];if(typeof a!="function")throw new Error("invalid validator function");const c=r[s];if(!(o&&c===void 0)&&!a(c,r))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))n(s,i,!1);for(const[s,i]of Object.entries(t))n(s,i,!0);return r}function iw(r){const e=new WeakMap;return(t,...n)=>{const s=e.get(t);if(s!==void 0)return s;const i=r(t,...n);return e.set(t,i),i}}const ht=BigInt(0),We=BigInt(1),uo=BigInt(2),AT=BigInt(3),jg=BigInt(4),ow=BigInt(5),aw=BigInt(8);function tt(r,e){const t=r%e;return t>=ht?t:e+t}function IT(r,e,t){if(e<ht)throw new Error("invalid exponent, negatives unsupported");if(t<=ht)throw new Error("invalid modulus");if(t===We)return ht;let n=We;for(;e>ht;)e&We&&(n=n*r%t),r=r*r%t,e>>=We;return n}function vn(r,e,t){let n=r;for(;e-- >ht;)n*=n,n%=t;return n}function cw(r,e){if(r===ht)throw new Error("invert: expected non-zero number");if(e<=ht)throw new Error("invert: expected positive modulus, got "+e);let t=tt(r,e),n=e,s=ht,i=We;for(;t!==ht;){const o=n/t,a=n%t,c=s-i*o;n=t,t=a,s=i,i=c}if(n!==We)throw new Error("invert: does not exist");return tt(s,e)}function ST(r){const e=(r-We)/uo;let t,n,s;for(t=r-We,n=0;t%uo===ht;t/=uo,n++);for(s=uo;s<r&&IT(s,e,r)!==r-We;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const o=(r+We)/jg;return function(a,c){const l=a.pow(c,o);if(!a.eql(a.sqr(l),c))throw new Error("Cannot find square root");return l}}const i=(t+We)/uo;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=n,l=o.pow(o.mul(o.ONE,s),t),u=o.pow(a,i),f=o.pow(a,t);for(;!o.eql(f,o.ONE);){if(o.eql(f,o.ZERO))return o.ZERO;let h=1;for(let p=o.sqr(f);h<c&&!o.eql(p,o.ONE);h++)p=o.sqr(p);const d=o.pow(l,We<<BigInt(c-h-1));l=o.sqr(d),u=o.mul(u,d),f=o.mul(f,l),c=h}return u}}function OT(r){if(r%jg===AT){const e=(r+We)/jg;return function(t,n){const s=t.pow(n,e);if(!t.eql(t.sqr(s),n))throw new Error("Cannot find square root");return s}}if(r%aw===ow){const e=(r-ow)/aw;return function(t,n){const s=t.mul(n,uo),i=t.pow(s,e),o=t.mul(n,i),a=t.mul(t.mul(o,uo),i),c=t.mul(o,t.sub(a,t.ONE));if(!t.eql(t.sqr(c),n))throw new Error("Cannot find square root");return c}}return ST(r)}const PT=(r,e)=>(tt(r,e)&We)===We,CT=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function TT(r){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=CT.reduce((n,s)=>(n[s]="function",n),e);return Iy(r,t)}function NT(r,e,t){if(t<ht)throw new Error("invalid exponent, negatives unsupported");if(t===ht)return r.ONE;if(t===We)return e;let n=r.ONE,s=e;for(;t>ht;)t&We&&(n=r.mul(n,s)),s=r.sqr(s),t>>=We;return n}function DT(r,e){const t=new Array(e.length),n=e.reduce((i,o,a)=>r.is0(o)?i:(t[a]=i,r.mul(i,o)),r.ONE),s=r.inv(n);return e.reduceRight((i,o,a)=>r.is0(o)?i:(t[a]=r.mul(i,t[a]),r.mul(i,o)),s),t}function _v(r,e){const t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function Bv(r,e,t=!1,n={}){if(r<=ht)throw new Error("invalid field: expected ORDER > 0, got "+r);const{nBitLength:s,nByteLength:i}=_v(r,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:r,isLE:t,BITS:s,BYTES:i,MASK:ET(s),ZERO:ht,ONE:We,create:c=>tt(c,r),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return ht<=c&&c<r},is0:c=>c===ht,isOdd:c=>(c&We)===We,neg:c=>tt(-c,r),eql:(c,l)=>c===l,sqr:c=>tt(c*c,r),add:(c,l)=>tt(c+l,r),sub:(c,l)=>tt(c-l,r),mul:(c,l)=>tt(c*l,r),pow:(c,l)=>NT(a,c,l),div:(c,l)=>tt(c*cw(l,r),r),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>cw(c,r),sqrt:n.sqrt||(c=>(o||(o=OT(r)),o(a,c))),invertBatch:c=>DT(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>t?Mg(c,i):Rv(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return t?_h(c):mT(c)}});return Object.freeze(a)}const lw=BigInt(0),eh=BigInt(1);function K0(r,e){const t=e.negate();return r?t:e}function kv(r,e){if(!Number.isSafeInteger(r)||r<=0||r>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+r)}function G0(r,e){kv(r,e);const t=Math.ceil(e/r)+1,n=2**(r-1);return{windows:t,windowSize:n}}function RT(r,e){if(!Array.isArray(r))throw new Error("array expected");r.forEach((t,n)=>{if(!(t instanceof e))throw new Error("invalid point at index "+n)})}function _T(r,e){if(!Array.isArray(r))throw new Error("array of scalars expected");r.forEach((t,n)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+n)})}const W0=new WeakMap,Uv=new WeakMap;function Q0(r){return Uv.get(r)||1}function BT(r,e){return{constTimeNegate:K0,hasPrecomputes(t){return Q0(t)!==1},unsafeLadder(t,n,s=r.ZERO){let i=t;for(;n>lw;)n&eh&&(s=s.add(i)),i=i.double(),n>>=eh;return s},precomputeWindow(t,n){const{windows:s,windowSize:i}=G0(n,e),o=[];let a=t,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(t,n,s){const{windows:i,windowSize:o}=G0(t,e);let a=r.ZERO,c=r.BASE;const l=BigInt(2**t-1),u=2**t,f=BigInt(t);for(let h=0;h<i;h++){const d=h*o;let p=Number(s&l);s>>=f,p>o&&(p-=u,s+=eh);const g=d,y=d+Math.abs(p)-1,x=h%2!==0,A=p<0;p===0?c=c.add(K0(x,n[g])):a=a.add(K0(A,n[y]))}return{p:a,f:c}},wNAFUnsafe(t,n,s,i=r.ZERO){const{windows:o,windowSize:a}=G0(t,e),c=BigInt(2**t-1),l=2**t,u=BigInt(t);for(let f=0;f<o;f++){const h=f*a;if(s===lw)break;let d=Number(s&c);if(s>>=u,d>a&&(d-=l,s+=eh),d===0)continue;let p=n[h+Math.abs(d)-1];d<0&&(p=p.negate()),i=i.add(p)}return i},getPrecomputes(t,n,s){let i=W0.get(n);return i||(i=this.precomputeWindow(n,t),t!==1&&W0.set(n,s(i))),i},wNAFCached(t,n,s){const i=Q0(t);return this.wNAF(i,this.getPrecomputes(i,t,s),n)},wNAFCachedUnsafe(t,n,s,i){const o=Q0(t);return o===1?this.unsafeLadder(t,n,i):this.wNAFUnsafe(o,this.getPrecomputes(o,t,s),n,i)},setWindowSize(t,n){kv(n,e),Uv.set(t,n),W0.delete(t)}}}function kT(r,e,t,n){if(RT(t,r),_T(n,e),t.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const s=r.ZERO,i=wT(BigInt(t.length)),o=i>12?i-3:i>4?i-2:i?2:1,a=(1<<o)-1,c=new Array(a+1).fill(s),l=Math.floor((e.BITS-1)/o)*o;let u=s;for(let f=l;f>=0;f-=o){c.fill(s);for(let d=0;d<n.length;d++){const p=n[d],g=Number(p>>BigInt(f)&BigInt(a));c[g]=c[g].add(t[d])}let h=s;for(let d=c.length-1,p=s;d>0;d--)p=p.add(c[d]),h=h.add(p);if(u=u.add(h),f!==0)for(let d=0;d<o;d++)u=u.double()}return u}function UT(r){return TT(r.Fp),Iy(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({..._v(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}const Wr=BigInt(0),Gt=BigInt(1),th=BigInt(2),$T=BigInt(8),LT={zip215:!0};function FT(r){const e=UT(r);return Iy(r,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function MT(r){const e=FT(r),{Fp:t,n,prehash:s,hash:i,randomBytes:o,nByteLength:a,h:c}=e,l=th<<BigInt(a*8)-Gt,u=t.create,f=Bv(e.n,e.nBitLength),h=e.uvRatio||((m,v)=>{try{return{isValid:!0,value:t.sqrt(m*t.inv(v))}}catch{return{isValid:!1,value:Wr}}}),d=e.adjustScalarBytes||(m=>m),p=e.domain||((m,v,N)=>{if(q0("phflag",N),v.length||N)throw new Error("Contexts/pre-hash are not supported");return m});function g(m,v){Ul("coordinate "+m,v,Wr,l)}function y(m){if(!(m instanceof w))throw new Error("ExtendedPoint expected")}const x=iw((m,v)=>{const{ex:N,ey:$,ez:R}=m,B=m.is0();v==null&&(v=B?$T:t.inv(R));const H=u(N*v),V=u($*v),X=u(R*v);if(B)return{x:Wr,y:Gt};if(X!==Gt)throw new Error("invZ was invalid");return{x:H,y:V}}),A=iw(m=>{const{a:v,d:N}=e;if(m.is0())throw new Error("bad point: ZERO");const{ex:$,ey:R,ez:B,et:H}=m,V=u($*$),X=u(R*R),W=u(B*B),J=u(W*W),ne=u(V*v),oe=u(W*u(ne+X)),fe=u(J+u(N*u(V*X)));if(oe!==fe)throw new Error("bad point: equation left != right (1)");const ie=u($*R),de=u(B*H);if(ie!==de)throw new Error("bad point: equation left != right (2)");return!0});class w{constructor(v,N,$,R){this.ex=v,this.ey=N,this.ez=$,this.et=R,g("x",v),g("y",N),g("z",$),g("t",R),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(v){if(v instanceof w)throw new Error("extended point not allowed");const{x:N,y:$}=v||{};return g("x",N),g("y",$),new w(N,$,Gt,u(N*$))}static normalizeZ(v){const N=t.invertBatch(v.map($=>$.ez));return v.map(($,R)=>$.toAffine(N[R])).map(w.fromAffine)}static msm(v,N){return kT(w,f,v,N)}_setWindowSize(v){E.setWindowSize(this,v)}assertValidity(){A(this)}equals(v){y(v);const{ex:N,ey:$,ez:R}=this,{ex:B,ey:H,ez:V}=v,X=u(N*V),W=u(B*R),J=u($*V),ne=u(H*R);return X===W&&J===ne}is0(){return this.equals(w.ZERO)}negate(){return new w(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:v}=e,{ex:N,ey:$,ez:R}=this,B=u(N*N),H=u($*$),V=u(th*u(R*R)),X=u(v*B),W=N+$,J=u(u(W*W)-B-H),ne=X+H,oe=ne-V,fe=X-H,ie=u(J*oe),de=u(ne*fe),je=u(J*fe),Je=u(oe*ne);return new w(ie,de,Je,je)}add(v){y(v);const{a:N,d:$}=e,{ex:R,ey:B,ez:H,et:V}=this,{ex:X,ey:W,ez:J,et:ne}=v;if(N===BigInt(-1)){const nm=u((B-R)*(W+X)),sm=u((B+R)*(W-X)),c0=u(sm-nm);if(c0===Wr)return this.double();const im=u(H*th*ne),om=u(V*th*J),am=om+im,cm=sm+nm,lm=om-im,sA=u(am*c0),iA=u(cm*lm),oA=u(am*lm),aA=u(c0*cm);return new w(sA,iA,aA,oA)}const oe=u(R*X),fe=u(B*W),ie=u(V*$*ne),de=u(H*J),je=u((R+B)*(X+W)-oe-fe),Je=de-ie,ze=de+ie,Pt=u(fe-N*oe),ya=u(je*Je),Nf=u(ze*Pt),rA=u(je*Pt),nA=u(Je*ze);return new w(ya,Nf,nA,rA)}subtract(v){return this.add(v.negate())}wNAF(v){return E.wNAFCached(this,v,w.normalizeZ)}multiply(v){const N=v;Ul("scalar",N,Gt,n);const{p:$,f:R}=this.wNAF(N);return w.normalizeZ([$,R])[0]}multiplyUnsafe(v,N=w.ZERO){const $=v;return Ul("scalar",$,Wr,n),$===Wr?I:this.is0()||$===Gt?this:E.wNAFCachedUnsafe(this,$,w.normalizeZ,N)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return E.unsafeLadder(this,n).is0()}toAffine(v){return x(this,v)}clearCofactor(){const{h:v}=e;return v===Gt?this:this.multiplyUnsafe(v)}static fromHex(v,N=!1){const{d:$,a:R}=e,B=t.BYTES;v=os("pointHex",v,B),q0("zip215",N);const H=v.slice(),V=v[B-1];H[B-1]=V&-129;const X=_h(H),W=N?l:t.ORDER;Ul("pointHex.y",X,Wr,W);const J=u(X*X),ne=u(J-Gt),oe=u($*J-R);let{isValid:fe,value:ie}=h(ne,oe);if(!fe)throw new Error("Point.fromHex: invalid y coordinate");const de=(ie&Gt)===Gt,je=(V&128)!==0;if(!N&&ie===Wr&&je)throw new Error("Point.fromHex: x=0 and x_0=1");return je!==de&&(ie=u(-ie)),w.fromAffine({x:ie,y:X})}static fromPrivateKey(v){return D(v).point}toRawBytes(){const{x:v,y:N}=this.toAffine(),$=Mg(N,t.BYTES);return $[$.length-1]|=v&Gt?128:0,$}toHex(){return Ay(this.toRawBytes())}}w.BASE=new w(e.Gx,e.Gy,Gt,u(e.Gx*e.Gy)),w.ZERO=new w(Wr,Gt,Gt,Wr);const{BASE:O,ZERO:I}=w,E=BT(w,a*8);function P(m){return tt(m,n)}function T(m){return P(_h(m))}function D(m){const v=t.BYTES;m=os("private key",m,v);const N=os("hashed private key",i(m),2*v),$=d(N.slice(0,v)),R=N.slice(v,2*v),B=T($),H=O.multiply(B),V=H.toRawBytes();return{head:$,prefix:R,scalar:B,point:H,pointBytes:V}}function F(m){return D(m).pointBytes}function j(m=new Uint8Array,...v){const N=sw(...v);return T(i(p(N,os("context",m),!!s)))}function L(m,v,N={}){m=os("message",m),s&&(m=s(m));const{prefix:$,scalar:R,pointBytes:B}=D(v),H=j(N.context,$,m),V=O.multiply(H).toRawBytes(),X=j(N.context,V,B,m),W=P(H+X*R);Ul("signature.s",W,Wr,n);const J=sw(V,Mg(W,t.BYTES));return os("result",J,t.BYTES*2)}const U=LT;function _(m,v,N,$=U){const{context:R,zip215:B}=$,H=t.BYTES;m=os("signature",m,2*H),v=os("message",v),N=os("publicKey",N,H),B!==void 0&&q0("zip215",B),s&&(v=s(v));const V=_h(m.slice(H,2*H));let X,W,J;try{X=w.fromHex(N,B),W=w.fromHex(m.slice(0,H),B),J=O.multiplyUnsafe(V)}catch{return!1}if(!B&&X.isSmallOrder())return!1;const ne=j(R,W.toRawBytes(),X.toRawBytes(),v);return W.add(X.multiplyUnsafe(ne)).subtract(J).clearCofactor().equals(w.ZERO)}return O._setWindowSize(8),{CURVE:e,getPublicKey:F,sign:L,verify:_,ExtendedPoint:w,utils:{getExtendedPublicKey:D,randomPrivateKey:()=>o(t.BYTES),precompute(m=8,v=w.BASE){return v._setWindowSize(m),v.multiply(BigInt(3)),v}}}}BigInt(0),BigInt(1);const Sy=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),uw=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const jT=BigInt(1),fw=BigInt(2);BigInt(3);const zT=BigInt(5),HT=BigInt(8);function qT(r){const e=BigInt(10),t=BigInt(20),n=BigInt(40),s=BigInt(80),i=Sy,o=r*r%i*r%i,a=vn(o,fw,i)*o%i,c=vn(a,jT,i)*r%i,l=vn(c,zT,i)*c%i,u=vn(l,e,i)*l%i,f=vn(u,t,i)*u%i,h=vn(f,n,i)*f%i,d=vn(h,s,i)*h%i,p=vn(d,s,i)*h%i,g=vn(p,e,i)*l%i;return{pow_p_5_8:vn(g,fw,i)*r%i,b2:o}}function VT(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}function KT(r,e){const t=Sy,n=tt(e*e*e,t),s=tt(n*n*e,t),i=qT(r*s).pow_p_5_8;let o=tt(r*n*i,t);const a=tt(e*o*o,t),c=o,l=tt(o*uw,t),u=a===r,f=a===tt(-r,t),h=a===tt(-r*uw,t);return u&&(o=c),(f||h)&&(o=l),PT(o,t)&&(o=tt(-o,t)),{isValid:u||f,value:o}}const GT=Bv(Sy,void 0,!0),WT={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:GT,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:HT,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:gT,randomBytes:Pv,adjustScalarBytes:VT,uvRatio:KT},$v=MT(WT),QT="EdDSA",JT="JWT",od=".",qd="base64url",Lv="utf8",Fv="utf8",YT=":",ZT="did",XT="key",hw="base58btc",eN="z",tN="K36",rN=32;function Oy(r){return globalThis.Buffer!=null?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function Mv(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Oy(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function jv(r,e){e||(e=r.reduce((s,i)=>s+i.length,0));const t=Mv(e);let n=0;for(const s of r)t.set(s,n),n+=s.length;return Oy(t)}function nN(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(t[o]!==255)throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function f(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,y=0,x=0,A=p.length;x!==A&&p[x]===0;)x++,g++;for(var w=(A-x)*u+1>>>0,O=new Uint8Array(w);x!==A;){for(var I=p[x],E=0,P=w-1;(I!==0||E<y)&&P!==-1;P--,E++)I+=256*O[P]>>>0,O[P]=I%a>>>0,I=I/a>>>0;if(I!==0)throw new Error("Non-zero carry");y=E,x++}for(var T=w-y;T!==w&&O[T]===0;)T++;for(var D=c.repeat(g);T<w;++T)D+=r.charAt(O[T]);return D}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var y=0,x=0;p[g]===c;)y++,g++;for(var A=(p.length-g)*l+1>>>0,w=new Uint8Array(A);p[g];){var O=t[p.charCodeAt(g)];if(O===255)return;for(var I=0,E=A-1;(O!==0||I<x)&&E!==-1;E--,I++)O+=a*w[E]>>>0,w[E]=O%256>>>0,O=O/256>>>0;if(O!==0)throw new Error("Non-zero carry");x=I,g++}if(p[g]!==" "){for(var P=A-x;P!==A&&w[P]===0;)P++;for(var T=new Uint8Array(y+(A-P)),D=y;P!==A;)T[D++]=w[P++];return T}}}function d(p){var g=h(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:f,decodeUnsafe:h,decode:d}}var sN=nN,iN=sN;const zv=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},oN=r=>new TextEncoder().encode(r),aN=r=>new TextDecoder().decode(r);let cN=class{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},lN=class{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Hv(this,e)}},uN=class{constructor(e){this.decoders=e}or(e){return Hv(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const Hv=(r,e)=>new uN({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});let fN=class{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new cN(e,t,n),this.decoder=new lN(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const Vd=({name:r,prefix:e,encode:t,decode:n})=>new fN(r,e,t,n),xf=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=iN(t,e);return Vd({prefix:r,name:e,encode:n,decode:i=>zv(s(i))})},hN=(r,e,t,n)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=r.length;for(;r[i-1]==="=";)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const f=s[r[u]];if(f===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<t|f,a+=t,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},dN=(r,e,t)=>{const n=e[e.length-1]==="=",s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i},It=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>Vd({prefix:e,name:r,encode(s){return dN(s,n,t)},decode(s){return hN(s,n,t,r)}}),pN=Vd({prefix:"\0",name:"identity",encode:r=>aN(r),decode:r=>oN(r)});var gN=Object.freeze({__proto__:null,identity:pN});const bN=It({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var yN=Object.freeze({__proto__:null,base2:bN});const mN=It({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var xN=Object.freeze({__proto__:null,base8:mN});const wN=xf({prefix:"9",name:"base10",alphabet:"0123456789"});var EN=Object.freeze({__proto__:null,base10:wN});const vN=It({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),AN=It({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var IN=Object.freeze({__proto__:null,base16:vN,base16upper:AN});const SN=It({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),ON=It({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),PN=It({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),CN=It({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),TN=It({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),NN=It({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),DN=It({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),RN=It({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),_N=It({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var BN=Object.freeze({__proto__:null,base32:SN,base32upper:ON,base32pad:PN,base32padupper:CN,base32hex:TN,base32hexupper:NN,base32hexpad:DN,base32hexpadupper:RN,base32z:_N});const kN=xf({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),UN=xf({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var $N=Object.freeze({__proto__:null,base36:kN,base36upper:UN});const LN=xf({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),FN=xf({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var MN=Object.freeze({__proto__:null,base58btc:LN,base58flickr:FN});const jN=It({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),zN=It({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),HN=It({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),qN=It({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var VN=Object.freeze({__proto__:null,base64:jN,base64pad:zN,base64url:HN,base64urlpad:qN});const qv=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),KN=qv.reduce((r,e,t)=>(r[t]=e,r),[]),GN=qv.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function WN(r){return r.reduce((e,t)=>(e+=KN[t],e),"")}function QN(r){const e=[];for(const t of r){const n=GN[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}const JN=Vd({prefix:"🚀",name:"base256emoji",encode:WN,decode:QN});var YN=Object.freeze({__proto__:null,base256emoji:JN}),ZN=Vv,dw=128,XN=-128,eD=Math.pow(2,31);function Vv(r,e,t){e=e||[],t=t||0;for(var n=t;r>=eD;)e[t++]=r&255|dw,r/=128;for(;r&XN;)e[t++]=r&255|dw,r>>>=7;return e[t]=r|0,Vv.bytes=t-n+1,e}var tD=zg,rD=128,pw=127;function zg(r,n){var t=0,n=n||0,s=0,i=n,o,a=r.length;do{if(i>=a)throw zg.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(o&pw)<<s:(o&pw)*Math.pow(2,s),s+=7}while(o>=rD);return zg.bytes=i-n,t}var nD=Math.pow(2,7),sD=Math.pow(2,14),iD=Math.pow(2,21),oD=Math.pow(2,28),aD=Math.pow(2,35),cD=Math.pow(2,42),lD=Math.pow(2,49),uD=Math.pow(2,56),fD=Math.pow(2,63),hD=function(r){return r<nD?1:r<sD?2:r<iD?3:r<oD?4:r<aD?5:r<cD?6:r<lD?7:r<uD?8:r<fD?9:10},dD={encode:ZN,decode:tD,encodingLength:hD},Kv=dD;const gw=(r,e,t=0)=>(Kv.encode(r,e,t),e),bw=r=>Kv.encodingLength(r),Hg=(r,e)=>{const t=e.byteLength,n=bw(r),s=n+bw(t),i=new Uint8Array(s+t);return gw(r,i,0),gw(t,i,n),i.set(e,s),new pD(r,t,e,i)};let pD=class{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}};const Gv=({name:r,code:e,encode:t})=>new gD(r,e,t);let gD=class{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Hg(this.code,t):t.then(n=>Hg(this.code,n))}else throw Error("Unknown type, must be binary type")}};const Wv=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),bD=Gv({name:"sha2-256",code:18,encode:Wv("SHA-256")}),yD=Gv({name:"sha2-512",code:19,encode:Wv("SHA-512")});var mD=Object.freeze({__proto__:null,sha256:bD,sha512:yD});const Qv=0,xD="identity",Jv=zv,wD=r=>Hg(Qv,Jv(r)),ED={code:Qv,name:xD,encode:Jv,digest:wD};var vD=Object.freeze({__proto__:null,identity:ED});new TextEncoder,new TextDecoder;const yw={...gN,...yN,...xN,...EN,...IN,...BN,...$N,...MN,...VN,...YN};({...mD,...vD});function Yv(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const mw=Yv("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),J0=Yv("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=Mv(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),Zv={utf8:mw,"utf-8":mw,hex:yw.base16,latin1:J0,ascii:J0,binary:J0,...yw};function Kd(r,e="utf8"){const t=Zv[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}function vl(r,e="utf8"){const t=Zv[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Oy(globalThis.Buffer.from(r,"utf-8")):t.decoder.decode(`${t.prefix}${r}`)}function xw(r){return oa(Kd(vl(r,qd),Lv))}function ad(r){return Kd(vl(Fs(r),Lv),qd)}function Xv(r){const e=vl(tN,hw),t=eN+Kd(jv([e,r]),hw);return[ZT,XT,t].join(YT)}function AD(r){return Kd(r,qd)}function ID(r){return vl(r,qd)}function SD(r){return vl([ad(r.header),ad(r.payload)].join(od),Fv)}function OD(r){return[ad(r.header),ad(r.payload),AD(r.signature)].join(od)}function qg(r){const e=r.split(od),t=xw(e[0]),n=xw(e[1]),s=ID(e[2]),i=vl(e.slice(0,2).join(od),Fv);return{header:t,payload:n,signature:s,data:i}}function ww(r=Pv(rN)){const e=$v.getPublicKey(r);return{secretKey:jv([r,e]),publicKey:e}}async function PD(r,e,t,n,s=Z.fromMiliseconds(Date.now())){const i={alg:QT,typ:JT},o=Xv(n.publicKey),a=s+t,c={iss:o,sub:r,aud:e,iat:s,exp:a},l=SD({header:i,payload:c}),u=$v.sign(l,n.secretKey.slice(0,32));return OD({header:i,payload:c,signature:u})}function Py(r){return globalThis.Buffer!=null?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function e4(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Py(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function cu(r,e){e||(e=r.reduce((s,i)=>s+i.length,0));const t=e4(e);let n=0;for(const s of r)t.set(s,n),n+=s.length;return Py(t)}function CD(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(t[o]!==255)throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function f(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,y=0,x=0,A=p.length;x!==A&&p[x]===0;)x++,g++;for(var w=(A-x)*u+1>>>0,O=new Uint8Array(w);x!==A;){for(var I=p[x],E=0,P=w-1;(I!==0||E<y)&&P!==-1;P--,E++)I+=256*O[P]>>>0,O[P]=I%a>>>0,I=I/a>>>0;if(I!==0)throw new Error("Non-zero carry");y=E,x++}for(var T=w-y;T!==w&&O[T]===0;)T++;for(var D=c.repeat(g);T<w;++T)D+=r.charAt(O[T]);return D}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var y=0,x=0;p[g]===c;)y++,g++;for(var A=(p.length-g)*l+1>>>0,w=new Uint8Array(A);p[g];){var O=t[p.charCodeAt(g)];if(O===255)return;for(var I=0,E=A-1;(O!==0||I<x)&&E!==-1;E--,I++)O+=a*w[E]>>>0,w[E]=O%256>>>0,O=O/256>>>0;if(O!==0)throw new Error("Non-zero carry");x=I,g++}if(p[g]!==" "){for(var P=A-x;P!==A&&w[P]===0;)P++;for(var T=new Uint8Array(y+(A-P)),D=y;P!==A;)T[D++]=w[P++];return T}}}function d(p){var g=h(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:f,decodeUnsafe:h,decode:d}}var TD=CD,ND=TD;const DD=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},RD=r=>new TextEncoder().encode(r),_D=r=>new TextDecoder().decode(r);class BD{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class kD{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return t4(this,e)}}class UD{constructor(e){this.decoders=e}or(e){return t4(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const t4=(r,e)=>new UD({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class $D{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new BD(e,t,n),this.decoder=new kD(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Gd=({name:r,prefix:e,encode:t,decode:n})=>new $D(r,e,t,n),wf=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=ND(t,e);return Gd({prefix:r,name:e,encode:n,decode:i=>DD(s(i))})},LD=(r,e,t,n)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=r.length;for(;r[i-1]==="=";)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const f=s[r[u]];if(f===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<t|f,a+=t,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},FD=(r,e,t)=>{const n=e[e.length-1]==="=",s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i},St=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>Gd({prefix:e,name:r,encode(s){return FD(s,n,t)},decode(s){return LD(s,n,t,r)}}),MD=Gd({prefix:"\0",name:"identity",encode:r=>_D(r),decode:r=>RD(r)}),jD=Object.freeze(Object.defineProperty({__proto__:null,identity:MD},Symbol.toStringTag,{value:"Module"})),zD=St({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),HD=Object.freeze(Object.defineProperty({__proto__:null,base2:zD},Symbol.toStringTag,{value:"Module"})),qD=St({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),VD=Object.freeze(Object.defineProperty({__proto__:null,base8:qD},Symbol.toStringTag,{value:"Module"})),KD=wf({prefix:"9",name:"base10",alphabet:"0123456789"}),GD=Object.freeze(Object.defineProperty({__proto__:null,base10:KD},Symbol.toStringTag,{value:"Module"})),WD=St({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),QD=St({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),JD=Object.freeze(Object.defineProperty({__proto__:null,base16:WD,base16upper:QD},Symbol.toStringTag,{value:"Module"})),YD=St({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),ZD=St({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),XD=St({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),eR=St({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),tR=St({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),rR=St({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),nR=St({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),sR=St({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),iR=St({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),oR=Object.freeze(Object.defineProperty({__proto__:null,base32:YD,base32hex:tR,base32hexpad:nR,base32hexpadupper:sR,base32hexupper:rR,base32pad:XD,base32padupper:eR,base32upper:ZD,base32z:iR},Symbol.toStringTag,{value:"Module"})),aR=wf({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),cR=wf({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),lR=Object.freeze(Object.defineProperty({__proto__:null,base36:aR,base36upper:cR},Symbol.toStringTag,{value:"Module"})),uR=wf({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),fR=wf({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),hR=Object.freeze(Object.defineProperty({__proto__:null,base58btc:uR,base58flickr:fR},Symbol.toStringTag,{value:"Module"})),dR=St({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),pR=St({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),gR=St({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),bR=St({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),yR=Object.freeze(Object.defineProperty({__proto__:null,base64:dR,base64pad:pR,base64url:gR,base64urlpad:bR},Symbol.toStringTag,{value:"Module"})),r4=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),mR=r4.reduce((r,e,t)=>(r[t]=e,r),[]),xR=r4.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function wR(r){return r.reduce((e,t)=>(e+=mR[t],e),"")}function ER(r){const e=[];for(const t of r){const n=xR[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}const vR=Gd({prefix:"🚀",name:"base256emoji",encode:wR,decode:ER}),AR=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:vR},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const Ew={...jD,...HD,...VD,...GD,...JD,...oR,...lR,...hR,...yR,...AR};function n4(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const vw=n4("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Y0=n4("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=e4(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),s4={utf8:vw,"utf-8":vw,hex:Ew.base16,latin1:Y0,ascii:Y0,binary:Y0,...Ew};function Hr(r,e="utf8"){const t=s4[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Py(globalThis.Buffer.from(r,"utf-8")):t.decoder.decode(`${t.prefix}${r}`)}function sr(r,e="utf8"){const t=s4[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}const IR={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var Z0,Aw;function i4(){if(Aw)return Z0;Aw=1;const r="Input must be an string, Buffer or Uint8Array";function e(o){let a;if(o instanceof Uint8Array)a=o;else if(typeof o=="string")a=new TextEncoder().encode(o);else throw new Error(r);return a}function t(o){return Array.prototype.map.call(o,function(a){return(a<16?"0":"")+a.toString(16)}).join("")}function n(o){return(4294967296+o).toString(16).substring(1)}function s(o,a,c){let l=`
`+o+" = ";for(let u=0;u<a.length;u+=2){if(c===32)l+=n(a[u]).toUpperCase(),l+=" ",l+=n(a[u+1]).toUpperCase();else if(c===64)l+=n(a[u+1]).toUpperCase(),l+=n(a[u]).toUpperCase();else throw new Error("Invalid size "+c);u%6===4?l+=`
`+new Array(o.length+4).join(" "):u<a.length-2&&(l+=" ")}console.log(l)}function i(o,a,c){let l=new Date().getTime();const u=new Uint8Array(a);for(let h=0;h<a;h++)u[h]=h%256;const f=new Date().getTime();console.log("Generated random input in "+(f-l)+"ms"),l=f;for(let h=0;h<c;h++){const d=o(u),p=new Date().getTime(),g=p-l;l=p,console.log("Hashed in "+g+"ms: "+d.substring(0,20)+"..."),console.log(Math.round(a/(1<<20)/(g/1e3)*100)/100+" MB PER SECOND")}}return Z0={normalizeInput:e,toHex:t,debugPrint:s,testSpeed:i},Z0}var X0,Iw;function SR(){if(Iw)return X0;Iw=1;const r=i4();function e(x,A,w){const O=x[A]+x[w];let I=x[A+1]+x[w+1];O>=4294967296&&I++,x[A]=O,x[A+1]=I}function t(x,A,w,O){let I=x[A]+w;w<0&&(I+=4294967296);let E=x[A+1]+O;I>=4294967296&&E++,x[A]=I,x[A+1]=E}function n(x,A){return x[A]^x[A+1]<<8^x[A+2]<<16^x[A+3]<<24}function s(x,A,w,O,I,E){const P=l[I],T=l[I+1],D=l[E],F=l[E+1];e(c,x,A),t(c,x,P,T);let j=c[O]^c[x],L=c[O+1]^c[x+1];c[O]=L,c[O+1]=j,e(c,w,O),j=c[A]^c[w],L=c[A+1]^c[w+1],c[A]=j>>>24^L<<8,c[A+1]=L>>>24^j<<8,e(c,x,A),t(c,x,D,F),j=c[O]^c[x],L=c[O+1]^c[x+1],c[O]=j>>>16^L<<16,c[O+1]=L>>>16^j<<16,e(c,w,O),j=c[A]^c[w],L=c[A+1]^c[w+1],c[A]=L>>>31^j<<1,c[A+1]=j>>>31^L<<1}const i=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),o=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3],a=new Uint8Array(o.map(function(x){return x*2})),c=new Uint32Array(32),l=new Uint32Array(32);function u(x,A){let w=0;for(w=0;w<16;w++)c[w]=x.h[w],c[w+16]=i[w];for(c[24]=c[24]^x.t,c[25]=c[25]^x.t/4294967296,A&&(c[28]=~c[28],c[29]=~c[29]),w=0;w<32;w++)l[w]=n(x.b,4*w);for(w=0;w<12;w++)s(0,8,16,24,a[w*16+0],a[w*16+1]),s(2,10,18,26,a[w*16+2],a[w*16+3]),s(4,12,20,28,a[w*16+4],a[w*16+5]),s(6,14,22,30,a[w*16+6],a[w*16+7]),s(0,10,20,30,a[w*16+8],a[w*16+9]),s(2,12,22,24,a[w*16+10],a[w*16+11]),s(4,14,16,26,a[w*16+12],a[w*16+13]),s(6,8,18,28,a[w*16+14],a[w*16+15]);for(w=0;w<16;w++)x.h[w]=x.h[w]^c[w]^c[w+16]}const f=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function h(x,A,w,O){if(x===0||x>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(A&&A.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");if(w&&w.length!==16)throw new Error("Illegal salt, expected Uint8Array with length is 16");if(O&&O.length!==16)throw new Error("Illegal personal, expected Uint8Array with length is 16");const I={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:x};f.fill(0),f[0]=x,A&&(f[1]=A.length),f[2]=1,f[3]=1,w&&f.set(w,32),O&&f.set(O,48);for(let E=0;E<16;E++)I.h[E]=i[E]^n(f,E*4);return A&&(d(I,A),I.c=128),I}function d(x,A){for(let w=0;w<A.length;w++)x.c===128&&(x.t+=x.c,u(x,!1),x.c=0),x.b[x.c++]=A[w]}function p(x){for(x.t+=x.c;x.c<128;)x.b[x.c++]=0;u(x,!0);const A=new Uint8Array(x.outlen);for(let w=0;w<x.outlen;w++)A[w]=x.h[w>>2]>>8*(w&3);return A}function g(x,A,w,O,I){w=w||64,x=r.normalizeInput(x),O&&(O=r.normalizeInput(O)),I&&(I=r.normalizeInput(I));const E=h(w,A,O,I);return d(E,x),p(E)}function y(x,A,w,O,I){const E=g(x,A,w,O,I);return r.toHex(E)}return X0={blake2b:g,blake2bHex:y,blake2bInit:h,blake2bUpdate:d,blake2bFinal:p},X0}var ep,Sw;function OR(){if(Sw)return ep;Sw=1;const r=i4();function e(p,g){return p[g]^p[g+1]<<8^p[g+2]<<16^p[g+3]<<24}function t(p,g,y,x,A,w){o[p]=o[p]+o[g]+A,o[x]=n(o[x]^o[p],16),o[y]=o[y]+o[x],o[g]=n(o[g]^o[y],12),o[p]=o[p]+o[g]+w,o[x]=n(o[x]^o[p],8),o[y]=o[y]+o[x],o[g]=n(o[g]^o[y],7)}function n(p,g){return p>>>g^p<<32-g}const s=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),i=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),o=new Uint32Array(16),a=new Uint32Array(16);function c(p,g){let y=0;for(y=0;y<8;y++)o[y]=p.h[y],o[y+8]=s[y];for(o[12]^=p.t,o[13]^=p.t/4294967296,g&&(o[14]=~o[14]),y=0;y<16;y++)a[y]=e(p.b,4*y);for(y=0;y<10;y++)t(0,4,8,12,a[i[y*16+0]],a[i[y*16+1]]),t(1,5,9,13,a[i[y*16+2]],a[i[y*16+3]]),t(2,6,10,14,a[i[y*16+4]],a[i[y*16+5]]),t(3,7,11,15,a[i[y*16+6]],a[i[y*16+7]]),t(0,5,10,15,a[i[y*16+8]],a[i[y*16+9]]),t(1,6,11,12,a[i[y*16+10]],a[i[y*16+11]]),t(2,7,8,13,a[i[y*16+12]],a[i[y*16+13]]),t(3,4,9,14,a[i[y*16+14]],a[i[y*16+15]]);for(y=0;y<8;y++)p.h[y]^=o[y]^o[y+8]}function l(p,g){if(!(p>0&&p<=32))throw new Error("Incorrect output length, should be in [1, 32]");const y=g?g.length:0;if(g&&!(y>0&&y<=32))throw new Error("Incorrect key length, should be in [1, 32]");const x={h:new Uint32Array(s),b:new Uint8Array(64),c:0,t:0,outlen:p};return x.h[0]^=16842752^y<<8^p,y>0&&(u(x,g),x.c=64),x}function u(p,g){for(let y=0;y<g.length;y++)p.c===64&&(p.t+=p.c,c(p,!1),p.c=0),p.b[p.c++]=g[y]}function f(p){for(p.t+=p.c;p.c<64;)p.b[p.c++]=0;c(p,!0);const g=new Uint8Array(p.outlen);for(let y=0;y<p.outlen;y++)g[y]=p.h[y>>2]>>8*(y&3)&255;return g}function h(p,g,y){y=y||32,p=r.normalizeInput(p);const x=l(y,g);return u(x,p),f(x)}function d(p,g,y){const x=h(p,g,y);return r.toHex(x)}return ep={blake2s:h,blake2sHex:d,blake2sInit:l,blake2sUpdate:u,blake2sFinal:f},ep}var tp,Ow;function PR(){if(Ow)return tp;Ow=1;const r=SR(),e=OR();return tp={blake2b:r.blake2b,blake2bHex:r.blake2bHex,blake2bInit:r.blake2bInit,blake2bUpdate:r.blake2bUpdate,blake2bFinal:r.blake2bFinal,blake2s:e.blake2s,blake2sHex:e.blake2sHex,blake2sInit:e.blake2sInit,blake2sUpdate:e.blake2sUpdate,blake2sFinal:e.blake2sFinal},tp}var CR=PR(),TR={};const NR=":";function _s(r){const[e,t]=r.split(NR);return{namespace:e,reference:t}}function Pw(r,e=[]){const t=[];return Object.keys(r).forEach(n=>{if(e.length&&!e.includes(n))return;const s=r[n];t.push(...s.accounts)}),t}function o4(r,e){return r.includes(":")?[r]:e.chains||[]}var DR=Object.defineProperty,RR=Object.defineProperties,_R=Object.getOwnPropertyDescriptors,Cw=Object.getOwnPropertySymbols,BR=Object.prototype.hasOwnProperty,kR=Object.prototype.propertyIsEnumerable,Vg=(r,e,t)=>e in r?DR(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Tw=(r,e)=>{for(var t in e||(e={}))BR.call(e,t)&&Vg(r,t,e[t]);if(Cw)for(var t of Cw(e))kR.call(e,t)&&Vg(r,t,e[t]);return r},UR=(r,e)=>RR(r,_R(e)),Nw=(r,e,t)=>Vg(r,typeof e!="symbol"?e+"":e,t);const $R="ReactNative",Er={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},LR="js";function cd(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Qi(){return!Ls.getDocument()&&!!Ls.getNavigator()&&navigator.product===$R}function FR(){return Qi()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function MR(){return Qi()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function Al(){return!cd()&&!!Ls.getNavigator()&&!!Ls.getDocument()}function Ef(){return Qi()?Er.reactNative:cd()?Er.node:Al()?Er.browser:Er.unknown}function Dw(){var r;try{return Qi()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(r=global.Application)==null?void 0:r.applicationId:void 0}catch{return}}function jR(r,e){const t=new URLSearchParams(r);return Object.entries(e).sort(([n],[s])=>n.localeCompare(s)).forEach(([n,s])=>{s!=null&&t.set(n,String(s))}),t.toString()}function zR(r){var e,t;const n=a4();try{return r!=null&&r.url&&n.url&&new URL(r.url).host!==new URL(n.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${r.url} differs from the actual page url:${n.url}. This is probably unintended and can lead to issues.`),r.url=n.url),(e=r==null?void 0:r.icons)!=null&&e.length&&r.icons.length>0&&(r.icons=r.icons.filter(s=>s!=="")),UR(Tw(Tw({},n),r),{url:(r==null?void 0:r.url)||n.url,name:(r==null?void 0:r.name)||n.name,description:(r==null?void 0:r.description)||n.description,icons:(t=r==null?void 0:r.icons)!=null&&t.length&&r.icons.length>0?r.icons:n.icons})}catch(s){return console.warn("Error populating app metadata",s),r||n}}function a4(){return XO.getWindowMetadata()||{name:"",description:"",url:"",icons:[""]}}function HR(){if(Ef()===Er.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:t,Version:n}=global.Platform;return[t,n].join("-")}const r=yO();if(r===null)return"unknown";const e=r.os?r.os.replace(" ","").toLowerCase():"unknown";return r.type==="browser"?[e,r.name,r.version].join("-"):[e,r.version].join("-")}function qR(){var r;const e=Ef();return e===Er.browser?[e,((r=Ls.getLocation())==null?void 0:r.host)||"unknown"].join(":"):e}function c4(r,e,t){const n=HR(),s=qR();return[[r,e].join("-"),[LR,t].join("-"),n,s].join("/")}function VR({protocol:r,version:e,relayUrl:t,sdkVersion:n,auth:s,projectId:i,useOnCloseEvent:o,bundleId:a,packageName:c}){const l=t.split("?"),u=c4(r,e,n),f={auth:s,ua:u,projectId:i,useOnCloseEvent:o,packageName:c||void 0,bundleId:a||void 0},h=jR(l[1]||"",f);return l[0]+"?"+h}function Eo(r,e){return r.filter(t=>e.includes(t)).length===r.length}function Kg(r){return Object.fromEntries(r.entries())}function Gg(r){return new Map(Object.entries(r))}function oo(r=Z.FIVE_MINUTES,e){const t=Z.toMiliseconds(r||Z.FIVE_MINUTES);let n,s,i,o;return{resolve:a=>{i&&n&&(clearTimeout(i),n(a),o=Promise.resolve(a))},reject:a=>{i&&s&&(clearTimeout(i),s(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);i=setTimeout(()=>{const l=new Error(e);o=Promise.reject(l),c(l)},t),n=a,s=c})}}function Kn(r,e,t){return new Promise(async(n,s)=>{const i=setTimeout(()=>s(new Error(t)),e);try{const o=await r;n(o)}catch(o){s(o)}clearTimeout(i)})}function l4(r,e){if(typeof e=="string"&&e.startsWith(`${r}:`))return e;if(r.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(r.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${r}`)}function KR(r){return l4("topic",r)}function GR(r){return l4("id",r)}function u4(r){const[e,t]=r.split(":"),n={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")n.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))n.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return n}function Ze(r,e){return Z.fromMiliseconds(Date.now()+Z.toMiliseconds(r))}function qn(r){return Date.now()>=Z.toMiliseconds(r)}function Ie(r,e){return`${r}${e?`:${e}`:""}`}function Qn(r=[],e=[]){return[...new Set([...r,...e])]}async function WR({id:r,topic:e,wcDeepLink:t}){var n;try{if(!t)return;const s=typeof t=="string"?JSON.parse(t):t,i=s==null?void 0:s.href;if(typeof i!="string")return;const o=QR(i,r,e),a=Ef();if(a===Er.browser){if(!((n=Ls.getDocument())!=null&&n.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}JR(o)}else a===Er.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(o)}catch(s){console.error(s)}}function QR(r,e,t){const n=`requestId=${e}&sessionTopic=${t}`;r.endsWith("/")&&(r=r.slice(0,-1));let s=`${r}`;if(r.startsWith("https://t.me")){const i=r.includes("?")?"&startapp=":"?startapp=";s=`${s}${i}${e_(n,!0)}`}else s=`${s}/wc?${n}`;return s}function JR(r){let e="_self";XR()?e="_top":(ZR()||r.startsWith("https://")||r.startsWith("http://"))&&(e="_blank"),window.open(r,e,"noreferrer noopener")}async function YR(r,e){let t="";try{if(Al()&&(t=localStorage.getItem(e),t))return t;t=await r.getItem(e)}catch(n){console.error(n)}return t}function Rw(r,e){if(!r.includes(e))return null;const t=r.split(/([&,?,=])/),n=t.indexOf(e);return t[n+2]}function _w(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,r=>{const e=Math.random()*16|0;return(r==="x"?e:e&3|8).toString(16)})}function Cy(){return typeof process<"u"&&TR.IS_VITEST==="true"}function ZR(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function XR(){try{return window.self!==window.top}catch{return!1}}function e_(r,e=!1){const t=Buffer.from(r).toString("base64");return e?t.replace(/[=]/g,""):t}function f4(r){return Buffer.from(r,"base64").toString("utf-8")}function t_(r){return new Promise(e=>setTimeout(e,r))}let r_=class{constructor({limit:e}){Nw(this,"limit"),Nw(this,"set"),this.limit=e,this.set=new Set}add(e){if(!this.set.has(e)){if(this.set.size>=this.limit){const t=this.set.values().next().value;t&&this.set.delete(t)}this.set.add(e)}}has(e){return this.set.has(e)}};const rh=BigInt(2**32-1),Bw=BigInt(32);function h4(r,e=!1){return e?{h:Number(r&rh),l:Number(r>>Bw&rh)}:{h:Number(r>>Bw&rh)|0,l:Number(r&rh)|0}}function d4(r,e=!1){const t=r.length;let n=new Uint32Array(t),s=new Uint32Array(t);for(let i=0;i<t;i++){const{h:o,l:a}=h4(r[i],e);[n[i],s[i]]=[o,a]}return[n,s]}const kw=(r,e,t)=>r>>>t,Uw=(r,e,t)=>r<<32-t|e>>>t,si=(r,e,t)=>r>>>t|e<<32-t,ii=(r,e,t)=>r<<32-t|e>>>t,ru=(r,e,t)=>r<<64-t|e>>>t-32,nu=(r,e,t)=>r>>>t-32|e<<64-t,n_=(r,e)=>e,s_=(r,e)=>r,i_=(r,e,t)=>r<<t|e>>>32-t,o_=(r,e,t)=>e<<t|r>>>32-t,a_=(r,e,t)=>e<<t-32|r>>>64-t,c_=(r,e,t)=>r<<t-32|e>>>64-t;function Xr(r,e,t,n){const s=(e>>>0)+(n>>>0);return{h:r+t+(s/2**32|0)|0,l:s|0}}const Ty=(r,e,t)=>(r>>>0)+(e>>>0)+(t>>>0),Ny=(r,e,t,n)=>e+t+n+(r/2**32|0)|0,l_=(r,e,t,n)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0),u_=(r,e,t,n,s)=>e+t+n+s+(r/2**32|0)|0,f_=(r,e,t,n,s)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0)+(s>>>0),h_=(r,e,t,n,s,i)=>e+t+n+s+i+(r/2**32|0)|0,Pa=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function Wd(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function Ms(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function xn(r,...e){if(!Wd(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function Qd(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Ms(r.outputLen),Ms(r.blockLen)}function Mi(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function Dy(r,e){xn(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}function Uu(r){return new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4))}function Gr(...r){for(let e=0;e<r.length;e++)r[e].fill(0)}function rp(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function An(r,e){return r<<32-e|r>>>e}const p4=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function g4(r){return r<<24&4278190080|r<<8&16711680|r>>>8&65280|r>>>24&255}const hs=p4?r=>r:r=>g4(r);function d_(r){for(let e=0;e<r.length;e++)r[e]=g4(r[e]);return r}const oi=p4?r=>r:d_,b4=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",p_=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function Xa(r){if(xn(r),b4)return r.toHex();let e="";for(let t=0;t<r.length;t++)e+=p_[r[t]];return e}const as={_0:48,_9:57,A:65,F:70,a:97,f:102};function $w(r){if(r>=as._0&&r<=as._9)return r-as._0;if(r>=as.A&&r<=as.F)return r-(as.A-10);if(r>=as.a&&r<=as.f)return r-(as.a-10)}function ld(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);if(b4)return Uint8Array.fromHex(r);const e=r.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(t);for(let s=0,i=0;s<t;s++,i+=2){const o=$w(r.charCodeAt(i)),a=$w(r.charCodeAt(i+1));if(o===void 0||a===void 0){const c=r[i]+r[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}n[s]=o*16+a}return n}function y4(r){if(typeof r!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(r))}function yn(r){return typeof r=="string"&&(r=y4(r)),xn(r),r}function ci(...r){let e=0;for(let n=0;n<r.length;n++){const s=r[n];xn(s),e+=s.length}const t=new Uint8Array(e);for(let n=0,s=0;n<r.length;n++){const i=r[n];t.set(i,s),s+=i.length}return t}class Jd{}function vf(r){const e=n=>r().update(yn(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function g_(r){const e=(n,s)=>r(s).update(yn(n)).digest(),t=r({});return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=n=>r(n),e}function ha(r=32){if(Pa&&typeof Pa.getRandomValues=="function")return Pa.getRandomValues(new Uint8Array(r));if(Pa&&typeof Pa.randomBytes=="function")return Uint8Array.from(Pa.randomBytes(r));throw new Error("crypto.getRandomValues must be defined")}const b_=BigInt(0),$l=BigInt(1),y_=BigInt(2),m_=BigInt(7),x_=BigInt(256),w_=BigInt(113),m4=[],x4=[],w4=[];for(let r=0,e=$l,t=1,n=0;r<24;r++){[t,n]=[n,(2*t+3*n)%5],m4.push(2*(5*n+t)),x4.push((r+1)*(r+2)/2%64);let s=b_;for(let i=0;i<7;i++)e=(e<<$l^(e>>m_)*w_)%x_,e&y_&&(s^=$l<<($l<<BigInt(i))-$l);w4.push(s)}const E4=d4(w4,!0),E_=E4[0],v_=E4[1],Lw=(r,e,t)=>t>32?a_(r,e,t):i_(r,e,t),Fw=(r,e,t)=>t>32?c_(r,e,t):o_(r,e,t);function A_(r,e=24){const t=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)t[o]=r[o]^r[o+10]^r[o+20]^r[o+30]^r[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=t[c],u=t[c+1],f=Lw(l,u,1)^t[a],h=Fw(l,u,1)^t[a+1];for(let d=0;d<50;d+=10)r[o+d]^=f,r[o+d+1]^=h}let s=r[2],i=r[3];for(let o=0;o<24;o++){const a=x4[o],c=Lw(s,i,a),l=Fw(s,i,a),u=m4[o];s=r[u],i=r[u+1],r[u]=c,r[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=r[o+a];for(let a=0;a<10;a++)r[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}r[0]^=E_[n],r[1]^=v_[n]}Gr(t)}let I_=class v4 extends Jd{constructor(e,t,n,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=s,this.rounds=i,Ms(n),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=Uu(this.state)}clone(){return this._cloneInto()}keccak(){oi(this.state32),A_(this.state32,this.rounds),oi(this.state32),this.posOut=0,this.pos=0}update(e){Mi(this),e=yn(e),xn(e);const{blockLen:t,state:n}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(t-this.pos,s-i);for(let a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:s}=this;e[n]^=t,(t&128)!==0&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Mi(this,!1),xn(e),this.finish();const t=this.state,{blockLen:n}=this;for(let s=0,i=e.length;s<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-s);e.set(t.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Ms(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Dy(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Gr(this.state)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new v4(t,n,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const S_=(r,e,t)=>vf(()=>new I_(e,r,t)),O_=S_(1,136,256/8);function P_(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i),c=n?4:0,l=n?0:4;r.setUint32(e+c,o,n),r.setUint32(e+l,a,n)}function C_(r,e,t){return r&e^~r&t}function T_(r,e,t){return r&e^r&t^e&t}let A4=class extends Jd{constructor(e,t,n,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=s,this.buffer=new Uint8Array(e),this.view=rp(this.buffer)}update(e){Mi(this),e=yn(e),xn(e);const{view:t,buffer:n,blockLen:s}=this,i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=rp(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Mi(this),Dy(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;t[o++]=128,Gr(this.buffer.subarray(o)),this.padOffset>s-o&&(this.process(n,0),o=0);for(let f=o;f<s;f++)t[f]=0;P_(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=rp(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let f=0;f<l;f++)a.setUint32(4*f,u[f],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=i,e.length=s,e.pos=a,s%t&&e.buffer.set(n),e}clone(){return this._cloneInto()}};const Js=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ct=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),Tt=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),N_=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ys=new Uint32Array(64);class D_ extends A4{constructor(e=32){super(64,e,8,!1),this.A=Js[0]|0,this.B=Js[1]|0,this.C=Js[2]|0,this.D=Js[3]|0,this.E=Js[4]|0,this.F=Js[5]|0,this.G=Js[6]|0,this.H=Js[7]|0}get(){const{A:e,B:t,C:n,D:s,E:i,F:o,G:a,H:c}=this;return[e,t,n,s,i,o,a,c]}set(e,t,n,s,i,o,a,c){this.A=e|0,this.B=t|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,t){for(let f=0;f<16;f++,t+=4)Ys[f]=e.getUint32(t,!1);for(let f=16;f<64;f++){const h=Ys[f-15],d=Ys[f-2],p=An(h,7)^An(h,18)^h>>>3,g=An(d,17)^An(d,19)^d>>>10;Ys[f]=g+Ys[f-7]+p+Ys[f-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let f=0;f<64;f++){const h=An(a,6)^An(a,11)^An(a,25),d=u+h+C_(a,c,l)+N_[f]+Ys[f]|0,p=(An(n,2)^An(n,13)^An(n,22))+T_(n,s,i)|0;u=l,l=c,c=a,a=o+d|0,o=i,i=s,s=n,n=d+p|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(n,s,i,o,a,c,l,u)}roundClean(){Gr(Ys)}destroy(){this.set(0,0,0,0,0,0,0,0),Gr(this.buffer)}}const I4=d4(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))),R_=I4[0],__=I4[1],Zs=new Uint32Array(80),Xs=new Uint32Array(80);let Ry=class extends A4{constructor(e=64){super(128,e,16,!1),this.Ah=Tt[0]|0,this.Al=Tt[1]|0,this.Bh=Tt[2]|0,this.Bl=Tt[3]|0,this.Ch=Tt[4]|0,this.Cl=Tt[5]|0,this.Dh=Tt[6]|0,this.Dl=Tt[7]|0,this.Eh=Tt[8]|0,this.El=Tt[9]|0,this.Fh=Tt[10]|0,this.Fl=Tt[11]|0,this.Gh=Tt[12]|0,this.Gl=Tt[13]|0,this.Hh=Tt[14]|0,this.Hl=Tt[15]|0}get(){const{Ah:e,Al:t,Bh:n,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:f,Fl:h,Gh:d,Gl:p,Hh:g,Hl:y}=this;return[e,t,n,s,i,o,a,c,l,u,f,h,d,p,g,y]}set(e,t,n,s,i,o,a,c,l,u,f,h,d,p,g,y){this.Ah=e|0,this.Al=t|0,this.Bh=n|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=f|0,this.Fl=h|0,this.Gh=d|0,this.Gl=p|0,this.Hh=g|0,this.Hl=y|0}process(e,t){for(let w=0;w<16;w++,t+=4)Zs[w]=e.getUint32(t),Xs[w]=e.getUint32(t+=4);for(let w=16;w<80;w++){const O=Zs[w-15]|0,I=Xs[w-15]|0,E=si(O,I,1)^si(O,I,8)^kw(O,I,7),P=ii(O,I,1)^ii(O,I,8)^Uw(O,I,7),T=Zs[w-2]|0,D=Xs[w-2]|0,F=si(T,D,19)^ru(T,D,61)^kw(T,D,6),j=ii(T,D,19)^nu(T,D,61)^Uw(T,D,6),L=l_(P,j,Xs[w-7],Xs[w-16]),U=u_(L,E,F,Zs[w-7],Zs[w-16]);Zs[w]=U|0,Xs[w]=L|0}let{Ah:n,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:f,El:h,Fh:d,Fl:p,Gh:g,Gl:y,Hh:x,Hl:A}=this;for(let w=0;w<80;w++){const O=si(f,h,14)^si(f,h,18)^ru(f,h,41),I=ii(f,h,14)^ii(f,h,18)^nu(f,h,41),E=f&d^~f&g,P=h&p^~h&y,T=f_(A,I,P,__[w],Xs[w]),D=h_(T,x,O,E,R_[w],Zs[w]),F=T|0,j=si(n,s,28)^ru(n,s,34)^ru(n,s,39),L=ii(n,s,28)^nu(n,s,34)^nu(n,s,39),U=n&i^n&a^i&a,_=s&o^s&c^o&c;x=g|0,A=y|0,g=d|0,y=p|0,d=f|0,p=h|0,{h:f,l:h}=Xr(l|0,u|0,D|0,F|0),l=a|0,u=c|0,a=i|0,c=o|0,i=n|0,o=s|0;const m=Ty(F,L,_);n=Ny(m,D,j,U),s=m|0}({h:n,l:s}=Xr(this.Ah|0,this.Al|0,n|0,s|0)),{h:i,l:o}=Xr(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=Xr(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=Xr(this.Dh|0,this.Dl|0,l|0,u|0),{h:f,l:h}=Xr(this.Eh|0,this.El|0,f|0,h|0),{h:d,l:p}=Xr(this.Fh|0,this.Fl|0,d|0,p|0),{h:g,l:y}=Xr(this.Gh|0,this.Gl|0,g|0,y|0),{h:x,l:A}=Xr(this.Hh|0,this.Hl|0,x|0,A|0),this.set(n,s,i,o,a,c,l,u,f,h,d,p,g,y,x,A)}roundClean(){Gr(Zs,Xs)}destroy(){Gr(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};class B_ extends Ry{constructor(){super(48),this.Ah=Ct[0]|0,this.Al=Ct[1]|0,this.Bh=Ct[2]|0,this.Bl=Ct[3]|0,this.Ch=Ct[4]|0,this.Cl=Ct[5]|0,this.Dh=Ct[6]|0,this.Dl=Ct[7]|0,this.Eh=Ct[8]|0,this.El=Ct[9]|0,this.Fh=Ct[10]|0,this.Fl=Ct[11]|0,this.Gh=Ct[12]|0,this.Gl=Ct[13]|0,this.Hh=Ct[14]|0,this.Hl=Ct[15]|0}}const Nt=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class k_ extends Ry{constructor(){super(32),this.Ah=Nt[0]|0,this.Al=Nt[1]|0,this.Bh=Nt[2]|0,this.Bl=Nt[3]|0,this.Ch=Nt[4]|0,this.Cl=Nt[5]|0,this.Dh=Nt[6]|0,this.Dl=Nt[7]|0,this.Eh=Nt[8]|0,this.El=Nt[9]|0,this.Fh=Nt[10]|0,this.Fl=Nt[11]|0,this.Gh=Nt[12]|0,this.Gl=Nt[13]|0,this.Hh=Nt[14]|0,this.Hl=Nt[15]|0}}const Yd=vf(()=>new D_),U_=vf(()=>new Ry),$_=vf(()=>new B_),L_=vf(()=>new k_),F_=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),et=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),ee=new Uint32Array(32);function ei(r,e,t,n,s,i){const o=s[i],a=s[i+1];let c=ee[2*r],l=ee[2*r+1],u=ee[2*e],f=ee[2*e+1],h=ee[2*t],d=ee[2*t+1],p=ee[2*n],g=ee[2*n+1],y=Ty(c,u,o);l=Ny(y,l,f,a),c=y|0,{Dh:g,Dl:p}={Dh:g^l,Dl:p^c},{Dh:g,Dl:p}={Dh:n_(g,p),Dl:s_(g)},{h:d,l:h}=Xr(d,h,g,p),{Bh:f,Bl:u}={Bh:f^d,Bl:u^h},{Bh:f,Bl:u}={Bh:si(f,u,24),Bl:ii(f,u,24)},ee[2*r]=c,ee[2*r+1]=l,ee[2*e]=u,ee[2*e+1]=f,ee[2*t]=h,ee[2*t+1]=d,ee[2*n]=p,ee[2*n+1]=g}function ti(r,e,t,n,s,i){const o=s[i],a=s[i+1];let c=ee[2*r],l=ee[2*r+1],u=ee[2*e],f=ee[2*e+1],h=ee[2*t],d=ee[2*t+1],p=ee[2*n],g=ee[2*n+1],y=Ty(c,u,o);l=Ny(y,l,f,a),c=y|0,{Dh:g,Dl:p}={Dh:g^l,Dl:p^c},{Dh:g,Dl:p}={Dh:si(g,p,16),Dl:ii(g,p,16)},{h:d,l:h}=Xr(d,h,g,p),{Bh:f,Bl:u}={Bh:f^d,Bl:u^h},{Bh:f,Bl:u}={Bh:ru(f,u,63),Bl:nu(f,u,63)},ee[2*r]=c,ee[2*r+1]=l,ee[2*e]=u,ee[2*e+1]=f,ee[2*t]=h,ee[2*t+1]=d,ee[2*n]=p,ee[2*n+1]=g}function M_(r,e={},t,n,s){if(Ms(t),r<0||r>t)throw new Error("outputLen bigger than keyLen");const{key:i,salt:o,personalization:a}=e;if(i!==void 0&&(i.length<1||i.length>t))throw new Error("key length must be undefined or 1.."+t);if(o!==void 0&&o.length!==n)throw new Error("salt must be undefined or "+n);if(a!==void 0&&a.length!==s)throw new Error("personalization must be undefined or "+s)}class j_ extends Jd{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,Ms(e),Ms(t),this.blockLen=e,this.outputLen=t,this.buffer=new Uint8Array(e),this.buffer32=Uu(this.buffer)}update(e){Mi(this),e=yn(e),xn(e);const{blockLen:t,buffer:n,buffer32:s}=this,i=e.length,o=e.byteOffset,a=e.buffer;for(let c=0;c<i;){this.pos===t&&(oi(s),this.compress(s,0,!1),oi(s),this.pos=0);const l=Math.min(t-this.pos,i-c),u=o+c;if(l===t&&!(u%4)&&c+l<i){const f=new Uint32Array(a,u,Math.floor((i-c)/4));oi(f);for(let h=0;c+t<i;h+=s.length,c+=t)this.length+=t,this.compress(f,h,!1);oi(f);continue}n.set(e.subarray(c,c+l),this.pos),this.pos+=l,this.length+=l,c+=l}return this}digestInto(e){Mi(this),Dy(e,this);const{pos:t,buffer32:n}=this;this.finished=!0,Gr(this.buffer.subarray(t)),oi(n),this.compress(n,0,!0),oi(n);const s=Uu(e);this.get().forEach((i,o)=>s[o]=hs(i))}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){const{buffer:t,length:n,finished:s,destroyed:i,outputLen:o,pos:a}=this;return e||(e=new this.constructor({dkLen:o})),e.set(...this.get()),e.buffer.set(t),e.destroyed=i,e.finished=s,e.length=n,e.pos=a,e.outputLen=o,e}clone(){return this._cloneInto()}}class z_ extends j_{constructor(e={}){const t=e.dkLen===void 0?64:e.dkLen;super(128,t),this.v0l=et[0]|0,this.v0h=et[1]|0,this.v1l=et[2]|0,this.v1h=et[3]|0,this.v2l=et[4]|0,this.v2h=et[5]|0,this.v3l=et[6]|0,this.v3h=et[7]|0,this.v4l=et[8]|0,this.v4h=et[9]|0,this.v5l=et[10]|0,this.v5h=et[11]|0,this.v6l=et[12]|0,this.v6h=et[13]|0,this.v7l=et[14]|0,this.v7h=et[15]|0,M_(t,e,64,16,16);let{key:n,personalization:s,salt:i}=e,o=0;if(n!==void 0&&(n=yn(n),o=n.length),this.v0l^=this.outputLen|o<<8|65536|1<<24,i!==void 0){i=yn(i);const a=Uu(i);this.v4l^=hs(a[0]),this.v4h^=hs(a[1]),this.v5l^=hs(a[2]),this.v5h^=hs(a[3])}if(s!==void 0){s=yn(s);const a=Uu(s);this.v6l^=hs(a[0]),this.v6h^=hs(a[1]),this.v7l^=hs(a[2]),this.v7h^=hs(a[3])}if(n!==void 0){const a=new Uint8Array(this.blockLen);a.set(n),this.update(a)}}get(){let{v0l:e,v0h:t,v1l:n,v1h:s,v2l:i,v2h:o,v3l:a,v3h:c,v4l:l,v4h:u,v5l:f,v5h:h,v6l:d,v6h:p,v7l:g,v7h:y}=this;return[e,t,n,s,i,o,a,c,l,u,f,h,d,p,g,y]}set(e,t,n,s,i,o,a,c,l,u,f,h,d,p,g,y){this.v0l=e|0,this.v0h=t|0,this.v1l=n|0,this.v1h=s|0,this.v2l=i|0,this.v2h=o|0,this.v3l=a|0,this.v3h=c|0,this.v4l=l|0,this.v4h=u|0,this.v5l=f|0,this.v5h=h|0,this.v6l=d|0,this.v6h=p|0,this.v7l=g|0,this.v7h=y|0}compress(e,t,n){this.get().forEach((c,l)=>ee[l]=c),ee.set(et,16);let{h:s,l:i}=h4(BigInt(this.length));ee[24]=et[8]^i,ee[25]=et[9]^s,n&&(ee[28]=~ee[28],ee[29]=~ee[29]);let o=0;const a=F_;for(let c=0;c<12;c++)ei(0,4,8,12,e,t+2*a[o++]),ti(0,4,8,12,e,t+2*a[o++]),ei(1,5,9,13,e,t+2*a[o++]),ti(1,5,9,13,e,t+2*a[o++]),ei(2,6,10,14,e,t+2*a[o++]),ti(2,6,10,14,e,t+2*a[o++]),ei(3,7,11,15,e,t+2*a[o++]),ti(3,7,11,15,e,t+2*a[o++]),ei(0,5,10,15,e,t+2*a[o++]),ti(0,5,10,15,e,t+2*a[o++]),ei(1,6,11,12,e,t+2*a[o++]),ti(1,6,11,12,e,t+2*a[o++]),ei(2,7,8,13,e,t+2*a[o++]),ti(2,7,8,13,e,t+2*a[o++]),ei(3,4,9,14,e,t+2*a[o++]),ti(3,4,9,14,e,t+2*a[o++]);this.v0l^=ee[0]^ee[16],this.v0h^=ee[1]^ee[17],this.v1l^=ee[2]^ee[18],this.v1h^=ee[3]^ee[19],this.v2l^=ee[4]^ee[20],this.v2h^=ee[5]^ee[21],this.v3l^=ee[6]^ee[22],this.v3h^=ee[7]^ee[23],this.v4l^=ee[8]^ee[24],this.v4h^=ee[9]^ee[25],this.v5l^=ee[10]^ee[26],this.v5h^=ee[11]^ee[27],this.v6l^=ee[12]^ee[28],this.v6h^=ee[13]^ee[29],this.v7l^=ee[14]^ee[30],this.v7h^=ee[15]^ee[31],Gr(ee)}destroy(){this.destroyed=!0,Gr(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const H_=g_(r=>new z_(r)),q_="https://rpc.walletconnect.org/v1";function S4(r){const e=`Ethereum Signed Message:
${r.length}`,t=new TextEncoder().encode(e+r);return"0x"+Buffer.from(O_(t)).toString("hex")}async function V_(r,e,t,n,s,i){switch(t.t){case"eip191":return await K_(r,e,t.s);case"eip1271":return await G_(r,e,t.s,n,s,i);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${t.t}`)}}async function K_(r,e,t){return(await HP({hash:S4(e),signature:t})).toLowerCase()===r.toLowerCase()}async function G_(r,e,t,n,s,i){const o=_s(n);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${n}`);try{const a="0x1626ba7e",c="0000000000000000000000000000000000000000000000000000000000000040",l=t.substring(2),u=(l.length/2).toString(16).padStart(64,"0"),f=(e.startsWith("0x")?e:S4(e)).substring(2),h=a+f+c+u+l,d=await fetch(`${i||q_}/?chainId=${n}&projectId=${s}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:W_(),jsonrpc:"2.0",method:"eth_call",params:[{to:r,data:h},"latest"]})}),{result:p}=await d.json();return p?p.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function W_(){return Date.now()+Math.floor(Math.random()*1e3)}function Q_(r){const e=atob(r),t=new Uint8Array(e.length);for(let o=0;o<e.length;o++)t[o]=e.charCodeAt(o);const n=t[0];if(n===0)throw new Error("No signatures found");const s=1+n*64;if(t.length<s)throw new Error("Transaction data too short for claimed signature count");if(t.length<100)throw new Error("Transaction too short");const i=Buffer.from(r,"base64").slice(1,65);return mf.encode(i)}function J_(r){const e=new Uint8Array(Buffer.from(r,"base64")),t=Array.from("TransactionData::").map(i=>i.charCodeAt(0)),n=new Uint8Array(t.length+e.length);n.set(t),n.set(e,t.length);const s=H_(n,{dkLen:32});return mf.encode(s)}function Mw(r){const e=new Uint8Array(Yd(Y_(r)));return mf.encode(e)}function Y_(r){if(r instanceof Uint8Array)return r;if(Array.isArray(r))return new Uint8Array(r);if(typeof r=="object"&&r!=null&&r.data)return new Uint8Array(Object.values(r.data));if(typeof r=="object"&&r)return new Uint8Array(Object.values(r));throw new Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}function jw(r){const e=Buffer.from(r,"base64"),t=PC(e).txn;if(!t)throw new Error("Invalid signed transaction: missing 'txn' field");const n=mC(t),s=Buffer.from("TX"),i=Buffer.concat([s,Buffer.from(n)]),o=L_(i);return kC.encode(o).replace(/=+$/,"")}function np(r){const e=[];let t=BigInt(r);for(;t>=BigInt(128);)e.push(Number(t&BigInt(127)|BigInt(128))),t>>=BigInt(7);return e.push(Number(t)),Buffer.from(e)}function Z_(r){const e=Buffer.from(r.signed.bodyBytes,"base64"),t=Buffer.from(r.signed.authInfoBytes,"base64"),n=Buffer.from(r.signature.signature,"base64"),s=[];s.push(Buffer.from([10])),s.push(np(e.length)),s.push(e),s.push(Buffer.from([18])),s.push(np(t.length)),s.push(t),s.push(Buffer.from([26])),s.push(np(n.length)),s.push(n);const i=Buffer.concat(s),o=Yd(i);return Buffer.from(o).toString("hex").toUpperCase()}function X_(r){var e,t;const n=[];try{if(typeof r=="string")return n.push(r),n;if(typeof r!="object")return n;r!=null&&r.id&&n.push(r.id);const s=(t=(e=r==null?void 0:r.capabilities)==null?void 0:e.caip345)==null?void 0:t.transactionHashes;s&&n.push(...s)}catch(s){console.warn("getWalletSendCallsHashes failed: ",s)}return n}var eB=Object.defineProperty,tB=Object.defineProperties,rB=Object.getOwnPropertyDescriptors,zw=Object.getOwnPropertySymbols,nB=Object.prototype.hasOwnProperty,sB=Object.prototype.propertyIsEnumerable,Hw=(r,e,t)=>e in r?eB(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,iB=(r,e)=>{for(var t in e||(e={}))nB.call(e,t)&&Hw(r,t,e[t]);if(zw)for(var t of zw(e))sB.call(e,t)&&Hw(r,t,e[t]);return r},oB=(r,e)=>tB(r,rB(e));const aB="did:pkh:",_y=r=>r==null?void 0:r.split(":"),cB=r=>{const e=r&&_y(r);if(e)return r.includes(aB)?e[3]:e[1]},Wg=r=>{const e=r&&_y(r);if(e)return e[2]+":"+e[3]},ud=r=>{const e=r&&_y(r);if(e)return e.pop()};async function qw(r){const{cacao:e,projectId:t}=r,{s:n,p:s}=e,i=O4(s,s.iss),o=ud(s.iss);return await V_(o,i,n,Wg(s.iss),t)}const O4=(r,e)=>{const t=`${r.domain} wants you to sign in with your Ethereum account:`,n=ud(e);if(!r.aud&&!r.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let s=r.statement||void 0;const i=`URI: ${r.aud||r.uri}`,o=`Version: ${r.version}`,a=`Chain ID: ${cB(e)}`,c=`Nonce: ${r.nonce}`,l=`Issued At: ${r.iat}`,u=r.exp?`Expiration Time: ${r.exp}`:void 0,f=r.nbf?`Not Before: ${r.nbf}`:void 0,h=r.requestId?`Request ID: ${r.requestId}`:void 0,d=r.resources?`Resources:${r.resources.map(g=>`
- ${g}`).join("")}`:void 0,p=Bh(r.resources);if(p){const g=$u(p);s=yB(s,g)}return[t,n,"",s,"",i,o,a,c,l,u,f,h,d].filter(g=>g!=null).join(`
`)};function lB(r){return Buffer.from(JSON.stringify(r)).toString("base64")}function uB(r){return JSON.parse(Buffer.from(r,"base64").toString("utf-8"))}function aa(r){if(!r)throw new Error("No recap provided, value is undefined");if(!r.att)throw new Error("No `att` property found");const e=Object.keys(r.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(t=>{const n=r.att[t];if(Array.isArray(n))throw new Error(`Resource must be an object: ${t}`);if(typeof n!="object")throw new Error(`Resource must be an object: ${t}`);if(!Object.keys(n).length)throw new Error(`Resource object is empty: ${t}`);Object.keys(n).forEach(s=>{const i=n[s];if(!Array.isArray(i))throw new Error(`Ability limits ${s} must be an array of objects, found: ${i}`);if(!i.length)throw new Error(`Value of ${s} is empty array, must be an array with objects`);i.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${s}) must be an array of objects, found: ${o}`)})})})}function fB(r,e,t,n={}){return t==null||t.sort((s,i)=>s.localeCompare(i)),{att:{[r]:hB(e,t,n)}}}function hB(r,e,t={}){e=e==null?void 0:e.sort((s,i)=>s.localeCompare(i));const n=e.map(s=>({[`${r}/${s}`]:[t]}));return Object.assign({},...n)}function P4(r){return aa(r),`urn:recap:${lB(r).replace(/=/g,"")}`}function $u(r){const e=uB(r.replace("urn:recap:",""));return aa(e),e}function dB(r,e,t){const n=fB(r,e,t);return P4(n)}function pB(r){return r&&r.includes("urn:recap:")}function gB(r,e){const t=$u(r),n=$u(e),s=bB(t,n);return P4(s)}function bB(r,e){aa(r),aa(e);const t=Object.keys(r.att).concat(Object.keys(e.att)).sort((s,i)=>s.localeCompare(i)),n={att:{}};return t.forEach(s=>{var i,o;Object.keys(((i=r.att)==null?void 0:i[s])||{}).concat(Object.keys(((o=e.att)==null?void 0:o[s])||{})).sort((a,c)=>a.localeCompare(c)).forEach(a=>{var c,l;n.att[s]=oB(iB({},n.att[s]),{[a]:((c=r.att[s])==null?void 0:c[a])||((l=e.att[s])==null?void 0:l[a])})})}),n}function yB(r="",e){aa(e);const t="I further authorize the stated URI to perform the following actions on my behalf: ";if(r.includes(t))return r;const n=[];let s=0;Object.keys(e.att).forEach(a=>{const c=Object.keys(e.att[a]).map(f=>({ability:f.split("/")[0],action:f.split("/")[1]}));c.sort((f,h)=>f.action.localeCompare(h.action));const l={};c.forEach(f=>{l[f.ability]||(l[f.ability]=[]),l[f.ability].push(f.action)});const u=Object.keys(l).map(f=>(s++,`(${s}) '${f}': '${l[f].join("', '")}' for '${a}'.`));n.push(u.join(", ").replace(".,","."))});const i=n.join(" "),o=`${t}${i}`;return`${r?r+" ":""}${o}`}function Vw(r){var e;const t=$u(r);aa(t);const n=(e=t.att)==null?void 0:e.eip155;return n?Object.keys(n).map(s=>s.split("/")[1]):[]}function Kw(r){const e=$u(r);aa(e);const t=[];return Object.values(e.att).forEach(n=>{Object.values(n).forEach(s=>{var i;(i=s==null?void 0:s[0])!=null&&i.chains&&t.push(s[0].chains)})}),[...new Set(t.flat())]}function Bh(r){if(!r)return;const e=r==null?void 0:r[r.length-1];return pB(e)?e:void 0}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */function C4(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function Qg(r){if(typeof r!="boolean")throw new Error(`boolean expected, not ${r}`)}function sp(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function tr(r,...e){if(!C4(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function Gw(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function mB(r,e){tr(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}function Ui(r){return new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4))}function hl(...r){for(let e=0;e<r.length;e++)r[e].fill(0)}function xB(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}const wB=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function EB(r){if(typeof r!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(r))}function Jg(r){if(typeof r=="string")r=EB(r);else if(C4(r))r=Yg(r);else throw new Error("Uint8Array expected, got "+typeof r);return r}function vB(r,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(r,e)}function AB(r,e){if(r.length!==e.length)return!1;let t=0;for(let n=0;n<r.length;n++)t|=r[n]^e[n];return t===0}const IB=(r,e)=>{function t(n,...s){if(tr(n),!wB)throw new Error("Non little-endian hardware is not yet supported");if(r.nonceLength!==void 0){const l=s[0];if(!l)throw new Error("nonce / iv required");r.varSizeNonce?tr(l):tr(l,r.nonceLength)}const i=r.tagLength;i&&s[1]!==void 0&&tr(s[1]);const o=e(n,...s),a=(l,u)=>{if(u!==void 0){if(l!==2)throw new Error("cipher output not supported");tr(u)}};let c=!1;return{encrypt(l,u){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,tr(l),a(o.encrypt.length,u),o.encrypt(l,u)},decrypt(l,u){if(tr(l),i&&l.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return a(o.decrypt.length,u),o.decrypt(l,u)}}}return Object.assign(t,r),t};function Ww(r,e,t=!0){if(e===void 0)return new Uint8Array(r);if(e.length!==r)throw new Error("invalid output length, expected "+r+", got: "+e.length);if(t&&!OB(e))throw new Error("invalid output, must be aligned");return e}function Qw(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i);r.setUint32(e+4,o,n),r.setUint32(e+0,a,n)}function SB(r,e,t){Qg(t);const n=new Uint8Array(16),s=xB(n);return Qw(s,0,BigInt(e),t),Qw(s,8,BigInt(r),t),n}function OB(r){return r.byteOffset%4===0}function Yg(r){return Uint8Array.from(r)}const T4=r=>Uint8Array.from(r.split("").map(e=>e.charCodeAt(0))),PB=T4("expand 16-byte k"),CB=T4("expand 32-byte k"),TB=Ui(PB),NB=Ui(CB);function Ee(r,e){return r<<e|r>>>32-e}function Zg(r){return r.byteOffset%4===0}const nh=64,DB=16,N4=2**32-1,Jw=new Uint32Array;function RB(r,e,t,n,s,i,o,a){const c=s.length,l=new Uint8Array(nh),u=Ui(l),f=Zg(s)&&Zg(i),h=f?Ui(s):Jw,d=f?Ui(i):Jw;for(let p=0;p<c;o++){if(r(e,t,n,u,o,a),o>=N4)throw new Error("arx: counter overflow");const g=Math.min(nh,c-p);if(f&&g===nh){const y=p/4;if(p%4!==0)throw new Error("arx: invalid block position");for(let x=0,A;x<DB;x++)A=y+x,d[A]=h[A]^u[x];p+=nh;continue}for(let y=0,x;y<g;y++)x=p+y,i[x]=s[x]^l[y];p+=g}}function _B(r,e){const{allowShortKeys:t,extendNonceFn:n,counterLength:s,counterRight:i,rounds:o}=vB({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof r!="function")throw new Error("core must be a function");return sp(s),sp(o),Qg(i),Qg(t),(a,c,l,u,f=0)=>{tr(a),tr(c),tr(l);const h=l.length;if(u===void 0&&(u=new Uint8Array(h)),tr(u),sp(f),f<0||f>=N4)throw new Error("arx: counter overflow");if(u.length<h)throw new Error(`arx: output (${u.length}) is shorter than data (${h})`);const d=[];let p=a.length,g,y;if(p===32)d.push(g=Yg(a)),y=NB;else if(p===16&&t)g=new Uint8Array(32),g.set(a),g.set(a,16),y=TB,d.push(g);else throw new Error(`arx: invalid 32-byte key, got length=${p}`);Zg(c)||d.push(c=Yg(c));const x=Ui(g);if(n){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");n(y,x,Ui(c.subarray(0,16)),x),c=c.subarray(16)}const A=16-s;if(A!==c.length)throw new Error(`arx: nonce must be ${A} or 16 bytes`);if(A!==12){const O=new Uint8Array(12);O.set(c,i?0:12-c.length),c=O,d.push(c)}const w=Ui(c);return RB(r,y,x,w,l,u,f,o),hl(...d),u}}const bt=(r,e)=>r[e++]&255|(r[e++]&255)<<8;class BB{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=Jg(e),tr(e,32);const t=bt(e,0),n=bt(e,2),s=bt(e,4),i=bt(e,6),o=bt(e,8),a=bt(e,10),c=bt(e,12),l=bt(e,14);this.r[0]=t&8191,this.r[1]=(t>>>13|n<<3)&8191,this.r[2]=(n>>>10|s<<6)&7939,this.r[3]=(s>>>7|i<<9)&8191,this.r[4]=(i>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let u=0;u<8;u++)this.pad[u]=bt(e,16+2*u)}process(e,t,n=!1){const s=n?0:2048,{h:i,r:o}=this,a=o[0],c=o[1],l=o[2],u=o[3],f=o[4],h=o[5],d=o[6],p=o[7],g=o[8],y=o[9],x=bt(e,t+0),A=bt(e,t+2),w=bt(e,t+4),O=bt(e,t+6),I=bt(e,t+8),E=bt(e,t+10),P=bt(e,t+12),T=bt(e,t+14);let D=i[0]+(x&8191),F=i[1]+((x>>>13|A<<3)&8191),j=i[2]+((A>>>10|w<<6)&8191),L=i[3]+((w>>>7|O<<9)&8191),U=i[4]+((O>>>4|I<<12)&8191),_=i[5]+(I>>>1&8191),m=i[6]+((I>>>14|E<<2)&8191),v=i[7]+((E>>>11|P<<5)&8191),N=i[8]+((P>>>8|T<<8)&8191),$=i[9]+(T>>>5|s),R=0,B=R+D*a+F*(5*y)+j*(5*g)+L*(5*p)+U*(5*d);R=B>>>13,B&=8191,B+=_*(5*h)+m*(5*f)+v*(5*u)+N*(5*l)+$*(5*c),R+=B>>>13,B&=8191;let H=R+D*c+F*a+j*(5*y)+L*(5*g)+U*(5*p);R=H>>>13,H&=8191,H+=_*(5*d)+m*(5*h)+v*(5*f)+N*(5*u)+$*(5*l),R+=H>>>13,H&=8191;let V=R+D*l+F*c+j*a+L*(5*y)+U*(5*g);R=V>>>13,V&=8191,V+=_*(5*p)+m*(5*d)+v*(5*h)+N*(5*f)+$*(5*u),R+=V>>>13,V&=8191;let X=R+D*u+F*l+j*c+L*a+U*(5*y);R=X>>>13,X&=8191,X+=_*(5*g)+m*(5*p)+v*(5*d)+N*(5*h)+$*(5*f),R+=X>>>13,X&=8191;let W=R+D*f+F*u+j*l+L*c+U*a;R=W>>>13,W&=8191,W+=_*(5*y)+m*(5*g)+v*(5*p)+N*(5*d)+$*(5*h),R+=W>>>13,W&=8191;let J=R+D*h+F*f+j*u+L*l+U*c;R=J>>>13,J&=8191,J+=_*a+m*(5*y)+v*(5*g)+N*(5*p)+$*(5*d),R+=J>>>13,J&=8191;let ne=R+D*d+F*h+j*f+L*u+U*l;R=ne>>>13,ne&=8191,ne+=_*c+m*a+v*(5*y)+N*(5*g)+$*(5*p),R+=ne>>>13,ne&=8191;let oe=R+D*p+F*d+j*h+L*f+U*u;R=oe>>>13,oe&=8191,oe+=_*l+m*c+v*a+N*(5*y)+$*(5*g),R+=oe>>>13,oe&=8191;let fe=R+D*g+F*p+j*d+L*h+U*f;R=fe>>>13,fe&=8191,fe+=_*u+m*l+v*c+N*a+$*(5*y),R+=fe>>>13,fe&=8191;let ie=R+D*y+F*g+j*p+L*d+U*h;R=ie>>>13,ie&=8191,ie+=_*f+m*u+v*l+N*c+$*a,R+=ie>>>13,ie&=8191,R=(R<<2)+R|0,R=R+B|0,B=R&8191,R=R>>>13,H+=R,i[0]=B,i[1]=H,i[2]=V,i[3]=X,i[4]=W,i[5]=J,i[6]=ne,i[7]=oe,i[8]=fe,i[9]=ie}finalize(){const{h:e,pad:t}=this,n=new Uint16Array(10);let s=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=s,s=e[a]>>>13,e[a]&=8191;e[0]+=s*5,s=e[0]>>>13,e[0]&=8191,e[1]+=s,s=e[1]>>>13,e[1]&=8191,e[2]+=s,n[0]=e[0]+5,s=n[0]>>>13,n[0]&=8191;for(let a=1;a<10;a++)n[a]=e[a]+s,s=n[a]>>>13,n[a]&=8191;n[9]-=8192;let i=(s^1)-1;for(let a=0;a<10;a++)n[a]&=i;i=~i;for(let a=0;a<10;a++)e[a]=e[a]&i|n[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+t[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+t[a]|0)+(o>>>16)|0,e[a]=o&65535;hl(n)}update(e){Gw(this),e=Jg(e),tr(e);const{buffer:t,blockLen:n}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);if(o===n){for(;n<=s-i;i+=n)this.process(e,i);continue}t.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===n&&(this.process(t,0,!1),this.pos=0)}return this}destroy(){hl(this.h,this.r,this.buffer,this.pad)}digestInto(e){Gw(this),mB(e,this),this.finished=!0;const{buffer:t,h:n}=this;let{pos:s}=this;if(s){for(t[s++]=1;s<16;s++)t[s]=0;this.process(t,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)e[i++]=n[o]>>>0,e[i++]=n[o]>>>8;return e}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}}function kB(r){const e=(n,s)=>r(s).update(Jg(n)).digest(),t=r(new Uint8Array(32));return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=n=>r(n),e}const UB=kB(r=>new BB(r));function $B(r,e,t,n,s,i=20){let o=r[0],a=r[1],c=r[2],l=r[3],u=e[0],f=e[1],h=e[2],d=e[3],p=e[4],g=e[5],y=e[6],x=e[7],A=s,w=t[0],O=t[1],I=t[2],E=o,P=a,T=c,D=l,F=u,j=f,L=h,U=d,_=p,m=g,v=y,N=x,$=A,R=w,B=O,H=I;for(let X=0;X<i;X+=2)E=E+F|0,$=Ee($^E,16),_=_+$|0,F=Ee(F^_,12),E=E+F|0,$=Ee($^E,8),_=_+$|0,F=Ee(F^_,7),P=P+j|0,R=Ee(R^P,16),m=m+R|0,j=Ee(j^m,12),P=P+j|0,R=Ee(R^P,8),m=m+R|0,j=Ee(j^m,7),T=T+L|0,B=Ee(B^T,16),v=v+B|0,L=Ee(L^v,12),T=T+L|0,B=Ee(B^T,8),v=v+B|0,L=Ee(L^v,7),D=D+U|0,H=Ee(H^D,16),N=N+H|0,U=Ee(U^N,12),D=D+U|0,H=Ee(H^D,8),N=N+H|0,U=Ee(U^N,7),E=E+j|0,H=Ee(H^E,16),v=v+H|0,j=Ee(j^v,12),E=E+j|0,H=Ee(H^E,8),v=v+H|0,j=Ee(j^v,7),P=P+L|0,$=Ee($^P,16),N=N+$|0,L=Ee(L^N,12),P=P+L|0,$=Ee($^P,8),N=N+$|0,L=Ee(L^N,7),T=T+U|0,R=Ee(R^T,16),_=_+R|0,U=Ee(U^_,12),T=T+U|0,R=Ee(R^T,8),_=_+R|0,U=Ee(U^_,7),D=D+F|0,B=Ee(B^D,16),m=m+B|0,F=Ee(F^m,12),D=D+F|0,B=Ee(B^D,8),m=m+B|0,F=Ee(F^m,7);let V=0;n[V++]=o+E|0,n[V++]=a+P|0,n[V++]=c+T|0,n[V++]=l+D|0,n[V++]=u+F|0,n[V++]=f+j|0,n[V++]=h+L|0,n[V++]=d+U|0,n[V++]=p+_|0,n[V++]=g+m|0,n[V++]=y+v|0,n[V++]=x+N|0,n[V++]=A+$|0,n[V++]=w+R|0,n[V++]=O+B|0,n[V++]=I+H|0}const LB=_B($B,{counterRight:!1,counterLength:4,allowShortKeys:!1}),FB=new Uint8Array(16),Yw=(r,e)=>{r.update(e);const t=e.length%16;t&&r.update(FB.subarray(t))},MB=new Uint8Array(32);function Zw(r,e,t,n,s){const i=r(e,t,MB),o=UB.create(i);s&&Yw(o,s),Yw(o,n);const a=SB(n.length,s?s.length:0,!0);o.update(a);const c=o.digest();return hl(i,a),c}const jB=r=>(e,t,n)=>({encrypt(s,i){const o=s.length;i=Ww(o+16,i,!1),i.set(s);const a=i.subarray(0,-16);r(e,t,a,a,1);const c=Zw(r,e,t,a,n);return i.set(c,o),hl(c),i},decrypt(s,i){i=Ww(s.length-16,i,!1);const o=s.subarray(0,-16),a=s.subarray(-16),c=Zw(r,e,t,o,n);if(!AB(a,c))throw new Error("invalid tag");return i.set(s.subarray(0,-16)),r(e,t,i,i,1),hl(c),i}}),D4=IB({blockSize:64,nonceLength:12,tagLength:16},jB(LB));let R4=class extends Jd{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,Qd(e);const n=yn(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(n.length>s?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),Gr(i)}update(e){return Mi(this),this.iHash.update(e),this}digestInto(e){Mi(this),xn(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const Zd=(r,e,t)=>new R4(r,e).update(t).digest();Zd.create=(r,e)=>new R4(r,e);function zB(r,e,t){return Qd(r),t===void 0&&(t=new Uint8Array(r.outputLen)),Zd(r,yn(t),yn(e))}const ip=Uint8Array.from([0]),Xw=Uint8Array.of();function HB(r,e,t,n=32){Qd(r),Ms(n);const s=r.outputLen;if(n>255*s)throw new Error("Length should be <= 255*HashLen");const i=Math.ceil(n/s);t===void 0&&(t=Xw);const o=new Uint8Array(i*s),a=Zd.create(r,e),c=a._cloneInto(),l=new Uint8Array(a.outputLen);for(let u=0;u<i;u++)ip[0]=u+1,c.update(u===0?Xw:l).update(t).update(ip).digestInto(l),o.set(l,s*u),a._cloneInto(c);return a.destroy(),c.destroy(),Gr(l,ip),o.slice(0,n)}const qB=(r,e,t,n,s)=>HB(r,zB(r,e,t),n,s),Xd=Yd,By=BigInt(0),Xg=BigInt(1);function fd(r,e=""){if(typeof r!="boolean"){const t=e&&`"${e}"`;throw new Error(t+"expected boolean, got type="+typeof r)}return r}function vo(r,e,t=""){const n=Wd(r),s=r==null?void 0:r.length,i=e!==void 0;if(!n||i&&s!==e){const o=t&&`"${t}" `,a=i?` of length ${e}`:"",c=n?`length=${s}`:`type=${typeof r}`;throw new Error(o+"expected Uint8Array"+a+", got "+c)}return r}function sh(r){const e=r.toString(16);return e.length&1?"0"+e:e}function _4(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return r===""?By:BigInt("0x"+r)}function e0(r){return _4(Xa(r))}function hd(r){return xn(r),_4(Xa(Uint8Array.from(r).reverse()))}function ky(r,e){return ld(r.toString(16).padStart(e*2,"0"))}function Uy(r,e){return ky(r,e).reverse()}function Ut(r,e,t){let n;if(typeof e=="string")try{n=ld(e)}catch(i){throw new Error(r+" must be hex string or Uint8Array, cause: "+i)}else if(Wd(e))n=Uint8Array.from(e);else throw new Error(r+" must be hex string or Uint8Array");const s=n.length;if(typeof t=="number"&&s!==t)throw new Error(r+" of length "+t+" expected, got "+s);return n}const op=r=>typeof r=="bigint"&&By<=r;function VB(r,e,t){return op(r)&&op(e)&&op(t)&&e<=r&&r<t}function eb(r,e,t,n){if(!VB(e,t,n))throw new Error("expected valid "+r+": "+t+" <= n < "+n+", got "+e)}function B4(r){let e;for(e=0;r>By;r>>=Xg,e+=1);return e}const Af=r=>(Xg<<BigInt(r))-Xg;function KB(r,e,t){if(typeof r!="number"||r<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");const n=h=>new Uint8Array(h),s=h=>Uint8Array.of(h);let i=n(r),o=n(r),a=0;const c=()=>{i.fill(1),o.fill(0),a=0},l=(...h)=>t(o,i,...h),u=(h=n(0))=>{o=l(s(0),h),i=l(),h.length!==0&&(o=l(s(1),h),i=l())},f=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let h=0;const d=[];for(;h<e;){i=l();const p=i.slice();d.push(p),h+=i.length}return ci(...d)};return(h,d)=>{c(),u(h);let p;for(;!(p=d(f()));)u();return c(),p}}function t0(r,e,t={}){if(!r||typeof r!="object")throw new Error("expected valid options object");function n(s,i,o){const a=r[s];if(o&&a===void 0)return;const c=typeof a;if(c!==i||a===null)throw new Error(`param "${s}" is invalid: expected ${i}, got ${c}`)}Object.entries(e).forEach(([s,i])=>n(s,i,!1)),Object.entries(t).forEach(([s,i])=>n(s,i,!0))}function e1(r){const e=new WeakMap;return(t,...n)=>{const s=e.get(t);if(s!==void 0)return s;const i=r(t,...n);return e.set(t,i),i}}const nr=BigInt(0),Ht=BigInt(1),Ao=BigInt(2),k4=BigInt(3),U4=BigInt(4),$4=BigInt(5),GB=BigInt(7),L4=BigInt(8),WB=BigInt(9),F4=BigInt(16);function mr(r,e){const t=r%e;return t>=nr?t:e+t}function Jr(r,e,t){let n=r;for(;e-- >nr;)n*=n,n%=t;return n}function t1(r,e){if(r===nr)throw new Error("invert: expected non-zero number");if(e<=nr)throw new Error("invert: expected positive modulus, got "+e);let t=mr(r,e),n=e,s=nr,i=Ht;for(;t!==nr;){const o=n/t,a=n%t,c=s-i*o;n=t,t=a,s=i,i=c}if(n!==Ht)throw new Error("invert: does not exist");return mr(s,e)}function $y(r,e,t){if(!r.eql(r.sqr(e),t))throw new Error("Cannot find square root")}function M4(r,e){const t=(r.ORDER+Ht)/U4,n=r.pow(e,t);return $y(r,n,e),n}function QB(r,e){const t=(r.ORDER-$4)/L4,n=r.mul(e,Ao),s=r.pow(n,t),i=r.mul(e,s),o=r.mul(r.mul(i,Ao),s),a=r.mul(i,r.sub(o,r.ONE));return $y(r,a,e),a}function JB(r){const e=Ji(r),t=j4(r),n=t(e,e.neg(e.ONE)),s=t(e,n),i=t(e,e.neg(n)),o=(r+GB)/F4;return(a,c)=>{let l=a.pow(c,o),u=a.mul(l,n);const f=a.mul(l,s),h=a.mul(l,i),d=a.eql(a.sqr(u),c),p=a.eql(a.sqr(f),c);l=a.cmov(l,u,d),u=a.cmov(h,f,p);const g=a.eql(a.sqr(u),c),y=a.cmov(l,u,g);return $y(a,y,c),y}}function j4(r){if(r<k4)throw new Error("sqrt is not defined for small field");let e=r-Ht,t=0;for(;e%Ao===nr;)e/=Ao,t++;let n=Ao;const s=Ji(r);for(;r1(s,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(t===1)return M4;let i=s.pow(n,e);const o=(e+Ht)/Ao;return function(a,c){if(a.is0(c))return c;if(r1(a,c)!==1)throw new Error("Cannot find square root");let l=t,u=a.mul(a.ONE,i),f=a.pow(c,e),h=a.pow(c,o);for(;!a.eql(f,a.ONE);){if(a.is0(f))return a.ZERO;let d=1,p=a.sqr(f);for(;!a.eql(p,a.ONE);)if(d++,p=a.sqr(p),d===l)throw new Error("Cannot find square root");const g=Ht<<BigInt(l-d-1),y=a.pow(u,g);l=d,u=a.sqr(y),f=a.mul(f,u),h=a.mul(h,y)}return h}}function YB(r){return r%U4===k4?M4:r%L4===$4?QB:r%F4===WB?JB(r):j4(r)}const ZB=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function XB(r){const e={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},t=ZB.reduce((n,s)=>(n[s]="function",n),e);return t0(r,t),r}function ek(r,e,t){if(t<nr)throw new Error("invalid exponent, negatives unsupported");if(t===nr)return r.ONE;if(t===Ht)return e;let n=r.ONE,s=e;for(;t>nr;)t&Ht&&(n=r.mul(n,s)),s=r.sqr(s),t>>=Ht;return n}function z4(r,e,t=!1){const n=new Array(e.length).fill(t?r.ZERO:void 0),s=e.reduce((o,a,c)=>r.is0(a)?o:(n[c]=o,r.mul(o,a)),r.ONE),i=r.inv(s);return e.reduceRight((o,a,c)=>r.is0(a)?o:(n[c]=r.mul(o,n[c]),r.mul(o,a)),i),n}function r1(r,e){const t=(r.ORDER-Ht)/Ao,n=r.pow(e,t),s=r.eql(n,r.ONE),i=r.eql(n,r.ZERO),o=r.eql(n,r.neg(r.ONE));if(!s&&!i&&!o)throw new Error("invalid Legendre symbol result");return s?1:i?0:-1}function H4(r,e){e!==void 0&&Ms(e);const t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function Ji(r,e,t=!1,n={}){if(r<=nr)throw new Error("invalid field: expected ORDER > 0, got "+r);let s,i,o=!1,a;if(typeof e=="object"&&e!=null){if(n.sqrt||t)throw new Error("cannot specify opts in two arguments");const h=e;h.BITS&&(s=h.BITS),h.sqrt&&(i=h.sqrt),typeof h.isLE=="boolean"&&(t=h.isLE),typeof h.modFromBytes=="boolean"&&(o=h.modFromBytes),a=h.allowedLengths}else typeof e=="number"&&(s=e),n.sqrt&&(i=n.sqrt);const{nBitLength:c,nByteLength:l}=H4(r,s);if(l>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let u;const f=Object.freeze({ORDER:r,isLE:t,BITS:c,BYTES:l,MASK:Af(c),ZERO:nr,ONE:Ht,allowedLengths:a,create:h=>mr(h,r),isValid:h=>{if(typeof h!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof h);return nr<=h&&h<r},is0:h=>h===nr,isValidNot0:h=>!f.is0(h)&&f.isValid(h),isOdd:h=>(h&Ht)===Ht,neg:h=>mr(-h,r),eql:(h,d)=>h===d,sqr:h=>mr(h*h,r),add:(h,d)=>mr(h+d,r),sub:(h,d)=>mr(h-d,r),mul:(h,d)=>mr(h*d,r),pow:(h,d)=>ek(f,h,d),div:(h,d)=>mr(h*t1(d,r),r),sqrN:h=>h*h,addN:(h,d)=>h+d,subN:(h,d)=>h-d,mulN:(h,d)=>h*d,inv:h=>t1(h,r),sqrt:i||(h=>(u||(u=YB(r)),u(f,h))),toBytes:h=>t?Uy(h,l):ky(h,l),fromBytes:(h,d=!0)=>{if(a){if(!a.includes(h.length)||h.length>l)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+h.length);const g=new Uint8Array(l);g.set(h,t?0:g.length-h.length),h=g}if(h.length!==l)throw new Error("Field.fromBytes: expected "+l+" bytes, got "+h.length);let p=t?hd(h):e0(h);if(o&&(p=mr(p,r)),!d&&!f.isValid(p))throw new Error("invalid field element: outside of range 0..ORDER");return p},invertBatch:h=>z4(f,h),cmov:(h,d,p)=>p?d:h});return Object.freeze(f)}function q4(r){if(typeof r!="bigint")throw new Error("field order must be bigint");const e=r.toString(2).length;return Math.ceil(e/8)}function V4(r){const e=q4(r);return e+Math.ceil(e/2)}function tk(r,e,t=!1){const n=r.length,s=q4(e),i=V4(e);if(n<16||n<i||n>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+n);const o=t?hd(r):e0(r),a=mr(o,e-Ht)+Ht;return t?Uy(a,s):ky(a,s)}const dl=BigInt(0),Io=BigInt(1);function dd(r,e){const t=e.negate();return r?t:e}function ap(r,e){const t=z4(r.Fp,e.map(n=>n.Z));return e.map((n,s)=>r.fromAffine(n.toAffine(t[s])))}function K4(r,e){if(!Number.isSafeInteger(r)||r<=0||r>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+r)}function cp(r,e){K4(r,e);const t=Math.ceil(e/r)+1,n=2**(r-1),s=2**r,i=Af(r),o=BigInt(r);return{windows:t,windowSize:n,mask:i,maxNumber:s,shiftBy:o}}function n1(r,e,t){const{windowSize:n,mask:s,maxNumber:i,shiftBy:o}=t;let a=Number(r&s),c=r>>o;a>n&&(a-=i,c+=Io);const l=e*n,u=l+Math.abs(a)-1,f=a===0,h=a<0,d=e%2!==0;return{nextN:c,offset:u,isZero:f,isNeg:h,isNegF:d,offsetF:l}}function rk(r,e){if(!Array.isArray(r))throw new Error("array expected");r.forEach((t,n)=>{if(!(t instanceof e))throw new Error("invalid point at index "+n)})}function nk(r,e){if(!Array.isArray(r))throw new Error("array of scalars expected");r.forEach((t,n)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+n)})}const lp=new WeakMap,G4=new WeakMap;function up(r){return G4.get(r)||1}function s1(r){if(r!==dl)throw new Error("invalid wNAF")}class sk{constructor(e,t){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=t}_unsafeLadder(e,t,n=this.ZERO){let s=e;for(;t>dl;)t&Io&&(n=n.add(s)),s=s.double(),t>>=Io;return n}precomputeWindow(e,t){const{windows:n,windowSize:s}=cp(t,this.bits),i=[];let o=e,a=o;for(let c=0;c<n;c++){a=o,i.push(a);for(let l=1;l<s;l++)a=a.add(o),i.push(a);o=a.double()}return i}wNAF(e,t,n){if(!this.Fn.isValid(n))throw new Error("invalid scalar");let s=this.ZERO,i=this.BASE;const o=cp(e,this.bits);for(let a=0;a<o.windows;a++){const{nextN:c,offset:l,isZero:u,isNeg:f,isNegF:h,offsetF:d}=n1(n,a,o);n=c,u?i=i.add(dd(h,t[d])):s=s.add(dd(f,t[l]))}return s1(n),{p:s,f:i}}wNAFUnsafe(e,t,n,s=this.ZERO){const i=cp(e,this.bits);for(let o=0;o<i.windows&&n!==dl;o++){const{nextN:a,offset:c,isZero:l,isNeg:u}=n1(n,o,i);if(n=a,!l){const f=t[c];s=s.add(u?f.negate():f)}}return s1(n),s}getPrecomputes(e,t,n){let s=lp.get(t);return s||(s=this.precomputeWindow(t,e),e!==1&&(typeof n=="function"&&(s=n(s)),lp.set(t,s))),s}cached(e,t,n){const s=up(e);return this.wNAF(s,this.getPrecomputes(s,e,n),t)}unsafe(e,t,n,s){const i=up(e);return i===1?this._unsafeLadder(e,t,s):this.wNAFUnsafe(i,this.getPrecomputes(i,e,n),t,s)}createCache(e,t){K4(t,this.bits),G4.set(e,t),lp.delete(e)}hasCache(e){return up(e)!==1}}function ik(r,e,t,n){let s=e,i=r.ZERO,o=r.ZERO;for(;t>dl||n>dl;)t&Io&&(i=i.add(s)),n&Io&&(o=o.add(s)),s=s.double(),t>>=Io,n>>=Io;return{p1:i,p2:o}}function ok(r,e,t,n){rk(t,r),nk(n,e);const s=t.length,i=n.length;if(s!==i)throw new Error("arrays of points and scalars must have equal length");const o=r.ZERO,a=B4(BigInt(s));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const l=Af(c),u=new Array(Number(l)+1).fill(o),f=Math.floor((e.BITS-1)/c)*c;let h=o;for(let d=f;d>=0;d-=c){u.fill(o);for(let g=0;g<i;g++){const y=n[g],x=Number(y>>BigInt(d)&l);u[x]=u[x].add(t[g])}let p=o;for(let g=u.length-1,y=o;g>0;g--)y=y.add(u[g]),p=p.add(y);if(h=h.add(p),d!==0)for(let g=0;g<c;g++)h=h.double()}return h}function i1(r,e,t){if(e){if(e.ORDER!==r)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return XB(e),e}else return Ji(r,{isLE:t})}function ak(r,e,t={},n){if(n===void 0&&(n=r==="edwards"),!e||typeof e!="object")throw new Error(`expected valid ${r} CURVE object`);for(const a of["p","n","h"]){const c=e[a];if(!(typeof c=="bigint"&&c>dl))throw new Error(`CURVE.${a} must be positive bigint`)}const s=i1(e.p,t.Fp,n),i=i1(e.n,t.Fn,n),o=["Gx","Gy","a","b"];for(const a of o)if(!s.isValid(e[a]))throw new Error(`CURVE.${a} must be valid field element of CURVE.Fp`);return e=Object.freeze(Object.assign({},e)),{CURVE:e,Fp:s,Fn:i}}BigInt(0),BigInt(1),BigInt(2),BigInt(8),y4("HashToScalar-");const Ll=BigInt(0),Ca=BigInt(1),ih=BigInt(2);function ck(r){return t0(r,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...r})}function lk(r){const e=ck(r),{P:t,type:n,adjustScalarBytes:s,powPminus2:i,randomBytes:o}=e,a=n==="x25519";if(!a&&n!=="x448")throw new Error("invalid type");const c=o||ha,l=a?255:448,u=a?32:56,f=BigInt(a?9:5),h=BigInt(a?121665:39081),d=a?ih**BigInt(254):ih**BigInt(447),p=a?BigInt(8)*ih**BigInt(251)-Ca:BigInt(4)*ih**BigInt(445)-Ca,g=d+p+Ca,y=L=>mr(L,t),x=A(f);function A(L){return Uy(y(L),u)}function w(L){const U=Ut("u coordinate",L,u);return a&&(U[31]&=127),y(hd(U))}function O(L){return hd(s(Ut("scalar",L,u)))}function I(L,U){const _=T(w(U),O(L));if(_===Ll)throw new Error("invalid private or public key received");return A(_)}function E(L){return I(L,x)}function P(L,U,_){const m=y(L*(U-_));return U=y(U-m),_=y(_+m),{x_2:U,x_3:_}}function T(L,U){eb("u",L,Ll,t),eb("scalar",U,d,g);const _=U,m=L;let v=Ca,N=Ll,$=L,R=Ca,B=Ll;for(let V=BigInt(l-1);V>=Ll;V--){const X=_>>V&Ca;B^=X,{x_2:v,x_3:$}=P(B,v,$),{x_2:N,x_3:R}=P(B,N,R),B=X;const W=v+N,J=y(W*W),ne=v-N,oe=y(ne*ne),fe=J-oe,ie=$+R,de=$-R,je=y(de*W),Je=y(ie*ne),ze=je+Je,Pt=je-Je;$=y(ze*ze),R=y(m*y(Pt*Pt)),v=y(J*oe),N=y(fe*(J+y(h*fe)))}({x_2:v,x_3:$}=P(B,v,$)),{x_2:N,x_3:R}=P(B,N,R);const H=i(N);return y(v*H)}const D={secretKey:u,publicKey:u,seed:u},F=(L=c(u))=>(xn(L,D.seed),L);function j(L){const U=F(L);return{secretKey:U,publicKey:E(U)}}return{keygen:j,getSharedSecret:(L,U)=>I(L,U),getPublicKey:L=>E(L),scalarMult:I,scalarMultBase:E,utils:{randomSecretKey:F,randomPrivateKey:F},GuBytes:x.slice(),lengths:D}}const uk=BigInt(1),o1=BigInt(2),fk=BigInt(3),hk=BigInt(5);BigInt(8);const W4=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),dk={p:W4,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function pk(r){const e=BigInt(10),t=BigInt(20),n=BigInt(40),s=BigInt(80),i=W4,o=r*r%i*r%i,a=Jr(o,o1,i)*o%i,c=Jr(a,uk,i)*r%i,l=Jr(c,hk,i)*c%i,u=Jr(l,e,i)*l%i,f=Jr(u,t,i)*u%i,h=Jr(f,n,i)*f%i,d=Jr(h,s,i)*h%i,p=Jr(d,s,i)*h%i,g=Jr(p,e,i)*l%i;return{pow_p_5_8:Jr(g,o1,i)*r%i,b2:o}}function gk(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}const bk=Ji(dk.p,{isLE:!0}),tb=(()=>{const r=bk.ORDER;return lk({P:r,type:"x25519",powPminus2:e=>{const{pow_p_5_8:t,b2:n}=pk(e);return mr(Jr(t,fk,r)*n,r)},adjustScalarBytes:gk})})(),a1=(r,e)=>(r+(r>=0?e:-e)/Q4)/e;function yk(r,e,t){const[[n,s],[i,o]]=e,a=a1(o*r,t),c=a1(-s*r,t);let l=r-a*n-c*i,u=-a*s-c*o;const f=l<Ns,h=u<Ns;f&&(l=-l),h&&(u=-u);const d=Af(Math.ceil(B4(t)/2))+ec;if(l<Ns||l>=d||u<Ns||u>=d)throw new Error("splitScalar (endomorphism): failed, k="+r);return{k1neg:f,k1:l,k2neg:h,k2:u}}function rb(r){if(!["compact","recovered","der"].includes(r))throw new Error('Signature format must be "compact", "recovered", or "der"');return r}function fp(r,e){const t={};for(let n of Object.keys(e))t[n]=r[n]===void 0?e[n]:r[n];return fd(t.lowS,"lowS"),fd(t.prehash,"prehash"),t.format!==void 0&&rb(t.format),t}class mk extends Error{constructor(e=""){super(e)}}const bs={Err:mk,_tlv:{encode:(r,e)=>{const{Err:t}=bs;if(r<0||r>256)throw new t("tlv.encode: wrong tag");if(e.length&1)throw new t("tlv.encode: unpadded data");const n=e.length/2,s=sh(n);if(s.length/2&128)throw new t("tlv.encode: long form length too big");const i=n>127?sh(s.length/2|128):"";return sh(r)+i+s+e},decode(r,e){const{Err:t}=bs;let n=0;if(r<0||r>256)throw new t("tlv.encode: wrong tag");if(e.length<2||e[n++]!==r)throw new t("tlv.decode: wrong tlv");const s=e[n++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new t("tlv.decode(long): indefinite length not supported");if(c>4)throw new t("tlv.decode(long): byte length is too big");const l=e.subarray(n,n+c);if(l.length!==c)throw new t("tlv.decode: length bytes not complete");if(l[0]===0)throw new t("tlv.decode(long): zero leftmost byte");for(const u of l)o=o<<8|u;if(n+=c,o<128)throw new t("tlv.decode(long): not minimal encoding")}const a=e.subarray(n,n+o);if(a.length!==o)throw new t("tlv.decode: wrong value length");return{v:a,l:e.subarray(n+o)}}},_int:{encode(r){const{Err:e}=bs;if(r<Ns)throw new e("integer: negative integers are not allowed");let t=sh(r);if(Number.parseInt(t[0],16)&8&&(t="00"+t),t.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return t},decode(r){const{Err:e}=bs;if(r[0]&128)throw new e("invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return e0(r)}},toSig(r){const{Err:e,_int:t,_tlv:n}=bs,s=Ut("signature",r),{v:i,l:o}=n.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=n.decode(2,i),{v:l,l:u}=n.decode(2,c);if(u.length)throw new e("invalid signature: left bytes after parsing");return{r:t.decode(a),s:t.decode(l)}},hexFromSig(r){const{_tlv:e,_int:t}=bs,n=e.encode(2,t.encode(r.r)),s=e.encode(2,t.encode(r.s)),i=n+s;return e.encode(48,i)}},Ns=BigInt(0),ec=BigInt(1),Q4=BigInt(2),oh=BigInt(3),xk=BigInt(4);function Ma(r,e){const{BYTES:t}=r;let n;if(typeof e=="bigint")n=e;else{let s=Ut("private key",e);try{n=r.fromBytes(s)}catch{throw new Error(`invalid private key: expected ui8a of size ${t}, got ${typeof e}`)}}if(!r.isValidNot0(n))throw new Error("invalid private key: out of range [1..N-1]");return n}function wk(r,e={}){const t=ak("weierstrass",r,e),{Fp:n,Fn:s}=t;let i=t.CURVE;const{h:o,n:a}=i;t0(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:c}=e;if(c&&(!n.is0(i.a)||typeof c.beta!="bigint"||!Array.isArray(c.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const l=Y4(n,s);function u(){if(!n.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function f(L,U,_){const{x:m,y:v}=U.toAffine(),N=n.toBytes(m);if(fd(_,"isCompressed"),_){u();const $=!n.isOdd(v);return ci(J4($),N)}else return ci(Uint8Array.of(4),N,n.toBytes(v))}function h(L){vo(L,void 0,"Point");const{publicKey:U,publicKeyUncompressed:_}=l,m=L.length,v=L[0],N=L.subarray(1);if(m===U&&(v===2||v===3)){const $=n.fromBytes(N);if(!n.isValid($))throw new Error("bad point: is not on curve, wrong x");const R=g($);let B;try{B=n.sqrt(R)}catch(V){const X=V instanceof Error?": "+V.message:"";throw new Error("bad point: is not on curve, sqrt error"+X)}u();const H=n.isOdd(B);return(v&1)===1!==H&&(B=n.neg(B)),{x:$,y:B}}else if(m===_&&v===4){const $=n.BYTES,R=n.fromBytes(N.subarray(0,$)),B=n.fromBytes(N.subarray($,$*2));if(!y(R,B))throw new Error("bad point: is not on curve");return{x:R,y:B}}else throw new Error(`bad point: got length ${m}, expected compressed=${U} or uncompressed=${_}`)}const d=e.toBytes||f,p=e.fromBytes||h;function g(L){const U=n.sqr(L),_=n.mul(U,L);return n.add(n.add(_,n.mul(L,i.a)),i.b)}function y(L,U){const _=n.sqr(U),m=g(L);return n.eql(_,m)}if(!y(i.Gx,i.Gy))throw new Error("bad curve params: generator point");const x=n.mul(n.pow(i.a,oh),xk),A=n.mul(n.sqr(i.b),BigInt(27));if(n.is0(n.add(x,A)))throw new Error("bad curve params: a or b");function w(L,U,_=!1){if(!n.isValid(U)||_&&n.is0(U))throw new Error(`bad point coordinate ${L}`);return U}function O(L){if(!(L instanceof D))throw new Error("ProjectivePoint expected")}function I(L){if(!c||!c.basises)throw new Error("no endo");return yk(L,c.basises,s.ORDER)}const E=e1((L,U)=>{const{X:_,Y:m,Z:v}=L;if(n.eql(v,n.ONE))return{x:_,y:m};const N=L.is0();U==null&&(U=N?n.ONE:n.inv(v));const $=n.mul(_,U),R=n.mul(m,U),B=n.mul(v,U);if(N)return{x:n.ZERO,y:n.ZERO};if(!n.eql(B,n.ONE))throw new Error("invZ was invalid");return{x:$,y:R}}),P=e1(L=>{if(L.is0()){if(e.allowInfinityPoint&&!n.is0(L.Y))return;throw new Error("bad point: ZERO")}const{x:U,y:_}=L.toAffine();if(!n.isValid(U)||!n.isValid(_))throw new Error("bad point: x or y not field elements");if(!y(U,_))throw new Error("bad point: equation left != right");if(!L.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function T(L,U,_,m,v){return _=new D(n.mul(_.X,L),_.Y,_.Z),U=dd(m,U),_=dd(v,_),U.add(_)}class D{constructor(U,_,m){this.X=w("x",U),this.Y=w("y",_,!0),this.Z=w("z",m),Object.freeze(this)}static CURVE(){return i}static fromAffine(U){const{x:_,y:m}=U||{};if(!U||!n.isValid(_)||!n.isValid(m))throw new Error("invalid affine point");if(U instanceof D)throw new Error("projective point not allowed");return n.is0(_)&&n.is0(m)?D.ZERO:new D(_,m,n.ONE)}static fromBytes(U){const _=D.fromAffine(p(vo(U,void 0,"point")));return _.assertValidity(),_}static fromHex(U){return D.fromBytes(Ut("pointHex",U))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(U=8,_=!0){return j.createCache(this,U),_||this.multiply(oh),this}assertValidity(){P(this)}hasEvenY(){const{y:U}=this.toAffine();if(!n.isOdd)throw new Error("Field doesn't support isOdd");return!n.isOdd(U)}equals(U){O(U);const{X:_,Y:m,Z:v}=this,{X:N,Y:$,Z:R}=U,B=n.eql(n.mul(_,R),n.mul(N,v)),H=n.eql(n.mul(m,R),n.mul($,v));return B&&H}negate(){return new D(this.X,n.neg(this.Y),this.Z)}double(){const{a:U,b:_}=i,m=n.mul(_,oh),{X:v,Y:N,Z:$}=this;let R=n.ZERO,B=n.ZERO,H=n.ZERO,V=n.mul(v,v),X=n.mul(N,N),W=n.mul($,$),J=n.mul(v,N);return J=n.add(J,J),H=n.mul(v,$),H=n.add(H,H),R=n.mul(U,H),B=n.mul(m,W),B=n.add(R,B),R=n.sub(X,B),B=n.add(X,B),B=n.mul(R,B),R=n.mul(J,R),H=n.mul(m,H),W=n.mul(U,W),J=n.sub(V,W),J=n.mul(U,J),J=n.add(J,H),H=n.add(V,V),V=n.add(H,V),V=n.add(V,W),V=n.mul(V,J),B=n.add(B,V),W=n.mul(N,$),W=n.add(W,W),V=n.mul(W,J),R=n.sub(R,V),H=n.mul(W,X),H=n.add(H,H),H=n.add(H,H),new D(R,B,H)}add(U){O(U);const{X:_,Y:m,Z:v}=this,{X:N,Y:$,Z:R}=U;let B=n.ZERO,H=n.ZERO,V=n.ZERO;const X=i.a,W=n.mul(i.b,oh);let J=n.mul(_,N),ne=n.mul(m,$),oe=n.mul(v,R),fe=n.add(_,m),ie=n.add(N,$);fe=n.mul(fe,ie),ie=n.add(J,ne),fe=n.sub(fe,ie),ie=n.add(_,v);let de=n.add(N,R);return ie=n.mul(ie,de),de=n.add(J,oe),ie=n.sub(ie,de),de=n.add(m,v),B=n.add($,R),de=n.mul(de,B),B=n.add(ne,oe),de=n.sub(de,B),V=n.mul(X,ie),B=n.mul(W,oe),V=n.add(B,V),B=n.sub(ne,V),V=n.add(ne,V),H=n.mul(B,V),ne=n.add(J,J),ne=n.add(ne,J),oe=n.mul(X,oe),ie=n.mul(W,ie),ne=n.add(ne,oe),oe=n.sub(J,oe),oe=n.mul(X,oe),ie=n.add(ie,oe),J=n.mul(ne,ie),H=n.add(H,J),J=n.mul(de,ie),B=n.mul(fe,B),B=n.sub(B,J),J=n.mul(fe,ne),V=n.mul(de,V),V=n.add(V,J),new D(B,H,V)}subtract(U){return this.add(U.negate())}is0(){return this.equals(D.ZERO)}multiply(U){const{endo:_}=e;if(!s.isValidNot0(U))throw new Error("invalid scalar: out of range");let m,v;const N=$=>j.cached(this,$,R=>ap(D,R));if(_){const{k1neg:$,k1:R,k2neg:B,k2:H}=I(U),{p:V,f:X}=N(R),{p:W,f:J}=N(H);v=X.add(J),m=T(_.beta,V,W,$,B)}else{const{p:$,f:R}=N(U);m=$,v=R}return ap(D,[m,v])[0]}multiplyUnsafe(U){const{endo:_}=e,m=this;if(!s.isValid(U))throw new Error("invalid scalar: out of range");if(U===Ns||m.is0())return D.ZERO;if(U===ec)return m;if(j.hasCache(this))return this.multiply(U);if(_){const{k1neg:v,k1:N,k2neg:$,k2:R}=I(U),{p1:B,p2:H}=ik(D,m,N,R);return T(_.beta,B,H,v,$)}else return j.unsafe(m,U)}multiplyAndAddUnsafe(U,_,m){const v=this.multiplyUnsafe(_).add(U.multiplyUnsafe(m));return v.is0()?void 0:v}toAffine(U){return E(this,U)}isTorsionFree(){const{isTorsionFree:U}=e;return o===ec?!0:U?U(D,this):j.unsafe(this,a).is0()}clearCofactor(){const{clearCofactor:U}=e;return o===ec?this:U?U(D,this):this.multiplyUnsafe(o)}isSmallOrder(){return this.multiplyUnsafe(o).is0()}toBytes(U=!0){return fd(U,"isCompressed"),this.assertValidity(),d(D,this,U)}toHex(U=!0){return Xa(this.toBytes(U))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(U=!0){return this.toBytes(U)}_setWindowSize(U){this.precompute(U)}static normalizeZ(U){return ap(D,U)}static msm(U,_){return ok(D,s,U,_)}static fromPrivateKey(U){return D.BASE.multiply(Ma(s,U))}}D.BASE=new D(i.Gx,i.Gy,n.ONE),D.ZERO=new D(n.ZERO,n.ONE,n.ZERO),D.Fp=n,D.Fn=s;const F=s.BITS,j=new sk(D,e.endo?Math.ceil(F/2):F);return D.BASE.precompute(8),D}function J4(r){return Uint8Array.of(r?2:3)}function Y4(r,e){return{secretKey:e.BYTES,publicKey:1+r.BYTES,publicKeyUncompressed:1+2*r.BYTES,publicKeyHasPrefix:!0,signature:2*e.BYTES}}function Ek(r,e={}){const{Fn:t}=r,n=e.randomBytes||ha,s=Object.assign(Y4(r.Fp,t),{seed:V4(t.ORDER)});function i(h){try{return!!Ma(t,h)}catch{return!1}}function o(h,d){const{publicKey:p,publicKeyUncompressed:g}=s;try{const y=h.length;return d===!0&&y!==p||d===!1&&y!==g?!1:!!r.fromBytes(h)}catch{return!1}}function a(h=n(s.seed)){return tk(vo(h,s.seed,"seed"),t.ORDER)}function c(h,d=!0){return r.BASE.multiply(Ma(t,h)).toBytes(d)}function l(h){const d=a(h);return{secretKey:d,publicKey:c(d)}}function u(h){if(typeof h=="bigint")return!1;if(h instanceof r)return!0;const{secretKey:d,publicKey:p,publicKeyUncompressed:g}=s;if(t.allowedLengths||d===p)return;const y=Ut("key",h).length;return y===p||y===g}function f(h,d,p=!0){if(u(h)===!0)throw new Error("first arg must be private key");if(u(d)===!1)throw new Error("second arg must be public key");const g=Ma(t,h);return r.fromHex(d).multiply(g).toBytes(p)}return Object.freeze({getPublicKey:c,getSharedSecret:f,keygen:l,Point:r,utils:{isValidSecretKey:i,isValidPublicKey:o,randomSecretKey:a,isValidPrivateKey:i,randomPrivateKey:a,normPrivateKeyToScalar:h=>Ma(t,h),precompute(h=8,d=r.BASE){return d.precompute(h,!1)}},lengths:s})}function vk(r,e,t={}){Qd(e),t0(t,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const n=t.randomBytes||ha,s=t.hmac||((_,...m)=>Zd(e,_,ci(...m))),{Fp:i,Fn:o}=r,{ORDER:a,BITS:c}=o,{keygen:l,getPublicKey:u,getSharedSecret:f,utils:h,lengths:d}=Ek(r,t),p={prehash:!1,lowS:typeof t.lowS=="boolean"?t.lowS:!1,format:void 0,extraEntropy:!1},g="compact";function y(_){const m=a>>ec;return _>m}function x(_,m){if(!o.isValidNot0(m))throw new Error(`invalid signature ${_}: out of range 1..Point.Fn.ORDER`);return m}function A(_,m){rb(m);const v=d.signature,N=m==="compact"?v:m==="recovered"?v+1:void 0;return vo(_,N,`${m} signature`)}class w{constructor(m,v,N){this.r=x("r",m),this.s=x("s",v),N!=null&&(this.recovery=N),Object.freeze(this)}static fromBytes(m,v=g){A(m,v);let N;if(v==="der"){const{r:H,s:V}=bs.toSig(vo(m));return new w(H,V)}v==="recovered"&&(N=m[0],v="compact",m=m.subarray(1));const $=o.BYTES,R=m.subarray(0,$),B=m.subarray($,$*2);return new w(o.fromBytes(R),o.fromBytes(B),N)}static fromHex(m,v){return this.fromBytes(ld(m),v)}addRecoveryBit(m){return new w(this.r,this.s,m)}recoverPublicKey(m){const v=i.ORDER,{r:N,s:$,recovery:R}=this;if(R==null||![0,1,2,3].includes(R))throw new Error("recovery id invalid");if(a*Q4<v&&R>1)throw new Error("recovery id is ambiguous for h>1 curve");const B=R===2||R===3?N+a:N;if(!i.isValid(B))throw new Error("recovery id 2 or 3 invalid");const H=i.toBytes(B),V=r.fromBytes(ci(J4((R&1)===0),H)),X=o.inv(B),W=I(Ut("msgHash",m)),J=o.create(-W*X),ne=o.create($*X),oe=r.BASE.multiplyUnsafe(J).add(V.multiplyUnsafe(ne));if(oe.is0())throw new Error("point at infinify");return oe.assertValidity(),oe}hasHighS(){return y(this.s)}toBytes(m=g){if(rb(m),m==="der")return ld(bs.hexFromSig(this));const v=o.toBytes(this.r),N=o.toBytes(this.s);if(m==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return ci(Uint8Array.of(this.recovery),v,N)}return ci(v,N)}toHex(m){return Xa(this.toBytes(m))}assertValidity(){}static fromCompact(m){return w.fromBytes(Ut("sig",m),"compact")}static fromDER(m){return w.fromBytes(Ut("sig",m),"der")}normalizeS(){return this.hasHighS()?new w(this.r,o.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return Xa(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return Xa(this.toBytes("compact"))}}const O=t.bits2int||function(_){if(_.length>8192)throw new Error("input is too large");const m=e0(_),v=_.length*8-c;return v>0?m>>BigInt(v):m},I=t.bits2int_modN||function(_){return o.create(O(_))},E=Af(c);function P(_){return eb("num < 2^"+c,_,Ns,E),o.toBytes(_)}function T(_,m){return vo(_,void 0,"message"),m?vo(e(_),void 0,"prehashed message"):_}function D(_,m,v){if(["recovered","canonical"].some(ne=>ne in v))throw new Error("sign() legacy options not supported");const{lowS:N,prehash:$,extraEntropy:R}=fp(v,p);_=T(_,$);const B=I(_),H=Ma(o,m),V=[P(H),P(B)];if(R!=null&&R!==!1){const ne=R===!0?n(d.secretKey):R;V.push(Ut("extraEntropy",ne))}const X=ci(...V),W=B;function J(ne){const oe=O(ne);if(!o.isValidNot0(oe))return;const fe=o.inv(oe),ie=r.BASE.multiply(oe).toAffine(),de=o.create(ie.x);if(de===Ns)return;const je=o.create(fe*o.create(W+de*H));if(je===Ns)return;let Je=(ie.x===de?0:2)|Number(ie.y&ec),ze=je;return N&&y(je)&&(ze=o.neg(je),Je^=1),new w(de,ze,Je)}return{seed:X,k2sig:J}}function F(_,m,v={}){_=Ut("message",_);const{seed:N,k2sig:$}=D(_,m,v);return KB(e.outputLen,o.BYTES,s)(N,$)}function j(_){let m;const v=typeof _=="string"||Wd(_),N=!v&&_!==null&&typeof _=="object"&&typeof _.r=="bigint"&&typeof _.s=="bigint";if(!v&&!N)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(N)m=new w(_.r,_.s);else if(v){try{m=w.fromBytes(Ut("sig",_),"der")}catch($){if(!($ instanceof bs.Err))throw $}if(!m)try{m=w.fromBytes(Ut("sig",_),"compact")}catch{return!1}}return m||!1}function L(_,m,v,N={}){const{lowS:$,prehash:R,format:B}=fp(N,p);if(v=Ut("publicKey",v),m=T(Ut("message",m),R),"strict"in N)throw new Error("options.strict was renamed to lowS");const H=B===void 0?j(_):w.fromBytes(Ut("sig",_),B);if(H===!1)return!1;try{const V=r.fromBytes(v);if($&&H.hasHighS())return!1;const{r:X,s:W}=H,J=I(m),ne=o.inv(W),oe=o.create(J*ne),fe=o.create(X*ne),ie=r.BASE.multiplyUnsafe(oe).add(V.multiplyUnsafe(fe));return ie.is0()?!1:o.create(ie.x)===X}catch{return!1}}function U(_,m,v={}){const{prehash:N}=fp(v,p);return m=T(m,N),w.fromBytes(_,"recovered").recoverPublicKey(m).toBytes()}return Object.freeze({keygen:l,getPublicKey:u,getSharedSecret:f,utils:h,lengths:d,Point:r,sign:F,verify:L,recoverPublicKey:U,Signature:w,hash:e})}function Ak(r){const e={a:r.a,b:r.b,p:r.Fp.ORDER,n:r.n,h:r.h,Gx:r.Gx,Gy:r.Gy},t=r.Fp;let n=r.allowedPrivateKeyLengths?Array.from(new Set(r.allowedPrivateKeyLengths.map(o=>Math.ceil(o/2)))):void 0;const s=Ji(e.n,{BITS:r.nBitLength,allowedLengths:n,modFromBytes:r.wrapPrivateKey}),i={Fp:t,Fn:s,allowInfinityPoint:r.allowInfinityPoint,endo:r.endo,isTorsionFree:r.isTorsionFree,clearCofactor:r.clearCofactor,fromBytes:r.fromBytes,toBytes:r.toBytes};return{CURVE:e,curveOpts:i}}function Ik(r){const{CURVE:e,curveOpts:t}=Ak(r),n={hmac:r.hmac,randomBytes:r.randomBytes,lowS:r.lowS,bits2int:r.bits2int,bits2int_modN:r.bits2int_modN};return{CURVE:e,curveOpts:t,hash:r.hash,ecdsaOpts:n}}function Sk(r,e){const t=e.Point;return Object.assign({},e,{ProjectivePoint:t,CURVE:Object.assign({},r,H4(t.Fn.ORDER,t.Fn.BITS))})}function Ok(r){const{CURVE:e,curveOpts:t,hash:n,ecdsaOpts:s}=Ik(r),i=wk(e,t),o=vk(i,n,s);return Sk(r,o)}function nb(r,e){const t=n=>Ok({...r,hash:n});return{...t(e),create:t}}const Z4={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},X4={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},e6={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},Pk=Ji(Z4.p),Ck=Ji(X4.p),Tk=Ji(e6.p),Nk=nb({...Z4,Fp:Pk,lowS:!1},Yd);nb({...X4,Fp:Ck,lowS:!1},$_),nb({...e6,Fp:Tk,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},U_);const Dk=Nk,t6="base10",qt="base16",rr="base64pad",li="base64url",If="utf8",r6=0,Bs=1,Sf=2,Rk=0,c1=1,lu=12,Ly=32;function _k(){const r=tb.utils.randomPrivateKey(),e=tb.getPublicKey(r);return{privateKey:sr(r,qt),publicKey:sr(e,qt)}}function sb(){const r=ha(Ly);return sr(r,qt)}function Bk(r,e){const t=tb.getSharedSecret(Hr(r,qt),Hr(e,qt)),n=qB(Xd,t,void 0,void 0,Ly);return sr(n,qt)}function kh(r){const e=Xd(Hr(r,qt));return sr(e,qt)}function Mr(r){const e=Xd(Hr(r,If));return sr(e,qt)}function n6(r){return Hr(`${r}`,t6)}function ca(r){return Number(sr(r,t6))}function s6(r){return r.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function i6(r){const e=r.replace(/-/g,"+").replace(/_/g,"/"),t=(4-e.length%4)%4;return e+"=".repeat(t)}function kk(r){const e=n6(typeof r.type<"u"?r.type:r6);if(ca(e)===Bs&&typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof r.senderPublicKey<"u"?Hr(r.senderPublicKey,qt):void 0,n=typeof r.iv<"u"?Hr(r.iv,qt):ha(lu),s=Hr(r.symKey,qt),i=D4(s,n).encrypt(Hr(r.message,If)),o=o6({type:e,sealed:i,iv:n,senderPublicKey:t});return r.encoding===li?s6(o):o}function Uk(r){const e=Hr(r.symKey,qt),{sealed:t,iv:n}=Lu({encoded:r.encoded,encoding:r.encoding}),s=D4(e,n).decrypt(t);if(s===null)throw new Error("Failed to decrypt");return sr(s,If)}function $k(r,e){const t=n6(Sf),n=ha(lu),s=Hr(r,If),i=o6({type:t,sealed:s,iv:n});return e===li?s6(i):i}function Lk(r,e){const{sealed:t}=Lu({encoded:r,encoding:e});return sr(t,If)}function o6(r){if(ca(r.type)===Sf)return sr(cu([r.type,r.sealed]),rr);if(ca(r.type)===Bs){if(typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return sr(cu([r.type,r.senderPublicKey,r.iv,r.sealed]),rr)}return sr(cu([r.type,r.iv,r.sealed]),rr)}function Lu(r){const e=(r.encoding||rr)===li?i6(r.encoded):r.encoded,t=Hr(e,rr),n=t.slice(Rk,c1),s=c1;if(ca(n)===Bs){const c=s+Ly,l=c+lu,u=t.slice(s,c),f=t.slice(c,l),h=t.slice(l);return{type:n,sealed:h,iv:f,senderPublicKey:u}}if(ca(n)===Sf){const c=t.slice(s),l=ha(lu);return{type:n,sealed:c,iv:l}}const i=s+lu,o=t.slice(s,i),a=t.slice(i);return{type:n,sealed:a,iv:o}}function Fk(r,e){const t=Lu({encoded:r,encoding:e==null?void 0:e.encoding});return a6({type:ca(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?sr(t.senderPublicKey,qt):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function a6(r){const e=(r==null?void 0:r.type)||r6;if(e===Bs){if(typeof(r==null?void 0:r.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(r==null?void 0:r.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:r==null?void 0:r.senderPublicKey,receiverPublicKey:r==null?void 0:r.receiverPublicKey}}function l1(r){return r.type===Bs&&typeof r.senderPublicKey=="string"&&typeof r.receiverPublicKey=="string"}function u1(r){return r.type===Sf}function Mk(r){const e=Buffer.from(r.x,"base64"),t=Buffer.from(r.y,"base64");return cu([new Uint8Array([4]),e,t])}function jk(r,e){const[t,n,s]=r.split("."),i=Buffer.from(i6(s),"base64");if(i.length!==64)throw new Error("Invalid signature length");const o=i.slice(0,32),a=i.slice(32,64),c=`${t}.${n}`,l=Xd(c),u=Mk(e);if(!Dk.verify(cu([o,a]),l,u))throw new Error("Invalid signature");return qg(r).payload}const zk="irn";function pd(r){return(r==null?void 0:r.relay)||{protocol:zk}}function ja(r){const e=IR[r];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${r}`);return e}var Hk=Object.defineProperty,qk=Object.defineProperties,Vk=Object.getOwnPropertyDescriptors,f1=Object.getOwnPropertySymbols,Kk=Object.prototype.hasOwnProperty,Gk=Object.prototype.propertyIsEnumerable,h1=(r,e,t)=>e in r?Hk(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,hp=(r,e)=>{for(var t in e||(e={}))Kk.call(e,t)&&h1(r,t,e[t]);if(f1)for(var t of f1(e))Gk.call(e,t)&&h1(r,t,e[t]);return r},Wk=(r,e)=>qk(r,Vk(e));function Qk(r,e="-"){const t={},n="relay"+e;return Object.keys(r).forEach(s=>{if(s.startsWith(n)){const i=s.replace(n,""),o=r[s];t[i]=o}}),t}function d1(r){if(!r.includes("wc:")){const l=f4(r);l!=null&&l.includes("wc:")&&(r=l)}r=r.includes("wc://")?r.replace("wc://",""):r,r=r.includes("wc:")?r.replace("wc:",""):r;const e=r.indexOf(":"),t=r.indexOf("?")!==-1?r.indexOf("?"):void 0,n=r.substring(0,e),s=r.substring(e+1,t).split("@"),i=typeof t<"u"?r.substring(t):"",o=new URLSearchParams(i),a=Object.fromEntries(o.entries()),c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:n,topic:Jk(s[0]),version:parseInt(s[1],10),symKey:a.symKey,relay:Qk(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function Jk(r){return r.startsWith("//")?r.substring(2):r}function Yk(r,e="-"){const t="relay",n={};return Object.keys(r).forEach(s=>{const i=s,o=t+e+i;r[i]&&(n[o]=r[i])}),n}function p1(r){const e=new URLSearchParams,t=hp(hp(Wk(hp({},Yk(r.relay)),{symKey:r.symKey}),r.expiryTimestamp&&{expiryTimestamp:r.expiryTimestamp.toString()}),r.methods&&{methods:r.methods.join(",")});return Object.entries(t).sort(([n],[s])=>n.localeCompare(s)).forEach(([n,s])=>{s!==void 0&&e.append(n,String(s))}),`${r.protocol}:${r.topic}@${r.version}?${e}`}function ah(r,e,t){return`${r}?wc_ev=${t}&topic=${e}`}var Zk=Object.defineProperty,Xk=Object.defineProperties,eU=Object.getOwnPropertyDescriptors,g1=Object.getOwnPropertySymbols,tU=Object.prototype.hasOwnProperty,rU=Object.prototype.propertyIsEnumerable,b1=(r,e,t)=>e in r?Zk(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,nU=(r,e)=>{for(var t in e||(e={}))tU.call(e,t)&&b1(r,t,e[t]);if(g1)for(var t of g1(e))rU.call(e,t)&&b1(r,t,e[t]);return r},sU=(r,e)=>Xk(r,eU(e));function Il(r){const e=[];return r.forEach(t=>{const[n,s]=t.split(":");e.push(`${n}:${s}`)}),e}function iU(r){const e=[];return Object.values(r).forEach(t=>{e.push(...Il(t.accounts))}),e}function oU(r,e){const t=[];return Object.values(r).forEach(n=>{Il(n.accounts).includes(e)&&t.push(...n.methods)}),t}function aU(r,e){const t=[];return Object.values(r).forEach(n=>{Il(n.accounts).includes(e)&&t.push(...n.events)}),t}function r0(r){return r.includes(":")}function za(r){return r0(r)?r.split(":")[0]:r}function y1(r){var e,t,n;const s={};if(!Jn(r))return s;for(const[i,o]of Object.entries(r)){const a=r0(i)?[i]:o.chains,c=o.methods||[],l=o.events||[],u=za(i);s[u]=sU(nU({},s[u]),{chains:Qn(a,(e=s[u])==null?void 0:e.chains),methods:Qn(c,(t=s[u])==null?void 0:t.methods),events:Qn(l,(n=s[u])==null?void 0:n.events)})}return s}function cU(r){const e={};return r==null||r.forEach(t=>{var n;const[s,i]=t.split(":");e[s]||(e[s]={accounts:[],chains:[],events:[],methods:[]}),e[s].accounts.push(t),(n=e[s].chains)==null||n.push(`${s}:${i}`)}),e}function m1(r,e){e=e.map(n=>n.replace("did:pkh:",""));const t=cU(e);for(const[n,s]of Object.entries(t))s.methods?s.methods=Qn(s.methods,r):s.methods=r,s.events=["chainChanged","accountsChanged"];return t}function lU(r,e){var t,n,s,i,o,a;const c=y1(r),l=y1(e),u={},f=Object.keys(c).concat(Object.keys(l));for(const h of f)u[h]={chains:Qn((t=c[h])==null?void 0:t.chains,(n=l[h])==null?void 0:n.chains),methods:Qn((s=c[h])==null?void 0:s.methods,(i=l[h])==null?void 0:i.methods),events:Qn((o=c[h])==null?void 0:o.events,(a=l[h])==null?void 0:a.events)};return u}const uU={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},fU={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function Y(r,e){const{message:t,code:n}=fU[r];return{message:e?`${t} ${e}`:t,code:n}}function Le(r,e){const{message:t,code:n}=uU[r];return{message:e?`${t} ${e}`:t,code:n}}function Kr(r,e){return!!Array.isArray(r)}function Jn(r){return Object.getPrototypeOf(r)===Object.prototype&&Object.keys(r).length}function rt(r){return typeof r>"u"}function Xe(r,e){return e&&rt(r)?!0:typeof r=="string"&&!!r.trim().length}function Fy(r,e){return e&&rt(r)?!0:typeof r=="number"&&!isNaN(r)}function hU(r,e){const{requiredNamespaces:t}=e,n=Object.keys(r.namespaces),s=Object.keys(t);let i=!0;return Eo(s,n)?(n.forEach(o=>{const{accounts:a,methods:c,events:l}=r.namespaces[o],u=Il(a),f=t[o];(!Eo(o4(o,f),u)||!Eo(f.methods,c)||!Eo(f.events,l))&&(i=!1)}),i):!1}function gd(r){return Xe(r,!1)&&r.includes(":")?r.split(":").length===2:!1}function dU(r){if(Xe(r,!1)&&r.includes(":")){const e=r.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&gd(t)}}return!1}function pU(r){function e(t){try{return typeof new URL(t)<"u"}catch{return!1}}try{if(Xe(r,!1)){if(e(r))return!0;const t=f4(r);return e(t)}}catch{}return!1}function gU(r){var e;return(e=r==null?void 0:r.proposer)==null?void 0:e.publicKey}function bU(r){return r==null?void 0:r.topic}function yU(r,e){let t=null;return Xe(r==null?void 0:r.publicKey,!1)||(t=Y("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function x1(r){let e=!0;return Kr(r)?r.length&&(e=r.every(t=>Xe(t,!1))):e=!1,e}function mU(r,e,t){let n=null;return Kr(e)&&e.length?e.forEach(s=>{n||gd(s)||(n=Le("UNSUPPORTED_CHAINS",`${t}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):gd(r)||(n=Le("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),n}function xU(r,e,t){let n=null;return Object.entries(r).forEach(([s,i])=>{if(n)return;const o=mU(s,o4(s,i),`${e} ${t}`);o&&(n=o)}),n}function wU(r,e){let t=null;return Kr(r)?r.forEach(n=>{t||dU(n)||(t=Le("UNSUPPORTED_ACCOUNTS",`${e}, account ${n} should be a string and conform to "namespace:chainId:address" format`))}):t=Le("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function EU(r,e){let t=null;return Object.values(r).forEach(n=>{if(t)return;const s=wU(n==null?void 0:n.accounts,`${e} namespace`);s&&(t=s)}),t}function vU(r,e){let t=null;return x1(r==null?void 0:r.methods)?x1(r==null?void 0:r.events)||(t=Le("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=Le("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function c6(r,e){let t=null;return Object.values(r).forEach(n=>{if(t)return;const s=vU(n,`${e}, namespace`);s&&(t=s)}),t}function AU(r,e,t){let n=null;if(r&&Jn(r)){const s=c6(r,e);s&&(n=s);const i=xU(r,e,t);i&&(n=i)}else n=Y("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return n}function dp(r,e){let t=null;if(r&&Jn(r)){const n=c6(r,e);n&&(t=n);const s=EU(r,e);s&&(t=s)}else t=Y("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function l6(r){return Xe(r.protocol,!0)}function IU(r,e){let t=!1;return r?r&&Kr(r)&&r.length&&r.forEach(n=>{t=l6(n)}):t=!0,t}function SU(r){return typeof r=="number"}function Jt(r){return typeof r<"u"&&typeof r!==null}function OU(r){return!(!r||typeof r!="object"||!r.code||!Fy(r.code,!1)||!r.message||!Xe(r.message,!1))}function PU(r){return!(rt(r)||!Xe(r.method,!1))}function CU(r){return!(rt(r)||rt(r.result)&&rt(r.error)||!Fy(r.id,!1)||!Xe(r.jsonrpc,!1))}function TU(r){return!(rt(r)||!Xe(r.name,!1))}function w1(r,e){return!(!gd(e)||!iU(r).includes(e))}function NU(r,e,t){return Xe(t,!1)?oU(r,e).includes(t):!1}function DU(r,e,t){return Xe(t,!1)?aU(r,e).includes(t):!1}function E1(r,e,t){let n=null;const s=RU(r),i=_U(e),o=Object.keys(s),a=Object.keys(i),c=v1(Object.keys(r)),l=v1(Object.keys(e)),u=c.filter(f=>!l.includes(f));return u.length&&(n=Y("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${u.toString()}
      Received: ${Object.keys(e).toString()}`)),Eo(o,a)||(n=Y("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(e).forEach(f=>{if(!f.includes(":")||n)return;const h=Il(e[f].accounts);h.includes(f)||(n=Y("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${f}
        Required: ${f}
        Approved: ${h.toString()}`))}),o.forEach(f=>{n||(Eo(s[f].methods,i[f].methods)?Eo(s[f].events,i[f].events)||(n=Y("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${f}`)):n=Y("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${f}`))}),n}function RU(r){const e={};return Object.keys(r).forEach(t=>{var n;t.includes(":")?e[t]=r[t]:(n=r[t].chains)==null||n.forEach(s=>{e[s]={methods:r[t].methods,events:r[t].events}})}),e}function v1(r){return[...new Set(r.map(e=>e.includes(":")?e.split(":")[0]:e))]}function _U(r){const e={};return Object.keys(r).forEach(t=>{if(t.includes(":"))e[t]=r[t];else{const n=Il(r[t].accounts);n==null||n.forEach(s=>{e[s]={accounts:r[t].accounts.filter(i=>i.includes(`${s}:`)),methods:r[t].methods,events:r[t].events}})}}),e}function BU(r,e){return Fy(r,!1)&&r<=e.max&&r>=e.min}function A1(){const r=Ef();return new Promise(e=>{switch(r){case Er.browser:e(kU());break;case Er.reactNative:e(UU());break;case Er.node:e($U());break;default:e(!0)}})}function kU(){return Al()&&(navigator==null?void 0:navigator.onLine)}async function UU(){if(Qi()&&typeof global<"u"&&global!=null&&global.NetInfo){const r=await(global==null?void 0:global.NetInfo.fetch());return r==null?void 0:r.isConnected}return!0}function $U(){return!0}function LU(r){switch(Ef()){case Er.browser:FU(r);break;case Er.reactNative:MU(r);break}}function FU(r){!Qi()&&Al()&&(window.addEventListener("online",()=>r(!0)),window.addEventListener("offline",()=>r(!1)))}function MU(r){Qi()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(e=>r(e==null?void 0:e.isConnected)))}function jU(){var r;return Al()&&Ls.getDocument()?((r=Ls.getDocument())==null?void 0:r.visibilityState)==="visible":!0}const pp={};class Fl{static get(e){return pp[e]}static set(e,t){pp[e]=t}static delete(e){delete pp[e]}}function zU(r){const e=mf.decode(r);if(e.length<33)throw new Error("Too short to contain a public key");return e.slice(1,33)}function HU({publicKey:r,signature:e,payload:t}){var n;const s=ib(t.method),i=128|parseInt(((n=t.version)==null?void 0:n.toString())||"4"),o=KU(t.address),a=t.era==="00"?new Uint8Array([0]):ib(t.era);if(a.length!==1&&a.length!==2)throw new Error("Invalid era length");const c=parseInt(t.nonce,16),l=new Uint8Array([c&255,c>>8&255]),u=BigInt(`0x${VU(t.tip)}`),f=WU(u),h=new Uint8Array([0,...r,o,...e,...a,...l,...f,...s]),d=GU(h.length+1);return new Uint8Array([...d,i,...h])}function qU(r){const e=ib(r),t=CR.blake2b(e,void 0,32);return"0x"+Buffer.from(t).toString("hex")}function ib(r){return new Uint8Array(r.replace(/^0x/,"").match(/.{1,2}/g).map(e=>parseInt(e,16)))}function VU(r){return r.startsWith("0x")?r.slice(2):r}function KU(r){const e=mf.decode(r)[0];return e===42?0:e===60?2:1}function GU(r){if(r<64)return new Uint8Array([r<<2]);if(r<16384){const e=r<<2|1;return new Uint8Array([e&255,e>>8&255])}else if(r<1<<30){const e=r<<2|2;return new Uint8Array([e&255,e>>8&255,e>>16&255,e>>24&255])}else throw new Error("Compact encoding > 2^30 not supported")}function WU(r){if(r<BigInt(1)<<BigInt(6))return new Uint8Array([Number(r<<BigInt(2))]);if(r<BigInt(1)<<BigInt(14)){const e=r<<BigInt(2)|BigInt(1);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255))])}else if(r<BigInt(1)<<BigInt(30)){const e=r<<BigInt(2)|BigInt(2);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255)),Number(e>>BigInt(16)&BigInt(255)),Number(e>>BigInt(24)&BigInt(255))])}else throw new Error("BigInt compact encoding not supported > 2^30")}function QU(r){const e=Uint8Array.from(Buffer.from(r.signature,"hex")),t=zU(r.transaction.address),n=HU({publicKey:t,signature:e,payload:r.transaction}),s=Buffer.from(n).toString("hex");return qU(s)}class da{}let JU=class extends da{constructor(e){super()}};const I1=Z.FIVE_SECONDS,pa={pulse:"heartbeat_pulse"};let YU=class u6 extends JU{constructor(e){super(e),this.events=new Ar.EventEmitter,this.interval=I1,this.interval=(e==null?void 0:e.interval)||I1}static async init(e){const t=new u6(e);return await t.init(),t}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),Z.toMiliseconds(this.interval))}pulse(){this.events.emit(pa.pulse)}};const ZU=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,XU=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,e$=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function t$(r,e){if(r==="__proto__"||r==="constructor"&&e&&typeof e=="object"&&"prototype"in e){r$(r);return}return e}function r$(r){console.warn(`[destr] Dropping "${r}" key to prevent prototype pollution.`)}function ch(r,e={}){if(typeof r!="string")return r;if(r[0]==='"'&&r[r.length-1]==='"'&&r.indexOf("\\")===-1)return r.slice(1,-1);const t=r.trim();if(t.length<=9)switch(t.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!e$.test(r)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return r}try{if(ZU.test(r)||XU.test(r)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(r,t$)}return JSON.parse(r)}catch(n){if(e.strict)throw n;return r}}function n$(r){return!r||typeof r.then!="function"?Promise.resolve(r):r}function ot(r,...e){try{return n$(r(...e))}catch(t){return Promise.reject(t)}}function s$(r){const e=typeof r;return r===null||e!=="object"&&e!=="function"}function i$(r){const e=Object.getPrototypeOf(r);return!e||e.isPrototypeOf(Object)}function Uh(r){if(s$(r))return String(r);if(i$(r)||Array.isArray(r))return JSON.stringify(r);if(typeof r.toJSON=="function")return Uh(r.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const ob="base64:";function o$(r){return typeof r=="string"?r:ob+l$(r)}function a$(r){return typeof r!="string"||!r.startsWith(ob)?r:c$(r.slice(ob.length))}function c$(r){return globalThis.Buffer?Buffer.from(r,"base64"):Uint8Array.from(globalThis.atob(r),e=>e.codePointAt(0))}function l$(r){return globalThis.Buffer?Buffer.from(r).toString("base64"):globalThis.btoa(String.fromCodePoint(...r))}function Qt(r){var e;return r&&((e=r.split("?")[0])==null?void 0:e.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""))||""}function u$(...r){return Qt(r.join(":"))}function lh(r){return r=Qt(r),r?r+":":""}function f$(r,e){if(e===void 0)return!0;let t=0,n=r.indexOf(":");for(;n>-1;)t++,n=r.indexOf(":",n+1);return t<=e}function h$(r,e){return e?r.startsWith(e)&&r[r.length-1]!=="$":r[r.length-1]!=="$"}const d$="memory",p$=()=>{const r=new Map;return{name:d$,getInstance:()=>r,hasItem(e){return r.has(e)},getItem(e){return r.get(e)??null},getItemRaw(e){return r.get(e)??null},setItem(e,t){r.set(e,t)},setItemRaw(e,t){r.set(e,t)},removeItem(e){r.delete(e)},getKeys(){return[...r.keys()]},clear(){r.clear()},dispose(){r.clear()}}};function g$(r={}){const e={mounts:{"":r.driver||p$()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},t=l=>{for(const u of e.mountpoints)if(l.startsWith(u))return{base:u,relativeKey:l.slice(u.length),driver:e.mounts[u]};return{base:"",relativeKey:l,driver:e.mounts[""]}},n=(l,u)=>e.mountpoints.filter(f=>f.startsWith(l)||u&&l.startsWith(f)).map(f=>({relativeBase:l.length>f.length?l.slice(f.length):void 0,mountpoint:f,driver:e.mounts[f]})),s=(l,u)=>{if(e.watching){u=Qt(u);for(const f of e.watchListeners)f(l,u)}},i=async()=>{if(!e.watching){e.watching=!0;for(const l in e.mounts)e.unwatch[l]=await S1(e.mounts[l],s,l)}},o=async()=>{if(e.watching){for(const l in e.unwatch)await e.unwatch[l]();e.unwatch={},e.watching=!1}},a=(l,u,f)=>{const h=new Map,d=p=>{let g=h.get(p.base);return g||(g={driver:p.driver,base:p.base,items:[]},h.set(p.base,g)),g};for(const p of l){const g=typeof p=="string",y=Qt(g?p:p.key),x=g?void 0:p.value,A=g||!p.options?u:{...u,...p.options},w=t(y);d(w).items.push({key:y,value:x,relativeKey:w.relativeKey,options:A})}return Promise.all([...h.values()].map(p=>f(p))).then(p=>p.flat())},c={hasItem(l,u={}){l=Qt(l);const{relativeKey:f,driver:h}=t(l);return ot(h.hasItem,f,u)},getItem(l,u={}){l=Qt(l);const{relativeKey:f,driver:h}=t(l);return ot(h.getItem,f,u).then(d=>ch(d))},getItems(l,u={}){return a(l,u,f=>f.driver.getItems?ot(f.driver.getItems,f.items.map(h=>({key:h.relativeKey,options:h.options})),u).then(h=>h.map(d=>({key:u$(f.base,d.key),value:ch(d.value)}))):Promise.all(f.items.map(h=>ot(f.driver.getItem,h.relativeKey,h.options).then(d=>({key:h.key,value:ch(d)})))))},getItemRaw(l,u={}){l=Qt(l);const{relativeKey:f,driver:h}=t(l);return h.getItemRaw?ot(h.getItemRaw,f,u):ot(h.getItem,f,u).then(d=>a$(d))},async setItem(l,u,f={}){if(u===void 0)return c.removeItem(l);l=Qt(l);const{relativeKey:h,driver:d}=t(l);d.setItem&&(await ot(d.setItem,h,Uh(u),f),d.watch||s("update",l))},async setItems(l,u){await a(l,u,async f=>{if(f.driver.setItems)return ot(f.driver.setItems,f.items.map(h=>({key:h.relativeKey,value:Uh(h.value),options:h.options})),u);f.driver.setItem&&await Promise.all(f.items.map(h=>ot(f.driver.setItem,h.relativeKey,Uh(h.value),h.options)))})},async setItemRaw(l,u,f={}){if(u===void 0)return c.removeItem(l,f);l=Qt(l);const{relativeKey:h,driver:d}=t(l);if(d.setItemRaw)await ot(d.setItemRaw,h,u,f);else if(d.setItem)await ot(d.setItem,h,o$(u),f);else return;d.watch||s("update",l)},async removeItem(l,u={}){typeof u=="boolean"&&(u={removeMeta:u}),l=Qt(l);const{relativeKey:f,driver:h}=t(l);h.removeItem&&(await ot(h.removeItem,f,u),(u.removeMeta||u.removeMata)&&await ot(h.removeItem,f+"$",u),h.watch||s("remove",l))},async getMeta(l,u={}){typeof u=="boolean"&&(u={nativeOnly:u}),l=Qt(l);const{relativeKey:f,driver:h}=t(l),d=Object.create(null);if(h.getMeta&&Object.assign(d,await ot(h.getMeta,f,u)),!u.nativeOnly){const p=await ot(h.getItem,f+"$",u).then(g=>ch(g));p&&typeof p=="object"&&(typeof p.atime=="string"&&(p.atime=new Date(p.atime)),typeof p.mtime=="string"&&(p.mtime=new Date(p.mtime)),Object.assign(d,p))}return d},setMeta(l,u,f={}){return this.setItem(l+"$",u,f)},removeMeta(l,u={}){return this.removeItem(l+"$",u)},async getKeys(l,u={}){var y;l=lh(l);const f=n(l,!0);let h=[];const d=[];let p=!0;for(const x of f){(y=x.driver.flags)!=null&&y.maxDepth||(p=!1);const A=await ot(x.driver.getKeys,x.relativeBase,u);for(const w of A){const O=x.mountpoint+Qt(w);h.some(I=>O.startsWith(I))||d.push(O)}h=[x.mountpoint,...h.filter(w=>!w.startsWith(x.mountpoint))]}const g=u.maxDepth!==void 0&&!p;return d.filter(x=>(!g||f$(x,u.maxDepth))&&h$(x,l))},async clear(l,u={}){l=lh(l),await Promise.all(n(l,!1).map(async f=>{if(f.driver.clear)return ot(f.driver.clear,f.relativeBase,u);if(f.driver.removeItem){const h=await f.driver.getKeys(f.relativeBase||"",u);return Promise.all(h.map(d=>f.driver.removeItem(d,u)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(l=>O1(l)))},async watch(l){return await i(),e.watchListeners.push(l),async()=>{e.watchListeners=e.watchListeners.filter(u=>u!==l),e.watchListeners.length===0&&await o()}},async unwatch(){e.watchListeners=[],await o()},mount(l,u){if(l=lh(l),l&&e.mounts[l])throw new Error(`already mounted at ${l}`);return l&&(e.mountpoints.push(l),e.mountpoints.sort((f,h)=>h.length-f.length)),e.mounts[l]=u,e.watching&&Promise.resolve(S1(u,s,l)).then(f=>{e.unwatch[l]=f}).catch(console.error),c},async unmount(l,u=!0){var f,h;l=lh(l),!(!l||!e.mounts[l])&&(e.watching&&l in e.unwatch&&((h=(f=e.unwatch)[l])==null||h.call(f),delete e.unwatch[l]),u&&await O1(e.mounts[l]),e.mountpoints=e.mountpoints.filter(d=>d!==l),delete e.mounts[l])},getMount(l=""){l=Qt(l)+":";const u=t(l);return{driver:u.driver,base:u.base}},getMounts(l="",u={}){return l=Qt(l),n(l,u.parents).map(h=>({driver:h.driver,base:h.mountpoint}))},keys:(l,u={})=>c.getKeys(l,u),get:(l,u={})=>c.getItem(l,u),set:(l,u,f={})=>c.setItem(l,u,f),has:(l,u={})=>c.hasItem(l,u),del:(l,u={})=>c.removeItem(l,u),remove:(l,u={})=>c.removeItem(l,u)};return c}function S1(r,e,t){return r.watch?r.watch((n,s)=>e(n,t+s)):()=>{}}async function O1(r){typeof r.dispose=="function"&&await ot(r.dispose)}function ga(r){return new Promise((e,t)=>{r.oncomplete=r.onsuccess=()=>e(r.result),r.onabort=r.onerror=()=>t(r.error)})}function f6(r,e){let t;const n=()=>{if(t)return t;const s=indexedDB.open(r);return s.onupgradeneeded=()=>s.result.createObjectStore(e),t=ga(s),t.then(i=>{i.onclose=()=>t=void 0},()=>{}),t};return(s,i)=>n().then(o=>i(o.transaction(e,s).objectStore(e)))}let gp;function Of(){return gp||(gp=f6("keyval-store","keyval")),gp}function P1(r,e=Of()){return e("readonly",t=>ga(t.get(r)))}function b$(r,e,t=Of()){return t("readwrite",n=>(n.put(e,r),ga(n.transaction)))}function y$(r,e=Of()){return e("readwrite",t=>(t.delete(r),ga(t.transaction)))}function m$(r=Of()){return r("readwrite",e=>(e.clear(),ga(e.transaction)))}function x$(r,e){return r.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},ga(r.transaction)}function w$(r=Of()){return r("readonly",e=>{if(e.getAllKeys)return ga(e.getAllKeys());const t=[];return x$(e,n=>t.push(n.key)).then(()=>t)})}const E$="idb-keyval";var v$=(r={})=>{const e=r.base&&r.base.length>0?`${r.base}:`:"",t=s=>e+s;let n;return r.dbName&&r.storeName&&(n=f6(r.dbName,r.storeName)),{name:E$,options:r,async hasItem(s){return!(typeof await P1(t(s),n)>"u")},async getItem(s){return await P1(t(s),n)??null},setItem(s,i){return b$(t(s),i,n)},removeItem(s){return y$(t(s),n)},getKeys(){return w$(n)},clear(){return m$(n)}}};const A$="WALLET_CONNECT_V2_INDEXED_DB",I$="keyvaluestorage";let S$=class{constructor(){this.indexedDb=g$({driver:v$({dbName:A$,storeName:I$})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const t=await this.indexedDb.getItem(e);if(t!==null)return t}async setItem(e,t){await this.indexedDb.setItem(e,Fs(t))}async removeItem(e){await this.indexedDb.removeItem(e)}};var bp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},$h={exports:{}};(function(){let r;function e(){}r=e,r.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},r.prototype.setItem=function(t,n){this[t]=String(n)},r.prototype.removeItem=function(t){delete this[t]},r.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(n){t[n]=void 0,delete t[n]})},r.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},r.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof bp<"u"&&bp.localStorage?$h.exports=bp.localStorage:typeof window<"u"&&window.localStorage?$h.exports=window.localStorage:$h.exports=new e})();function O$(r){var e;return[r[0],oa((e=r[1])!=null?e:"")]}let P$=class{constructor(){this.localStorage=$h.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(O$)}async getItem(e){const t=this.localStorage.getItem(e);if(t!==null)return oa(t)}async setItem(e,t){this.localStorage.setItem(e,Fs(t))}async removeItem(e){this.localStorage.removeItem(e)}};const C$="wc_storage_version",C1=1,T$=async(r,e,t)=>{const n=C$,s=await e.getItem(n);if(s&&s>=C1){t(e);return}const i=await r.getKeys();if(!i.length){t(e);return}const o=[];for(;i.length;){const a=i.shift();if(!a)continue;const c=a.toLowerCase();if(c.includes("wc@")||c.includes("walletconnect")||c.includes("wc_")||c.includes("wallet_connect")){const l=await r.getItem(a);await e.setItem(a,l),o.push(a)}}await e.setItem(n,C1),t(e),N$(r,o)},N$=async(r,e)=>{e.length&&e.forEach(async t=>{await r.removeItem(t)})};let D$=class{constructor(){this.initialized=!1,this.setInitialized=t=>{this.storage=t,this.initialized=!0};const e=new P$;this.storage=e;try{const t=new S$;T$(e,t,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)})}};var yp,T1;function R$(){if(T1)return yp;T1=1;function r(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}yp=e;function e(t,n,s){var i=s&&s.stringify||r,o=1;if(typeof t=="object"&&t!==null){var a=n.length+o;if(a===1)return t;var c=new Array(a);c[0]=i(t);for(var l=1;l<a;l++)c[l]=i(n[l]);return c.join(" ")}if(typeof t!="string")return t;var u=n.length;if(u===0)return t;for(var f="",h=1-o,d=-1,p=t&&t.length||0,g=0;g<p;){if(t.charCodeAt(g)===37&&g+1<p){switch(d=d>-1?d:0,t.charCodeAt(g+1)){case 100:case 102:if(h>=u||n[h]==null)break;d<g&&(f+=t.slice(d,g)),f+=Number(n[h]),d=g+2,g++;break;case 105:if(h>=u||n[h]==null)break;d<g&&(f+=t.slice(d,g)),f+=Math.floor(Number(n[h])),d=g+2,g++;break;case 79:case 111:case 106:if(h>=u||n[h]===void 0)break;d<g&&(f+=t.slice(d,g));var y=typeof n[h];if(y==="string"){f+="'"+n[h]+"'",d=g+2,g++;break}if(y==="function"){f+=n[h].name||"<anonymous>",d=g+2,g++;break}f+=i(n[h]),d=g+2,g++;break;case 115:if(h>=u)break;d<g&&(f+=t.slice(d,g)),f+=String(n[h]),d=g+2,g++;break;case 37:d<g&&(f+=t.slice(d,g)),f+="%",d=g+2,g++,h--;break}++h}++g}return d===-1?t:(d<p&&(f+=t.slice(d)),f)}return yp}var mp,N1;function _$(){if(N1)return mp;N1=1;const r=R$();mp=s;const e=I().console||{},t={mapHttpRequest:p,mapHttpResponse:p,wrapRequestSerializer:g,wrapResponseSerializer:g,wrapErrorSerializer:g,req:p,res:p,err:h};function n(E,P){return Array.isArray(E)?E.filter(function(D){return D!=="!stdSerializers.err"}):E===!0?Object.keys(P):!1}function s(E){E=E||{},E.browser=E.browser||{};const P=E.browser.transmit;if(P&&typeof P.send!="function")throw Error("pino: transmit option must have a send function");const T=E.browser.write||e;E.browser.write&&(E.browser.asObject=!0);const D=E.serializers||{},F=n(E.browser.serialize,D);let j=E.browser.serialize;Array.isArray(E.browser.serialize)&&E.browser.serialize.indexOf("!stdSerializers.err")>-1&&(j=!1);const L=["error","fatal","warn","info","debug","trace"];typeof T=="function"&&(T.error=T.fatal=T.warn=T.info=T.debug=T.trace=T),E.enabled===!1&&(E.level="silent");const U=E.level||"info",_=Object.create(T);_.log||(_.log=y),Object.defineProperty(_,"levelVal",{get:v}),Object.defineProperty(_,"level",{get:N,set:$});const m={transmit:P,serialize:F,asObject:E.browser.asObject,levels:L,timestamp:d(E)};_.levels=s.levels,_.level=U,_.setMaxListeners=_.getMaxListeners=_.emit=_.addListener=_.on=_.prependListener=_.once=_.prependOnceListener=_.removeListener=_.removeAllListeners=_.listeners=_.listenerCount=_.eventNames=_.write=_.flush=y,_.serializers=D,_._serialize=F,_._stdErrSerialize=j,_.child=R,P&&(_._logEvent=f());function v(){return this.level==="silent"?1/0:this.levels.values[this.level]}function N(){return this._level}function $(B){if(B!=="silent"&&!this.levels.values[B])throw Error("unknown level "+B);this._level=B,i(m,_,"error","log"),i(m,_,"fatal","error"),i(m,_,"warn","error"),i(m,_,"info","log"),i(m,_,"debug","log"),i(m,_,"trace","log")}function R(B,H){if(!B)throw new Error("missing bindings for child Pino");H=H||{},F&&B.serializers&&(H.serializers=B.serializers);const V=H.serializers;if(F&&V){var X=Object.assign({},D,V),W=E.browser.serialize===!0?Object.keys(X):F;delete B.serializers,c([B],W,X,this._stdErrSerialize)}function J(ne){this._childLevel=(ne._childLevel|0)+1,this.error=l(ne,B,"error"),this.fatal=l(ne,B,"fatal"),this.warn=l(ne,B,"warn"),this.info=l(ne,B,"info"),this.debug=l(ne,B,"debug"),this.trace=l(ne,B,"trace"),X&&(this.serializers=X,this._serialize=W),P&&(this._logEvent=f([].concat(ne._logEvent.bindings,B)))}return J.prototype=this,new J(this)}return _}s.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},s.stdSerializers=t,s.stdTimeFunctions=Object.assign({},{nullTime:x,epochTime:A,unixTime:w,isoTime:O});function i(E,P,T,D){const F=Object.getPrototypeOf(P);P[T]=P.levelVal>P.levels.values[T]?y:F[T]?F[T]:e[T]||e[D]||y,o(E,P,T)}function o(E,P,T){!E.transmit&&P[T]===y||(P[T]=(function(D){return function(){const j=E.timestamp(),L=new Array(arguments.length),U=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var _=0;_<L.length;_++)L[_]=arguments[_];if(E.serialize&&!E.asObject&&c(L,this._serialize,this.serializers,this._stdErrSerialize),E.asObject?D.call(U,a(this,T,L,j)):D.apply(U,L),E.transmit){const m=E.transmit.level||P.level,v=s.levels.values[m],N=s.levels.values[T];if(N<v)return;u(this,{ts:j,methodLevel:T,methodValue:N,transmitValue:s.levels.values[E.transmit.level||P.level],send:E.transmit.send,val:P.levelVal},L)}}})(P[T]))}function a(E,P,T,D){E._serialize&&c(T,E._serialize,E.serializers,E._stdErrSerialize);const F=T.slice();let j=F[0];const L={};D&&(L.time=D),L.level=s.levels.values[P];let U=(E._childLevel|0)+1;if(U<1&&(U=1),j!==null&&typeof j=="object"){for(;U--&&typeof F[0]=="object";)Object.assign(L,F.shift());j=F.length?r(F.shift(),F):void 0}else typeof j=="string"&&(j=r(F.shift(),F));return j!==void 0&&(L.msg=j),L}function c(E,P,T,D){for(const F in E)if(D&&E[F]instanceof Error)E[F]=s.stdSerializers.err(E[F]);else if(typeof E[F]=="object"&&!Array.isArray(E[F]))for(const j in E[F])P&&P.indexOf(j)>-1&&j in T&&(E[F][j]=T[j](E[F][j]))}function l(E,P,T){return function(){const D=new Array(1+arguments.length);D[0]=P;for(var F=1;F<D.length;F++)D[F]=arguments[F-1];return E[T].apply(this,D)}}function u(E,P,T){const D=P.send,F=P.ts,j=P.methodLevel,L=P.methodValue,U=P.val,_=E._logEvent.bindings;c(T,E._serialize||Object.keys(E.serializers),E.serializers,E._stdErrSerialize===void 0?!0:E._stdErrSerialize),E._logEvent.ts=F,E._logEvent.messages=T.filter(function(m){return _.indexOf(m)===-1}),E._logEvent.level.label=j,E._logEvent.level.value=L,D(j,E._logEvent,U),E._logEvent=f(_)}function f(E){return{ts:0,messages:[],bindings:E||[],level:{label:"",value:0}}}function h(E){const P={type:E.constructor.name,msg:E.message,stack:E.stack};for(const T in E)P[T]===void 0&&(P[T]=E[T]);return P}function d(E){return typeof E.timestamp=="function"?E.timestamp:E.timestamp===!1?x:A}function p(){return{}}function g(E){return E}function y(){}function x(){return!1}function A(){return Date.now()}function w(){return Math.round(Date.now()/1e3)}function O(){return new Date(Date.now()).toISOString()}function I(){function E(P){return typeof P<"u"&&P}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return E(self)||E(window)||E(this)||{}}}return mp}var Ua=_$();const Pf=gy(Ua),B$={level:"info"},Cf="custom_context",My=1e3*1024;let k$=class{constructor(e){this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},D1=class{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const t=new k$(e);if(t.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${t.size}`);for(;this.size+t.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=t),this.tail=t):(this.head=t,this.tail=t),this.lengthInNodes++,this.sizeInBytes+=t.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let t=this.head;for(;t!==null;)e.push(t.value),t=t.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const t=e.value;return e=e.next,{done:!1,value:t}}}}},h6=class{constructor(e,t=My){this.level=e??"error",this.levelValue=Ua.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=t,this.logs=new D1(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,t){t===Ua.levels.values.error?console.error(e):t===Ua.levels.values.warn?console.warn(e):t===Ua.levels.values.debug?console.debug(e):t===Ua.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(Fs({timestamp:new Date().toISOString(),log:e}));const t=typeof e=="string"?JSON.parse(e).level:e.level;t>=this.levelValue&&this.forwardToConsole(e,t)}getLogs(){return this.logs}clearLogs(){this.logs=new D1(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const t=this.getLogArray();return t.push(Fs({extraMetadata:e})),new Blob(t,{type:"application/json"})}},U$=class{constructor(e,t=My){this.baseChunkLogger=new h6(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const t=URL.createObjectURL(this.logsToBlob(e)),n=document.createElement("a");n.href=t,n.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t)}},$$=class{constructor(e,t=My){this.baseChunkLogger=new h6(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}};var L$=Object.defineProperty,F$=Object.defineProperties,M$=Object.getOwnPropertyDescriptors,R1=Object.getOwnPropertySymbols,j$=Object.prototype.hasOwnProperty,z$=Object.prototype.propertyIsEnumerable,_1=(r,e,t)=>e in r?L$(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,bd=(r,e)=>{for(var t in e||(e={}))j$.call(e,t)&&_1(r,t,e[t]);if(R1)for(var t of R1(e))z$.call(e,t)&&_1(r,t,e[t]);return r},yd=(r,e)=>F$(r,M$(e));function n0(r){return yd(bd({},r),{level:(r==null?void 0:r.level)||B$.level})}function H$(r,e=Cf){return r[e]||""}function q$(r,e,t=Cf){return r[t]=e,r}function ar(r,e=Cf){let t="";return typeof r.bindings>"u"?t=H$(r,e):t=r.bindings().context||"",t}function V$(r,e,t=Cf){const n=ar(r,t);return n.trim()?`${n}/${e}`:e}function Kt(r,e,t=Cf){const n=V$(r,e,t),s=r.child({context:n});return q$(s,n,t)}function K$(r){var e,t;const n=new U$((e=r.opts)==null?void 0:e.level,r.maxSizeInBytes);return{logger:Pf(yd(bd({},r.opts),{level:"trace",browser:yd(bd({},(t=r.opts)==null?void 0:t.browser),{write:s=>n.write(s)})})),chunkLoggerController:n}}function G$(r){var e;const t=new $$((e=r.opts)==null?void 0:e.level,r.maxSizeInBytes);return{logger:Pf(yd(bd({},r.opts),{level:"trace"}),t),chunkLoggerController:t}}function W$(r){return typeof r.loggerOverride<"u"&&typeof r.loggerOverride!="string"?{logger:r.loggerOverride,chunkLoggerController:null}:typeof window<"u"?K$(r):G$(r)}var Q$=Object.defineProperty,J$=(r,e,t)=>e in r?Q$(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,B1=(r,e,t)=>J$(r,typeof e!="symbol"?e+"":e,t);let Y$=class extends da{constructor(e){super(),this.opts=e,B1(this,"protocol","wc"),B1(this,"version",2)}};var Z$=Object.defineProperty,X$=(r,e,t)=>e in r?Z$(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,eL=(r,e,t)=>X$(r,e+"",t);let tL=class extends da{constructor(e,t){super(),this.core=e,this.logger=t,eL(this,"records",new Map)}},rL=class{constructor(e,t){this.logger=e,this.core=t}},nL=class extends da{constructor(e,t){super(),this.relayer=e,this.logger=t}},sL=class extends da{constructor(e){super()}},iL=class{constructor(e,t,n,s){this.core=e,this.logger=t,this.name=n}},oL=class extends da{constructor(e,t){super(),this.relayer=e,this.logger=t}},aL=class extends da{constructor(e,t){super(),this.core=e,this.logger=t}},cL=class{constructor(e,t,n){this.core=e,this.logger=t,this.store=n}},lL=class{constructor(e,t){this.projectId=e,this.logger=t}},uL=class{constructor(e,t,n){this.core=e,this.logger=t,this.telemetryEnabled=n}};var fL=Object.defineProperty,hL=(r,e,t)=>e in r?fL(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,k1=(r,e,t)=>hL(r,typeof e!="symbol"?e+"":e,t);let dL=class{constructor(e){this.opts=e,k1(this,"protocol","wc"),k1(this,"version",2)}},pL=class{constructor(e){this.client=e}};const gL="PARSE_ERROR",bL="INVALID_REQUEST",yL="METHOD_NOT_FOUND",mL="INVALID_PARAMS",d6="INTERNAL_ERROR",jy="SERVER_ERROR",xL=[-32700,-32600,-32601,-32602,-32603],uu={[gL]:{code:-32700,message:"Parse error"},[bL]:{code:-32600,message:"Invalid Request"},[yL]:{code:-32601,message:"Method not found"},[mL]:{code:-32602,message:"Invalid params"},[d6]:{code:-32603,message:"Internal error"},[jy]:{code:-32e3,message:"Server error"}},p6=jy;function wL(r){return xL.includes(r)}function U1(r){return Object.keys(uu).includes(r)?uu[r]:uu[p6]}function EL(r){const e=Object.values(uu).find(t=>t.code===r);return e||uu[p6]}function g6(r,e,t){return r.message.includes("getaddrinfo ENOTFOUND")||r.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):r}var xp={},cs={},$1;function vL(){if($1)return cs;$1=1,Object.defineProperty(cs,"__esModule",{value:!0}),cs.isBrowserCryptoAvailable=cs.getSubtleCrypto=cs.getBrowerCrypto=void 0;function r(){return(Hn==null?void 0:Hn.crypto)||(Hn==null?void 0:Hn.msCrypto)||{}}cs.getBrowerCrypto=r;function e(){const n=r();return n.subtle||n.webkitSubtle}cs.getSubtleCrypto=e;function t(){return!!r()&&!!e()}return cs.isBrowserCryptoAvailable=t,cs}var ls={},L1;function AL(){if(L1)return ls;L1=1,Object.defineProperty(ls,"__esModule",{value:!0}),ls.isBrowser=ls.isNode=ls.isReactNative=void 0;function r(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}ls.isReactNative=r;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}ls.isNode=e;function t(){return!r()&&!e()}return ls.isBrowser=t,ls}var F1;function IL(){return F1||(F1=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=yf;e.__exportStar(vL(),r),e.__exportStar(AL(),r)})(xp)),xp}var SL=IL();function Cn(r=3){const e=Date.now()*Math.pow(10,r),t=Math.floor(Math.random()*Math.pow(10,r));return e+t}function Ri(r=6){return BigInt(Cn(r))}function fn(r,e,t){return{id:t||Cn(),jsonrpc:"2.0",method:r,params:e}}function Fu(r,e){return{id:r,jsonrpc:"2.0",result:e}}function s0(r,e,t){return{id:r,jsonrpc:"2.0",error:OL(e)}}function OL(r,e){return typeof r>"u"?U1(d6):(typeof r=="string"&&(r=Object.assign(Object.assign({},U1(jy)),{message:r})),wL(r.code)&&(r=EL(r.code)),r)}class PL{}class CL extends PL{constructor(){super()}}class TL extends CL{constructor(e){super()}}const NL="^https?:",DL="^wss?:";function RL(r){const e=r.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function b6(r,e){const t=RL(r);return typeof t>"u"?!1:new RegExp(e).test(t)}function M1(r){return b6(r,NL)}function j1(r){return b6(r,DL)}function _L(r){return new RegExp("wss?://localhost(:d{2,5})?").test(r)}function y6(r){return typeof r=="object"&&"id"in r&&"jsonrpc"in r&&r.jsonrpc==="2.0"}function zy(r){return y6(r)&&"method"in r}function i0(r){return y6(r)&&(Tn(r)||jr(r))}function Tn(r){return"result"in r}function jr(r){return"error"in r}let Hy=class extends TL{constructor(e){super(e),this.events=new Ar.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(fn(e.method,e.params||[],e.id||Ri().toString()),t)}async requestStrict(e,t){return new Promise(async(n,s)=>{if(!this.connection.connected)try{await this.open()}catch(i){s(i)}this.events.on(`${e.id}`,i=>{jr(i)?s(i.error):n(i.result)});try{await this.connection.send(e,t)}catch(i){s(i)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),i0(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}};const BL=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),kL=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",z1=r=>r.split("?")[0],H1=10,UL=BL();let $L=class{constructor(e){if(this.url=e,this.events=new Ar.EventEmitter,this.registering=!1,!j1(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Fs(e))}catch(t){this.onError(e.id,t)}}register(e=this.url){if(!j1(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((n,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,n)=>{const s=SL.isReactNative()?void 0:{rejectUnauthorized:!_L(e)},i=new UL(e,[],s);kL()?i.onerror=o=>{const a=o;n(this.emitError(a.error))}:i.on("error",o=>{n(this.emitError(o))}),i.onopen=()=>{this.onOpen(i),t(i)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?oa(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const n=this.parseError(t),s=n.message||n.toString(),i=s0(e,s);this.events.emit("payload",i)}parseError(e,t=this.url){return g6(e,z1(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>H1&&this.events.setMaxListeners(H1)}emitError(e){const t=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${z1(this.url)}`));return this.events.emit("register_error",t),t}};var LL={};const m6="wc",x6=2,ab="core",ts=`${m6}@2:${ab}:`,FL={logger:"error"},ML={database:":memory:"},jL="crypto",q1="client_ed25519_seed",zL=Z.ONE_DAY,HL="keychain",qL="0.3",VL="messages",KL="0.3",GL=Z.SIX_HOURS,WL="publisher",w6="irn",QL="error",E6="wss://relay.walletconnect.org",JL="relayer",Ve={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},YL="_subscription",Pr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},ZL=.1,cb="2.21.9",$e={link_mode:"link_mode",relay:"relay"},Lh={inbound:"inbound",outbound:"outbound"},XL="0.3",eF="WALLETCONNECT_CLIENT_ID",V1="WALLETCONNECT_LINK_MODE_APPS",fr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},tF="subscription",rF="0.3",nF="pairing",sF="0.3",Ml={wc_pairingDelete:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:0},res:{ttl:Z.ONE_DAY,prompt:!1,tag:0}}},fo={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Qr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},iF="history",oF="0.3",aF="expirer",Rr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},cF="0.3",lF="verify-api",uF="https://verify.walletconnect.com",v6="https://verify.walletconnect.org",fu=v6,fF=`${fu}/v3`,hF=[uF,v6],dF="echo",pF="https://echo.walletconnect.com",Pn={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},ds={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},ri={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},jl={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},to={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},zl={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},gF=.1,bF="event-client",yF=86400,mF="https://pulse.walletconnect.org/batch";function xF(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(t[o]!==255)throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function f(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,y=0,x=0,A=p.length;x!==A&&p[x]===0;)x++,g++;for(var w=(A-x)*u+1>>>0,O=new Uint8Array(w);x!==A;){for(var I=p[x],E=0,P=w-1;(I!==0||E<y)&&P!==-1;P--,E++)I+=256*O[P]>>>0,O[P]=I%a>>>0,I=I/a>>>0;if(I!==0)throw new Error("Non-zero carry");y=E,x++}for(var T=w-y;T!==w&&O[T]===0;)T++;for(var D=c.repeat(g);T<w;++T)D+=r.charAt(O[T]);return D}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var y=0,x=0;p[g]===c;)y++,g++;for(var A=(p.length-g)*l+1>>>0,w=new Uint8Array(A);p[g];){var O=t[p.charCodeAt(g)];if(O===255)return;for(var I=0,E=A-1;(O!==0||I<x)&&E!==-1;E--,I++)O+=a*w[E]>>>0,w[E]=O%256>>>0,O=O/256>>>0;if(O!==0)throw new Error("Non-zero carry");x=I,g++}if(p[g]!==" "){for(var P=A-x;P!==A&&w[P]===0;)P++;for(var T=new Uint8Array(y+(A-P)),D=y;P!==A;)T[D++]=w[P++];return T}}}function d(p){var g=h(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:f,decodeUnsafe:h,decode:d}}var wF=xF,EF=wF;const A6=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},vF=r=>new TextEncoder().encode(r),AF=r=>new TextDecoder().decode(r);class IF{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class SF{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return I6(this,e)}}class OF{constructor(e){this.decoders=e}or(e){return I6(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const I6=(r,e)=>new OF({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class PF{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new IF(e,t,n),this.decoder=new SF(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const o0=({name:r,prefix:e,encode:t,decode:n})=>new PF(r,e,t,n),Tf=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=EF(t,e);return o0({prefix:r,name:e,encode:n,decode:i=>A6(s(i))})},CF=(r,e,t,n)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=r.length;for(;r[i-1]==="=";)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const f=s[r[u]];if(f===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<t|f,a+=t,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},TF=(r,e,t)=>{const n=e[e.length-1]==="=",s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i},Ot=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>o0({prefix:e,name:r,encode(s){return TF(s,n,t)},decode(s){return CF(s,n,t,r)}}),NF=o0({prefix:"\0",name:"identity",encode:r=>AF(r),decode:r=>vF(r)});var DF=Object.freeze({__proto__:null,identity:NF});const RF=Ot({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var _F=Object.freeze({__proto__:null,base2:RF});const BF=Ot({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var kF=Object.freeze({__proto__:null,base8:BF});const UF=Tf({prefix:"9",name:"base10",alphabet:"0123456789"});var $F=Object.freeze({__proto__:null,base10:UF});const LF=Ot({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),FF=Ot({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var MF=Object.freeze({__proto__:null,base16:LF,base16upper:FF});const jF=Ot({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),zF=Ot({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),HF=Ot({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),qF=Ot({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),VF=Ot({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),KF=Ot({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),GF=Ot({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),WF=Ot({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),QF=Ot({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var JF=Object.freeze({__proto__:null,base32:jF,base32upper:zF,base32pad:HF,base32padupper:qF,base32hex:VF,base32hexupper:KF,base32hexpad:GF,base32hexpadupper:WF,base32z:QF});const YF=Tf({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),ZF=Tf({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var XF=Object.freeze({__proto__:null,base36:YF,base36upper:ZF});const eM=Tf({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),tM=Tf({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var rM=Object.freeze({__proto__:null,base58btc:eM,base58flickr:tM});const nM=Ot({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),sM=Ot({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),iM=Ot({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),oM=Ot({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var aM=Object.freeze({__proto__:null,base64:nM,base64pad:sM,base64url:iM,base64urlpad:oM});const S6=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),cM=S6.reduce((r,e,t)=>(r[t]=e,r),[]),lM=S6.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function uM(r){return r.reduce((e,t)=>(e+=cM[t],e),"")}function fM(r){const e=[];for(const t of r){const n=lM[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}const hM=o0({prefix:"🚀",name:"base256emoji",encode:uM,decode:fM});var dM=Object.freeze({__proto__:null,base256emoji:hM}),pM=O6,K1=128,gM=-128,bM=Math.pow(2,31);function O6(r,e,t){e=e||[],t=t||0;for(var n=t;r>=bM;)e[t++]=r&255|K1,r/=128;for(;r&gM;)e[t++]=r&255|K1,r>>>=7;return e[t]=r|0,O6.bytes=t-n+1,e}var yM=lb,mM=128,G1=127;function lb(r,n){var t=0,n=n||0,s=0,i=n,o,a=r.length;do{if(i>=a)throw lb.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(o&G1)<<s:(o&G1)*Math.pow(2,s),s+=7}while(o>=mM);return lb.bytes=i-n,t}var xM=Math.pow(2,7),wM=Math.pow(2,14),EM=Math.pow(2,21),vM=Math.pow(2,28),AM=Math.pow(2,35),IM=Math.pow(2,42),SM=Math.pow(2,49),OM=Math.pow(2,56),PM=Math.pow(2,63),CM=function(r){return r<xM?1:r<wM?2:r<EM?3:r<vM?4:r<AM?5:r<IM?6:r<SM?7:r<OM?8:r<PM?9:10},TM={encode:pM,decode:yM,encodingLength:CM},P6=TM;const W1=(r,e,t=0)=>(P6.encode(r,e,t),e),Q1=r=>P6.encodingLength(r),ub=(r,e)=>{const t=e.byteLength,n=Q1(r),s=n+Q1(t),i=new Uint8Array(s+t);return W1(r,i,0),W1(t,i,n),i.set(e,s),new NM(r,t,e,i)};class NM{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const C6=({name:r,code:e,encode:t})=>new DM(r,e,t);class DM{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?ub(this.code,t):t.then(n=>ub(this.code,n))}else throw Error("Unknown type, must be binary type")}}const T6=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),RM=C6({name:"sha2-256",code:18,encode:T6("SHA-256")}),_M=C6({name:"sha2-512",code:19,encode:T6("SHA-512")});var BM=Object.freeze({__proto__:null,sha256:RM,sha512:_M});const N6=0,kM="identity",D6=A6,UM=r=>ub(N6,D6(r)),$M={code:N6,name:kM,encode:D6,digest:UM};var LM=Object.freeze({__proto__:null,identity:$M});new TextEncoder,new TextDecoder;const J1={...DF,..._F,...kF,...$F,...MF,...JF,...XF,...rM,...aM,...dM};({...BM,...LM});function R6(r){return globalThis.Buffer!=null?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function FM(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?R6(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function _6(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const Y1=_6("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),wp=_6("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=FM(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),MM={utf8:Y1,"utf-8":Y1,hex:J1.base16,latin1:wp,ascii:wp,binary:wp,...J1};function jM(r,e="utf8"){const t=MM[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?R6(globalThis.Buffer.from(r,"utf-8")):t.decoder.decode(`${t.prefix}${r}`)}var zM=Object.defineProperty,HM=(r,e,t)=>e in r?zM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,In=(r,e,t)=>HM(r,typeof e!="symbol"?e+"":e,t);class qM{constructor(e,t){this.core=e,this.logger=t,In(this,"keychain",new Map),In(this,"name",HL),In(this,"version",qL),In(this,"initialized",!1),In(this,"storagePrefix",ts),In(this,"init",async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}}),In(this,"has",n=>(this.isInitialized(),this.keychain.has(n))),In(this,"set",async(n,s)=>{this.isInitialized(),this.keychain.set(n,s),await this.persist()}),In(this,"get",n=>{this.isInitialized();const s=this.keychain.get(n);if(typeof s>"u"){const{message:i}=Y("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(i)}return s}),In(this,"del",async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()}),this.core=e,this.logger=Kt(t,this.name)}get context(){return ar(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Kg(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Gg(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=Y("NOT_INITIALIZED",this.name);throw new Error(e)}}}var VM=Object.defineProperty,KM=(r,e,t)=>e in r?VM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,yt=(r,e,t)=>KM(r,typeof e!="symbol"?e+"":e,t);class GM{constructor(e,t,n){this.core=e,this.logger=t,yt(this,"name",jL),yt(this,"keychain"),yt(this,"randomSessionIdentifier",sb()),yt(this,"initialized",!1),yt(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),yt(this,"hasKeys",s=>(this.isInitialized(),this.keychain.has(s))),yt(this,"getClientId",async()=>{this.isInitialized();const s=await this.getClientSeed(),i=ww(s);return Xv(i.publicKey)}),yt(this,"generateKeyPair",()=>{this.isInitialized();const s=_k();return this.setPrivateKey(s.publicKey,s.privateKey)}),yt(this,"signJWT",async s=>{this.isInitialized();const i=await this.getClientSeed(),o=ww(i),a=this.randomSessionIdentifier;return await PD(a,s,zL,o)}),yt(this,"generateSharedKey",(s,i,o)=>{this.isInitialized();const a=this.getPrivateKey(s),c=Bk(a,i);return this.setSymKey(c,o)}),yt(this,"setSymKey",async(s,i)=>{this.isInitialized();const o=i||kh(s);return await this.keychain.set(o,s),o}),yt(this,"deleteKeyPair",async s=>{this.isInitialized(),await this.keychain.del(s)}),yt(this,"deleteSymKey",async s=>{this.isInitialized(),await this.keychain.del(s)}),yt(this,"encode",async(s,i,o)=>{this.isInitialized();const a=a6(o),c=Fs(i);if(u1(a))return $k(c,o==null?void 0:o.encoding);if(l1(a)){const h=a.senderPublicKey,d=a.receiverPublicKey;s=await this.generateSharedKey(h,d)}const l=this.getSymKey(s),{type:u,senderPublicKey:f}=a;return kk({type:u,symKey:l,message:c,senderPublicKey:f,encoding:o==null?void 0:o.encoding})}),yt(this,"decode",async(s,i,o)=>{this.isInitialized();const a=Fk(i,o);if(u1(a)){const c=Lk(i,o==null?void 0:o.encoding);return oa(c)}if(l1(a)){const c=a.receiverPublicKey,l=a.senderPublicKey;s=await this.generateSharedKey(c,l)}try{const c=this.getSymKey(s),l=Uk({symKey:c,encoded:i,encoding:o==null?void 0:o.encoding});return oa(l)}catch(c){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),yt(this,"getPayloadType",(s,i=rr)=>{const o=Lu({encoded:s,encoding:i});return ca(o.type)}),yt(this,"getPayloadSenderPublicKey",(s,i=rr)=>{const o=Lu({encoded:s,encoding:i});return o.senderPublicKey?sr(o.senderPublicKey,qt):void 0}),this.core=e,this.logger=Kt(t,this.name),this.keychain=n||new qM(this.core,this.logger)}get context(){return ar(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(q1)}catch{e=sb(),await this.keychain.set(q1,e)}return jM(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=Y("NOT_INITIALIZED",this.name);throw new Error(e)}}}var WM=Object.defineProperty,QM=Object.defineProperties,JM=Object.getOwnPropertyDescriptors,Z1=Object.getOwnPropertySymbols,YM=Object.prototype.hasOwnProperty,ZM=Object.prototype.propertyIsEnumerable,fb=(r,e,t)=>e in r?WM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,XM=(r,e)=>{for(var t in e||(e={}))YM.call(e,t)&&fb(r,t,e[t]);if(Z1)for(var t of Z1(e))ZM.call(e,t)&&fb(r,t,e[t]);return r},ej=(r,e)=>QM(r,JM(e)),cr=(r,e,t)=>fb(r,typeof e!="symbol"?e+"":e,t);class tj extends rL{constructor(e,t){super(e,t),this.logger=e,this.core=t,cr(this,"messages",new Map),cr(this,"messagesWithoutClientAck",new Map),cr(this,"name",VL),cr(this,"version",KL),cr(this,"initialized",!1),cr(this,"storagePrefix",ts),cr(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n);const s=await this.getRelayerMessagesWithoutClientAck();typeof s<"u"&&(this.messagesWithoutClientAck=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}}),cr(this,"set",async(n,s,i)=>{this.isInitialized();const o=Mr(s);let a=this.messages.get(n);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=s,this.messages.set(n,a),i===Lh.inbound){const c=this.messagesWithoutClientAck.get(n)||{};this.messagesWithoutClientAck.set(n,ej(XM({},c),{[o]:s}))}return await this.persist(),o}),cr(this,"get",n=>{this.isInitialized();let s=this.messages.get(n);return typeof s>"u"&&(s={}),s}),cr(this,"getWithoutAck",n=>{this.isInitialized();const s={};for(const i of n){const o=this.messagesWithoutClientAck.get(i)||{};s[i]=Object.values(o)}return s}),cr(this,"has",(n,s)=>{this.isInitialized();const i=this.get(n),o=Mr(s);return typeof i[o]<"u"}),cr(this,"ack",async(n,s)=>{this.isInitialized();const i=this.messagesWithoutClientAck.get(n);if(typeof i>"u")return;const o=Mr(s);delete i[o],Object.keys(i).length===0?this.messagesWithoutClientAck.delete(n):this.messagesWithoutClientAck.set(n,i),await this.persist()}),cr(this,"del",async n=>{this.isInitialized(),this.messages.delete(n),this.messagesWithoutClientAck.delete(n),await this.persist()}),this.logger=Kt(e,this.name),this.core=t}get context(){return ar(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Kg(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,Kg(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Gg(e):void 0}async getRelayerMessagesWithoutClientAck(){const e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?Gg(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:e}=Y("NOT_INITIALIZED",this.name);throw new Error(e)}}}var rj=Object.defineProperty,nj=Object.defineProperties,sj=Object.getOwnPropertyDescriptors,X1=Object.getOwnPropertySymbols,ij=Object.prototype.hasOwnProperty,oj=Object.prototype.propertyIsEnumerable,hb=(r,e,t)=>e in r?rj(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ta=(r,e)=>{for(var t in e||(e={}))ij.call(e,t)&&hb(r,t,e[t]);if(X1)for(var t of X1(e))oj.call(e,t)&&hb(r,t,e[t]);return r},e2=(r,e)=>nj(r,sj(e)),Cr=(r,e,t)=>hb(r,typeof e!="symbol"?e+"":e,t);class aj extends nL{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,Cr(this,"events",new Ar.EventEmitter),Cr(this,"name",WL),Cr(this,"queue",new Map),Cr(this,"publishTimeout",Z.toMiliseconds(Z.ONE_MINUTE)),Cr(this,"initialPublishTimeout",Z.toMiliseconds(Z.ONE_SECOND*15)),Cr(this,"needsTransportRestart",!1),Cr(this,"publish",async(n,s,i)=>{var o,a,c,l,u;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:s,opts:i}});const f=(i==null?void 0:i.ttl)||GL,h=(i==null?void 0:i.prompt)||!1,d=(i==null?void 0:i.tag)||0,p=(i==null?void 0:i.id)||Ri().toString(),g=ja(pd().protocol),y={id:p,method:(i==null?void 0:i.publishMethod)||g.publish,params:Ta({topic:n,message:s,ttl:f,prompt:h,tag:d,attestation:i==null?void 0:i.attestation},i==null?void 0:i.tvf)},x=`Failed to publish payload, please try again. id:${p} tag:${d}`;try{rt((o=y.params)==null?void 0:o.prompt)&&((a=y.params)==null||delete a.prompt),rt((c=y.params)==null?void 0:c.tag)&&((l=y.params)==null||delete l.tag);const A=new Promise(async w=>{const O=({id:E})=>{var P;((P=y.id)==null?void 0:P.toString())===E.toString()&&(this.removeRequestFromQueue(E),this.relayer.events.removeListener(Ve.publish,O),w())};this.relayer.events.on(Ve.publish,O);const I=Kn(new Promise((E,P)=>{this.rpcPublish(y,i).then(E).catch(T=>{this.logger.warn(T,T==null?void 0:T.message),P(T)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${p} tag:${d}`);try{await I,this.events.removeListener(Ve.publish,O)}catch(E){this.queue.set(p,{request:y,opts:i,attempt:1}),this.logger.warn(E,E==null?void 0:E.message)}});this.logger.trace({type:"method",method:"publish",params:{id:p,topic:n,message:s,opts:i}}),await Kn(A,this.publishTimeout,x)}catch(A){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(A),(u=i==null?void 0:i.internal)!=null&&u.throwOnFailedPublish)throw A}finally{this.queue.delete(p)}}),Cr(this,"publishCustom",async n=>{var s,i,o,a,c;this.logger.debug("Publishing custom payload"),this.logger.trace({type:"method",method:"publishCustom",params:n});const{payload:l,opts:u={}}=n,{attestation:f,tvf:h,publishMethod:d,prompt:p,tag:g,ttl:y=Z.FIVE_MINUTES}=u,x=u.id||Ri().toString(),A=ja(pd().protocol),w=d||A.publish,O={id:x,method:w,params:Ta(e2(Ta({},l),{ttl:y,prompt:p,tag:g,attestation:f}),h)},I=`Failed to publish custom payload, please try again. id:${x} tag:${g}`;try{rt((s=O.params)==null?void 0:s.prompt)&&((i=O.params)==null||delete i.prompt),rt((o=O.params)==null?void 0:o.tag)&&((a=O.params)==null||delete a.tag);const E=new Promise(async P=>{const T=({id:F})=>{var j;((j=O.id)==null?void 0:j.toString())===F.toString()&&(this.removeRequestFromQueue(F),this.relayer.events.removeListener(Ve.publish,T),P())};this.relayer.events.on(Ve.publish,T);const D=Kn(new Promise((F,j)=>{this.rpcPublish(O,u).then(F).catch(L=>{this.logger.warn(L,L==null?void 0:L.message),j(L)})}),this.initialPublishTimeout,`Failed initial custom payload publish, retrying.... method:${w} id:${x} tag:${g}`);try{await D,this.events.removeListener(Ve.publish,T)}catch(F){this.queue.set(x,{request:O,opts:u,attempt:1}),this.logger.warn(F,F==null?void 0:F.message)}});this.logger.trace({type:"method",method:"publish",params:{id:x,payload:l,opts:u}}),await Kn(E,this.publishTimeout,I)}catch(E){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(E),(c=u==null?void 0:u.internal)!=null&&c.throwOnFailedPublish)throw E}finally{this.queue.delete(x)}}),Cr(this,"on",(n,s)=>{this.events.on(n,s)}),Cr(this,"once",(n,s)=>{this.events.once(n,s)}),Cr(this,"off",(n,s)=>{this.events.off(n,s)}),Cr(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.relayer=e,this.logger=Kt(t,this.name),this.registerEventListeners()}get context(){return ar(this.logger)}async rpcPublish(e,t){this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:e});const n=await this.relayer.request(e);return this.relayer.events.emit(Ve.publish,Ta(Ta({},e),t)),this.logger.debug("Successfully Published Payload"),n}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,t)=>{var n;const s=e.attempt+1;this.queue.set(t,e2(Ta({},e),{attempt:s})),this.logger.warn({},`Publisher: queue->publishing: ${e.request.id}, tag: ${(n=e.request.params)==null?void 0:n.tag}, attempt: ${s}`),await this.rpcPublish(e.request,e.opts),this.logger.warn({},`Publisher: queue->published: ${e.request.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(pa.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Ve.connection_stalled);return}this.checkQueue()}),this.relayer.on(Ve.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var cj=Object.defineProperty,lj=(r,e,t)=>e in r?cj(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Na=(r,e,t)=>lj(r,typeof e!="symbol"?e+"":e,t);class uj{constructor(){Na(this,"map",new Map),Na(this,"set",(e,t)=>{const n=this.get(e);this.exists(e,t)||this.map.set(e,[...n,t])}),Na(this,"get",e=>this.map.get(e)||[]),Na(this,"exists",(e,t)=>this.get(e).includes(t)),Na(this,"delete",(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const n=this.get(e);if(!this.exists(e,t))return;const s=n.filter(i=>i!==t);if(!s.length){this.map.delete(e);return}this.map.set(e,s)}),Na(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var fj=Object.defineProperty,hj=Object.defineProperties,dj=Object.getOwnPropertyDescriptors,t2=Object.getOwnPropertySymbols,pj=Object.prototype.hasOwnProperty,gj=Object.prototype.propertyIsEnumerable,db=(r,e,t)=>e in r?fj(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Hl=(r,e)=>{for(var t in e||(e={}))pj.call(e,t)&&db(r,t,e[t]);if(t2)for(var t of t2(e))gj.call(e,t)&&db(r,t,e[t]);return r},Ep=(r,e)=>hj(r,dj(e)),_e=(r,e,t)=>db(r,typeof e!="symbol"?e+"":e,t);class bj extends oL{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,_e(this,"subscriptions",new Map),_e(this,"topicMap",new uj),_e(this,"events",new Ar.EventEmitter),_e(this,"name",tF),_e(this,"version",rF),_e(this,"pending",new Map),_e(this,"cached",[]),_e(this,"initialized",!1),_e(this,"storagePrefix",ts),_e(this,"subscribeTimeout",Z.toMiliseconds(Z.ONE_MINUTE)),_e(this,"initialSubscribeTimeout",Z.toMiliseconds(Z.ONE_SECOND*15)),_e(this,"clientId"),_e(this,"batchSubscribeTopicsLimit",500),_e(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),_e(this,"subscribe",async(n,s)=>{var i;this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}});try{const o=pd(s),a={topic:n,relay:o,transportType:s==null?void 0:s.transportType};(i=s==null?void 0:s.internal)!=null&&i.skipSubscribe||this.pending.set(n,a);const c=await this.rpcSubscribe(n,o,s);return typeof c=="string"&&(this.onSubscribe(c,a),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}})),c}catch(o){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(o),o}}),_e(this,"unsubscribe",async(n,s)=>{this.isInitialized(),typeof(s==null?void 0:s.id)<"u"?await this.unsubscribeById(n,s.id,s):await this.unsubscribeByTopic(n,s)}),_e(this,"isSubscribed",n=>new Promise(s=>{s(this.topicMap.topics.includes(n))})),_e(this,"isKnownTopic",n=>new Promise(s=>{s(this.topicMap.topics.includes(n)||this.pending.has(n)||this.cached.some(i=>i.topic===n))})),_e(this,"on",(n,s)=>{this.events.on(n,s)}),_e(this,"once",(n,s)=>{this.events.once(n,s)}),_e(this,"off",(n,s)=>{this.events.off(n,s)}),_e(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),_e(this,"start",async()=>{await this.onConnect()}),_e(this,"stop",async()=>{await this.onDisconnect()}),_e(this,"restart",async()=>{await this.restore(),await this.onRestart()}),_e(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const n=[];this.pending.forEach(s=>{n.push(s)}),await this.batchSubscribe(n)}),_e(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(pa.pulse,async()=>{await this.checkPending()}),this.events.on(fr.created,async n=>{const s=fr.created;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:n}),await this.persist()}),this.events.on(fr.deleted,async n=>{const s=fr.deleted;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:n}),await this.persist()})}),this.relayer=e,this.logger=Kt(t,this.name),this.clientId=""}get context(){return ar(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,t){let n=!1;try{n=this.getSubscription(e).topic===t}catch{}return n}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const n=this.topicMap.get(e);await Promise.all(n.map(async s=>await this.unsubscribeById(e,s,t)))}async unsubscribeById(e,t,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:n}});try{const s=pd(n);await this.restartToComplete({topic:e,id:t,relay:s}),await this.rpcUnsubscribe(e,t,s);const i=Le("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:n}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(e,t,n){var s,i;const o=await this.getSubscriptionId(e);if((s=n==null?void 0:n.internal)!=null&&s.skipSubscribe)return o;(!n||(n==null?void 0:n.transportType)===$e.relay)&&await this.restartToComplete({topic:e,id:e,relay:t});const a={method:ja(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a});const c=(i=n==null?void 0:n.internal)==null?void 0:i.throwOnFailedPublish;try{if((n==null?void 0:n.transportType)===$e.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(a).catch(f=>this.logger.warn(f))},Z.toMiliseconds(Z.ONE_SECOND)),o;const l=new Promise(async f=>{const h=d=>{d.topic===e&&(this.events.removeListener(fr.created,h),f(d.id))};this.events.on(fr.created,h);try{const d=await Kn(new Promise((p,g)=>{this.relayer.request(a).catch(y=>{this.logger.warn(y,y==null?void 0:y.message),g(y)}).then(p)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(fr.created,h),f(d)}catch{}}),u=await Kn(l,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!u&&c)throw new Error(`Subscribing to ${e} failed, please try again`);return u?o:null}catch(l){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Ve.connection_stalled),c)throw l}return null}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,n={method:ja(t.protocol).batchSubscribe,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await Kn(new Promise(s=>{this.relayer.request(n).catch(i=>this.logger.warn(i)).then(s)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(Ve.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const t=e[0].relay,n={method:ja(t.protocol).batchFetchMessages,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});let s;try{s=await await Kn(new Promise((i,o)=>{this.relayer.request(n).catch(a=>{this.logger.warn(a),o(a)}).then(i)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(Ve.connection_stalled)}return s}rpcUnsubscribe(e,t,n){const s={method:ja(n.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(e,t){this.setSubscription(e,Ep(Hl({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,Hl({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,n){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,n),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}addSubscription(e,t){this.subscriptions.set(e,Hl({},t)),this.topicMap.set(t.topic,e),this.events.emit(fr.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:n}=Y("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const n=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(n.topic,e),this.events.emit(fr.deleted,Ep(Hl({},n),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(fr.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let n=0;n<t;n++){const s=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(fr.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size&&!e.every(t=>{var n;return t.topic===((n=this.subscriptions.get(t.id))==null?void 0:n.topic)})){const{message:t}=Y("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async t=>Ep(Hl({},t),{id:await this.getSubscriptionId(t.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const t=await this.rpcBatchFetchMessages(e);t&&t.messages&&(await t_(Z.toMiliseconds(Z.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(t.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=Y("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return Mr(e+await this.getClientId())}}var yj=Object.defineProperty,r2=Object.getOwnPropertySymbols,mj=Object.prototype.hasOwnProperty,xj=Object.prototype.propertyIsEnumerable,pb=(r,e,t)=>e in r?yj(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,n2=(r,e)=>{for(var t in e||(e={}))mj.call(e,t)&&pb(r,t,e[t]);if(r2)for(var t of r2(e))xj.call(e,t)&&pb(r,t,e[t]);return r},ve=(r,e,t)=>pb(r,typeof e!="symbol"?e+"":e,t);class wj extends sL{constructor(e){super(e),ve(this,"protocol","wc"),ve(this,"version",2),ve(this,"core"),ve(this,"logger"),ve(this,"events",new Ar.EventEmitter),ve(this,"provider"),ve(this,"messages"),ve(this,"subscriber"),ve(this,"publisher"),ve(this,"name",JL),ve(this,"transportExplicitlyClosed",!1),ve(this,"initialized",!1),ve(this,"connectionAttemptInProgress",!1),ve(this,"relayUrl"),ve(this,"projectId"),ve(this,"packageName"),ve(this,"bundleId"),ve(this,"hasExperiencedNetworkDisruption",!1),ve(this,"pingTimeout"),ve(this,"heartBeatTimeout",Z.toMiliseconds(Z.THIRTY_SECONDS+Z.FIVE_SECONDS)),ve(this,"reconnectTimeout"),ve(this,"connectPromise"),ve(this,"reconnectInProgress",!1),ve(this,"requestsInFlight",[]),ve(this,"connectTimeout",Z.toMiliseconds(Z.ONE_SECOND*15)),ve(this,"request",async t=>{var n,s;this.logger.debug("Publishing Request Payload");const i=t.id||Ri().toString();await this.toEstablishConnection();try{this.logger.trace({id:i,method:t.method,topic:(n=t.params)==null?void 0:n.topic},"relayer.request - publishing...");const o=`${i}:${((s=t.params)==null?void 0:s.tag)||""}`;this.requestsInFlight.push(o);const a=await this.provider.request(t);return this.requestsInFlight=this.requestsInFlight.filter(c=>c!==o),a}catch(o){throw this.logger.debug(`Failed to Publish Request: ${i}`),o}}),ve(this,"resetPingTimeout",()=>{cd()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var t,n,s,i;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(i=(s=(n=(t=this.provider)==null?void 0:t.connection)==null?void 0:n.socket)==null?void 0:s.terminate)==null||i.call(s)}catch(o){this.logger.warn(o,o==null?void 0:o.message)}},this.heartBeatTimeout))}),ve(this,"onPayloadHandler",t=>{this.onProviderPayload(t),this.resetPingTimeout()}),ve(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected 🛜"),this.startPingTimeout(),this.events.emit(Ve.connect)}),ve(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected 🛑"),this.requestsInFlight=[],this.onProviderDisconnect()}),ve(this,"onProviderErrorHandler",t=>{this.logger.fatal(`Fatal socket error: ${t.message}`),this.events.emit(Ve.error,t),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),ve(this,"registerProviderListeners",()=>{this.provider.on(Pr.payload,this.onPayloadHandler),this.provider.on(Pr.connect,this.onConnectHandler),this.provider.on(Pr.disconnect,this.onDisconnectHandler),this.provider.on(Pr.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Kt(e.logger,this.name):Pf(n0({level:e.logger||QL})),this.messages=new tj(this.logger,e.core),this.subscriber=new bj(this,this.logger),this.publisher=new aj(this,this.logger),this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||E6,FR()?this.packageName=Dw():MR()&&(this.bundleId=Dw()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(e=>this.logger.warn(e,e==null?void 0:e.message))}get context(){return ar(this.logger)}get connected(){var e,t,n;return((n=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:n.readyState)===1||!1}get connecting(){var e,t,n;return((n=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:n.readyState)===0||this.connectPromise!==void 0||!1}async publish(e,t,n){this.isInitialized(),await this.publisher.publish(e,t,n),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now(),transportType:$e.relay},Lh.outbound)}async publishCustom(e){this.isInitialized(),await this.publisher.publishCustom(e)}async subscribe(e,t){var n,s,i;this.isInitialized(),(!(t!=null&&t.transportType)||(t==null?void 0:t.transportType)==="relay")&&await this.toEstablishConnection();const o=typeof((n=t==null?void 0:t.internal)==null?void 0:n.throwOnFailedPublish)>"u"?!0:(s=t==null?void 0:t.internal)==null?void 0:s.throwOnFailedPublish;let a=((i=this.subscriber.topicMap.get(e))==null?void 0:i[0])||"",c;const l=u=>{u.topic===e&&(this.subscriber.off(fr.created,l),c())};return await Promise.all([new Promise(u=>{c=u,this.subscriber.on(fr.created,l)}),new Promise(async(u,f)=>{a=await this.subscriber.subscribe(e,n2({internal:{throwOnFailedPublish:o}},t)).catch(h=>{o&&f(h)})||a,u()})]),a}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await Kn(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.info("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(t,n)=>{await this.connect(e).then(t).catch(n).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await A1())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if((e==null?void 0:e.length)===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const t=e.sort((n,s)=>n.publishedAt-s.publishedAt);this.logger.debug(`Batch of ${t.length} message events sorted`);for(const n of t)try{await this.onMessageEvent(n)}catch(s){this.logger.warn(s,"Error while processing batch message event: "+(s==null?void 0:s.message))}this.logger.trace(`Batch of ${t.length} message events processed`)}async onLinkMessageEvent(e,t){const{topic:n}=e;if(!t.sessionExists){const s=Ze(Z.FIVE_MINUTES),i={topic:n,expiry:s,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(n,i)}this.events.emit(Ve.message,e),await this.recordMessageEvent(e,Lh.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let t=1;for(;t<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${t}...`),await this.createProvider(),await new Promise(async(n,s)=>{const i=()=>{s(new Error("Connection interrupted while trying to connect"))};this.provider.once(Pr.disconnect,i),await Kn(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{s(o)}).finally(()=>{this.provider.off(Pr.disconnect,i),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const c=()=>{s(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Pr.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(Pr.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,n()})}catch(n){await this.subscriber.stop();const s=n;this.logger.warn({},s.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${t}`);break}await new Promise(n=>setTimeout(n,Z.toMiliseconds(t*1))),t++}}startPingTimeout(){var e,t,n,s,i;if(cd())try{(t=(e=this.provider)==null?void 0:e.connection)!=null&&t.socket&&((i=(s=(n=this.provider)==null?void 0:n.connection)==null?void 0:s.socket)==null||i.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o==null?void 0:o.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Hy(new $L(VR({sdkVersion:cb,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,t){const{topic:n,message:s}=e;await this.messages.set(n,s,t)}async shouldIgnoreMessageEvent(e){const{topic:t,message:n}=e;if(!n||n.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isKnownTopic(t))return this.logger.warn(`Ignoring message for unknown topic ${t}`),!0;const s=this.messages.has(t,n);return s&&this.logger.warn(`Ignoring duplicate message: ${n}`),s}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),zy(e)){if(!e.method.endsWith(YL))return;const t=e.params,{topic:n,message:s,publishedAt:i,attestation:o}=t.data,a={topic:n,message:s,publishedAt:i,transportType:$e.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(n2({type:"event",event:t.id},a)),this.events.emit(t.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else i0(e)&&this.events.emit(Ve.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,Lh.inbound),this.events.emit(Ve.message,e))}async acknowledgePayload(e){const t=Fu(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(Pr.payload,this.onPayloadHandler),this.provider.off(Pr.connect,this.onConnectHandler),this.provider.off(Pr.disconnect,this.onDisconnectHandler),this.provider.off(Pr.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await A1();LU(async t=>{e!==t&&(e=t,t?await this.transportOpen().catch(n=>this.logger.error(n,n==null?void 0:n.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(pa.pulse,async()=>{if(!this.transportExplicitlyClosed&&!this.connected&&jU())try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(t){this.logger.warn(t,t==null?void 0:t.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(Ve.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e==null?void 0:e.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},Z.toMiliseconds(ZL)))))}isInitialized(){if(!this.initialized){const{message:e}=Y("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}}function Ej(r,e){return r===e||Number.isNaN(r)&&Number.isNaN(e)}function s2(r){return Object.getOwnPropertySymbols(r).filter(e=>Object.prototype.propertyIsEnumerable.call(r,e))}function i2(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}const vj="[object RegExp]",Aj="[object String]",Ij="[object Number]",Sj="[object Boolean]",o2="[object Arguments]",Oj="[object Symbol]",Pj="[object Date]",Cj="[object Map]",Tj="[object Set]",Nj="[object Array]",Dj="[object Function]",Rj="[object ArrayBuffer]",vp="[object Object]",_j="[object Error]",Bj="[object DataView]",kj="[object Uint8Array]",Uj="[object Uint8ClampedArray]",$j="[object Uint16Array]",Lj="[object Uint32Array]",Fj="[object BigUint64Array]",Mj="[object Int8Array]",jj="[object Int16Array]",zj="[object Int32Array]",Hj="[object BigInt64Array]",qj="[object Float32Array]",Vj="[object Float64Array]";function Kj(){}function a2(r){if(!r||typeof r!="object")return!1;const e=Object.getPrototypeOf(r);return e===null||e===Object.prototype||Object.getPrototypeOf(e)===null?Object.prototype.toString.call(r)==="[object Object]":!1}function Gj(r,e,t){return su(r,e,void 0,void 0,void 0,void 0,t)}function su(r,e,t,n,s,i,o){const a=o(r,e,t,n,s,i);if(a!==void 0)return a;if(typeof r==typeof e)switch(typeof r){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return r===e;case"number":return r===e||Object.is(r,e);case"function":return r===e;case"object":return hu(r,e,i,o)}return hu(r,e,i,o)}function hu(r,e,t,n){if(Object.is(r,e))return!0;let s=i2(r),i=i2(e);if(s===o2&&(s=vp),i===o2&&(i=vp),s!==i)return!1;switch(s){case Aj:return r.toString()===e.toString();case Ij:{const c=r.valueOf(),l=e.valueOf();return Ej(c,l)}case Sj:case Pj:case Oj:return Object.is(r.valueOf(),e.valueOf());case vj:return r.source===e.source&&r.flags===e.flags;case Dj:return r===e}t=t??new Map;const o=t.get(r),a=t.get(e);if(o!=null&&a!=null)return o===e;t.set(r,e),t.set(e,r);try{switch(s){case Cj:{if(r.size!==e.size)return!1;for(const[c,l]of r.entries())if(!e.has(c)||!su(l,e.get(c),c,r,e,t,n))return!1;return!0}case Tj:{if(r.size!==e.size)return!1;const c=Array.from(r.values()),l=Array.from(e.values());for(let u=0;u<c.length;u++){const f=c[u],h=l.findIndex(d=>su(f,d,void 0,r,e,t,n));if(h===-1)return!1;l.splice(h,1)}return!0}case Nj:case kj:case Uj:case $j:case Lj:case Fj:case Mj:case jj:case zj:case Hj:case qj:case Vj:{if(typeof Buffer<"u"&&Buffer.isBuffer(r)!==Buffer.isBuffer(e)||r.length!==e.length)return!1;for(let c=0;c<r.length;c++)if(!su(r[c],e[c],c,r,e,t,n))return!1;return!0}case Rj:return r.byteLength!==e.byteLength?!1:hu(new Uint8Array(r),new Uint8Array(e),t,n);case Bj:return r.byteLength!==e.byteLength||r.byteOffset!==e.byteOffset?!1:hu(new Uint8Array(r),new Uint8Array(e),t,n);case _j:return r.name===e.name&&r.message===e.message;case vp:{if(!(hu(r.constructor,e.constructor,t,n)||a2(r)&&a2(e)))return!1;const c=[...Object.keys(r),...s2(r)],l=[...Object.keys(e),...s2(e)];if(c.length!==l.length)return!1;for(let u=0;u<c.length;u++){const f=c[u],h=r[f];if(!Object.hasOwn(e,f))return!1;const d=e[f];if(!su(h,d,f,r,e,t,n))return!1}return!0}default:return!1}}finally{t.delete(r),t.delete(e)}}function Wj(r,e){return Gj(r,e,Kj)}var Qj=Object.defineProperty,c2=Object.getOwnPropertySymbols,Jj=Object.prototype.hasOwnProperty,Yj=Object.prototype.propertyIsEnumerable,gb=(r,e,t)=>e in r?Qj(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,l2=(r,e)=>{for(var t in e||(e={}))Jj.call(e,t)&&gb(r,t,e[t]);if(c2)for(var t of c2(e))Yj.call(e,t)&&gb(r,t,e[t]);return r},Wt=(r,e,t)=>gb(r,typeof e!="symbol"?e+"":e,t);class ba extends iL{constructor(e,t,n,s=ts,i=void 0){super(e,t,n,s),this.core=e,this.logger=t,this.name=n,Wt(this,"map",new Map),Wt(this,"version",XL),Wt(this,"cached",[]),Wt(this,"initialized",!1),Wt(this,"getKey"),Wt(this,"storagePrefix",ts),Wt(this,"recentlyDeleted",[]),Wt(this,"recentlyDeletedLimit",200),Wt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!rt(o)?this.map.set(this.getKey(o),o):gU(o)?this.map.set(o.id,o):bU(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),Wt(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),Wt(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),Wt(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>Wj(a[c],o[c]))):this.values)),Wt(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const c=l2(l2({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),Wt(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=Kt(t,this.name),this.storagePrefix=s,this.getKey=i}get context(){return ar(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){const{message:s}=Y("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}const{message:n}=Y("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=Y("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=Y("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Zj=Object.defineProperty,Xj=(r,e,t)=>e in r?Zj(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,pe=(r,e,t)=>Xj(r,typeof e!="symbol"?e+"":e,t);class ez{constructor(e,t){this.core=e,this.logger=t,pe(this,"name",nF),pe(this,"version",sF),pe(this,"events",new by),pe(this,"pairings"),pe(this,"initialized",!1),pe(this,"storagePrefix",ts),pe(this,"ignoredPayloadTypes",[Bs]),pe(this,"registeredMethods",[]),pe(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),pe(this,"register",({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]}),pe(this,"create",async n=>{this.isInitialized();const s=sb(),i=await this.core.crypto.setSymKey(s),o=Ze(Z.FIVE_MINUTES),a={protocol:w6},c={topic:i,expiry:o,relay:a,active:!1,methods:n==null?void 0:n.methods},l=p1({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:s,relay:a,expiryTimestamp:o,methods:n==null?void 0:n.methods});return this.events.emit(fo.create,c),this.core.expirer.set(i,o),await this.pairings.set(i,c),await this.core.relayer.subscribe(i,{transportType:n==null?void 0:n.transportType,internal:n==null?void 0:n.internal}),{topic:i,uri:l}}),pe(this,"pair",async n=>{this.isInitialized();const s=this.core.eventClient.createEvent({properties:{topic:n==null?void 0:n.uri,trace:[Pn.pairing_started]}});this.isValidPair(n,s);const{topic:i,symKey:o,relay:a,expiryTimestamp:c,methods:l}=d1(n.uri);s.props.properties.topic=i,s.addTrace(Pn.pairing_uri_validation_success),s.addTrace(Pn.pairing_uri_not_expired);let u;if(this.pairings.keys.includes(i)){if(u=this.pairings.get(i),s.addTrace(Pn.existing_pairing),u.active)throw s.setError(ds.active_pairing_already_exists),new Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);s.addTrace(Pn.pairing_not_expired)}const f=c||Ze(Z.FIVE_MINUTES),h={topic:i,relay:a,expiry:f,active:!1,methods:l};this.core.expirer.set(i,f),await this.pairings.set(i,h),s.addTrace(Pn.store_new_pairing),n.activatePairing&&await this.activate({topic:i}),this.events.emit(fo.create,h),s.addTrace(Pn.emit_inactive_pairing),this.core.crypto.keychain.has(i)||await this.core.crypto.setSymKey(o,i),s.addTrace(Pn.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{s.setError(ds.no_internet_connection)}try{await this.core.relayer.subscribe(i,{relay:a})}catch(d){throw s.setError(ds.subscribe_pairing_topic_failure),d}return s.addTrace(Pn.subscribe_pairing_topic_success),h}),pe(this,"activate",async({topic:n})=>{this.isInitialized();const s=Ze(Z.FIVE_MINUTES);this.core.expirer.set(n,s),await this.pairings.update(n,{active:!0,expiry:s})}),pe(this,"ping",async n=>{this.isInitialized(),await this.isValidPing(n),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:s}=n;if(this.pairings.keys.includes(s)){const i=await this.sendRequest(s,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=oo();this.events.once(Ie("pairing_ping",i),({error:l})=>{l?c(l):a()}),await o()}}),pe(this,"updateExpiry",async({topic:n,expiry:s})=>{this.isInitialized(),await this.pairings.update(n,{expiry:s})}),pe(this,"updateMetadata",async({topic:n,metadata:s})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:s})}),pe(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),pe(this,"disconnect",async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:s}=n;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",Le("USER_DISCONNECTED")),await this.deletePairing(s))}),pe(this,"formatUriFromPairing",n=>{this.isInitialized();const{topic:s,relay:i,expiry:o,methods:a}=n,c=this.core.crypto.keychain.get(s);return p1({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:c,relay:i,expiryTimestamp:o,methods:a})}),pe(this,"sendRequest",async(n,s,i)=>{const o=fn(s,i),a=await this.core.crypto.encode(n,o),c=Ml[s].req;return this.core.history.set(n,o),this.core.relayer.publish(n,a,c),o.id}),pe(this,"sendResult",async(n,s,i)=>{const o=Fu(n,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,n)).request.method,l=Ml[c].res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),pe(this,"sendError",async(n,s,i)=>{const o=s0(n,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,n)).request.method,l=Ml[c]?Ml[c].res:Ml.unregistered_method.res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),pe(this,"deletePairing",async(n,s)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,Le("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),s?Promise.resolve():this.core.expirer.del(n)])}),pe(this,"cleanup",async()=>{const n=this.pairings.getAll().filter(s=>qn(s.expiry));await Promise.all(n.map(s=>this.deletePairing(s.topic)))}),pe(this,"onRelayEventRequest",async n=>{const{topic:s,payload:i}=n;switch(i.method){case"wc_pairingPing":return await this.onPairingPingRequest(s,i);case"wc_pairingDelete":return await this.onPairingDeleteRequest(s,i);default:return await this.onUnknownRpcMethodRequest(s,i)}}),pe(this,"onRelayEventResponse",async n=>{const{topic:s,payload:i}=n,o=(await this.core.history.get(s,i.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(s,i);default:return this.onUnknownRpcMethodResponse(o)}}),pe(this,"onPairingPingRequest",async(n,s)=>{const{id:i}=s;try{this.isValidPing({topic:n}),await this.sendResult(i,n,!0),this.events.emit(fo.ping,{id:i,topic:n})}catch(o){await this.sendError(i,n,o),this.logger.error(o)}}),pe(this,"onPairingPingResponse",(n,s)=>{const{id:i}=s;setTimeout(()=>{Tn(s)?this.events.emit(Ie("pairing_ping",i),{}):jr(s)&&this.events.emit(Ie("pairing_ping",i),{error:s.error})},500)}),pe(this,"onPairingDeleteRequest",async(n,s)=>{const{id:i}=s;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(fo.delete,{id:i,topic:n})}catch(o){await this.sendError(i,n,o),this.logger.error(o)}}),pe(this,"onUnknownRpcMethodRequest",async(n,s)=>{const{id:i,method:o}=s;try{if(this.registeredMethods.includes(o))return;const a=Le("WC_METHOD_UNSUPPORTED",o);await this.sendError(i,n,a),this.logger.error(a)}catch(a){await this.sendError(i,n,a),this.logger.error(a)}}),pe(this,"onUnknownRpcMethodResponse",n=>{this.registeredMethods.includes(n)||this.logger.error(Le("WC_METHOD_UNSUPPORTED",n))}),pe(this,"isValidPair",(n,s)=>{var i;if(!Jt(n)){const{message:a}=Y("MISSING_OR_INVALID",`pair() params: ${n}`);throw s.setError(ds.malformed_pairing_uri),new Error(a)}if(!pU(n.uri)){const{message:a}=Y("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw s.setError(ds.malformed_pairing_uri),new Error(a)}const o=d1(n==null?void 0:n.uri);if(!((i=o==null?void 0:o.relay)!=null&&i.protocol)){const{message:a}=Y("MISSING_OR_INVALID","pair() uri#relay-protocol");throw s.setError(ds.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=Y("MISSING_OR_INVALID","pair() uri#symKey");throw s.setError(ds.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&Z.toMiliseconds(o==null?void 0:o.expiryTimestamp)<Date.now()){s.setError(ds.pairing_expired);const{message:a}=Y("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),pe(this,"isValidPing",async n=>{if(!Jt(n)){const{message:i}=Y("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(i)}const{topic:s}=n;await this.isValidPairingTopic(s)}),pe(this,"isValidDisconnect",async n=>{if(!Jt(n)){const{message:i}=Y("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(i)}const{topic:s}=n;await this.isValidPairingTopic(s)}),pe(this,"isValidPairingTopic",async n=>{if(!Xe(n,!1)){const{message:s}=Y("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(s)}if(!this.pairings.keys.includes(n)){const{message:s}=Y("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(s)}if(qn(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:s}=Y("EXPIRED",`pairing topic: ${n}`);throw new Error(s)}}),this.core=e,this.logger=Kt(t,this.name),this.pairings=new ba(this.core,this.logger,this.name,this.storagePrefix)}get context(){return ar(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=Y("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Ve.message,async e=>{const{topic:t,message:n,transportType:s}=e;if(this.pairings.keys.includes(t)&&s!==$e.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))try{const i=await this.core.crypto.decode(t,n);zy(i)?(this.core.history.set(t,i),await this.onRelayEventRequest({topic:t,payload:i})):i0(i)&&(await this.core.history.resolve(i),await this.onRelayEventResponse({topic:t,payload:i}),this.core.history.delete(t,i.id)),await this.core.relayer.messages.ack(t,n)}catch(i){this.logger.error(i)}})}registerExpirerEvents(){this.core.expirer.on(Rr.expired,async e=>{const{topic:t}=u4(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(fo.expire,{topic:t}))})}}var tz=Object.defineProperty,rz=(r,e,t)=>e in r?tz(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,mt=(r,e,t)=>rz(r,typeof e!="symbol"?e+"":e,t);class nz extends tL{constructor(e,t){super(e,t),this.core=e,this.logger=t,mt(this,"records",new Map),mt(this,"events",new Ar.EventEmitter),mt(this,"name",iF),mt(this,"version",oF),mt(this,"cached",[]),mt(this,"initialized",!1),mt(this,"storagePrefix",ts),mt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),mt(this,"set",(n,s,i)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:s,chainId:i}),this.records.has(s.id))return;const o={id:s.id,topic:n,request:{method:s.method,params:s.params||null},chainId:i,expiry:Ze(Z.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(Qr.created,o)}),mt(this,"resolve",async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const s=await this.getRecord(n.id);typeof s.response>"u"&&(s.response=jr(n)?{error:n.error}:{result:n.result},this.records.set(s.id,s),this.persist(),this.events.emit(Qr.updated,s))}),mt(this,"get",async(n,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:s}),await this.getRecord(s))),mt(this,"delete",(n,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(i=>{if(i.topic===n){if(typeof s<"u"&&i.id!==s)return;this.records.delete(i.id),this.events.emit(Qr.deleted,i)}}),this.persist()}),mt(this,"exists",async(n,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===n:!1)),mt(this,"on",(n,s)=>{this.events.on(n,s)}),mt(this,"once",(n,s)=>{this.events.once(n,s)}),mt(this,"off",(n,s)=>{this.events.off(n,s)}),mt(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.logger=Kt(t,this.name)}get context(){return ar(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const n={topic:t.topic,request:fn(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(n)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:n}=Y("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Qr.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=Y("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Qr.created,e=>{const t=Qr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(Qr.updated,e=>{const t=Qr.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(Qr.deleted,e=>{const t=Qr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.core.heartbeat.on(pa.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(t=>{Z.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.records.delete(t.id),this.events.emit(Qr.deleted,t,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=Y("NOT_INITIALIZED",this.name);throw new Error(e)}}}var sz=Object.defineProperty,iz=(r,e,t)=>e in r?sz(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Dt=(r,e,t)=>iz(r,typeof e!="symbol"?e+"":e,t);class oz extends aL{constructor(e,t){super(e,t),this.core=e,this.logger=t,Dt(this,"expirations",new Map),Dt(this,"events",new Ar.EventEmitter),Dt(this,"name",aF),Dt(this,"version",cF),Dt(this,"cached",[]),Dt(this,"initialized",!1),Dt(this,"storagePrefix",ts),Dt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Dt(this,"has",n=>{try{const s=this.formatTarget(n);return typeof this.getExpiration(s)<"u"}catch{return!1}}),Dt(this,"set",(n,s)=>{this.isInitialized();const i=this.formatTarget(n),o={target:i,expiry:s};this.expirations.set(i,o),this.checkExpiry(i,o),this.events.emit(Rr.created,{target:i,expiration:o})}),Dt(this,"get",n=>{this.isInitialized();const s=this.formatTarget(n);return this.getExpiration(s)}),Dt(this,"del",n=>{if(this.isInitialized(),this.has(n)){const s=this.formatTarget(n),i=this.getExpiration(s);this.expirations.delete(s),this.events.emit(Rr.deleted,{target:s,expiration:i})}}),Dt(this,"on",(n,s)=>{this.events.on(n,s)}),Dt(this,"once",(n,s)=>{this.events.once(n,s)}),Dt(this,"off",(n,s)=>{this.events.off(n,s)}),Dt(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.logger=Kt(t,this.name)}get context(){return ar(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return KR(e);if(typeof e=="number")return GR(e);const{message:t}=Y("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Rr.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=Y("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:n}=Y("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(n),new Error(n)}return t}checkExpiry(e,t){const{expiry:n}=t;Z.toMiliseconds(n)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(Rr.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(pa.pulse,()=>this.checkExpirations()),this.events.on(Rr.created,e=>{const t=Rr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Rr.expired,e=>{const t=Rr.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Rr.deleted,e=>{const t=Rr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=Y("NOT_INITIALIZED",this.name);throw new Error(e)}}}var az=Object.defineProperty,cz=(r,e,t)=>e in r?az(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ye=(r,e,t)=>cz(r,typeof e!="symbol"?e+"":e,t);class lz extends cL{constructor(e,t,n){super(e,t,n),this.core=e,this.logger=t,this.store=n,Ye(this,"name",lF),Ye(this,"abortController"),Ye(this,"isDevEnv"),Ye(this,"verifyUrlV3",fF),Ye(this,"storagePrefix",ts),Ye(this,"version",x6),Ye(this,"publicKey"),Ye(this,"fetchPromise"),Ye(this,"init",async()=>{var s;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&Z.toMiliseconds((s=this.publicKey)==null?void 0:s.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),Ye(this,"register",async s=>{if(!Al()||this.isDevEnv)return;const i=window.location.origin,{id:o,decryptedId:a}=s,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${i}&id=${o}&decryptedId=${a}`;try{const l=Ls.getDocument(),u=this.startAbortTimer(Z.ONE_SECOND*5),f=await new Promise((h,d)=>{const p=()=>{window.removeEventListener("message",y),l.body.removeChild(g),d("attestation aborted")};this.abortController.signal.addEventListener("abort",p);const g=l.createElement("iframe");g.src=c,g.style.display="none",g.addEventListener("error",p,{signal:this.abortController.signal});const y=x=>{if(x.data&&typeof x.data=="string")try{const A=JSON.parse(x.data);if(A.type==="verify_attestation"){if(qg(A.attestation).payload.id!==o)return;clearInterval(u),l.body.removeChild(g),this.abortController.signal.removeEventListener("abort",p),window.removeEventListener("message",y),h(A.attestation===null?"":A.attestation)}}catch(A){this.logger.warn(A)}};l.body.appendChild(g),window.addEventListener("message",y,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",f),f}catch(l){this.logger.warn(l)}return""}),Ye(this,"resolve",async s=>{if(this.isDevEnv)return"";const{attestationId:i,hash:o,encryptedId:a}=s;if(i===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(i){if(qg(i).payload.id!==a)return;const l=await this.isValidJwtAttestation(i);if(l){if(!l.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return l}}if(!o)return;const c=this.getVerifyUrl(s==null?void 0:s.verifyUrl);return this.fetchAttestation(o,c)}),Ye(this,"fetchAttestation",async(s,i)=>{this.logger.debug(`resolving attestation: ${s} from url: ${i}`);const o=this.startAbortTimer(Z.ONE_SECOND*5),a=await fetch(`${i}/attestation/${s}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),Ye(this,"getVerifyUrl",s=>{let i=s||fu;return hF.includes(i)||(this.logger.info(`verify url: ${i}, not included in trusted list, assigning default: ${fu}`),i=fu),i}),Ye(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const s=this.startAbortTimer(Z.FIVE_SECONDS),i=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(s),await i.json()}catch(s){this.logger.warn(s)}}),Ye(this,"persistPublicKey",async s=>{this.logger.debug("persisting public key to local storage",s),await this.store.setItem(this.storeKey,s),this.publicKey=s}),Ye(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),Ye(this,"isValidJwtAttestation",async s=>{const i=await this.getPublicKey();try{if(i)return this.validateAttestation(s,i)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(s,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),Ye(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),Ye(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async i=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),i(o))});const s=await this.fetchPromise;return this.fetchPromise=void 0,s}),Ye(this,"validateAttestation",(s,i)=>{const o=jk(s,i.publicKey),a={hasExpired:Z.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=Kt(t,this.name),this.abortController=new AbortController,this.isDevEnv=Cy(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return ar(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),Z.toMiliseconds(e))}}var uz=Object.defineProperty,fz=(r,e,t)=>e in r?uz(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,u2=(r,e,t)=>fz(r,typeof e!="symbol"?e+"":e,t);class hz extends lL{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,u2(this,"context",dF),u2(this,"registerDeviceToken",async n=>{const{clientId:s,token:i,notificationType:o,enableEncrypted:a=!1}=n,c=`${pF}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:s,type:o,token:i,always_raw:a})})}),this.logger=Kt(t,this.context)}}var dz=Object.defineProperty,f2=Object.getOwnPropertySymbols,pz=Object.prototype.hasOwnProperty,gz=Object.prototype.propertyIsEnumerable,bb=(r,e,t)=>e in r?dz(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ql=(r,e)=>{for(var t in e||(e={}))pz.call(e,t)&&bb(r,t,e[t]);if(f2)for(var t of f2(e))gz.call(e,t)&&bb(r,t,e[t]);return r},it=(r,e,t)=>bb(r,typeof e!="symbol"?e+"":e,t);class bz extends uL{constructor(e,t,n=!0){super(e,t,n),this.core=e,this.logger=t,it(this,"context",bF),it(this,"storagePrefix",ts),it(this,"storageVersion",gF),it(this,"events",new Map),it(this,"shouldPersist",!1),it(this,"init",async()=>{if(!Cy())try{const s={eventId:_w(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:c4(this.core.relayer.protocol,this.core.relayer.version,cb)}}};await this.sendEvent([s])}catch(s){this.logger.warn(s)}}),it(this,"createEvent",s=>{const{event:i="ERROR",type:o="",properties:{topic:a,trace:c}}=s,l=_w(),u=this.core.projectId||"",f=Date.now(),h=ql({eventId:l,timestamp:f,props:{event:i,type:o,properties:{topic:a,trace:c}},bundleId:u,domain:this.getAppDomain()},this.setMethods(l));return this.telemetryEnabled&&(this.events.set(l,h),this.shouldPersist=!0),h}),it(this,"getEvent",s=>{const{eventId:i,topic:o}=s;if(i)return this.events.get(i);const a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return ql(ql({},a),this.setMethods(a.eventId))}),it(this,"deleteEvent",s=>{const{eventId:i}=s;this.events.delete(i),this.shouldPersist=!0}),it(this,"setEventListeners",()=>{this.core.heartbeat.on(pa.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(s=>{Z.fromMiliseconds(Date.now())-Z.fromMiliseconds(s.timestamp)>yF&&(this.events.delete(s.eventId),this.shouldPersist=!0)})})}),it(this,"setMethods",s=>({addTrace:i=>this.addTrace(s,i),setError:i=>this.setError(s,i)})),it(this,"addTrace",(s,i)=>{const o=this.events.get(s);o&&(o.props.properties.trace.push(i),this.events.set(s,o),this.shouldPersist=!0)}),it(this,"setError",(s,i)=>{const o=this.events.get(s);o&&(o.props.type=i,o.timestamp=Date.now(),this.events.set(s,o),this.shouldPersist=!0)}),it(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),it(this,"restore",async()=>{try{const s=await this.core.storage.getItem(this.storageKey)||[];if(!s.length)return;s.forEach(i=>{this.events.set(i.eventId,ql(ql({},i),this.setMethods(i.eventId)))})}catch(s){this.logger.warn(s)}}),it(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const s=[];for(const[i,o]of this.events)o.props.type&&s.push(o);if(s.length!==0)try{if((await this.sendEvent(s)).ok)for(const i of s)this.events.delete(i.eventId),this.shouldPersist=!0}catch(i){this.logger.warn(i)}}),it(this,"sendEvent",async s=>{const i=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${mF}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${cb}${i}`,{method:"POST",body:JSON.stringify(s)})}),it(this,"getAppDomain",()=>a4().url),this.logger=Kt(t,this.context),this.telemetryEnabled=n,n?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var yz=Object.defineProperty,h2=Object.getOwnPropertySymbols,mz=Object.prototype.hasOwnProperty,xz=Object.prototype.propertyIsEnumerable,yb=(r,e,t)=>e in r?yz(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,d2=(r,e)=>{for(var t in e||(e={}))mz.call(e,t)&&yb(r,t,e[t]);if(h2)for(var t of h2(e))xz.call(e,t)&&yb(r,t,e[t]);return r},Ue=(r,e,t)=>yb(r,typeof e!="symbol"?e+"":e,t);let wz=class B6 extends Y${constructor(e){var t;super(e),Ue(this,"protocol",m6),Ue(this,"version",x6),Ue(this,"name",ab),Ue(this,"relayUrl"),Ue(this,"projectId"),Ue(this,"customStoragePrefix"),Ue(this,"events",new Ar.EventEmitter),Ue(this,"logger"),Ue(this,"heartbeat"),Ue(this,"relayer"),Ue(this,"crypto"),Ue(this,"storage"),Ue(this,"history"),Ue(this,"expirer"),Ue(this,"pairing"),Ue(this,"verify"),Ue(this,"echoClient"),Ue(this,"linkModeSupportedApps"),Ue(this,"eventClient"),Ue(this,"initialized",!1),Ue(this,"logChunkController"),Ue(this,"on",(a,c)=>this.events.on(a,c)),Ue(this,"once",(a,c)=>this.events.once(a,c)),Ue(this,"off",(a,c)=>this.events.off(a,c)),Ue(this,"removeListener",(a,c)=>this.events.removeListener(a,c)),Ue(this,"dispatchEnvelope",({topic:a,message:c,sessionExists:l})=>{if(!a||!c)return;const u={topic:a,message:c,publishedAt:Date.now(),transportType:$e.link_mode};this.relayer.onLinkMessageEvent(u,{sessionExists:l})});const n=this.getGlobalCore(e==null?void 0:e.customStoragePrefix);if(n)try{return this.customStoragePrefix=n.customStoragePrefix,this.logger=n.logger,this.heartbeat=n.heartbeat,this.crypto=n.crypto,this.history=n.history,this.expirer=n.expirer,this.storage=n.storage,this.relayer=n.relayer,this.pairing=n.pairing,this.verify=n.verify,this.echoClient=n.echoClient,this.linkModeSupportedApps=n.linkModeSupportedApps,this.eventClient=n.eventClient,this.initialized=n.initialized,this.logChunkController=n.logChunkController,n}catch(a){console.warn("Failed to copy global core",a)}this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||E6,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const s=n0({level:typeof(e==null?void 0:e.logger)=="string"&&e.logger?e.logger:FL.logger,name:ab}),{logger:i,chunkLoggerController:o}=W$({opts:s,maxSizeInBytes:e==null?void 0:e.maxLogBlobSizeInBytes,loggerOverride:e==null?void 0:e.logger});this.logChunkController=o,(t=this.logChunkController)!=null&&t.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,c;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=Kt(i,this.name),this.heartbeat=new YU,this.crypto=new GM(this,this.logger,e==null?void 0:e.keychain),this.history=new nz(this,this.logger),this.expirer=new oz(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new D$(d2(d2({},ML),e==null?void 0:e.storageOptions)),this.relayer=new wj({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new ez(this,this.logger),this.verify=new lz(this,this.logger,this.storage),this.echoClient=new hz(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new bz(this,this.logger,e==null?void 0:e.telemetryEnabled),this.setGlobalCore(this)}static async init(e){const t=new B6(e);await t.initialize();const n=await t.crypto.getClientId();return await t.storage.setItem(eF,n),t}get context(){return ar(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(V1,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(V1)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;const t=`_walletConnectCore_${e}`,n=`${t}_count`;return globalThis[n]=(globalThis[n]||0)+1,globalThis[n]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[n]} times.`),globalThis[t]}catch(t){console.warn("Failed to get global WalletConnect core",t);return}}setGlobalCore(e){var t;try{if(this.isGlobalCoreDisabled())return;const n=`_walletConnectCore_${((t=e.opts)==null?void 0:t.customStoragePrefix)||""}`;globalThis[n]=e}catch(n){console.warn("Failed to set global WalletConnect core",n)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&LL.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}};const Ez=wz,k6="wc",U6=2,$6="client",qy=`${k6}@${U6}:${$6}:`,Ap={name:$6,logger:"error"},p2="WALLETCONNECT_DEEPLINK_CHOICE",vz="proposal",g2="Proposal expired",Az="session",Da=Z.SEVEN_DAYS,Iz="engine",xt={wc_sessionPropose:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1114},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:Z.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:Z.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1119}}},Ip={min:Z.FIVE_MINUTES,max:Z.SEVEN_DAYS},Sn={idle:"IDLE",active:"ACTIVE"},Sz={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},Oz="request",Pz=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],Cz="wc",Tz="auth",Nz="authKeys",Dz="pairingTopics",Rz="requests",a0=`${Cz}@${1.5}:${Tz}:`,Fh=`${a0}:PUB_KEY`;var _z=Object.defineProperty,Bz=Object.defineProperties,kz=Object.getOwnPropertyDescriptors,b2=Object.getOwnPropertySymbols,Uz=Object.prototype.hasOwnProperty,$z=Object.prototype.propertyIsEnumerable,mb=(r,e,t)=>e in r?_z(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Pe=(r,e)=>{for(var t in e||(e={}))Uz.call(e,t)&&mb(r,t,e[t]);if(b2)for(var t of b2(e))$z.call(e,t)&&mb(r,t,e[t]);return r},Rt=(r,e)=>Bz(r,kz(e)),G=(r,e,t)=>mb(r,typeof e!="symbol"?e+"":e,t);class Lz extends pL{constructor(e){super(e),G(this,"name",Iz),G(this,"events",new by),G(this,"initialized",!1),G(this,"requestQueue",{state:Sn.idle,queue:[]}),G(this,"sessionRequestQueue",{state:Sn.idle,queue:[]}),G(this,"emittedSessionRequests",new r_({limit:500})),G(this,"requestQueueDelay",Z.ONE_SECOND),G(this,"expectedPairingMethodMap",new Map),G(this,"recentlyDeletedMap",new Map),G(this,"recentlyDeletedLimit",200),G(this,"relayMessageCache",[]),G(this,"pendingSessions",new Map),G(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(xt)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},Z.toMiliseconds(this.requestQueueDelay)))}),G(this,"connect",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const n=Rt(Pe({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(n),n.optionalNamespaces=lU(n.requiredNamespaces,n.optionalNamespaces),n.requiredNamespaces={};const{pairingTopic:s,requiredNamespaces:i,optionalNamespaces:o,sessionProperties:a,scopedProperties:c,relays:l}=n;let u=s,f,h=!1;try{if(u){const E=this.client.core.pairing.pairings.get(u);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),h=E.active}}catch(E){throw this.client.logger.error(`connect() -> pairing.get(${u}) failed`),E}if(!u||!h){const{topic:E,uri:P}=await this.client.core.pairing.create({internal:{skipSubscribe:!0}});u=E,f=P}if(!u){const{message:E}=Y("NO_MATCHING_KEY",`connect() pairing topic: ${u}`);throw new Error(E)}const d=await this.client.core.crypto.generateKeyPair(),p=xt.wc_sessionPropose.req.ttl||Z.FIVE_MINUTES,g=Ze(p),y=Rt(Pe(Pe({requiredNamespaces:i,optionalNamespaces:o,relays:l??[{protocol:w6}],proposer:{publicKey:d,metadata:this.client.metadata},expiryTimestamp:g,pairingTopic:u},a&&{sessionProperties:a}),c&&{scopedProperties:c}),{id:Cn()}),x=Ie("session_connect",y.id),{reject:A,resolve:w,done:O}=oo(p,g2),I=({id:E})=>{E===y.id&&(this.client.events.off("proposal_expire",I),this.pendingSessions.delete(y.id),this.events.emit(x,{error:{message:g2,code:0}}))};return this.client.events.on("proposal_expire",I),this.events.once(x,({error:E,session:P})=>{this.client.events.off("proposal_expire",I),E?A(E):P&&w(P)}),await this.sendProposeSession({proposal:y,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:y.id}}}),await this.setProposal(y.id,y),{uri:f,approval:O}}),G(this,"pair",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(t)}catch(n){throw this.client.logger.error("pair() failed"),n}}),G(this,"approve",async t=>{var n,s,i;const o=this.client.core.eventClient.createEvent({properties:{topic:(n=t==null?void 0:t.id)==null?void 0:n.toString(),trace:[ri.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(D){throw o.setError(jl.no_internet_connection),D}try{await this.isValidProposalId(t==null?void 0:t.id)}catch(D){throw this.client.logger.error(`approve() -> proposal.get(${t==null?void 0:t.id}) failed`),o.setError(jl.proposal_not_found),D}try{await this.isValidApprove(t)}catch(D){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(jl.session_approve_namespace_validation_failure),D}const{id:a,relayProtocol:c,namespaces:l,sessionProperties:u,scopedProperties:f,sessionConfig:h}=t,d=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});const{pairingTopic:p,proposer:g,requiredNamespaces:y,optionalNamespaces:x}=d;let A=(s=this.client.core.eventClient)==null?void 0:s.getEvent({topic:p});A||(A=(i=this.client.core.eventClient)==null?void 0:i.createEvent({type:ri.session_approve_started,properties:{topic:p,trace:[ri.session_approve_started,ri.session_namespaces_validation_success]}}));const w=await this.client.core.crypto.generateKeyPair(),O=g.publicKey,I=await this.client.core.crypto.generateSharedKey(w,O),E=Pe(Pe(Pe({relay:{protocol:c??"irn"},namespaces:l,controller:{publicKey:w,metadata:this.client.metadata},expiry:Ze(Da)},u&&{sessionProperties:u}),f&&{scopedProperties:f}),h&&{sessionConfig:h}),P=$e.relay;A.addTrace(ri.subscribing_session_topic);try{await this.client.core.relayer.subscribe(I,{transportType:P,internal:{skipSubscribe:!0}})}catch(D){throw A.setError(jl.subscribe_session_topic_failure),D}A.addTrace(ri.subscribe_session_topic_success);const T=Rt(Pe({},E),{topic:I,requiredNamespaces:y,optionalNamespaces:x,pairingTopic:p,acknowledged:!1,self:E.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:w,transportType:$e.relay});await this.client.session.set(I,T),A.addTrace(ri.store_session);try{await this.sendApproveSession({sessionTopic:I,proposal:d,pairingProposalResponse:{relay:{protocol:c??"irn"},responderPublicKey:w},sessionSettleRequest:E,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:a}}}),A.addTrace(ri.session_approve_publish_success)}catch(D){throw this.client.logger.error(D),this.client.session.delete(I,Le("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(I),D}return this.client.core.eventClient.deleteEvent({eventId:A.eventId}),await this.client.core.pairing.updateMetadata({topic:p,metadata:g.metadata}),await this.deleteProposal(a),await this.client.core.pairing.activate({topic:p}),await this.setExpiry(I,Ze(Da)),{topic:I,acknowledged:()=>Promise.resolve(this.client.session.get(I))}}),G(this,"reject",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(t)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}const{id:n,reason:s}=t;let i;try{i=this.client.proposal.get(n).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${n}) failed`),o}i&&await this.sendError({id:n,topic:i,error:s,rpcOpts:xt.wc_sessionPropose.reject}),await this.deleteProposal(n)}),G(this,"update",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(t)}catch(f){throw this.client.logger.error("update() -> isValidUpdate() failed"),f}const{topic:n,namespaces:s}=t,{done:i,resolve:o,reject:a}=oo(),c=Cn(),l=Ri().toString(),u=this.client.session.get(n).namespaces;return this.events.once(Ie("session_update",c),({error:f})=>{f?a(f):o()}),await this.client.session.update(n,{namespaces:s}),await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:s},throwOnFailedPublish:!0,clientRpcId:c,relayRpcId:l}).catch(f=>{this.client.logger.error(f),this.client.session.update(n,{namespaces:u}),a(f)}),{acknowledged:i}}),G(this,"extend",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(t)}catch(c){throw this.client.logger.error("extend() -> isValidExtend() failed"),c}const{topic:n}=t,s=Cn(),{done:i,resolve:o,reject:a}=oo();return this.events.once(Ie("session_extend",s),({error:c})=>{c?a(c):o()}),await this.setExpiry(n,Ze(Da)),this.sendRequest({topic:n,method:"wc_sessionExtend",params:{},clientRpcId:s,throwOnFailedPublish:!0}).catch(c=>{a(c)}),{acknowledged:i}}),G(this,"request",async t=>{this.isInitialized();try{await this.isValidRequest(t)}catch(y){throw this.client.logger.error("request() -> isValidRequest() failed"),y}const{chainId:n,request:s,topic:i,expiry:o=xt.wc_sessionRequest.req.ttl}=t,a=this.client.session.get(i);(a==null?void 0:a.transportType)===$e.relay&&await this.confirmOnlineStateOrThrow();const c=Cn(),l=Ri().toString(),{done:u,resolve:f,reject:h}=oo(o,"Request expired. Please try again.");this.events.once(Ie("session_request",c),({error:y,result:x})=>{y?h(y):f(x)});const d="wc_sessionRequest",p=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(p)return await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:d,params:{request:Rt(Pe({},s),{expiryTimestamp:Ze(o)}),chainId:n},expiry:o,throwOnFailedPublish:!0,appLink:p}).catch(y=>h(y)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:n,id:c}),await u();const g={request:Rt(Pe({},s),{expiryTimestamp:Ze(o)}),chainId:n};return await Promise.all([new Promise(async y=>{await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:d,params:g,expiry:o,throwOnFailedPublish:!0,tvf:this.getTVFParams(c,g)}).catch(x=>h(x)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:n,id:c}),y()}),new Promise(async y=>{var x;if(!((x=a.sessionConfig)!=null&&x.disableDeepLink)){const A=await YR(this.client.core.storage,p2);await WR({id:c,topic:i,wcDeepLink:A})}y()}),u()]).then(y=>y[2])}),G(this,"respond",async t=>{this.isInitialized(),await this.isValidRespond(t);const{topic:n,response:s}=t,{id:i}=s,o=this.client.session.get(n);o.transportType===$e.relay&&await this.confirmOnlineStateOrThrow();const a=this.getAppLinkIfEnabled(o.peer.metadata,o.transportType);Tn(s)?await this.sendResult({id:i,topic:n,result:s.result,throwOnFailedPublish:!0,appLink:a}):jr(s)&&await this.sendError({id:i,topic:n,error:s.error,appLink:a}),this.cleanupAfterResponse(t)}),G(this,"ping",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(t)}catch(s){throw this.client.logger.error("ping() -> isValidPing() failed"),s}const{topic:n}=t;if(this.client.session.keys.includes(n)){const s=Cn(),i=Ri().toString(),{done:o,resolve:a,reject:c}=oo();this.events.once(Ie("session_ping",s),({error:l})=>{l?c(l):a()}),await Promise.all([this.sendRequest({topic:n,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:s,relayRpcId:i}),o()])}else this.client.core.pairing.pairings.keys.includes(n)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:n}))}),G(this,"emit",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(t);const{topic:n,event:s,chainId:i}=t,o=Ri().toString(),a=Cn();await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:s,chainId:i},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),G(this,"disconnect",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(t);const{topic:n}=t;if(this.client.session.keys.includes(n))await this.sendRequest({topic:n,method:"wc_sessionDelete",params:Le("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:n,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(n))await this.client.core.pairing.disconnect({topic:n});else{const{message:s}=Y("MISMATCHED_TOPIC",`Session or pairing topic not found: ${n}`);throw new Error(s)}}),G(this,"find",t=>(this.isInitialized(),this.client.session.getAll().filter(n=>hU(n,t)))),G(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),G(this,"authenticate",async(t,n)=>{var s;this.isInitialized(),this.isValidAuthenticate(t);const i=n&&this.client.core.linkModeSupportedApps.includes(n)&&((s=this.client.metadata.redirect)==null?void 0:s.linkMode),o=i?$e.link_mode:$e.relay;o===$e.relay&&await this.confirmOnlineStateOrThrow();const{chains:a,statement:c="",uri:l,domain:u,nonce:f,type:h,exp:d,nbf:p,methods:g=[],expiry:y}=t,x=[...t.resources||[]],{topic:A,uri:w}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:A,uri:w}});const O=await this.client.core.crypto.generateKeyPair(),I=kh(O);if(await Promise.all([this.client.auth.authKeys.set(Fh,{responseTopic:I,publicKey:O}),this.client.auth.pairingTopics.set(I,{topic:I,pairingTopic:A})]),await this.client.core.relayer.subscribe(I,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${A}`),g.length>0){const{namespace:R}=_s(a[0]);let B=dB(R,"request",g);Bh(x)&&(B=gB(B,x.pop())),x.push(B)}const E=y&&y>xt.wc_sessionAuthenticate.req.ttl?y:xt.wc_sessionAuthenticate.req.ttl,P={authPayload:{type:h??"caip122",chains:a,statement:c,aud:l,domain:u,version:"1",nonce:f,iat:new Date().toISOString(),exp:d,nbf:p,resources:x},requester:{publicKey:O,metadata:this.client.metadata},expiryTimestamp:Ze(E)},T={eip155:{chains:a,methods:[...new Set(["personal_sign",...g])],events:["chainChanged","accountsChanged"]}},D={requiredNamespaces:{},optionalNamespaces:T,relays:[{protocol:"irn"}],pairingTopic:A,proposer:{publicKey:O,metadata:this.client.metadata},expiryTimestamp:Ze(xt.wc_sessionPropose.req.ttl),id:Cn()},{done:F,resolve:j,reject:L}=oo(E,"Request expired"),U=Cn(),_=Ie("session_connect",D.id),m=Ie("session_request",U),v=async({error:R,session:B})=>{this.events.off(m,N),R?L(R):B&&j({session:B})},N=async R=>{var B,H,V;if(await this.deletePendingAuthRequest(U,{message:"fulfilled",code:0}),R.error){const ie=Le("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return R.error.code===ie.code?void 0:(this.events.off(_,v),L(R.error.message))}await this.deleteProposal(D.id),this.events.off(_,v);const{cacaos:X,responder:W}=R.result,J=[],ne=[];for(const ie of X){await qw({cacao:ie,projectId:this.client.core.projectId})||(this.client.logger.error(ie,"Signature verification failed"),L(Le("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:de}=ie,je=Bh(de.resources),Je=[Wg(de.iss)],ze=ud(de.iss);if(je){const Pt=Vw(je),ya=Kw(je);J.push(...Pt),Je.push(...ya)}for(const Pt of Je)ne.push(`${Pt}:${ze}`)}const oe=await this.client.core.crypto.generateSharedKey(O,W.publicKey);let fe;J.length>0&&(fe={topic:oe,acknowledged:!0,self:{publicKey:O,metadata:this.client.metadata},peer:W,controller:W.publicKey,expiry:Ze(Da),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:A,namespaces:m1([...new Set(J)],[...new Set(ne)]),transportType:o},await this.client.core.relayer.subscribe(oe,{transportType:o}),await this.client.session.set(oe,fe),A&&await this.client.core.pairing.updateMetadata({topic:A,metadata:W.metadata}),fe=this.client.session.get(oe)),(B=this.client.metadata.redirect)!=null&&B.linkMode&&(H=W.metadata.redirect)!=null&&H.linkMode&&(V=W.metadata.redirect)!=null&&V.universal&&n&&(this.client.core.addLinkModeSupportedApp(W.metadata.redirect.universal),this.client.session.update(oe,{transportType:$e.link_mode})),j({auths:X,session:fe})};this.events.once(_,v),this.events.once(m,N);let $;try{if(i){const R=fn("wc_sessionAuthenticate",P,U);this.client.core.history.set(A,R);const B=await this.client.core.crypto.encode("",R,{type:Sf,encoding:li});$=ah(n,A,B)}else await Promise.all([this.sendRequest({topic:A,method:"wc_sessionAuthenticate",params:P,expiry:t.expiry,throwOnFailedPublish:!0,clientRpcId:U}),this.sendRequest({topic:A,method:"wc_sessionPropose",params:D,expiry:xt.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:D.id})])}catch(R){throw this.events.off(_,v),this.events.off(m,N),R}return await this.setProposal(D.id,D),await this.setAuthRequest(U,{request:Rt(Pe({},P),{verifyContext:{}}),pairingTopic:A,transportType:o}),{uri:$??w,response:F}}),G(this,"approveSessionAuthenticate",async t=>{const{id:n,auths:s}=t,i=this.client.core.eventClient.createEvent({properties:{topic:n.toString(),trace:[to.authenticated_session_approve_started]}});try{this.isInitialized()}catch(y){throw i.setError(zl.no_internet_connection),y}const o=this.getPendingAuthRequest(n);if(!o)throw i.setError(zl.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${n}`);const a=o.transportType||$e.relay;a===$e.relay&&await this.confirmOnlineStateOrThrow();const c=o.requester.publicKey,l=await this.client.core.crypto.generateKeyPair(),u=kh(c),f={type:Bs,receiverPublicKey:c,senderPublicKey:l},h=[],d=[];for(const y of s){if(!await qw({cacao:y,projectId:this.client.core.projectId})){i.setError(zl.invalid_cacao);const I=Le("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:n,topic:u,error:I,encodeOpts:f}),new Error(I.message)}i.addTrace(to.cacaos_verified);const{p:x}=y,A=Bh(x.resources),w=[Wg(x.iss)],O=ud(x.iss);if(A){const I=Vw(A),E=Kw(A);h.push(...I),w.push(...E)}for(const I of w)d.push(`${I}:${O}`)}const p=await this.client.core.crypto.generateSharedKey(l,c);i.addTrace(to.create_authenticated_session_topic);let g;if((h==null?void 0:h.length)>0){g={topic:p,acknowledged:!0,self:{publicKey:l,metadata:this.client.metadata},peer:{publicKey:c,metadata:o.requester.metadata},controller:c,expiry:Ze(Da),authentication:s,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:m1([...new Set(h)],[...new Set(d)]),transportType:a},i.addTrace(to.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(p,{transportType:a})}catch(y){throw i.setError(zl.subscribe_authenticated_session_topic_failure),y}i.addTrace(to.subscribe_authenticated_session_topic_success),await this.client.session.set(p,g),i.addTrace(to.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}i.addTrace(to.publishing_authenticated_session_approve);try{await this.sendResult({topic:u,id:n,result:{cacaos:s,responder:{publicKey:l,metadata:this.client.metadata}},encodeOpts:f,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(y){throw i.setError(zl.authenticated_session_approve_publish_failure),y}return await this.client.auth.requests.delete(n,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:i.eventId}),{session:g}}),G(this,"rejectSessionAuthenticate",async t=>{this.isInitialized();const{id:n,reason:s}=t,i=this.getPendingAuthRequest(n);if(!i)throw new Error(`Could not find pending auth request with id ${n}`);i.transportType===$e.relay&&await this.confirmOnlineStateOrThrow();const o=i.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=kh(o),l={type:Bs,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:n,topic:c,error:s,encodeOpts:l,rpcOpts:xt.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(n,{message:"rejected",code:0}),await this.deleteProposal(n)}),G(this,"formatAuthMessage",t=>{this.isInitialized();const{request:n,iss:s}=t;return O4(n,s)}),G(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const t=this.relayMessageCache.shift();t&&await this.onRelayMessage(t)}catch(t){this.client.logger.error(t)}},50)}),G(this,"cleanupDuplicatePairings",async t=>{if(t.pairingTopic)try{const n=this.client.core.pairing.pairings.get(t.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(i=>{var o,a;return((o=i.peerMetadata)==null?void 0:o.url)&&((a=i.peerMetadata)==null?void 0:a.url)===t.peer.metadata.url&&i.topic&&i.topic!==n.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(i=>this.client.core.pairing.disconnect({topic:i.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}}),G(this,"deleteSession",async t=>{var n;const{topic:s,expirerHasDeleted:i=!1,emitEvent:o=!0,id:a=0}=t,{self:c}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,Le("USER_DISCONNECTED")),this.addToRecentlyDeleted(s,"session"),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),i||this.client.core.expirer.del(s),this.client.core.storage.removeItem(p2).catch(l=>this.client.logger.warn(l)),this.getPendingSessionRequests().forEach(l=>{l.topic===s&&this.deletePendingSessionRequest(l.id,Le("USER_DISCONNECTED"))}),s===((n=this.sessionRequestQueue.queue[0])==null?void 0:n.topic)&&(this.sessionRequestQueue.state=Sn.idle),o&&this.client.events.emit("session_delete",{id:a,topic:s})}),G(this,"deleteProposal",async(t,n)=>{if(n)try{const s=this.client.proposal.get(t),i=this.client.core.eventClient.getEvent({topic:s.pairingTopic});i==null||i.setError(jl.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(t,Le("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"proposal")}),G(this,"deletePendingSessionRequest",async(t,n,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,n),s?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(i=>i.id!==t),s&&(this.sessionRequestQueue.state=Sn.idle,this.client.events.emit("session_request_expire",{id:t}))}),G(this,"deletePendingAuthRequest",async(t,n,s=!1)=>{await Promise.all([this.client.auth.requests.delete(t,n),s?Promise.resolve():this.client.core.expirer.del(t)])}),G(this,"setExpiry",async(t,n)=>{this.client.session.keys.includes(t)&&(this.client.core.expirer.set(t,n),await this.client.session.update(t,{expiry:n}))}),G(this,"setProposal",async(t,n)=>{this.client.core.expirer.set(t,Ze(xt.wc_sessionPropose.req.ttl)),await this.client.proposal.set(t,n)}),G(this,"setAuthRequest",async(t,n)=>{const{request:s,pairingTopic:i,transportType:o=$e.relay}=n;this.client.core.expirer.set(t,s.expiryTimestamp),await this.client.auth.requests.set(t,{authPayload:s.authPayload,requester:s.requester,expiryTimestamp:s.expiryTimestamp,id:t,pairingTopic:i,verifyContext:s.verifyContext,transportType:o})}),G(this,"setPendingSessionRequest",async t=>{const{id:n,topic:s,params:i,verifyContext:o}=t,a=i.request.expiryTimestamp||Ze(xt.wc_sessionRequest.req.ttl);this.client.core.expirer.set(n,a),await this.client.pendingRequest.set(n,{id:n,topic:s,params:i,verifyContext:o})}),G(this,"sendRequest",async t=>{const{topic:n,method:s,params:i,expiry:o,relayRpcId:a,clientRpcId:c,throwOnFailedPublish:l,appLink:u,tvf:f,publishOpts:h={}}=t,d=fn(s,i,c);let p;const g=!!u;try{const A=g?li:rr;p=await this.client.core.crypto.encode(n,d,{encoding:A})}catch(A){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${n} failed`),A}let y;if(Pz.includes(s)){const A=Mr(JSON.stringify(d)),w=Mr(p);y=await this.client.core.verify.register({id:w,decryptedId:A})}const x=Pe(Pe({},xt[s].req),h);if(x.attestation=y,o&&(x.ttl=o),a&&(x.id=a),this.client.core.history.set(n,d),g){const A=ah(u,n,p);await global.Linking.openURL(A,this.client.name)}else x.tvf=Rt(Pe({},f),{correlationId:d.id}),l?(x.internal=Rt(Pe({},x.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,p,x)):this.client.core.relayer.publish(n,p,x).catch(A=>this.client.logger.error(A));return d.id}),G(this,"sendProposeSession",async t=>{const{proposal:n,publishOpts:s}=t,i=fn("wc_sessionPropose",n,n.id);this.client.core.history.set(n.pairingTopic,i);const o=await this.client.core.crypto.encode(n.pairingTopic,i,{encoding:rr}),a=Mr(JSON.stringify(i)),c=Mr(o),l=await this.client.core.verify.register({id:c,decryptedId:a});await this.client.core.relayer.publishCustom({payload:{pairingTopic:n.pairingTopic,sessionProposal:o},opts:Rt(Pe({},s),{publishMethod:"wc_proposeSession",attestation:l})})}),G(this,"sendApproveSession",async t=>{const{sessionTopic:n,pairingProposalResponse:s,proposal:i,sessionSettleRequest:o,publishOpts:a}=t,c=Fu(i.id,s),l=await this.client.core.crypto.encode(i.pairingTopic,c,{encoding:rr}),u=fn("wc_sessionSettle",o,a==null?void 0:a.id),f=await this.client.core.crypto.encode(n,u,{encoding:rr});this.client.core.history.set(n,u),await this.client.core.relayer.publishCustom({payload:{sessionTopic:n,pairingTopic:i.pairingTopic,sessionProposalResponse:l,sessionSettlementRequest:f},opts:Rt(Pe({},a),{publishMethod:"wc_approveSession"})})}),G(this,"sendResult",async t=>{const{id:n,topic:s,result:i,throwOnFailedPublish:o,encodeOpts:a,appLink:c}=t,l=Fu(n,i);let u;const f=c&&typeof(global==null?void 0:global.Linking)<"u";try{const p=f?li:rr;u=await this.client.core.crypto.encode(s,l,Rt(Pe({},a||{}),{encoding:p}))}catch(p){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${s} failed`),p}let h,d;try{h=await this.client.core.history.get(s,n);const p=h.request;try{d=this.getTVFParams(n,p.params,i)}catch(g){this.client.logger.warn(`sendResult() -> getTVFParams() failed: ${g==null?void 0:g.message}`)}}catch(p){throw this.client.logger.error(`sendResult() -> history.get(${s}, ${n}) failed`),p}if(f){const p=ah(c,s,u);await global.Linking.openURL(p,this.client.name)}else{const p=h.request.method,g=xt[p].res;g.tvf=Rt(Pe({},d),{correlationId:n}),o?(g.internal=Rt(Pe({},g.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,u,g)):this.client.core.relayer.publish(s,u,g).catch(y=>this.client.logger.error(y))}await this.client.core.history.resolve(l)}),G(this,"sendError",async t=>{const{id:n,topic:s,error:i,encodeOpts:o,rpcOpts:a,appLink:c}=t,l=s0(n,i);let u;const f=c&&typeof(global==null?void 0:global.Linking)<"u";try{const d=f?li:rr;u=await this.client.core.crypto.encode(s,l,Rt(Pe({},o||{}),{encoding:d}))}catch(d){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${s} failed`),d}let h;try{h=await this.client.core.history.get(s,n)}catch(d){throw this.client.logger.error(`sendError() -> history.get(${s}, ${n}) failed`),d}if(f){const d=ah(c,s,u);await global.Linking.openURL(d,this.client.name)}else{const d=h.request.method,p=a||xt[d].res;this.client.core.relayer.publish(s,u,p)}await this.client.core.history.resolve(l)}),G(this,"cleanup",async()=>{const t=[],n=[];this.client.session.getAll().forEach(s=>{let i=!1;qn(s.expiry)&&(i=!0),this.client.core.crypto.keychain.has(s.topic)||(i=!0),i&&t.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{qn(s.expiryTimestamp)&&n.push(s.id)}),await Promise.all([...t.map(s=>this.deleteSession({topic:s})),...n.map(s=>this.deleteProposal(s))])}),G(this,"onProviderMessageEvent",async t=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(t):await this.onRelayMessage(t)}),G(this,"onRelayEventRequest",async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()}),G(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===Sn.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Sn.active;const t=this.requestQueue.queue.shift();if(t)try{await this.processRequest(t)}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=Sn.idle}),G(this,"processRequest",async t=>{const{topic:n,payload:s,attestation:i,transportType:o,encryptedId:a}=t,c=s.method;if(!this.shouldIgnorePairingRequest({topic:n,requestMethod:c}))switch(c){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:n,payload:s,attestation:i,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(n,s);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(n,s);case"wc_sessionExtend":return await this.onSessionExtendRequest(n,s);case"wc_sessionPing":return await this.onSessionPingRequest(n,s);case"wc_sessionDelete":return await this.onSessionDeleteRequest(n,s);case"wc_sessionRequest":return await this.onSessionRequest({topic:n,payload:s,attestation:i,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(n,s);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:n,payload:s,attestation:i,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${c}`)}}),G(this,"onRelayEventResponse",async t=>{const{topic:n,payload:s,transportType:i}=t,o=(await this.client.core.history.get(n,s.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(n,s,i);case"wc_sessionSettle":return this.onSessionSettleResponse(n,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,s);case"wc_sessionExtend":return this.onSessionExtendResponse(n,s);case"wc_sessionPing":return this.onSessionPingResponse(n,s);case"wc_sessionRequest":return this.onSessionRequestResponse(n,s);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(n,s);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),G(this,"onRelayEventUnknownPayload",t=>{const{topic:n}=t,{message:s}=Y("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)}),G(this,"shouldIgnorePairingRequest",t=>{const{topic:n,requestMethod:s}=t,i=this.expectedPairingMethodMap.get(n);return!i||i.includes(s)?!1:!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),G(this,"onSessionProposeRequest",async t=>{const{topic:n,payload:s,attestation:i,encryptedId:o}=t,{params:a,id:c}=s;try{const l=this.client.core.eventClient.getEvent({topic:n});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),l==null||l.setError(ds.proposal_listener_not_found)),this.isValidConnect(Pe({},s.params));const u=a.expiryTimestamp||Ze(xt.wc_sessionPropose.req.ttl),f=Pe({id:c,pairingTopic:n,expiryTimestamp:u,attestation:i,encryptedId:o},a);await this.setProposal(c,f);const h=await this.getVerifyContext({attestationId:i,hash:Mr(JSON.stringify(s)),encryptedId:o,metadata:f.proposer.metadata});l==null||l.addTrace(Pn.emit_session_proposal),this.client.events.emit("session_proposal",{id:c,params:f,verifyContext:h})}catch(l){await this.sendError({id:c,topic:n,error:l,rpcOpts:xt.wc_sessionPropose.autoReject}),this.client.logger.error(l)}}),G(this,"onSessionProposeResponse",async(t,n,s)=>{const{id:i}=n;if(Tn(n)){const{result:o}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});const a=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const l=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:l});const u=await this.client.core.crypto.generateSharedKey(c,l);this.pendingSessions.set(i,{sessionTopic:u,pairingTopic:t,proposalId:i,publicKey:c});const f=await this.client.core.relayer.subscribe(u,{transportType:s});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:f}),await this.client.core.pairing.activate({topic:t})}else if(jr(n)){await this.deleteProposal(i);const o=Ie("session_connect",i);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:n.error})}}),G(this,"onSessionSettleRequest",async(t,n)=>{const{id:s,params:i}=n;try{this.isValidSessionSettleRequest(i);const{relay:o,controller:a,expiry:c,namespaces:l,sessionProperties:u,scopedProperties:f,sessionConfig:h}=n.params,d=[...this.pendingSessions.values()].find(y=>y.sessionTopic===t);if(!d)return this.client.logger.error(`Pending session not found for topic ${t}`);const p=this.client.proposal.get(d.proposalId),g=Rt(Pe(Pe(Pe({topic:t,relay:o,expiry:c,namespaces:l,acknowledged:!0,pairingTopic:d.pairingTopic,requiredNamespaces:p.requiredNamespaces,optionalNamespaces:p.optionalNamespaces,controller:a.publicKey,self:{publicKey:d.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},u&&{sessionProperties:u}),f&&{scopedProperties:f}),h&&{sessionConfig:h}),{transportType:$e.relay});await this.client.session.set(g.topic,g),await this.setExpiry(g.topic,g.expiry),await this.client.core.pairing.updateMetadata({topic:d.pairingTopic,metadata:g.peer.metadata}),this.client.events.emit("session_connect",{session:g}),this.events.emit(Ie("session_connect",d.proposalId),{session:g}),this.pendingSessions.delete(d.proposalId),this.deleteProposal(d.proposalId,!1),this.cleanupDuplicatePairings(g),await this.sendResult({id:n.id,topic:t,result:!0})}catch(o){await this.sendError({id:s,topic:t,error:o}),this.client.logger.error(o)}}),G(this,"onSessionSettleResponse",async(t,n)=>{const{id:s}=n;Tn(n)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(Ie("session_approve",s),{})):jr(n)&&(await this.client.session.delete(t,Le("USER_DISCONNECTED")),this.events.emit(Ie("session_approve",s),{error:n.error}))}),G(this,"onSessionUpdateRequest",async(t,n)=>{const{params:s,id:i}=n;try{const o=`${t}_session_update`,a=Fl.get(o);if(a&&this.isRequestOutOfSync(a,i)){this.client.logger.warn(`Discarding out of sync request - ${i}`),this.sendError({id:i,topic:t,error:Le("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(Pe({topic:t},s));try{Fl.set(o,i),await this.client.session.update(t,{namespaces:s.namespaces}),await this.sendResult({id:i,topic:t,result:!0})}catch(c){throw Fl.delete(o),c}this.client.events.emit("session_update",{id:i,topic:t,params:s})}catch(o){await this.sendError({id:i,topic:t,error:o}),this.client.logger.error(o)}}),G(this,"isRequestOutOfSync",(t,n)=>n.toString().slice(0,-3)<t.toString().slice(0,-3)),G(this,"onSessionUpdateResponse",(t,n)=>{const{id:s}=n,i=Ie("session_update",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Tn(n)?this.events.emit(Ie("session_update",s),{}):jr(n)&&this.events.emit(Ie("session_update",s),{error:n.error})}),G(this,"onSessionExtendRequest",async(t,n)=>{const{id:s}=n;try{this.isValidExtend({topic:t}),await this.setExpiry(t,Ze(Da)),await this.sendResult({id:s,topic:t,result:!0}),this.client.events.emit("session_extend",{id:s,topic:t})}catch(i){await this.sendError({id:s,topic:t,error:i}),this.client.logger.error(i)}}),G(this,"onSessionExtendResponse",(t,n)=>{const{id:s}=n,i=Ie("session_extend",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Tn(n)?this.events.emit(Ie("session_extend",s),{}):jr(n)&&this.events.emit(Ie("session_extend",s),{error:n.error})}),G(this,"onSessionPingRequest",async(t,n)=>{const{id:s}=n;try{this.isValidPing({topic:t}),await this.sendResult({id:s,topic:t,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:s,topic:t})}catch(i){await this.sendError({id:s,topic:t,error:i}),this.client.logger.error(i)}}),G(this,"onSessionPingResponse",(t,n)=>{const{id:s}=n,i=Ie("session_ping",s);setTimeout(()=>{if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners 2176`);Tn(n)?this.events.emit(Ie("session_ping",s),{}):jr(n)&&this.events.emit(Ie("session_ping",s),{error:n.error})},500)}),G(this,"onSessionDeleteRequest",async(t,n)=>{const{id:s}=n;try{this.isValidDisconnect({topic:t,reason:n.params}),await Promise.all([new Promise(i=>{this.client.core.relayer.once(Ve.publish,async()=>{i(await this.deleteSession({topic:t,id:s}))})}),this.sendResult({id:s,topic:t,result:!0}),this.cleanupPendingSentRequestsForTopic({topic:t,error:Le("USER_DISCONNECTED")})]).catch(i=>this.client.logger.error(i))}catch(i){this.client.logger.error(i)}}),G(this,"onSessionRequest",async t=>{var n,s,i;const{topic:o,payload:a,attestation:c,encryptedId:l,transportType:u}=t,{id:f,params:h}=a;try{await this.isValidRequest(Pe({topic:o},h));const d=this.client.session.get(o),p=await this.getVerifyContext({attestationId:c,hash:Mr(JSON.stringify(fn("wc_sessionRequest",h,f))),encryptedId:l,metadata:d.peer.metadata,transportType:u}),g={id:f,topic:o,params:h,verifyContext:p};await this.setPendingSessionRequest(g),u===$e.link_mode&&(n=d.peer.metadata.redirect)!=null&&n.universal&&this.client.core.addLinkModeSupportedApp((s=d.peer.metadata.redirect)==null?void 0:s.universal),(i=this.client.signConfig)!=null&&i.disableRequestQueue?this.emitSessionRequest(g):(this.addSessionRequestToSessionRequestQueue(g),this.processSessionRequestQueue())}catch(d){await this.sendError({id:f,topic:o,error:d}),this.client.logger.error(d)}}),G(this,"onSessionRequestResponse",(t,n)=>{const{id:s}=n,i=Ie("session_request",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Tn(n)?this.events.emit(Ie("session_request",s),{result:n.result}):jr(n)&&this.events.emit(Ie("session_request",s),{error:n.error})}),G(this,"onSessionEventRequest",async(t,n)=>{const{id:s,params:i}=n;try{const o=`${t}_session_event_${i.event.name}`,a=Fl.get(o);if(a&&this.isRequestOutOfSync(a,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(Pe({topic:t},i)),this.client.events.emit("session_event",{id:s,topic:t,params:i}),Fl.set(o,s)}catch(o){await this.sendError({id:s,topic:t,error:o}),this.client.logger.error(o)}}),G(this,"onSessionAuthenticateResponse",(t,n)=>{const{id:s}=n;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:t,payload:n}),Tn(n)?this.events.emit(Ie("session_request",s),{result:n.result}):jr(n)&&this.events.emit(Ie("session_request",s),{error:n.error})}),G(this,"onSessionAuthenticateRequest",async t=>{var n;const{topic:s,payload:i,attestation:o,encryptedId:a,transportType:c}=t;try{const{requester:l,authPayload:u,expiryTimestamp:f}=i.params,h=await this.getVerifyContext({attestationId:o,hash:Mr(JSON.stringify(i)),encryptedId:a,metadata:l.metadata,transportType:c}),d={requester:l,pairingTopic:s,id:i.id,authPayload:u,verifyContext:h,expiryTimestamp:f};await this.setAuthRequest(i.id,{request:d,pairingTopic:s,transportType:c}),c===$e.link_mode&&(n=l.metadata.redirect)!=null&&n.universal&&this.client.core.addLinkModeSupportedApp(l.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:s,params:i.params,id:i.id,verifyContext:h})}catch(l){this.client.logger.error(l);const u=i.params.requester.publicKey,f=await this.client.core.crypto.generateKeyPair(),h=this.getAppLinkIfEnabled(i.params.requester.metadata,c),d={type:Bs,receiverPublicKey:u,senderPublicKey:f};await this.sendError({id:i.id,topic:s,error:l,encodeOpts:d,rpcOpts:xt.wc_sessionAuthenticate.autoReject,appLink:h})}}),G(this,"addSessionRequestToSessionRequestQueue",t=>{this.sessionRequestQueue.queue.push(t)}),G(this,"cleanupAfterResponse",t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Sn.idle,this.processSessionRequestQueue()},Z.toMiliseconds(this.requestQueueDelay))}),G(this,"cleanupPendingSentRequestsForTopic",({topic:t,error:n})=>{const s=this.client.core.history.pending;s.length>0&&s.filter(i=>i.topic===t&&i.request.method==="wc_sessionRequest").forEach(i=>{const o=i.request.id,a=Ie("session_request",o);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);this.events.emit(Ie("session_request",i.request.id),{error:n})})}),G(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===Sn.active){this.client.logger.info("session request queue is already active.");return}const t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{this.emitSessionRequest(t)}catch(n){this.client.logger.error(n)}}),G(this,"emitSessionRequest",t=>{if(this.emittedSessionRequests.has(t.id)){this.client.logger.warn({id:t.id},`Skipping emitting \`session_request\` event for duplicate request. id: ${t.id}`);return}this.sessionRequestQueue.state=Sn.active,this.emittedSessionRequests.add(t.id),this.client.events.emit("session_request",t)}),G(this,"onPairingCreated",t=>{if(t.methods&&this.expectedPairingMethodMap.set(t.topic,t.methods),t.active)return;const n=this.client.proposal.getAll().find(s=>s.pairingTopic===t.topic);n&&this.onSessionProposeRequest({topic:t.topic,payload:fn("wc_sessionPropose",Rt(Pe({},n),{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer,sessionProperties:n.sessionProperties,scopedProperties:n.scopedProperties}),n.id),attestation:n.attestation,encryptedId:n.encryptedId})}),G(this,"isValidConnect",async t=>{if(!Jt(t)){const{message:l}=Y("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(l)}const{pairingTopic:n,requiredNamespaces:s,optionalNamespaces:i,sessionProperties:o,scopedProperties:a,relays:c}=t;if(rt(n)||await this.isValidPairingTopic(n),!IU(c)){const{message:l}=Y("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(l)}if(!rt(s)&&Jn(s)!==0){const l="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(l):this.client.logger.warn(l),this.validateNamespaces(s,"requiredNamespaces")}if(!rt(i)&&Jn(i)!==0&&this.validateNamespaces(i,"optionalNamespaces"),rt(o)||this.validateSessionProps(o,"sessionProperties"),!rt(a)){this.validateSessionProps(a,"scopedProperties");const l=Object.keys(s||{}).concat(Object.keys(i||{}));if(!Object.keys(a).every(u=>l.includes(u.split(":")[0])))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(l)}`)}}),G(this,"validateNamespaces",(t,n)=>{const s=AU(t,"connect()",n);if(s)throw new Error(s.message)}),G(this,"isValidApprove",async t=>{if(!Jt(t))throw new Error(Y("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:n,namespaces:s,relayProtocol:i,sessionProperties:o,scopedProperties:a}=t;this.checkRecentlyDeleted(n),await this.isValidProposalId(n);const c=this.client.proposal.get(n),l=dp(s,"approve()");if(l)throw new Error(l.message);const u=E1(c.requiredNamespaces,s,"approve()");if(u)throw new Error(u.message);if(!Xe(i,!0)){const{message:f}=Y("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw new Error(f)}if(rt(o)||this.validateSessionProps(o,"sessionProperties"),!rt(a)){this.validateSessionProps(a,"scopedProperties");const f=new Set(Object.keys(s));if(!Object.keys(a).every(h=>f.has(h.split(":")[0])))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(a)}, approved namespaces: ${Array.from(f).join(", ")}`)}}),G(this,"isValidReject",async t=>{if(!Jt(t)){const{message:i}=Y("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(i)}const{id:n,reason:s}=t;if(this.checkRecentlyDeleted(n),await this.isValidProposalId(n),!OU(s)){const{message:i}=Y("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(i)}}),G(this,"isValidSessionSettleRequest",t=>{if(!Jt(t)){const{message:l}=Y("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(l)}const{relay:n,controller:s,namespaces:i,expiry:o}=t;if(!l6(n)){const{message:l}=Y("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(l)}const a=yU(s,"onSessionSettleRequest()");if(a)throw new Error(a.message);const c=dp(i,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(qn(o)){const{message:l}=Y("EXPIRED","onSessionSettleRequest()");throw new Error(l)}}),G(this,"isValidUpdate",async t=>{if(!Jt(t)){const{message:c}=Y("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(c)}const{topic:n,namespaces:s}=t;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const i=this.client.session.get(n),o=dp(s,"update()");if(o)throw new Error(o.message);const a=E1(i.requiredNamespaces,s,"update()");if(a)throw new Error(a.message)}),G(this,"isValidExtend",async t=>{if(!Jt(t)){const{message:s}=Y("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(s)}const{topic:n}=t;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n)}),G(this,"isValidRequest",async t=>{if(!Jt(t)){const{message:c}=Y("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(c)}const{topic:n,request:s,chainId:i,expiry:o}=t;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const{namespaces:a}=this.client.session.get(n);if(!w1(a,i)){const{message:c}=Y("MISSING_OR_INVALID",`request() chainId: ${i}`);throw new Error(c)}if(!PU(s)){const{message:c}=Y("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(c)}if(!NU(a,i,s.method)){const{message:c}=Y("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(c)}if(o&&!BU(o,Ip)){const{message:c}=Y("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${Ip.min} and ${Ip.max}`);throw new Error(c)}}),G(this,"isValidRespond",async t=>{var n;if(!Jt(t)){const{message:o}=Y("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(o)}const{topic:s,response:i}=t;try{await this.isValidSessionTopic(s)}catch(o){throw(n=t==null?void 0:t.response)!=null&&n.id&&this.cleanupAfterResponse(t),o}if(!CU(i)){const{message:o}=Y("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(o)}}),G(this,"isValidPing",async t=>{if(!Jt(t)){const{message:s}=Y("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(s)}const{topic:n}=t;await this.isValidSessionOrPairingTopic(n)}),G(this,"isValidEmit",async t=>{if(!Jt(t)){const{message:a}=Y("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(a)}const{topic:n,event:s,chainId:i}=t;await this.isValidSessionTopic(n);const{namespaces:o}=this.client.session.get(n);if(!w1(o,i)){const{message:a}=Y("MISSING_OR_INVALID",`emit() chainId: ${i}`);throw new Error(a)}if(!TU(s)){const{message:a}=Y("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}if(!DU(o,i,s.name)){const{message:a}=Y("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}}),G(this,"isValidDisconnect",async t=>{if(!Jt(t)){const{message:s}=Y("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(s)}const{topic:n}=t;await this.isValidSessionOrPairingTopic(n)}),G(this,"isValidAuthenticate",t=>{const{chains:n,uri:s,domain:i,nonce:o}=t;if(!Array.isArray(n)||n.length===0)throw new Error("chains is required and must be a non-empty array");if(!Xe(s,!1))throw new Error("uri is required parameter");if(!Xe(i,!1))throw new Error("domain is required parameter");if(!Xe(o,!1))throw new Error("nonce is required parameter");if([...new Set(n.map(c=>_s(c).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:a}=_s(n[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),G(this,"getVerifyContext",async t=>{const{attestationId:n,hash:s,encryptedId:i,metadata:o,transportType:a}=t,c={verified:{verifyUrl:o.verifyUrl||fu,validation:"UNKNOWN",origin:o.url||""}};try{if(a===$e.link_mode){const u=this.getAppLinkIfEnabled(o,a);return c.verified.validation=u&&new URL(u).origin===new URL(o.url).origin?"VALID":"INVALID",c}const l=await this.client.core.verify.resolve({attestationId:n,hash:s,encryptedId:i,verifyUrl:o.verifyUrl});l&&(c.verified.origin=l.origin,c.verified.isScam=l.isScam,c.verified.validation=l.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.warn(l)}return this.client.logger.debug(`Verify context: ${JSON.stringify(c)}`),c}),G(this,"validateSessionProps",(t,n)=>{Object.values(t).forEach((s,i)=>{if(s==null){const{message:o}=Y("MISSING_OR_INVALID",`${n} must contain an existing value for each key. Received: ${s} for key ${Object.keys(t)[i]}`);throw new Error(o)}})}),G(this,"getPendingAuthRequest",t=>{const n=this.client.auth.requests.get(t);return typeof n=="object"?n:void 0}),G(this,"addToRecentlyDeleted",(t,n)=>{if(this.recentlyDeletedMap.set(t,n),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let s=0;const i=this.recentlyDeletedLimit/2;for(const o of this.recentlyDeletedMap.keys()){if(s++>=i)break;this.recentlyDeletedMap.delete(o)}}}),G(this,"checkRecentlyDeleted",t=>{const n=this.recentlyDeletedMap.get(t);if(n){const{message:s}=Y("MISSING_OR_INVALID",`Record was recently deleted - ${n}: ${t}`);throw new Error(s)}}),G(this,"isLinkModeEnabled",(t,n)=>{var s,i,o,a,c,l,u,f,h;return!t||n!==$e.link_mode?!1:((i=(s=this.client.metadata)==null?void 0:s.redirect)==null?void 0:i.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((l=(c=this.client.metadata)==null?void 0:c.redirect)==null?void 0:l.universal)!==""&&((u=t==null?void 0:t.redirect)==null?void 0:u.universal)!==void 0&&((f=t==null?void 0:t.redirect)==null?void 0:f.universal)!==""&&((h=t==null?void 0:t.redirect)==null?void 0:h.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(t.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"}),G(this,"getAppLinkIfEnabled",(t,n)=>{var s;return this.isLinkModeEnabled(t,n)?(s=t==null?void 0:t.redirect)==null?void 0:s.universal:void 0}),G(this,"handleLinkModeMessage",({url:t})=>{if(!t||!t.includes("wc_ev")||!t.includes("topic"))return;const n=Rw(t,"topic")||"",s=decodeURIComponent(Rw(t,"wc_ev")||""),i=this.client.session.keys.includes(n);i&&this.client.session.update(n,{transportType:$e.link_mode}),this.client.core.dispatchEnvelope({topic:n,message:s,sessionExists:i})}),G(this,"registerLinkModeListeners",async()=>{var t;if(Cy()||Qi()&&(t=this.client.metadata.redirect)!=null&&t.linkMode){const n=global==null?void 0:global.Linking;if(typeof n<"u"){n.addEventListener("url",this.handleLinkModeMessage,this.client.name);const s=await n.getInitialURL();s&&setTimeout(()=>{this.handleLinkModeMessage({url:s})},50)}}}),G(this,"getTVFParams",(t,n,s)=>{var i,o,a;if(!((i=n.request)!=null&&i.method))return{};const c={correlationId:t,rpcMethods:[n.request.method],chainId:n.chainId};try{const l=this.extractTxHashesFromResult(n.request,s);c.txHashes=l,c.contractAddresses=this.isValidContractData(n.request.params)?[(a=(o=n.request.params)==null?void 0:o[0])==null?void 0:a.to]:[]}catch(l){this.client.logger.warn("Error getting TVF params",l)}return c}),G(this,"isValidContractData",t=>{var n;if(!t)return!1;try{const s=(t==null?void 0:t.data)||((n=t==null?void 0:t[0])==null?void 0:n.data);if(!s.startsWith("0x"))return!1;const i=s.slice(2);return/^[0-9a-fA-F]*$/.test(i)?i.length%2===0:!1}catch{}return!1}),G(this,"extractTxHashesFromResult",(t,n)=>{var s;try{if(!n)return[];const i=t.method,o=Sz[i];if(i==="sui_signTransaction")return[J_(n.transactionBytes)];if(i==="near_signTransaction")return[Mw(n)];if(i==="near_signTransactions")return n.map(c=>Mw(c));if(i==="xrpl_signTransactionFor"||i==="xrpl_signTransaction")return[(s=n.tx_json)==null?void 0:s.hash];if(i==="polkadot_signTransaction")return[QU({transaction:t.params.transactionPayload,signature:n.signature})];if(i==="algo_signTxn")return Kr(n)?n.map(c=>jw(c)):[jw(n)];if(i==="cosmos_signDirect")return[Z_(n)];if(i==="wallet_sendCalls")return X_(n);if(typeof n=="string")return[n];const a=n[o.key];if(Kr(a))return i==="solana_signAllTransactions"?a.map(c=>Q_(c)):a;if(typeof a=="string")return[a]}catch(i){this.client.logger.warn("Error extracting tx hashes from result",i)}return[]})}async processPendingMessageEvents(){try{const e=this.client.session.keys,t=this.client.core.relayer.messages.getWithoutAck(e);for(const[n,s]of Object.entries(t))for(const i of s)try{await this.onProviderMessageEvent({topic:n,message:i,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${n}, message: ${i}`)}}catch(e){this.client.logger.warn("processPendingMessageEvents failed",e)}}isInitialized(){if(!this.initialized){const{message:e}=Y("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Ve.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){const{topic:t,message:n,attestation:s,transportType:i}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(Fh)?this.client.auth.authKeys.get(Fh):{publicKey:void 0};try{const a=await this.client.core.crypto.decode(t,n,{receiverPublicKey:o,encoding:i===$e.link_mode?li:rr});zy(a)?(this.client.core.history.set(t,a),await this.onRelayEventRequest({topic:t,payload:a,attestation:s,transportType:i,encryptedId:Mr(n)})):i0(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:t,payload:a,transportType:i}),this.client.core.history.delete(t,a.id)):await this.onRelayEventUnknownPayload({topic:t,payload:a,transportType:i}),await this.client.core.relayer.messages.ack(t,n)}catch(a){this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(Rr.expired,async e=>{const{topic:t,id:n}=u4(e.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,Y("EXPIRED"),!0);if(n&&this.client.auth.requests.keys.includes(n))return await this.deletePendingAuthRequest(n,Y("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(fo.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(fo.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!Xe(e,!1)){const{message:t}=Y("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=Y("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(qn(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=Y("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!Xe(e,!1)){const{message:t}=Y("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:t}=Y("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(qn(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:t}=Y("EXPIRED",`session topic: ${e}`);throw new Error(t)}if(!this.client.core.crypto.keychain.has(e)){const{message:t}=Y("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Xe(e,!1)){const{message:t}=Y("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=Y("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!SU(e)){const{message:t}=Y("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=Y("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(qn(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:t}=Y("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class Fz extends ba{constructor(e,t){super(e,t,vz,qy),this.core=e,this.logger=t}}let Mz=class extends ba{constructor(e,t){super(e,t,Az,qy),this.core=e,this.logger=t}};class jz extends ba{constructor(e,t){super(e,t,Oz,qy,n=>n.id),this.core=e,this.logger=t}}class zz extends ba{constructor(e,t){super(e,t,Nz,a0,()=>Fh),this.core=e,this.logger=t}}class Hz extends ba{constructor(e,t){super(e,t,Dz,a0),this.core=e,this.logger=t}}class qz extends ba{constructor(e,t){super(e,t,Rz,a0,n=>n.id),this.core=e,this.logger=t}}var Vz=Object.defineProperty,Kz=(r,e,t)=>e in r?Vz(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Sp=(r,e,t)=>Kz(r,typeof e!="symbol"?e+"":e,t);class Gz{constructor(e,t){this.core=e,this.logger=t,Sp(this,"authKeys"),Sp(this,"pairingTopics"),Sp(this,"requests"),this.authKeys=new zz(this.core,this.logger),this.pairingTopics=new Hz(this.core,this.logger),this.requests=new qz(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var Wz=Object.defineProperty,Qz=(r,e,t)=>e in r?Wz(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ge=(r,e,t)=>Qz(r,typeof e!="symbol"?e+"":e,t);let Jz=class L6 extends dL{constructor(e){super(e),ge(this,"protocol",k6),ge(this,"version",U6),ge(this,"name",Ap.name),ge(this,"metadata"),ge(this,"core"),ge(this,"logger"),ge(this,"events",new Ar.EventEmitter),ge(this,"engine"),ge(this,"session"),ge(this,"proposal"),ge(this,"pendingRequest"),ge(this,"auth"),ge(this,"signConfig"),ge(this,"on",(n,s)=>this.events.on(n,s)),ge(this,"once",(n,s)=>this.events.once(n,s)),ge(this,"off",(n,s)=>this.events.off(n,s)),ge(this,"removeListener",(n,s)=>this.events.removeListener(n,s)),ge(this,"removeAllListeners",n=>this.events.removeAllListeners(n)),ge(this,"connect",async n=>{try{return await this.engine.connect(n)}catch(s){throw this.logger.error(s.message),s}}),ge(this,"pair",async n=>{try{return await this.engine.pair(n)}catch(s){throw this.logger.error(s.message),s}}),ge(this,"approve",async n=>{try{return await this.engine.approve(n)}catch(s){throw this.logger.error(s.message),s}}),ge(this,"reject",async n=>{try{return await this.engine.reject(n)}catch(s){throw this.logger.error(s.message),s}}),ge(this,"update",async n=>{try{return await this.engine.update(n)}catch(s){throw this.logger.error(s.message),s}}),ge(this,"extend",async n=>{try{return await this.engine.extend(n)}catch(s){throw this.logger.error(s.message),s}}),ge(this,"request",async n=>{try{return await this.engine.request(n)}catch(s){throw this.logger.error(s.message),s}}),ge(this,"respond",async n=>{try{return await this.engine.respond(n)}catch(s){throw this.logger.error(s.message),s}}),ge(this,"ping",async n=>{try{return await this.engine.ping(n)}catch(s){throw this.logger.error(s.message),s}}),ge(this,"emit",async n=>{try{return await this.engine.emit(n)}catch(s){throw this.logger.error(s.message),s}}),ge(this,"disconnect",async n=>{try{return await this.engine.disconnect(n)}catch(s){throw this.logger.error(s.message),s}}),ge(this,"find",n=>{try{return this.engine.find(n)}catch(s){throw this.logger.error(s.message),s}}),ge(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}}),ge(this,"authenticate",async(n,s)=>{try{return await this.engine.authenticate(n,s)}catch(i){throw this.logger.error(i.message),i}}),ge(this,"formatAuthMessage",n=>{try{return this.engine.formatAuthMessage(n)}catch(s){throw this.logger.error(s.message),s}}),ge(this,"approveSessionAuthenticate",async n=>{try{return await this.engine.approveSessionAuthenticate(n)}catch(s){throw this.logger.error(s.message),s}}),ge(this,"rejectSessionAuthenticate",async n=>{try{return await this.engine.rejectSessionAuthenticate(n)}catch(s){throw this.logger.error(s.message),s}}),this.name=(e==null?void 0:e.name)||Ap.name,this.metadata=zR(e==null?void 0:e.metadata),this.signConfig=e==null?void 0:e.signConfig;const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Pf(n0({level:(e==null?void 0:e.logger)||Ap.logger}));this.core=(e==null?void 0:e.core)||new Ez(e),this.logger=Kt(t,this.name),this.session=new Mz(this.core,this.logger),this.proposal=new Fz(this.core,this.logger),this.pendingRequest=new jz(this.core,this.logger),this.engine=new Lz(this),this.auth=new Gz(this.core,this.logger)}static async init(e){const t=new L6(e);return await t.initialize(),t}get context(){return ar(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};var uh={exports:{}},y2;function Yz(){return y2||(y2=1,(function(r,e){var t=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof Hn<"u"&&Hn,n=(function(){function i(){this.fetch=!1,this.DOMException=t.DOMException}return i.prototype=t,new i})();(function(i){(function(o){var a=typeof i<"u"&&i||typeof self<"u"&&self||typeof Hn<"u"&&Hn||{},c={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&(function(){try{return new Blob,!0}catch{return!1}})(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function l(m){return m&&DataView.prototype.isPrototypeOf(m)}if(c.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],f=ArrayBuffer.isView||function(m){return m&&u.indexOf(Object.prototype.toString.call(m))>-1};function h(m){if(typeof m!="string"&&(m=String(m)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(m)||m==="")throw new TypeError('Invalid character in header field name: "'+m+'"');return m.toLowerCase()}function d(m){return typeof m!="string"&&(m=String(m)),m}function p(m){var v={next:function(){var N=m.shift();return{done:N===void 0,value:N}}};return c.iterable&&(v[Symbol.iterator]=function(){return v}),v}function g(m){this.map={},m instanceof g?m.forEach(function(v,N){this.append(N,v)},this):Array.isArray(m)?m.forEach(function(v){if(v.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+v.length);this.append(v[0],v[1])},this):m&&Object.getOwnPropertyNames(m).forEach(function(v){this.append(v,m[v])},this)}g.prototype.append=function(m,v){m=h(m),v=d(v);var N=this.map[m];this.map[m]=N?N+", "+v:v},g.prototype.delete=function(m){delete this.map[h(m)]},g.prototype.get=function(m){return m=h(m),this.has(m)?this.map[m]:null},g.prototype.has=function(m){return this.map.hasOwnProperty(h(m))},g.prototype.set=function(m,v){this.map[h(m)]=d(v)},g.prototype.forEach=function(m,v){for(var N in this.map)this.map.hasOwnProperty(N)&&m.call(v,this.map[N],N,this)},g.prototype.keys=function(){var m=[];return this.forEach(function(v,N){m.push(N)}),p(m)},g.prototype.values=function(){var m=[];return this.forEach(function(v){m.push(v)}),p(m)},g.prototype.entries=function(){var m=[];return this.forEach(function(v,N){m.push([N,v])}),p(m)},c.iterable&&(g.prototype[Symbol.iterator]=g.prototype.entries);function y(m){if(!m._noBody){if(m.bodyUsed)return Promise.reject(new TypeError("Already read"));m.bodyUsed=!0}}function x(m){return new Promise(function(v,N){m.onload=function(){v(m.result)},m.onerror=function(){N(m.error)}})}function A(m){var v=new FileReader,N=x(v);return v.readAsArrayBuffer(m),N}function w(m){var v=new FileReader,N=x(v),$=/charset=([A-Za-z0-9_-]+)/.exec(m.type),R=$?$[1]:"utf-8";return v.readAsText(m,R),N}function O(m){for(var v=new Uint8Array(m),N=new Array(v.length),$=0;$<v.length;$++)N[$]=String.fromCharCode(v[$]);return N.join("")}function I(m){if(m.slice)return m.slice(0);var v=new Uint8Array(m.byteLength);return v.set(new Uint8Array(m)),v.buffer}function E(){return this.bodyUsed=!1,this._initBody=function(m){this.bodyUsed=this.bodyUsed,this._bodyInit=m,m?typeof m=="string"?this._bodyText=m:c.blob&&Blob.prototype.isPrototypeOf(m)?this._bodyBlob=m:c.formData&&FormData.prototype.isPrototypeOf(m)?this._bodyFormData=m:c.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)?this._bodyText=m.toString():c.arrayBuffer&&c.blob&&l(m)?(this._bodyArrayBuffer=I(m.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(m)||f(m))?this._bodyArrayBuffer=I(m):this._bodyText=m=Object.prototype.toString.call(m):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof m=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):c.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c.blob&&(this.blob=function(){var m=y(this);if(m)return m;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var m=y(this);return m||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(c.blob)return this.blob().then(A);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var m=y(this);if(m)return m;if(this._bodyBlob)return w(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(O(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(F)}),this.json=function(){return this.text().then(JSON.parse)},this}var P=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function T(m){var v=m.toUpperCase();return P.indexOf(v)>-1?v:m}function D(m,v){if(!(this instanceof D))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');v=v||{};var N=v.body;if(m instanceof D){if(m.bodyUsed)throw new TypeError("Already read");this.url=m.url,this.credentials=m.credentials,v.headers||(this.headers=new g(m.headers)),this.method=m.method,this.mode=m.mode,this.signal=m.signal,!N&&m._bodyInit!=null&&(N=m._bodyInit,m.bodyUsed=!0)}else this.url=String(m);if(this.credentials=v.credentials||this.credentials||"same-origin",(v.headers||!this.headers)&&(this.headers=new g(v.headers)),this.method=T(v.method||this.method||"GET"),this.mode=v.mode||this.mode||null,this.signal=v.signal||this.signal||(function(){if("AbortController"in a){var B=new AbortController;return B.signal}})(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&N)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(N),(this.method==="GET"||this.method==="HEAD")&&(v.cache==="no-store"||v.cache==="no-cache")){var $=/([?&])_=[^&]*/;if($.test(this.url))this.url=this.url.replace($,"$1_="+new Date().getTime());else{var R=/\?/;this.url+=(R.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}D.prototype.clone=function(){return new D(this,{body:this._bodyInit})};function F(m){var v=new FormData;return m.trim().split("&").forEach(function(N){if(N){var $=N.split("="),R=$.shift().replace(/\+/g," "),B=$.join("=").replace(/\+/g," ");v.append(decodeURIComponent(R),decodeURIComponent(B))}}),v}function j(m){var v=new g,N=m.replace(/\r?\n[\t ]+/g," ");return N.split("\r").map(function($){return $.indexOf(`
`)===0?$.substr(1,$.length):$}).forEach(function($){var R=$.split(":"),B=R.shift().trim();if(B){var H=R.join(":").trim();try{v.append(B,H)}catch(V){console.warn("Response "+V.message)}}}),v}E.call(D.prototype);function L(m,v){if(!(this instanceof L))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(v||(v={}),this.type="default",this.status=v.status===void 0?200:v.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=v.statusText===void 0?"":""+v.statusText,this.headers=new g(v.headers),this.url=v.url||"",this._initBody(m)}E.call(L.prototype),L.prototype.clone=function(){return new L(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new g(this.headers),url:this.url})},L.error=function(){var m=new L(null,{status:200,statusText:""});return m.ok=!1,m.status=0,m.type="error",m};var U=[301,302,303,307,308];L.redirect=function(m,v){if(U.indexOf(v)===-1)throw new RangeError("Invalid status code");return new L(null,{status:v,headers:{location:m}})},o.DOMException=a.DOMException;try{new o.DOMException}catch{o.DOMException=function(v,N){this.message=v,this.name=N;var $=Error(v);this.stack=$.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function _(m,v){return new Promise(function(N,$){var R=new D(m,v);if(R.signal&&R.signal.aborted)return $(new o.DOMException("Aborted","AbortError"));var B=new XMLHttpRequest;function H(){B.abort()}B.onload=function(){var W={statusText:B.statusText,headers:j(B.getAllResponseHeaders()||"")};R.url.indexOf("file://")===0&&(B.status<200||B.status>599)?W.status=200:W.status=B.status,W.url="responseURL"in B?B.responseURL:W.headers.get("X-Request-URL");var J="response"in B?B.response:B.responseText;setTimeout(function(){N(new L(J,W))},0)},B.onerror=function(){setTimeout(function(){$(new TypeError("Network request failed"))},0)},B.ontimeout=function(){setTimeout(function(){$(new TypeError("Network request timed out"))},0)},B.onabort=function(){setTimeout(function(){$(new o.DOMException("Aborted","AbortError"))},0)};function V(W){try{return W===""&&a.location.href?a.location.href:W}catch{return W}}if(B.open(R.method,V(R.url),!0),R.credentials==="include"?B.withCredentials=!0:R.credentials==="omit"&&(B.withCredentials=!1),"responseType"in B&&(c.blob?B.responseType="blob":c.arrayBuffer&&(B.responseType="arraybuffer")),v&&typeof v.headers=="object"&&!(v.headers instanceof g||a.Headers&&v.headers instanceof a.Headers)){var X=[];Object.getOwnPropertyNames(v.headers).forEach(function(W){X.push(h(W)),B.setRequestHeader(W,d(v.headers[W]))}),R.headers.forEach(function(W,J){X.indexOf(J)===-1&&B.setRequestHeader(J,W)})}else R.headers.forEach(function(W,J){B.setRequestHeader(J,W)});R.signal&&(R.signal.addEventListener("abort",H),B.onreadystatechange=function(){B.readyState===4&&R.signal.removeEventListener("abort",H)}),B.send(typeof R._bodyInit>"u"?null:R._bodyInit)})}return _.polyfill=!0,a.fetch||(a.fetch=_,a.Headers=g,a.Request=D,a.Response=L),o.Headers=g,o.Request=D,o.Response=L,o.fetch=_,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var s=t.fetch?t:n;e=s.fetch,e.default=s.fetch,e.fetch=s.fetch,e.Headers=s.Headers,e.Request=s.Request,e.Response=s.Response,r.exports=e})(uh,uh.exports)),uh.exports}var Zz=Yz();const m2=gy(Zz);var Xz=Object.defineProperty,eH=Object.defineProperties,tH=Object.getOwnPropertyDescriptors,x2=Object.getOwnPropertySymbols,rH=Object.prototype.hasOwnProperty,nH=Object.prototype.propertyIsEnumerable,w2=(r,e,t)=>e in r?Xz(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,E2=(r,e)=>{for(var t in e||(e={}))rH.call(e,t)&&w2(r,t,e[t]);if(x2)for(var t of x2(e))nH.call(e,t)&&w2(r,t,e[t]);return r},v2=(r,e)=>eH(r,tH(e));const sH={Accept:"application/json","Content-Type":"application/json"},iH="POST",A2={headers:sH,method:iH},I2=10;let F6=class{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new Ar.EventEmitter,this.isAvailable=!1,this.registering=!1,!M1(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const t=Fs(e),n=await(await m2(this.url,v2(E2({},A2),{body:t}))).json();this.onPayload({data:n})}catch(t){this.onError(e.id,t)}}async register(e=this.url){if(!M1(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((n,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return s(new Error("HTTP connection is missing or invalid"));n()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=Fs({id:1,jsonrpc:"2.0",method:"test",params:[]});await m2(e,v2(E2({},A2),{body:t}))}this.onOpen()}catch(t){const n=this.parseError(t);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?oa(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const n=this.parseError(t),s=n.message||n.toString(),i=s0(e,s);this.events.emit("payload",i)}parseError(e,t=this.url){return g6(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>I2&&this.events.setMaxListeners(I2)}};const S2="error",oH="wss://relay.walletconnect.org",aH="wc",cH="universal_provider",fh=`${aH}@2:${cH}:`,M6="https://rpc.walletconnect.org/v1/",j6="generic",lH=`${M6}bundler`,tc="call_status",uH=86400,Vy={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};function Ky(r){return r==null||typeof r!="object"&&typeof r!="function"}function z6(r){return Object.getOwnPropertySymbols(r).filter(e=>Object.prototype.propertyIsEnumerable.call(r,e))}function H6(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}const fH="[object RegExp]",q6="[object String]",V6="[object Number]",K6="[object Boolean]",G6="[object Arguments]",hH="[object Symbol]",dH="[object Date]",pH="[object Map]",gH="[object Set]",bH="[object Array]",yH="[object ArrayBuffer]",mH="[object Object]",xH="[object DataView]",wH="[object Uint8Array]",EH="[object Uint8ClampedArray]",vH="[object Uint16Array]",AH="[object Uint32Array]",IH="[object Int8Array]",SH="[object Int16Array]",OH="[object Int32Array]",PH="[object Float32Array]",CH="[object Float64Array]";function Gy(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}function TH(r,e){return Ha(r,void 0,r,new Map,e)}function Ha(r,e,t,n=new Map,s=void 0){const i=s==null?void 0:s(r,e,t,n);if(i!=null)return i;if(Ky(r))return r;if(n.has(r))return n.get(r);if(Array.isArray(r)){const o=new Array(r.length);n.set(r,o);for(let a=0;a<r.length;a++)o[a]=Ha(r[a],a,t,n,s);return Object.hasOwn(r,"index")&&(o.index=r.index),Object.hasOwn(r,"input")&&(o.input=r.input),o}if(r instanceof Date)return new Date(r.getTime());if(r instanceof RegExp){const o=new RegExp(r.source,r.flags);return o.lastIndex=r.lastIndex,o}if(r instanceof Map){const o=new Map;n.set(r,o);for(const[a,c]of r)o.set(a,Ha(c,a,t,n,s));return o}if(r instanceof Set){const o=new Set;n.set(r,o);for(const a of r)o.add(Ha(a,void 0,t,n,s));return o}if(typeof Buffer<"u"&&Buffer.isBuffer(r))return r.subarray();if(Gy(r)){const o=new(Object.getPrototypeOf(r)).constructor(r.length);n.set(r,o);for(let a=0;a<r.length;a++)o[a]=Ha(r[a],a,t,n,s);return o}if(r instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&r instanceof SharedArrayBuffer)return r.slice(0);if(r instanceof DataView){const o=new DataView(r.buffer.slice(0),r.byteOffset,r.byteLength);return n.set(r,o),ho(o,r,t,n,s),o}if(typeof File<"u"&&r instanceof File){const o=new File([r],r.name,{type:r.type});return n.set(r,o),ho(o,r,t,n,s),o}if(r instanceof Blob){const o=new Blob([r],{type:r.type});return n.set(r,o),ho(o,r,t,n,s),o}if(r instanceof Error){const o=new r.constructor;return n.set(r,o),o.message=r.message,o.name=r.name,o.stack=r.stack,o.cause=r.cause,ho(o,r,t,n,s),o}if(typeof r=="object"&&NH(r)){const o=Object.create(Object.getPrototypeOf(r));return n.set(r,o),ho(o,r,t,n,s),o}return r}function ho(r,e,t=r,n,s){const i=[...Object.keys(e),...z6(e)];for(let o=0;o<i.length;o++){const a=i[o],c=Object.getOwnPropertyDescriptor(r,a);(c==null||c.writable)&&(r[a]=Ha(e[a],a,t,n,s))}}function NH(r){switch(H6(r)){case G6:case bH:case yH:case xH:case K6:case dH:case PH:case CH:case IH:case SH:case OH:case pH:case V6:case mH:case fH:case gH:case q6:case hH:case wH:case EH:case vH:case AH:return!0;default:return!1}}function DH(r,e){return TH(r,(t,n,s,i)=>{if(typeof r=="object")switch(Object.prototype.toString.call(r)){case V6:case q6:case K6:{const o=new r.constructor(r==null?void 0:r.valueOf());return ho(o,r),o}case G6:{const o={};return ho(o,r),o.length=r.length,o[Symbol.iterator]=r[Symbol.iterator],o}default:return}})}function O2(r){return DH(r)}function P2(r){return r!==null&&typeof r=="object"&&H6(r)==="[object Arguments]"}function C2(r){return typeof r=="object"&&r!==null}function RH(){}function _H(r){return Gy(r)}function BH(r){var t;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const n=r[Symbol.toStringTag];return n==null||!((t=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&t.writable)?!1:r.toString()===`[object ${n}]`}let e=r;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(r)===e}function kH(r){if(Ky(r))return r;if(Array.isArray(r)||Gy(r)||r instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&r instanceof SharedArrayBuffer)return r.slice(0);const e=Object.getPrototypeOf(r),t=e.constructor;if(r instanceof Date||r instanceof Map||r instanceof Set)return new t(r);if(r instanceof RegExp){const n=new t(r);return n.lastIndex=r.lastIndex,n}if(r instanceof DataView)return new t(r.buffer.slice(0));if(r instanceof Error){const n=new t(r.message);return n.stack=r.stack,n.name=r.name,n.cause=r.cause,n}if(typeof File<"u"&&r instanceof File)return new t([r],r.name,{type:r.type,lastModified:r.lastModified});if(typeof r=="object"){const n=Object.create(e);return Object.assign(n,r)}return r}function UH(r,...e){const t=e.slice(0,-1),n=e[e.length-1];let s=r;for(let i=0;i<t.length;i++){const o=t[i];s=xb(s,o,n,new Map)}return s}function xb(r,e,t,n){if(Ky(r)&&(r=Object(r)),e==null||typeof e!="object")return r;if(n.has(e))return kH(n.get(e));if(n.set(e,r),Array.isArray(e)){e=e.slice();for(let i=0;i<e.length;i++)e[i]=e[i]??void 0}const s=[...Object.keys(e),...z6(e)];for(let i=0;i<s.length;i++){const o=s[i];let a=e[o],c=r[o];if(P2(a)&&(a={...a}),P2(c)&&(c={...c}),typeof Buffer<"u"&&Buffer.isBuffer(a)&&(a=O2(a)),Array.isArray(a))if(typeof c=="object"&&c!=null){const u=[],f=Reflect.ownKeys(c);for(let h=0;h<f.length;h++){const d=f[h];u[d]=c[d]}c=u}else c=[];const l=t(c,a,o,r,e,n);l!=null?r[o]=l:Array.isArray(a)||C2(c)&&C2(a)?r[o]=xb(c,a,t,n):c==null&&BH(a)?r[o]=xb({},a,t,n):c==null&&_H(a)?r[o]=O2(a):(c===void 0||a!==void 0)&&(r[o]=a)}return r}function $H(r,...e){return UH(r,...e,RH)}var LH=Object.defineProperty,FH=Object.defineProperties,MH=Object.getOwnPropertyDescriptors,T2=Object.getOwnPropertySymbols,jH=Object.prototype.hasOwnProperty,zH=Object.prototype.propertyIsEnumerable,N2=(r,e,t)=>e in r?LH(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,hh=(r,e)=>{for(var t in e||(e={}))jH.call(e,t)&&N2(r,t,e[t]);if(T2)for(var t of T2(e))zH.call(e,t)&&N2(r,t,e[t]);return r},HH=(r,e)=>FH(r,MH(e));function W6(r,e,t){var n;const s=_s(r);return((n=e.rpcMap)==null?void 0:n[s.reference])||`${M6}?chainId=${s.namespace}:${s.reference}&projectId=${t}`}function qH(r){return r.includes(":")?r.split(":")[1]:r}function Q6(r){return r.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function VH(r,e){const t=Object.keys(e.namespaces).filter(s=>s.includes(r));if(!t.length)return[];const n=[];return t.forEach(s=>{const i=e.namespaces[s].accounts;n.push(...i)}),n}function D2(r){return Object.fromEntries(Object.entries(r).filter(([e,t])=>{var n,s;return((n=t==null?void 0:t.chains)==null?void 0:n.length)&&((s=t==null?void 0:t.chains)==null?void 0:s.length)>0}))}function dh(r={},e={}){const t=D2(R2(r)),n=D2(R2(e));return $H(t,n)}function R2(r){var e,t,n,s,i;const o={};if(!Jn(r))return o;for(const[a,c]of Object.entries(r)){const l=r0(a)?[a]:c.chains,u=c.methods||[],f=c.events||[],h=c.rpcMap||{},d=za(a);o[d]=HH(hh(hh({},o[d]),c),{chains:Qn(l,(e=o[d])==null?void 0:e.chains),methods:Qn(u,(t=o[d])==null?void 0:t.methods),events:Qn(f,(n=o[d])==null?void 0:n.events)}),(Jn(h)||Jn(((s=o[d])==null?void 0:s.rpcMap)||{}))&&(o[d].rpcMap=hh(hh({},h),(i=o[d])==null?void 0:i.rpcMap))}return o}function _2(r){return r.includes(":")?r.split(":")[2]:r}function B2(r){const e={};for(const[t,n]of Object.entries(r)){const s=n.methods||[],i=n.events||[],o=n.accounts||[],a=r0(t)?[t]:n.chains?n.chains:Q6(n.accounts);e[t]={chains:a,methods:s,events:i,accounts:o}}return e}function Op(r){return typeof r=="number"?r:r.includes("0x")?parseInt(r,16):(r=r.includes(":")?r.split(":")[1]:r,isNaN(Number(r))?r:Number(r))}function KH(r){try{const e=JSON.parse(r);return typeof e=="object"&&e!==null&&!Array.isArray(e)}catch{return!1}}const J6={},rc=r=>J6[r],Pp=(r,e)=>{J6[r]=e};var GH=Object.defineProperty,k2=Object.getOwnPropertySymbols,WH=Object.prototype.hasOwnProperty,QH=Object.prototype.propertyIsEnumerable,U2=(r,e,t)=>e in r?GH(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,$2=(r,e)=>{for(var t in e||(e={}))WH.call(e,t)&&U2(r,t,e[t]);if(k2)for(var t of k2(e))QH.call(e,t)&&U2(r,t,e[t]);return r};const L2="eip155",JH=["atomic","flow-control","paymasterService","sessionKeys","auxiliaryFunds"],YH=r=>r&&r.startsWith("0x")?BigInt(r).toString(10):r,Cp=r=>r&&r.startsWith("0x")?r:`0x${BigInt(r).toString(16)}`,F2=r=>Object.keys(r).filter(e=>JH.includes(e)).reduce((e,t)=>(e[t]=ZH(r[t]),e),{}),ZH=r=>typeof r=="string"&&KH(r)?JSON.parse(r):r,XH=(r,e,t)=>{const{sessionProperties:n={},scopedProperties:s={}}=r,i={};if(!Jn(s)&&!Jn(n))return;const o=F2(n);for(const a of t){const c=YH(a);if(!c)continue;i[Cp(c)]=o;const l=s==null?void 0:s[`${L2}:${c}`];if(l){const u=l==null?void 0:l[`${L2}:${c}:${e}`];i[Cp(c)]=$2($2({},i[Cp(c)]),F2(u||l))}}for(const[a,c]of Object.entries(i))Object.keys(c).length===0&&delete i[a];return Object.keys(i).length>0?i:void 0};var eq=Object.defineProperty,tq=(r,e,t)=>e in r?eq(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,rq=(r,e,t)=>tq(r,e+"",t);let Tp,nq=class Y6{constructor(e){rq(this,"storage"),this.storage=e}async getItem(e){return await this.storage.getItem(e)}async setItem(e,t){return await this.storage.setItem(e,t)}async removeItem(e){return await this.storage.removeItem(e)}static getStorage(e){return Tp||(Tp=new Y6(e)),Tp}};var sq=Object.defineProperty,iq=Object.defineProperties,oq=Object.getOwnPropertyDescriptors,M2=Object.getOwnPropertySymbols,aq=Object.prototype.hasOwnProperty,cq=Object.prototype.propertyIsEnumerable,j2=(r,e,t)=>e in r?sq(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,lq=(r,e)=>{for(var t in e||(e={}))aq.call(e,t)&&j2(r,t,e[t]);if(M2)for(var t of M2(e))cq.call(e,t)&&j2(r,t,e[t]);return r},uq=(r,e)=>iq(r,oq(e));async function fq(r,e){const t=_s(r.result.capabilities.caip345.caip2),n=r.result.capabilities.caip345.transactionHashes,s=await Promise.allSettled(n.map(f=>hq(t.reference,f,e))),i=s.filter(f=>f.status==="fulfilled").map(f=>f.value).filter(f=>f);s.filter(f=>f.status==="rejected").forEach(f=>console.warn("Failed to fetch transaction receipt:",f.reason));const o=!i.length||i.some(f=>!f),a=i.every(f=>(f==null?void 0:f.status)==="0x1"),c=i.every(f=>(f==null?void 0:f.status)==="0x0"),l=i.some(f=>(f==null?void 0:f.status)==="0x0");let u;return o?u=100:a?u=200:c?u=500:l&&(u=600),{id:r.result.id,version:r.request.version,atomic:r.request.atomicRequired,chainId:r.request.chainId,capabilities:r.result.capabilities,receipts:i,status:u}}async function hq(r,e,t){return await t(parseInt(r)).request(fn("eth_getTransactionReceipt",[e]))}async function dq({sendCalls:r,storage:e}){const t=await e.getItem(tc);await e.setItem(tc,uq(lq({},t),{[r.result.id]:{request:r.request,result:r.result,expiry:Ze(uH)}}))}async function pq({resultId:r,storage:e}){const t=await e.getItem(tc);if(t){delete t[r],await e.setItem(tc,t);for(const n in t)qn(t[n].expiry)&&delete t[n];await e.setItem(tc,t)}}async function gq({resultId:r,storage:e}){const t=await e.getItem(tc),n=t==null?void 0:t[r];if(n&&!qn(n.expiry))return n;await pq({resultId:r,storage:e})}var bq=Object.defineProperty,yq=Object.defineProperties,mq=Object.getOwnPropertyDescriptors,z2=Object.getOwnPropertySymbols,xq=Object.prototype.hasOwnProperty,wq=Object.prototype.propertyIsEnumerable,wb=(r,e,t)=>e in r?bq(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Np=(r,e)=>{for(var t in e||(e={}))xq.call(e,t)&&wb(r,t,e[t]);if(z2)for(var t of z2(e))wq.call(e,t)&&wb(r,t,e[t]);return r},Dp=(r,e)=>yq(r,mq(e)),ro=(r,e,t)=>wb(r,typeof e!="symbol"?e+"":e,t);class Eq{constructor(e){ro(this,"name","eip155"),ro(this,"client"),ro(this,"chainId"),ro(this,"namespace"),ro(this,"httpProviders"),ro(this,"events"),ro(this,"storage"),this.namespace=e.namespace,this.events=rc("events"),this.client=rc("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain()),this.storage=nq.getStorage(this.client.core.storage)}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e);case"wallet_sendCalls":return await this.sendCalls(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t);const n=this.chainId;this.chainId=parseInt(e),this.events.emit(Vy.DEFAULT_CHAIN_CHANGED,{currentCaipChainId:`${this.name}:${e}`,previousCaipChainId:`${this.name}:${n}`})}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const n=t||W6(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Hy(new F6(n,rc("disableProviderPing")))}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const s=parseInt(qH(t));e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(e){const t=e||this.chainId;return this.httpProviders[t]||(this.httpProviders=Dp(Np({},this.httpProviders),{[t]:this.createHttpProvider(t)}),this.httpProviders[t])}async handleSwitchChain(e){var t,n;let s=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const i=parseInt(s,16);if(this.isChainApproved(i))this.setDefaultChain(`${i}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:s}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${i}`);else throw new Error(`Failed to switch to chain 'eip155:${i}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var t,n,s,i,o;const a=(n=(t=e.request)==null?void 0:t.params)==null?void 0:n[0],c=((i=(s=e.request)==null?void 0:s.params)==null?void 0:i[1])||[];if(!a)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const l=this.client.session.get(e.topic),u=((o=l==null?void 0:l.sessionProperties)==null?void 0:o.capabilities)||{},f=`${a}${c.join(",")}`,h=u==null?void 0:u[f];if(h)return h;let d;try{d=XH(l,a,c)}catch(g){console.warn("Failed to extract capabilities from session",g)}if(d)return d;const p=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:Dp(Np({},l.sessionProperties||{}),{capabilities:Dp(Np({},u||{}),{[f]:p})})})}catch(g){console.warn("Failed to update session with capabilities",g)}return p}async getCallStatus(e){var t,n,s;const i=this.client.session.get(e.topic),o=(t=i.sessionProperties)==null?void 0:t.bundler_name;if(o){const l=this.getBundlerUrl(e.chainId,o);try{return await this.getUserOperationReceipt(l,e)}catch(u){console.warn("Failed to fetch call status from bundler",u,l)}}const a=(n=i.sessionProperties)==null?void 0:n.bundler_url;if(a)try{return await this.getUserOperationReceipt(a,e)}catch(l){console.warn("Failed to fetch call status from custom bundler",l,a)}const c=await gq({resultId:(s=e.request.params)==null?void 0:s[0],storage:this.storage});if(c)try{return await fq(c,this.getHttpProvider.bind(this))}catch(l){console.warn("Failed to fetch call status from stored send calls",l,c)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,t){var n;const s=new URL(e),i=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(fn("eth_getUserOperationReceipt",[(n=t.request.params)==null?void 0:n[0]]))});if(!i.ok)throw new Error(`Failed to fetch user operation receipt - ${i.status}`);return await i.json()}getBundlerUrl(e,t){return`${lH}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${t}`}async sendCalls(e){var t,n,s;const i=await this.client.request(e),o=(t=e.request.params)==null?void 0:t[0],a=i==null?void 0:i.id,c=(i==null?void 0:i.capabilities)||{},l=(n=c==null?void 0:c.caip345)==null?void 0:n.caip2,u=(s=c==null?void 0:c.caip345)==null?void 0:s.transactionHashes;return!a||!l||!(u!=null&&u.length)||await dq({sendCalls:{request:o,result:i},storage:this.storage}),i}}var vq=Object.defineProperty,Aq=(r,e,t)=>e in r?vq(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ra=(r,e,t)=>Aq(r,typeof e!="symbol"?e+"":e,t);class Iq{constructor(e){Ra(this,"name",j6),Ra(this,"client"),Ra(this,"httpProviders"),Ra(this,"events"),Ra(this,"namespace"),Ra(this,"chainId"),this.namespace=e.namespace,this.events=rc("events"),this.client=rc("client"),this.chainId=this.getDefaultChain(),this.name=this.getNamespaceName(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t);const n=this.chainId;this.chainId=e,this.events.emit(Vy.DEFAULT_CHAIN_CHANGED,{currentCaipChainId:`${this.name}:${e}`,previousCaipChainId:`${this.name}:${n}`})}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getNamespaceName(){const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return _s(e).namespace}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){var e,t;const n={};return(t=(e=this.namespace)==null?void 0:e.accounts)==null||t.forEach(s=>{var i,o;const a=_s(s),c=(o=(i=this.namespace)==null?void 0:i.rpcMap)==null?void 0:o[`${a.namespace}:${a.reference}`];n[a.reference]=this.createHttpProvider(s,c)}),n}getHttpProvider(e){const t=_s(e).reference,n=this.httpProviders[t];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||W6(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Hy(new F6(n,rc("disableProviderPing")))}}var Sq=Object.defineProperty,Oq=Object.defineProperties,Pq=Object.getOwnPropertyDescriptors,H2=Object.getOwnPropertySymbols,Cq=Object.prototype.hasOwnProperty,Tq=Object.prototype.propertyIsEnumerable,Eb=(r,e,t)=>e in r?Sq(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Vl=(r,e)=>{for(var t in e||(e={}))Cq.call(e,t)&&Eb(r,t,e[t]);if(H2)for(var t of H2(e))Tq.call(e,t)&&Eb(r,t,e[t]);return r},ph=(r,e)=>Oq(r,Pq(e)),Tr=(r,e,t)=>Eb(r,typeof e!="symbol"?e+"":e,t);class Wy{constructor(e){Tr(this,"client"),Tr(this,"namespaces"),Tr(this,"optionalNamespaces"),Tr(this,"sessionProperties"),Tr(this,"scopedProperties"),Tr(this,"events",new by),Tr(this,"rpcProviders",{}),Tr(this,"session"),Tr(this,"providerOpts"),Tr(this,"logger"),Tr(this,"uri"),Tr(this,"disableProviderPing",!1),this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Pf(n0({level:(e==null?void 0:e.logger)||S2})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const t=new Wy(e);return await t.initialize(),t}async request(e,t,n){const[s,i]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:Vl({},e),chainId:`${s}:${i}`,topic:this.session.topic,expiry:n})}sendAsync(e,t,n,s){const i=new Date().getTime();this.request(e,n,s).then(o=>t(null,Fu(i,o))).catch(o=>t(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:Le("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,t){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:n,response:s}=await this.client.authenticate(e,t);n&&(this.uri=n,this.events.emit("display_uri",n));const i=await s();if(this.session=i.session,this.session){const o=B2(this.session.namespaces);this.namespaces=dh(this.namespaces,o),await this.persist("namespaces",this.namespaces),this.onConnect()}return i}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){const{uri:t,approval:n}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});t&&(this.uri=t,this.events.emit("display_uri",t));const s=await n();this.session=s;const i=B2(s.namespaces);return this.namespaces=dh(this.namespaces,i),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[n,s]=this.validateChain(e);this.getProvider(n).setDefaultChain(s,t)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(e={}){try{this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(!Kr(t))return;for(const n of t)e.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}catch(t){this.logger.warn("Failed to cleanup pending pairings",t)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,t;if(this.client=this.providerOpts.client||await Jz.init({core:this.providerOpts.core,logger:this.providerOpts.logger||S2,relayUrl:this.providerOpts.relayUrl||oH,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(n){throw this.logger.error("Failed to get session",n),new Error(`The provided session: ${(t=(e=this.providerOpts)==null?void 0:e.session)==null?void 0:t.topic} doesn't exist in the Sign client`)}else{const n=this.client.session.getAll();this.session=n[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>za(t)))];Pp("client",this.client),Pp("events",this.events),Pp("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const n=VH(t,this.session);if((n==null?void 0:n.length)===0)return;const s=Q6(n),i=dh(this.namespaces,this.optionalNamespaces),o=ph(Vl({},i[t]),{accounts:n,chains:s});switch(t){case"eip155":this.rpcProviders[t]=new Eq({namespace:o});break;default:this.rpcProviders[t]=new Iq({namespace:o})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var t;const{topic:n}=e;n===((t=this.session)==null?void 0:t.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var t;const{params:n,topic:s}=e;if(s!==((t=this.session)==null?void 0:t.topic))return;const{event:i}=n;if(i.name==="accountsChanged"){const o=i.data;o&&Kr(o)&&this.events.emit("accountsChanged",o.map(_2))}else if(i.name==="chainChanged"){const o=n.chainId,a=n.event.data,c=za(o),l=Op(o)!==Op(a)?`${c}:${Op(a)}`:o;this.onChainChanged({currentCaipChainId:l})}else this.events.emit(i.name,i.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var n,s;if(e!==((n=this.session)==null?void 0:n.topic))return;const{namespaces:i}=t,o=(s=this.client)==null?void 0:s.session.get(e);this.session=ph(Vl({},o),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{var t;e.topic===((t=this.session)==null?void 0:t.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",ph(Vl({},Le("USER_DISCONNECTED")),{data:e.topic})))}),this.on(Vy.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(ph(Vl({},e),{internal:!0}))})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[j6]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t={},optionalNamespaces:n={},sessionProperties:s,scopedProperties:i}=e;this.optionalNamespaces=dh(t,n),this.sessionProperties=s,this.scopedProperties=i}validateChain(e){const[t,n]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,n];if(t&&!Object.keys(this.namespaces||{}).map(o=>za(o)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&n)return[t,n];const s=za(Object.keys(this.namespaces)[0]),i=this.rpcProviders[s].getDefaultChain();return[s,i]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged({currentCaipChainId:e,previousCaipChainId:t,internal:n=!1}){if(!this.namespaces)return;const[s,i]=this.validateChain(e);i&&(this.updateNamespaceChain(s,i),n?(this.events.emit("chainChanged",i),this.emitAccountsChangedOnChainChange({namespace:s,currentCaipChainId:e,previousCaipChainId:t})):this.getProvider(s).setDefaultChain(i),await this.persist("namespaces",this.namespaces))}emitAccountsChangedOnChainChange({namespace:e,currentCaipChainId:t,previousCaipChainId:n}){var s,i;try{if(n===t)return;const o=(i=(s=this.session)==null?void 0:s.namespaces[e])==null?void 0:i.accounts;if(!o)return;const a=o.filter(c=>c.includes(`${t}:`)).map(_2);if(!Kr(a))return;this.events.emit("accountsChanged",a)}catch(o){this.logger.warn("Failed to emit accountsChanged on chain change",o)}}updateNamespaceChain(e,t){if(!this.namespaces)return;const n=this.namespaces[e]?e:`${e}:${t}`,s={chains:[],methods:[],events:[],defaultChain:t};this.namespaces[n]?this.namespaces[n]&&(this.namespaces[n].defaultChain=t):this.namespaces[n]=s}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,t){var n;const s=((n=this.session)==null?void 0:n.topic)||"";await this.client.core.storage.setItem(`${fh}/${e}${s}`,t)}async getFromStore(e){var t;const n=((t=this.session)==null?void 0:t.topic)||"";return await this.client.core.storage.getItem(`${fh}/${e}${n}`)}async deleteFromStore(e){var t;const n=((t=this.session)==null?void 0:t.topic)||"";await this.client.core.storage.removeItem(`${fh}/${e}${n}`)}async cleanupStorage(){var e;try{if(((e=this.client)==null?void 0:e.session.length)>0)return;const t=await this.client.core.storage.getKeys();for(const n of t)n.startsWith(fh)&&await this.client.core.storage.removeItem(n)}catch(t){this.logger.warn("Failed to cleanup storage",t)}}}const Nq=Wy,Dq="wc",Rq="ethereum_provider",_q=`${Dq}@2:${Rq}:`,Bq="https://rpc.walletconnect.org/v1/",vb=["eth_sendTransaction","personal_sign"],kq=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_sendCalls","wallet_getCapabilities","wallet_getCallsStatus","wallet_showCallsStatus"],Ab=["chainChanged","accountsChanged"],Uq=["chainChanged","accountsChanged","message","disconnect","connect"],$q=async()=>{const{createAppKit:r}=await ZE(()=>import("./core-BM6p6zA_.js").then(e=>e.ac),[]);return r};var Lq=Object.defineProperty,Fq=Object.defineProperties,Mq=Object.getOwnPropertyDescriptors,q2=Object.getOwnPropertySymbols,jq=Object.prototype.hasOwnProperty,zq=Object.prototype.propertyIsEnumerable,Ib=(r,e,t)=>e in r?Lq(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ao=(r,e)=>{for(var t in e||(e={}))jq.call(e,t)&&Ib(r,t,e[t]);if(q2)for(var t of q2(e))zq.call(e,t)&&Ib(r,t,e[t]);return r},Kl=(r,e)=>Fq(r,Mq(e)),lr=(r,e,t)=>Ib(r,typeof e!="symbol"?e+"":e,t);function md(r){return Number(r[0].split(":")[1])}function gh(r){return`0x${r.toString(16)}`}function Hq(r){const{chains:e,optionalChains:t,methods:n,optionalMethods:s,events:i,optionalEvents:o,rpcMap:a}=r;if(!Kr(e))throw new Error("Invalid chains");const c={chains:e,methods:n||vb,events:i||Ab,rpcMap:ao({},e.length?{[md(e)]:a[md(e)]}:{})},l=i==null?void 0:i.filter(d=>!Ab.includes(d)),u=n==null?void 0:n.filter(d=>!vb.includes(d));if(!t&&!o&&!s&&!(l!=null&&l.length)&&!(u!=null&&u.length))return{required:e.length?c:void 0};const f=(l==null?void 0:l.length)&&(u==null?void 0:u.length)||!t,h={chains:[...new Set(f?c.chains.concat(t||[]):t)],methods:[...new Set(c.methods.concat(s!=null&&s.length?s:kq))],events:[...new Set(c.events.concat(o!=null&&o.length?o:Uq))],rpcMap:a};return{required:e.length?c:void 0,optional:t.length?h:void 0}}class Qy{constructor(){lr(this,"events",new Ar.EventEmitter),lr(this,"namespace","eip155"),lr(this,"accounts",[]),lr(this,"signer"),lr(this,"chainId",1),lr(this,"modal"),lr(this,"rpc"),lr(this,"STORAGE_KEY",_q),lr(this,"on",(e,t)=>(this.events.on(e,t),this)),lr(this,"once",(e,t)=>(this.events.once(e,t),this)),lr(this,"removeListener",(e,t)=>(this.events.removeListener(e,t),this)),lr(this,"off",(e,t)=>(this.events.off(e,t),this)),lr(this,"parseAccount",e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e),this.signer={},this.rpc={}}static async init(e){const t=new Qy;return await t.initialize(e),t}async request(e,t){return await this.signer.request(e,this.formatChainId(this.chainId),t)}sendAsync(e,t,n){this.signer.sendAsync(e,t,this.formatChainId(this.chainId),n)}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){var t;if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:n,optional:s}=Hq(this.rpc);try{const i=await new Promise(async(a,c)=>{var l,u;this.rpc.showQrModal&&((l=this.modal)==null||l.open(),(u=this.modal)==null||u.subscribeState(h=>{!h.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),c(new Error("Connection request reset. Please try again.")))}));const f=e!=null&&e.scopedProperties?{[this.namespace]:e.scopedProperties}:void 0;await this.signer.connect(Kl(ao({namespaces:ao({},n&&{[this.namespace]:n})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:e==null?void 0:e.pairingTopic,scopedProperties:f})).then(h=>{a(h)}).catch(h=>{var d;(d=this.modal)==null||d.showErrorMessage("Unable to connect"),c(new Error(h.message))})});if(!i)return;const o=Pw(i.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:o),this.setAccounts(o),this.events.emit("connect",{chainId:gh(this.chainId)})}catch(i){throw this.signer.logger.error(i),i}finally{(t=this.modal)==null||t.close()}}async authenticate(e,t){var n;if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts({chains:e==null?void 0:e.chains});try{const s=await new Promise(async(o,a)=>{var c,l;this.rpc.showQrModal&&((c=this.modal)==null||c.open(),(l=this.modal)==null||l.subscribeState(u=>{!u.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),a(new Error("Connection request reset. Please try again.")))})),await this.signer.authenticate(Kl(ao({},e),{chains:this.rpc.chains}),t).then(u=>{o(u)}).catch(u=>{var f;(f=this.modal)==null||f.showErrorMessage("Unable to connect"),a(new Error(u.message))})}),i=s.session;if(i){const o=Pw(i.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:o),this.setAccounts(o),this.events.emit("connect",{chainId:gh(this.chainId)})}return s}catch(s){throw this.signer.logger.error(s),s}finally{(n=this.modal)==null||n.close()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:t}=e,{event:n}=t;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",e)}),this.signer.on("accountsChanged",e=>{this.accounts=this.parseAccounts(e),this.events.emit("accountsChanged",this.accounts)}),this.signer.on("chainChanged",e=>{const t=parseInt(e);this.chainId=t,this.events.emit("chainChanged",gh(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",Kl(ao({},Le("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const t=e.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",gh(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const t=this.parseChainId(e);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(e){const[t,n,s]=e.split(":");return{chainId:`${t}:${n}`,address:s}}setAccounts(e){this.accounts=e.filter(t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId).map(t=>this.parseAccountId(t).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var t,n;const s=(t=e==null?void 0:e.chains)!=null?t:[],i=(n=e==null?void 0:e.optionalChains)!=null?n:[],o=s.concat(i);if(!o.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const a=s.length?(e==null?void 0:e.methods)||vb:[],c=s.length?(e==null?void 0:e.events)||Ab:[],l=(e==null?void 0:e.optionalMethods)||[],u=(e==null?void 0:e.optionalEvents)||[],f=(e==null?void 0:e.rpcMap)||this.buildRpcMap(o,e.projectId),h=(e==null?void 0:e.qrModalOptions)||void 0;return{chains:s==null?void 0:s.map(d=>this.formatChainId(d)),optionalChains:i.map(d=>this.formatChainId(d)),methods:a,events:c,optionalMethods:l,optionalEvents:u,rpcMap:f,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:h,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,t){const n={};return e.forEach(s=>{n[s]=this.getRpcUrl(s,t)}),n}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?md(this.rpc.chains):md(this.rpc.optionalChains),this.signer=await Nq.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storage:e.storage,storageOptions:e.storageOptions,customStoragePrefix:e.customStoragePrefix,telemetryEnabled:e.telemetryEnabled,logger:e.logger}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let t;try{const n=await $q(),{convertWCMToAppKitOptions:s}=await Promise.resolve().then(function(){return Xq}),i=s(Kl(ao({},this.rpc.qrModalOptions),{chains:[...new Set([...this.rpc.chains,...this.rpc.optionalChains])],metadata:this.rpc.metadata,projectId:this.rpc.projectId}));if(!i.networks.length)throw new Error("No networks found for WalletConnect·");t=n(Kl(ao({},i),{universalProvider:this.signer,manualWCControl:!0}))}catch(n){throw console.warn(n),new Error("To use QR modal, please install @reown/appkit package")}if(t)try{this.modal=t}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;const{chains:t,optionalChains:n,rpcMap:s}=e;t&&Kr(t)&&(this.rpc.chains=t.map(i=>this.formatChainId(i)),t.forEach(i=>{this.rpc.rpcMap[i]=(s==null?void 0:s[i])||this.getRpcUrl(i)})),n&&Kr(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n==null?void 0:n.map(i=>this.formatChainId(i)),n.forEach(i=>{this.rpc.rpcMap[i]=(s==null?void 0:s[i])||this.getRpcUrl(i)}))}getRpcUrl(e,t){var n;return((n=this.rpc.rpcMap)==null?void 0:n[e])||`${Bq}?chainId=eip155:${e}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(this.session)try{const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:t==null?void 0:t.accounts),this.setAccounts(t==null?void 0:t.accounts)}catch(e){this.signer.logger.error("Failed to load persisted session, clearing state..."),this.signer.logger.error(e),await this.disconnect().catch(t=>this.signer.logger.warn(t))}}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(t=>this.parseAccount(t))}}var qq=Object.defineProperty,Vq=Object.defineProperties,Kq=Object.getOwnPropertyDescriptors,V2=Object.getOwnPropertySymbols,Gq=Object.prototype.hasOwnProperty,Wq=Object.prototype.propertyIsEnumerable,K2=(r,e,t)=>e in r?qq(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Z6=(r,e)=>{for(var t in e||(e={}))Gq.call(e,t)&&K2(r,t,e[t]);if(V2)for(var t of V2(e))Wq.call(e,t)&&K2(r,t,e[t]);return r},Qq=(r,e)=>Vq(r,Kq(e));function Jq(r){if(r)return{"--w3m-font-family":r["--wcm-font-family"],"--w3m-accent":r["--wcm-accent-color"],"--w3m-color-mix":r["--wcm-background-color"],"--w3m-z-index":r["--wcm-z-index"]?Number(r["--wcm-z-index"]):void 0,"--w3m-qr-color":r["--wcm-accent-color"],"--w3m-font-size-master":r["--wcm-text-medium-regular-size"],"--w3m-border-radius-master":r["--wcm-container-border-radius"],"--w3m-color-mix-strength":0}}const Yq=r=>{const[e,t]=r.split(":");return X6({id:t,caipNetworkId:r,chainNamespace:e,name:"",nativeCurrency:{name:"",symbol:"",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}})};function Zq(r){var e,t,n,s,i,o,a;const c=(e=r.chains)==null?void 0:e.map(Yq).filter(Boolean);if(c.length===0)throw new Error("At least one chain must be specified");const l=c.find(f=>{var h;return f.id===((h=r.defaultChain)==null?void 0:h.id)}),u={projectId:r.projectId,networks:c,themeMode:r.themeMode,themeVariables:Jq(r.themeVariables),chainImages:r.chainImages,connectorImages:r.walletImages,defaultNetwork:l,metadata:Qq(Z6({},r.metadata),{name:((t=r.metadata)==null?void 0:t.name)||"WalletConnect",description:((n=r.metadata)==null?void 0:n.description)||"Connect to WalletConnect-compatible wallets",url:((s=r.metadata)==null?void 0:s.url)||"https://walletconnect.org",icons:((i=r.metadata)==null?void 0:i.icons)||["https://walletconnect.org/walletconnect-logo.png"]}),showWallets:!0,featuredWalletIds:r.explorerRecommendedWalletIds==="NONE"?[]:Array.isArray(r.explorerRecommendedWalletIds)?r.explorerRecommendedWalletIds:[],excludeWalletIds:r.explorerExcludedWalletIds==="ALL"?[]:Array.isArray(r.explorerExcludedWalletIds)?r.explorerExcludedWalletIds:[],enableEIP6963:!1,enableInjected:!1,enableCoinbase:!0,enableWalletConnect:!0,features:{email:!1,socials:!1}};if((o=r.mobileWallets)!=null&&o.length||(a=r.desktopWallets)!=null&&a.length){const f=[...(r.mobileWallets||[]).map(p=>({id:p.id,name:p.name,links:p.links})),...(r.desktopWallets||[]).map(p=>({id:p.id,name:p.name,links:{native:p.links.native,universal:p.links.universal}}))],h=[...u.featuredWalletIds||[],...u.excludeWalletIds||[]],d=f.filter(p=>!h.includes(p.id));d.length&&(u.customWallets=d)}return u}function X6(r){return Z6({formatters:void 0,fees:void 0,serializers:void 0},r)}var Xq=Object.freeze({__proto__:null,convertWCMToAppKitOptions:Zq,defineChain:X6});window.ethers=sO;const eV="611536788e4297012ef34993004d5565",du=56,tV={56:"https://bsc-dataseed.binance.org/",137:"https://polygon-rpc.com",1:"https://eth.llamarpc.com"},rV="0x55d398326f99059fF775485246999027B3197955",nV=["function balanceOf(address) view returns (uint256)","function decimals() view returns (uint8)","function symbol() view returns (string)","function transfer(address to, uint256 value) returns (bool)"];let Gn=null,vt=null,ks=null,zr=null,la,Yr,Mh,Ae,gn;function sV(){la=document.getElementById("walletAddr"),Yr=document.getElementById("walletBalance"),Mh=document.getElementById("status"),Ae=document.getElementById("payBtn"),gn=document.getElementById("reconnectBtn")}function Se(r,e=!1){Mh&&(Mh.innerText=`Status: ${r}`,Mh.style.color=e?"crimson":"")}async function eA({showQrModal:r=!1}={}){return await Qy.init({projectId:eV,chains:[du],showQrModal:r,rpcMap:{[du]:tV[du]},optionalChains:[]})}async function iV(r,e=du){const t="0x"+Number(e).toString(16);async function n(i){if(!i)return!1;try{if(typeof i.request=="function")return await i.request({method:"wallet_switchEthereumChain",params:[{chainId:t}]}),!0;if(typeof i.send=="function")return await i.send("wallet_switchEthereumChain",[{chainId:t}]),!0;if(typeof i.sendAsync=="function")return await new Promise((o,a)=>i.sendAsync({jsonrpc:"2.0",id:Date.now(),method:"wallet_switchEthereumChain",params:[{chainId:t}]},(c,l)=>c?a(c):o(l))),!0}catch{return!1}return!1}const s=[r,Gn,vt&&vt.provider,vt];for(const i of s)if(i)try{if(await n(i))return!0}catch{}return!1}async function tA(){return await iV(Gn||vt&&vt.provider||vt,du)?(await new Promise(e=>setTimeout(e,700)),Se("Switched to BSC"),!0):(Se("Switch wallet to BSC (BNB Smart Chain) and reconnect.",!0),gn&&(gn.style.display="inline-block"),!1)}async function G2(){Se("restoring session...");try{return Gn=await eA({showQrModal:!1}),await Gn.enable(),vt=new Ru(Gn),ks=await vt.getSigner(),zr=await ks.getAddress(),window.__wcProvider=Gn,window.__provider=vt,window.__signer=ks,la&&(la.innerText=zr),Se("connected: "+zr),Ae&&(Ae.disabled=!1),gn&&(gn.style.display="none"),await tA(),await xd(zr),zr}catch(r){return console.warn("restoreSession failed:",r),Se("no active wallet session"),gn&&(gn.style.display="inline-block"),Ae&&(Ae.disabled=!0),null}}async function W2(){Se("opening WalletConnect QR...");try{Gn=await eA({showQrModal:!0}),await Gn.enable(),vt=new Ru(Gn),ks=await vt.getSigner(),zr=await ks.getAddress(),window.__wcProvider=Gn,window.__provider=vt,window.__signer=ks,la&&(la.innerText=zr),Se("connected: "+zr),Ae&&(Ae.disabled=!1),gn&&(gn.style.display="none"),await tA();try{if(window.USER_ID){const r=document.querySelector('meta[name="csrf-token"]'),e=r?r.getAttribute("content"):null;await fetch("/customer/wallet/save",{method:"POST",headers:{"Content-Type":"application/json",...e?{"X-CSRF-TOKEN":e}:{}},body:JSON.stringify({wallet_address:zr,user_id:window.USER_ID})})}}catch(r){console.warn("save wallet failed:",r)}return await xd(zr),zr}catch(r){throw console.error("openConnectQr failed:",r),Se("connect failed: "+(r.message||r),!0),r}}async function xd(r=null){var e,t;try{const n=r||zr||(la?la.innerText.trim():null);if(!n)return Yr&&(Yr.innerText="Not connected"),null;Se("fetching balance...");const s=window.USDT_CONTRACT||rV,i=`/wallet/balance/${encodeURIComponent(n)}?token=${encodeURIComponent(s)}`,o=await fetch(i,{headers:{Accept:"application/json"}});if(!o.ok)return console.error("Balance API error:",o.status,await o.text()),Yr&&(Yr.innerText="Error"),Se("balance fetch failed",!0),null;const a=await o.json();if(!a.ok)return console.error("Balance API returned error",a),Yr&&(Yr.innerText="Error"),Se("balance API error",!0),null;const c=((e=a.native)==null?void 0:e.balance)??"0",l=((t=a.native)==null?void 0:t.symbol)??"NATIVE";let u="0.00 USDT";return a.token&&a.token.balance!==void 0&&(u=parseFloat(a.token.balance).toFixed((a.token.decimals===6,2))+" USDT"),Yr&&(Yr.innerText=`${c} ${l} | ${u}`),Se("balance updated"),a}catch(n){return console.error("fetchBalanceFromServer error:",n),Yr&&(Yr.innerText="Error"),Se("fetch error",!0),null}}async function oV(){try{if(!vt||!ks){alert("Please connect your wallet first.");return}const r=(await ks.getAddress()).toLowerCase(),e=(window.SAVED_WALLET||"").toLowerCase();if(e&&e!==""&&r!==e&&!confirm("Connected wallet differs from saved wallet. Continue with connected wallet?"))return;const t=(window.USDT_CONTRACT||"").trim(),n=(window.RECEIVER||"").trim(),s=String(window.AMOUNT||"0").trim();if(!t){alert("Token contract not configured (USDT).");return}if(!n){alert("Receiver wallet not configured.");return}if(!s||Number(s)<=0){alert("Payment amount invalid.");return}Ae&&(Ae.disabled=!0,Ae.classList.add("disabled")),Se("Preparing payment...");const i=await vt.getCode(t).catch(()=>"0x");if(!i||i==="0x"||i==="0x0"){alert("Token contract not found on current network. Switch network and reconnect."),Se("Token not on chain",!0),Ae&&(Ae.disabled=!1,Ae.classList.remove("disabled"));return}const o=new ki(t,nV,vt),a=o.connect(ks);let c=18;try{c=Number(await o.decimals())}catch{}let l="TOKEN";try{l=await o.symbol()}catch{}const u=iu(s,c);Se("Checking token balance...");let f;try{f=await o.balanceOf(r)}catch(P){console.error("balanceOf failed:",P),alert("Could not read token balance. Try reconnecting."),Se("Balance read failed",!0),Ae&&(Ae.disabled=!1,Ae.classList.remove("disabled"));return}if(BigInt(f.toString())<BigInt(u.toString())){alert(`Insufficient ${l}. Have ${Nb(f,c)}, need ${s}`),Se("Insufficient token balance",!0),Ae&&(Ae.disabled=!1,Ae.classList.remove("disabled"));return}Se("Checking native balance for gas...");const h=await vt.getBalance(r);let d;try{d=await a.estimateGas.transfer(n,u),d=BigInt(d.toString())}catch(P){console.warn("estimateGas failed, fallback to 150000",P),d=150000n}const p=await vt.getFeeData();let g=p.maxFeePerGas??p.gasPrice??iu("5","gwei");g=BigInt(g.toString());const y=g*d,x=BigInt(iu("0.0005","ether").toString());if(BigInt(h.toString())<y+x){const P=parseFloat($p(h||0n)).toFixed(6),T=parseFloat($p(y+x)).toFixed(6);alert(`Insufficient native token (for gas).
You have: ${P}
Required (approx): ${T}
Please top up and try again.`),Se("Insufficient native for gas",!0),Ae&&(Ae.disabled=!1,Ae.classList.remove("disabled"));return}Se("Please approve the transaction in your wallet app…");let A;try{A=await a.transfer(n,u)}catch(P){console.error("transfer() failed:",P);const T=P&&P.message?P.message.toLowerCase():"";T.includes("user rejected")||T.includes("rejected")||P.code===4001?(Se("Transaction rejected by user",!0),alert("You rejected the transaction in your wallet.")):(Se("Transaction send failed",!0),alert("Transaction failed to send: "+(P.message||P))),Ae&&(Ae.disabled=!1,Ae.classList.remove("disabled"));return}Se("Transaction submitted — waiting for confirmation...");try{await A.wait(1)}catch(P){console.warn("tx.wait failed:",P),Se("Transaction submitted (no confirmation yet). Verifying...",!0)}Se("Verifying with server...");const w=document.querySelector('meta[name="csrf-token"]'),O=w?w.getAttribute("content"):null,E=await(await fetch("/api/payment/verify",{method:"POST",headers:{"Content-Type":"application/json",...O?{"X-CSRF-TOKEN":O}:{}},body:JSON.stringify({user_id:window.USER_ID,token_contract:t,amount:s,tx_hash:A.hash,from_address:r,receiver:n})})).json();if(E.ok)if(Se("Payment verified ✔"),window.RETURN_URL){const P=new URL(window.RETURN_URL);P.searchParams.set("user_id",window.USER_ID),P.searchParams.set("plan_id",window.PLAN_ID),P.searchParams.set("tx",A.hash),window.location.href=P.toString()}else alert("Payment successful: "+A.hash);else Se("Server verification failed",!0),console.error("verify response:",E),alert("Verify failed: "+(E.error||JSON.stringify(E)));Ae&&(Ae.disabled=!1,Ae.classList.remove("disabled"))}catch(r){console.error("payWithToken outer error:",r),Se("payment error: "+(r.message||r),!0),alert("Payment error: "+(r.message||r)),Ae&&(Ae.disabled=!1,Ae.classList.remove("disabled"))}}document.addEventListener("DOMContentLoaded",async()=>{if(sV(),window.connectWalletConnect=W2,window.openConnectQr=W2,window.restoreSession=G2,window.refreshBalance=()=>xd(),window.payWithToken=oV,window.SAVED_WALLET)try{await G2()}catch(r){console.warn("silent restore failed",r)}else Se("no saved wallet");gn&&(gn.onclick=()=>{window.openConnectQr?window.openConnectQr():location.reload()}),setInterval(()=>{xd()},15e3)});export{dV as $,W$ as A,by as B,IR as C,PD as D,Kt as E,Fs as F,oa as G,Ri as H,da as I,s0 as J,Tn as K,jr as L,Cn as M,F6 as N,PP as O,ww as P,Xv as Q,fV as R,Wx as S,fv as T,fl as U,wP as V,lv as W,CP as X,hV as Y,uV as Z,ZE as _,Z as a,xP as a0,pV as a1,gV as a2,td as a3,bV as a4,gy as a5,Ls as b,XO as c,yO as d,cu as e,Hr as f,mf as g,PC as h,mC as i,kC as j,CR as k,Ar as l,n0 as m,YU as n,D$ as o,fn as p,Pf as q,pa as r,qg as s,sr as t,Hy as u,$L as v,zy as w,i0 as x,ar as y,Fu as z};
